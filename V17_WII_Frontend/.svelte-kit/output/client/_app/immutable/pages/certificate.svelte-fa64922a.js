import{S as w1,i as S1,s as C1,x as K,y as M,z as H,f as D,t as O,C as F,o as A1,a as Z,e as Vs,c as ee,b as q,h as J,g as In,d as Bn,r as Kt,u as Mt,a1 as K0,a3 as Qf,a4 as Yf,a5 as zf,l as M0,m as H0,p as es,J as F0,F as xn,v as q0}from"../chunks/index-37477684.js";import{s as E1}from"../chunks/Indicator.svelte_svelte_type_style_lang-a281e7b7.js";import{B as J0}from"../chunks/Button-4b5393cf.js";import{F as Xf}from"../chunks/FloatingLabelInput-62e044b3.js";import{T as G0}from"../chunks/Table-88186101.js";import{T as j0,a as Nn,b as we}from"../chunks/TableBodyRow-e94a7e03.js";import{T as W0,a as st}from"../chunks/TableHeadCell-b43d40fe.js";import{T as Dh}from"../chunks/TabItem-1cd057fb.js";import{T as b1}from"../chunks/Tabs-1b53a38d.js";import{a4 as Rm,a_ as fd,bh as k1}from"../chunks/configG-9163882e.js";import"../chunks/index-744c10a2.js";var I1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function B1(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function x1(s){var e=s.default;if(typeof e=="function"){var t=function(){return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(r){var a=Object.getOwnPropertyDescriptor(s,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return s[r]}})}),t}var jp={exports:{}},Fe={options:{usePureJavaScript:!1}},Kg={},N1=Kg,Vm={};Kg.encode=function(s,e,t){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(t!==void 0&&typeof t!="number")throw new TypeError('"maxline" must be a number.');var r="";if(!(s instanceof Uint8Array))r=T1(s,e);else{var a=0,n=e.length,i=e.charAt(0),o=[0];for(a=0;a<s.length;++a){for(var l=0,u=s[a];l<o.length;++l)u+=o[l]<<8,o[l]=u%n,u=u/n|0;for(;u>0;)o.push(u%n),u=u/n|0}for(a=0;s[a]===0&&a<s.length-1;++a)r+=i;for(a=o.length-1;a>=0;--a)r+=e[o[a]]}if(t){var c=new RegExp(".{1,"+t+"}","g");r=r.match(c).join(`\r
`)}return r};Kg.decode=function(s,e){if(typeof s!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var t=Vm[e];if(!t){t=Vm[e]=[];for(var r=0;r<e.length;++r)t[e.charCodeAt(r)]=r}s=s.replace(/\s/g,"");for(var a=e.length,n=e.charAt(0),i=[0],r=0;r<s.length;r++){var o=t[s.charCodeAt(r)];if(o===void 0)return;for(var l=0,u=o;l<i.length;++l)u+=i[l]*a,i[l]=u&255,u>>=8;for(;u>0;)i.push(u&255),u>>=8}for(var c=0;s[c]===n&&c<s.length-1;++c)i.push(0);return typeof Buffer<"u"?Buffer.from(i.reverse()):new Uint8Array(i.reverse())};function T1(s,e){var t=0,r=e.length,a=e.charAt(0),n=[0];for(t=0;t<s.length();++t){for(var i=0,o=s.at(t);i<n.length;++i)o+=n[i]<<8,n[i]=o%r,o=o/r|0;for(;o>0;)n.push(o%r),o=o/r|0}var l="";for(t=0;s.at(t)===0&&t<s.length()-1;++t)l+=a;for(t=n.length-1;t>=0;--t)l+=e[n[t]];return l}var _m=Fe,$m=N1,x=_m.util=_m.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){x.nextTick=process.nextTick,typeof setImmediate=="function"?x.setImmediate=setImmediate:x.setImmediate=x.nextTick;return}if(typeof setImmediate=="function"){x.setImmediate=function(){return setImmediate.apply(void 0,arguments)},x.nextTick=function(i){return setImmediate(i)};return}if(x.setImmediate=function(i){setTimeout(i,0)},typeof window<"u"&&typeof window.postMessage=="function"){let i=function(o){if(o.source===window&&o.data===s){o.stopPropagation();var l=e.slice();e.length=0,l.forEach(function(u){u()})}};var s="forge.setImmediate",e=[];x.setImmediate=function(o){e.push(o),e.length===1&&window.postMessage(s,"*")},window.addEventListener("message",i,!0)}if(typeof MutationObserver<"u"){var t=Date.now(),r=!0,a=document.createElement("div"),e=[];new MutationObserver(function(){var o=e.slice();e.length=0,o.forEach(function(l){l()})}).observe(a,{attributes:!0});var n=x.setImmediate;x.setImmediate=function(o){Date.now()-t>15?(t=Date.now(),n(o)):(e.push(o),e.length===1&&a.setAttribute("a",r=!r))}}x.nextTick=x.setImmediate})();x.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;x.globalScope=function(){return x.isNodejs?I1:typeof self>"u"?window:self}();x.isArray=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};x.isArrayBuffer=function(s){return typeof ArrayBuffer<"u"&&s instanceof ArrayBuffer};x.isArrayBufferView=function(s){return s&&x.isArrayBuffer(s.buffer)&&s.byteLength!==void 0};function Zf(s){if(!(s===8||s===16||s===24||s===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+s)}x.ByteBuffer=Mg;function Mg(s){if(this.data="",this.read=0,typeof s=="string")this.data=s;else if(x.isArrayBuffer(s)||x.isArrayBufferView(s))if(typeof Buffer<"u"&&s instanceof Buffer)this.data=s.toString("binary");else{var e=new Uint8Array(s);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var t=0;t<e.length;++t)this.putByte(e[t])}}else(s instanceof Mg||typeof s=="object"&&typeof s.data=="string"&&typeof s.read=="number")&&(this.data=s.data,this.read=s.read);this._constructedStringLength=0}x.ByteStringBuffer=Mg;var R1=4096;x.ByteStringBuffer.prototype._optimizeConstructedString=function(s){this._constructedStringLength+=s,this._constructedStringLength>R1&&(this.data.substr(0,1),this._constructedStringLength=0)};x.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};x.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};x.ByteStringBuffer.prototype.putByte=function(s){return this.putBytes(String.fromCharCode(s))};x.ByteStringBuffer.prototype.fillWithByte=function(s,e){s=String.fromCharCode(s);for(var t=this.data;e>0;)e&1&&(t+=s),e>>>=1,e>0&&(s+=s);return this.data=t,this._optimizeConstructedString(e),this};x.ByteStringBuffer.prototype.putBytes=function(s){return this.data+=s,this._optimizeConstructedString(s.length),this};x.ByteStringBuffer.prototype.putString=function(s){return this.putBytes(x.encodeUtf8(s))};x.ByteStringBuffer.prototype.putInt16=function(s){return this.putBytes(String.fromCharCode(s>>8&255)+String.fromCharCode(s&255))};x.ByteStringBuffer.prototype.putInt24=function(s){return this.putBytes(String.fromCharCode(s>>16&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s&255))};x.ByteStringBuffer.prototype.putInt32=function(s){return this.putBytes(String.fromCharCode(s>>24&255)+String.fromCharCode(s>>16&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s&255))};x.ByteStringBuffer.prototype.putInt16Le=function(s){return this.putBytes(String.fromCharCode(s&255)+String.fromCharCode(s>>8&255))};x.ByteStringBuffer.prototype.putInt24Le=function(s){return this.putBytes(String.fromCharCode(s&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s>>16&255))};x.ByteStringBuffer.prototype.putInt32Le=function(s){return this.putBytes(String.fromCharCode(s&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s>>16&255)+String.fromCharCode(s>>24&255))};x.ByteStringBuffer.prototype.putInt=function(s,e){Zf(e);var t="";do e-=8,t+=String.fromCharCode(s>>e&255);while(e>0);return this.putBytes(t)};x.ByteStringBuffer.prototype.putSignedInt=function(s,e){return s<0&&(s+=2<<e-1),this.putInt(s,e)};x.ByteStringBuffer.prototype.putBuffer=function(s){return this.putBytes(s.getBytes())};x.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};x.ByteStringBuffer.prototype.getInt16=function(){var s=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,s};x.ByteStringBuffer.prototype.getInt24=function(){var s=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,s};x.ByteStringBuffer.prototype.getInt32=function(){var s=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,s};x.ByteStringBuffer.prototype.getInt16Le=function(){var s=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,s};x.ByteStringBuffer.prototype.getInt24Le=function(){var s=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,s};x.ByteStringBuffer.prototype.getInt32Le=function(){var s=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,s};x.ByteStringBuffer.prototype.getInt=function(s){Zf(s);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),s-=8;while(s>0);return e};x.ByteStringBuffer.prototype.getSignedInt=function(s){var e=this.getInt(s),t=2<<s-2;return e>=t&&(e-=t<<1),e};x.ByteStringBuffer.prototype.getBytes=function(s){var e;return s?(s=Math.min(this.length(),s),e=this.data.slice(this.read,this.read+s),this.read+=s):s===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};x.ByteStringBuffer.prototype.bytes=function(s){return typeof s>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+s)};x.ByteStringBuffer.prototype.at=function(s){return this.data.charCodeAt(this.read+s)};x.ByteStringBuffer.prototype.setAt=function(s,e){return this.data=this.data.substr(0,this.read+s)+String.fromCharCode(e)+this.data.substr(this.read+s+1),this};x.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};x.ByteStringBuffer.prototype.copy=function(){var s=x.createBuffer(this.data);return s.read=this.read,s};x.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};x.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};x.ByteStringBuffer.prototype.truncate=function(s){var e=Math.max(0,this.length()-s);return this.data=this.data.substr(this.read,e),this.read=0,this};x.ByteStringBuffer.prototype.toHex=function(){for(var s="",e=this.read;e<this.data.length;++e){var t=this.data.charCodeAt(e);t<16&&(s+="0"),s+=t.toString(16)}return s};x.ByteStringBuffer.prototype.toString=function(){return x.decodeUtf8(this.bytes())};function V1(s,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var t=x.isArrayBuffer(s),r=x.isArrayBufferView(s);if(t||r){t?this.data=new DataView(s):this.data=new DataView(s.buffer,s.byteOffset,s.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,s!=null&&this.putBytes(s),"writeOffset"in e&&(this.write=e.writeOffset)}x.DataBuffer=V1;x.DataBuffer.prototype.length=function(){return this.write-this.read};x.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};x.DataBuffer.prototype.accommodate=function(s,e){if(this.length()>=s)return this;e=Math.max(e||this.growSize,s);var t=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),r=new Uint8Array(this.length()+e);return r.set(t),this.data=new DataView(r.buffer),this};x.DataBuffer.prototype.putByte=function(s){return this.accommodate(1),this.data.setUint8(this.write++,s),this};x.DataBuffer.prototype.fillWithByte=function(s,e){this.accommodate(e);for(var t=0;t<e;++t)this.data.setUint8(s);return this};x.DataBuffer.prototype.putBytes=function(s,e){if(x.isArrayBufferView(s)){var t=new Uint8Array(s.buffer,s.byteOffset,s.byteLength),r=t.byteLength-t.byteOffset;this.accommodate(r);var a=new Uint8Array(this.data.buffer,this.write);return a.set(t),this.write+=r,this}if(x.isArrayBuffer(s)){var t=new Uint8Array(s);this.accommodate(t.byteLength);var a=new Uint8Array(this.data.buffer);return a.set(t,this.write),this.write+=t.byteLength,this}if(s instanceof x.DataBuffer||typeof s=="object"&&typeof s.read=="number"&&typeof s.write=="number"&&x.isArrayBufferView(s.data)){var t=new Uint8Array(s.data.byteLength,s.read,s.length());this.accommodate(t.byteLength);var a=new Uint8Array(s.data.byteLength,this.write);return a.set(t),this.write+=t.byteLength,this}if(s instanceof x.ByteStringBuffer&&(s=s.data,e="binary"),e=e||"binary",typeof s=="string"){var n;if(e==="hex")return this.accommodate(Math.ceil(s.length/2)),n=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.hex.decode(s,n,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(s.length/4)*3),n=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.base64.decode(s,n,this.write),this;if(e==="utf8"&&(s=x.encodeUtf8(s),e="binary"),e==="binary"||e==="raw")return this.accommodate(s.length),n=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.raw.decode(n),this;if(e==="utf16")return this.accommodate(s.length*2),n=new Uint16Array(this.data.buffer,this.write),this.write+=x.text.utf16.encode(n),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+s)};x.DataBuffer.prototype.putBuffer=function(s){return this.putBytes(s),s.clear(),this};x.DataBuffer.prototype.putString=function(s){return this.putBytes(s,"utf16")};x.DataBuffer.prototype.putInt16=function(s){return this.accommodate(2),this.data.setInt16(this.write,s),this.write+=2,this};x.DataBuffer.prototype.putInt24=function(s){return this.accommodate(3),this.data.setInt16(this.write,s>>8&65535),this.data.setInt8(this.write,s>>16&255),this.write+=3,this};x.DataBuffer.prototype.putInt32=function(s){return this.accommodate(4),this.data.setInt32(this.write,s),this.write+=4,this};x.DataBuffer.prototype.putInt16Le=function(s){return this.accommodate(2),this.data.setInt16(this.write,s,!0),this.write+=2,this};x.DataBuffer.prototype.putInt24Le=function(s){return this.accommodate(3),this.data.setInt8(this.write,s>>16&255),this.data.setInt16(this.write,s>>8&65535,!0),this.write+=3,this};x.DataBuffer.prototype.putInt32Le=function(s){return this.accommodate(4),this.data.setInt32(this.write,s,!0),this.write+=4,this};x.DataBuffer.prototype.putInt=function(s,e){Zf(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,s>>e&255);while(e>0);return this};x.DataBuffer.prototype.putSignedInt=function(s,e){return Zf(e),this.accommodate(e/8),s<0&&(s+=2<<e-1),this.putInt(s,e)};x.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};x.DataBuffer.prototype.getInt16=function(){var s=this.data.getInt16(this.read);return this.read+=2,s};x.DataBuffer.prototype.getInt24=function(){var s=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,s};x.DataBuffer.prototype.getInt32=function(){var s=this.data.getInt32(this.read);return this.read+=4,s};x.DataBuffer.prototype.getInt16Le=function(){var s=this.data.getInt16(this.read,!0);return this.read+=2,s};x.DataBuffer.prototype.getInt24Le=function(){var s=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,s};x.DataBuffer.prototype.getInt32Le=function(){var s=this.data.getInt32(this.read,!0);return this.read+=4,s};x.DataBuffer.prototype.getInt=function(s){Zf(s);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),s-=8;while(s>0);return e};x.DataBuffer.prototype.getSignedInt=function(s){var e=this.getInt(s),t=2<<s-2;return e>=t&&(e-=t<<1),e};x.DataBuffer.prototype.getBytes=function(s){var e;return s?(s=Math.min(this.length(),s),e=this.data.slice(this.read,this.read+s),this.read+=s):s===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};x.DataBuffer.prototype.bytes=function(s){return typeof s>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+s)};x.DataBuffer.prototype.at=function(s){return this.data.getUint8(this.read+s)};x.DataBuffer.prototype.setAt=function(s,e){return this.data.setUint8(s,e),this};x.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};x.DataBuffer.prototype.copy=function(){return new x.DataBuffer(this)};x.DataBuffer.prototype.compact=function(){if(this.read>0){var s=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(s.byteLength);e.set(s),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};x.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};x.DataBuffer.prototype.truncate=function(s){return this.write=Math.max(0,this.length()-s),this.read=Math.min(this.read,this.write),this};x.DataBuffer.prototype.toHex=function(){for(var s="",e=this.read;e<this.data.byteLength;++e){var t=this.data.getUint8(e);t<16&&(s+="0"),s+=t.toString(16)}return s};x.DataBuffer.prototype.toString=function(s){var e=new Uint8Array(this.data,this.read,this.length());if(s=s||"utf8",s==="binary"||s==="raw")return x.binary.raw.encode(e);if(s==="hex")return x.binary.hex.encode(e);if(s==="base64")return x.binary.base64.encode(e);if(s==="utf8")return x.text.utf8.decode(e);if(s==="utf16")return x.text.utf16.decode(e);throw new Error("Invalid encoding: "+s)};x.createBuffer=function(s,e){return e=e||"raw",s!==void 0&&e==="utf8"&&(s=x.encodeUtf8(s)),new x.ByteBuffer(s)};x.fillString=function(s,e){for(var t="";e>0;)e&1&&(t+=s),e>>>=1,e>0&&(s+=s);return t};x.xorBytes=function(s,e,t){for(var r="",a="",n="",i=0,o=0;t>0;--t,++i)a=s.charCodeAt(i)^e.charCodeAt(i),o>=10&&(r+=n,n="",o=0),n+=String.fromCharCode(a),++o;return r+=n,r};x.hexToBytes=function(s){var e="",t=0;for(s.length&!0&&(t=1,e+=String.fromCharCode(parseInt(s[0],16)));t<s.length;t+=2)e+=String.fromCharCode(parseInt(s.substr(t,2),16));return e};x.bytesToHex=function(s){return x.createBuffer(s).toHex()};x.int32ToBytes=function(s){return String.fromCharCode(s>>24&255)+String.fromCharCode(s>>16&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s&255)};var on="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ln=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Wp="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";x.encode64=function(s,e){for(var t="",r="",a,n,i,o=0;o<s.length;)a=s.charCodeAt(o++),n=s.charCodeAt(o++),i=s.charCodeAt(o++),t+=on.charAt(a>>2),t+=on.charAt((a&3)<<4|n>>4),isNaN(n)?t+="==":(t+=on.charAt((n&15)<<2|i>>6),t+=isNaN(i)?"=":on.charAt(i&63)),e&&t.length>e&&(r+=t.substr(0,e)+`\r
`,t=t.substr(e));return r+=t,r};x.decode64=function(s){s=s.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",t,r,a,n,i=0;i<s.length;)t=ln[s.charCodeAt(i++)-43],r=ln[s.charCodeAt(i++)-43],a=ln[s.charCodeAt(i++)-43],n=ln[s.charCodeAt(i++)-43],e+=String.fromCharCode(t<<2|r>>4),a!==64&&(e+=String.fromCharCode((r&15)<<4|a>>2),n!==64&&(e+=String.fromCharCode((a&3)<<6|n)));return e};x.encodeUtf8=function(s){return unescape(encodeURIComponent(s))};x.decodeUtf8=function(s){return decodeURIComponent(escape(s))};x.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:$m.encode,decode:$m.decode}};x.binary.raw.encode=function(s){return String.fromCharCode.apply(null,s)};x.binary.raw.decode=function(s,e,t){var r=e;r||(r=new Uint8Array(s.length)),t=t||0;for(var a=t,n=0;n<s.length;++n)r[a++]=s.charCodeAt(n);return e?a-t:r};x.binary.hex.encode=x.bytesToHex;x.binary.hex.decode=function(s,e,t){var r=e;r||(r=new Uint8Array(Math.ceil(s.length/2))),t=t||0;var a=0,n=t;for(s.length&1&&(a=1,r[n++]=parseInt(s[0],16));a<s.length;a+=2)r[n++]=parseInt(s.substr(a,2),16);return e?n-t:r};x.binary.base64.encode=function(s,e){for(var t="",r="",a,n,i,o=0;o<s.byteLength;)a=s[o++],n=s[o++],i=s[o++],t+=on.charAt(a>>2),t+=on.charAt((a&3)<<4|n>>4),isNaN(n)?t+="==":(t+=on.charAt((n&15)<<2|i>>6),t+=isNaN(i)?"=":on.charAt(i&63)),e&&t.length>e&&(r+=t.substr(0,e)+`\r
`,t=t.substr(e));return r+=t,r};x.binary.base64.decode=function(s,e,t){var r=e;r||(r=new Uint8Array(Math.ceil(s.length/4)*3)),s=s.replace(/[^A-Za-z0-9\+\/\=]/g,""),t=t||0;for(var a,n,i,o,l=0,u=t;l<s.length;)a=ln[s.charCodeAt(l++)-43],n=ln[s.charCodeAt(l++)-43],i=ln[s.charCodeAt(l++)-43],o=ln[s.charCodeAt(l++)-43],r[u++]=a<<2|n>>4,i!==64&&(r[u++]=(n&15)<<4|i>>2,o!==64&&(r[u++]=(i&3)<<6|o));return e?u-t:r.subarray(0,u)};x.binary.base58.encode=function(s,e){return x.binary.baseN.encode(s,Wp,e)};x.binary.base58.decode=function(s,e){return x.binary.baseN.decode(s,Wp,e)};x.text={utf8:{},utf16:{}};x.text.utf8.encode=function(s,e,t){s=x.encodeUtf8(s);var r=e;r||(r=new Uint8Array(s.length)),t=t||0;for(var a=t,n=0;n<s.length;++n)r[a++]=s.charCodeAt(n);return e?a-t:r};x.text.utf8.decode=function(s){return x.decodeUtf8(String.fromCharCode.apply(null,s))};x.text.utf16.encode=function(s,e,t){var r=e;r||(r=new Uint8Array(s.length*2));var a=new Uint16Array(r.buffer);t=t||0;for(var n=t,i=t,o=0;o<s.length;++o)a[i++]=s.charCodeAt(o),n+=2;return e?n-t:r};x.text.utf16.decode=function(s){return String.fromCharCode.apply(null,new Uint16Array(s.buffer))};x.deflate=function(s,e,t){if(e=x.decode64(s.deflate(x.encode64(e)).rval),t){var r=2,a=e.charCodeAt(1);a&32&&(r=6),e=e.substring(r,e.length-4)}return e};x.inflate=function(s,e,t){var r=s.inflate(x.encode64(e)).rval;return r===null?null:x.decode64(r)};var Hg=function(s,e,t){if(!s)throw new Error("WebStorage not available.");var r;if(t===null?r=s.removeItem(e):(t=x.encode64(JSON.stringify(t)),r=s.setItem(e,t)),typeof r<"u"&&r.rval!==!0){var a=new Error(r.error.message);throw a.id=r.error.id,a.name=r.error.name,a}},Fg=function(s,e){if(!s)throw new Error("WebStorage not available.");var t=s.getItem(e);if(s.init)if(t.rval===null){if(t.error){var r=new Error(t.error.message);throw r.id=t.error.id,r.name=t.error.name,r}t=null}else t=t.rval;return t!==null&&(t=JSON.parse(x.decode64(t))),t},_1=function(s,e,t,r){var a=Fg(s,e);a===null&&(a={}),a[t]=r,Hg(s,e,a)},$1=function(s,e,t){var r=Fg(s,e);return r!==null&&(r=t in r?r[t]:null),r},D1=function(s,e,t){var r=Fg(s,e);if(r!==null&&t in r){delete r[t];var a=!0;for(var n in r){a=!1;break}a&&(r=null),Hg(s,e,r)}},L1=function(s,e){Hg(s,e,null)},Q0=function(s,e,t){var r=null;typeof t>"u"&&(t=["web","flash"]);var a,n=!1,i=null;for(var o in t){a=t[o];try{if(a==="flash"||a==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");r=s.apply(this,e),n=a==="flash"}(a==="web"||a==="both")&&(e[0]=localStorage,r=s.apply(this,e),n=!0)}catch(l){i=l}if(n)break}if(!n)throw i;return r};x.setItem=function(s,e,t,r,a){Q0(_1,arguments,a)};x.getItem=function(s,e,t,r){return Q0($1,arguments,r)};x.removeItem=function(s,e,t,r){Q0(D1,arguments,r)};x.clearItems=function(s,e,t){Q0(L1,arguments,t)};x.isEmpty=function(s){for(var e in s)if(s.hasOwnProperty(e))return!1;return!0};x.format=function(s){for(var e=/%./g,t,r,a=0,n=[],i=0;t=e.exec(s);){r=s.substring(i,e.lastIndex-2),r.length>0&&n.push(r),i=e.lastIndex;var o=t[0][1];switch(o){case"s":case"o":a<arguments.length?n.push(arguments[a+++1]):n.push("<?>");break;case"%":n.push("%");break;default:n.push("<%"+o+"?>")}}return n.push(s.substring(i)),n.join("")};x.formatNumber=function(s,e,t,r){var a=s,n=isNaN(e=Math.abs(e))?2:e,i=t===void 0?",":t,o=r===void 0?".":r,l=a<0?"-":"",u=parseInt(a=Math.abs(+a||0).toFixed(n),10)+"",c=u.length>3?u.length%3:0;return l+(c?u.substr(0,c)+o:"")+u.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+o)+(n?i+Math.abs(a-u).toFixed(n).slice(2):"")};x.formatSize=function(s){return s>=1073741824?s=x.formatNumber(s/1073741824,2,".","")+" GiB":s>=1048576?s=x.formatNumber(s/1048576,2,".","")+" MiB":s>=1024?s=x.formatNumber(s/1024,0)+" KiB":s=x.formatNumber(s,0)+" bytes",s};x.bytesFromIP=function(s){return s.indexOf(".")!==-1?x.bytesFromIPv4(s):s.indexOf(":")!==-1?x.bytesFromIPv6(s):null};x.bytesFromIPv4=function(s){if(s=s.split("."),s.length!==4)return null;for(var e=x.createBuffer(),t=0;t<s.length;++t){var r=parseInt(s[t],10);if(isNaN(r))return null;e.putByte(r)}return e.getBytes()};x.bytesFromIPv6=function(s){var e=0;s=s.split(":").filter(function(i){return i.length===0&&++e,!0});for(var t=(8-s.length+e)*2,r=x.createBuffer(),a=0;a<8;++a){if(!s[a]||s[a].length===0){r.fillWithByte(0,t),t=0;continue}var n=x.hexToBytes(s[a]);n.length<2&&r.putByte(0),r.putBytes(n)}return r.getBytes()};x.bytesToIP=function(s){return s.length===4?x.bytesToIPv4(s):s.length===16?x.bytesToIPv6(s):null};x.bytesToIPv4=function(s){if(s.length!==4)return null;for(var e=[],t=0;t<s.length;++t)e.push(s.charCodeAt(t));return e.join(".")};x.bytesToIPv6=function(s){if(s.length!==16)return null;for(var e=[],t=[],r=0,a=0;a<s.length;a+=2){for(var n=x.bytesToHex(s[a]+s[a+1]);n[0]==="0"&&n!=="0";)n=n.substr(1);if(n==="0"){var i=t[t.length-1],o=e.length;!i||o!==i.end+1?t.push({start:o,end:o}):(i.end=o,i.end-i.start>t[r].end-t[r].start&&(r=t.length-1))}e.push(n)}if(t.length>0){var l=t[r];l.end-l.start>0&&(e.splice(l.start,l.end-l.start+1,""),l.start===0&&e.unshift(""),l.end===7&&e.push(""))}return e.join(":")};x.estimateCores=function(s,e){if(typeof s=="function"&&(e=s,s={}),s=s||{},"cores"in x&&!s.update)return e(null,x.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return x.cores=navigator.hardwareConcurrency,e(null,x.cores);if(typeof Worker>"u")return x.cores=1,e(null,x.cores);if(typeof Blob>"u")return x.cores=2,e(null,x.cores);var t=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(i){var o=Date.now(),l=o+4;self.postMessage({st:o,et:l})})}.toString(),")()"],{type:"application/javascript"}));r([],5,16);function r(i,o,l){if(o===0){var u=Math.floor(i.reduce(function(c,f){return c+f},0)/i.length);return x.cores=Math.max(1,u),URL.revokeObjectURL(t),e(null,x.cores)}a(l,function(c,f){i.push(n(l,f)),r(i,o-1,l)})}function a(i,o){for(var l=[],u=[],c=0;c<i;++c){var f=new Worker(t);f.addEventListener("message",function(g){if(u.push(g.data),u.length===i){for(var v=0;v<i;++v)l[v].terminate();o(null,u)}}),l.push(f)}for(var c=0;c<i;++c)l[c].postMessage(c)}function n(i,o){for(var l=[],u=0;u<i;++u)for(var c=o[u],f=l[u]=[],g=0;g<i;++g)if(u!==g){var v=o[g];(c.st>v.st&&c.st<v.et||v.st>c.st&&v.st<c.et)&&f.push(g)}return l.reduce(function(p,h){return Math.max(p,h.length)},0)}};var Zt=Fe;Zt.cipher=Zt.cipher||{};Zt.cipher.algorithms=Zt.cipher.algorithms||{};Zt.cipher.createCipher=function(s,e){var t=s;if(typeof t=="string"&&(t=Zt.cipher.getAlgorithm(t),t&&(t=t())),!t)throw new Error("Unsupported algorithm: "+s);return new Zt.cipher.BlockCipher({algorithm:t,key:e,decrypt:!1})};Zt.cipher.createDecipher=function(s,e){var t=s;if(typeof t=="string"&&(t=Zt.cipher.getAlgorithm(t),t&&(t=t())),!t)throw new Error("Unsupported algorithm: "+s);return new Zt.cipher.BlockCipher({algorithm:t,key:e,decrypt:!0})};Zt.cipher.registerAlgorithm=function(s,e){s=s.toUpperCase(),Zt.cipher.algorithms[s]=e};Zt.cipher.getAlgorithm=function(s){return s=s.toUpperCase(),s in Zt.cipher.algorithms?Zt.cipher.algorithms[s]:null};var qg=Zt.cipher.BlockCipher=function(s){this.algorithm=s.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=s.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=s.decrypt,this.algorithm.initialize(s)};qg.prototype.start=function(s){s=s||{};var e={};for(var t in s)e[t]=s[t];e.decrypt=this._decrypt,this._finish=!1,this._input=Zt.util.createBuffer(),this.output=s.output||Zt.util.createBuffer(),this.mode.start(e)};qg.prototype.update=function(s){for(s&&this._input.putBuffer(s);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};qg.prototype.finish=function(s){s&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(t){return s(this.blockSize,t,!1)},this.mode.unpad=function(t){return s(this.blockSize,t,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))};var Xt=Fe;Xt.cipher=Xt.cipher||{};var We=Xt.cipher.modes=Xt.cipher.modes||{};We.ecb=function(s){s=s||{},this.name="ECB",this.cipher=s.cipher,this.blockSize=s.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};We.ecb.prototype.start=function(s){};We.ecb.prototype.encrypt=function(s,e,t){if(s.length()<this.blockSize&&!(t&&s.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=s.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)e.putInt32(this._outBlock[r])};We.ecb.prototype.decrypt=function(s,e,t){if(s.length()<this.blockSize&&!(t&&s.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=s.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)e.putInt32(this._outBlock[r])};We.ecb.prototype.pad=function(s,e){var t=s.length()===this.blockSize?this.blockSize:this.blockSize-s.length();return s.fillWithByte(t,t),!0};We.ecb.prototype.unpad=function(s,e){if(e.overflow>0)return!1;var t=s.length(),r=s.at(t-1);return r>this.blockSize<<2?!1:(s.truncate(r),!0)};We.cbc=function(s){s=s||{},this.name="CBC",this.cipher=s.cipher,this.blockSize=s.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};We.cbc.prototype.start=function(s){if(s.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in s)this._iv=Y0(s.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};We.cbc.prototype.encrypt=function(s,e,t){if(s.length()<this.blockSize&&!(t&&s.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=this._prev[r]^s.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)e.putInt32(this._outBlock[r]);this._prev=this._outBlock};We.cbc.prototype.decrypt=function(s,e,t){if(s.length()<this.blockSize&&!(t&&s.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=s.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)e.putInt32(this._prev[r]^this._outBlock[r]);this._prev=this._inBlock.slice(0)};We.cbc.prototype.pad=function(s,e){var t=s.length()===this.blockSize?this.blockSize:this.blockSize-s.length();return s.fillWithByte(t,t),!0};We.cbc.prototype.unpad=function(s,e){if(e.overflow>0)return!1;var t=s.length(),r=s.at(t-1);return r>this.blockSize<<2?!1:(s.truncate(r),!0)};We.cfb=function(s){s=s||{},this.name="CFB",this.cipher=s.cipher,this.blockSize=s.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Xt.util.createBuffer(),this._partialBytes=0};We.cfb.prototype.start=function(s){if(!("iv"in s))throw new Error("Invalid IV parameter.");this._iv=Y0(s.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};We.cfb.prototype.encrypt=function(s,e,t){var r=s.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var a=0;a<this._ints;++a)this._inBlock[a]=s.getInt32()^this._outBlock[a],e.putInt32(this._inBlock[a]);return}var n=(this.blockSize-r)%this.blockSize;n>0&&(n=this.blockSize-n),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialBlock[a]=s.getInt32()^this._outBlock[a],this._partialOutput.putInt32(this._partialBlock[a]);if(n>0)s.read-=this.blockSize;else for(var a=0;a<this._ints;++a)this._inBlock[a]=this._partialBlock[a];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),n>0&&!t)return e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=n,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};We.cfb.prototype.decrypt=function(s,e,t){var r=s.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var a=0;a<this._ints;++a)this._inBlock[a]=s.getInt32(),e.putInt32(this._inBlock[a]^this._outBlock[a]);return}var n=(this.blockSize-r)%this.blockSize;n>0&&(n=this.blockSize-n),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialBlock[a]=s.getInt32(),this._partialOutput.putInt32(this._partialBlock[a]^this._outBlock[a]);if(n>0)s.read-=this.blockSize;else for(var a=0;a<this._ints;++a)this._inBlock[a]=this._partialBlock[a];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),n>0&&!t)return e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=n,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};We.ofb=function(s){s=s||{},this.name="OFB",this.cipher=s.cipher,this.blockSize=s.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Xt.util.createBuffer(),this._partialBytes=0};We.ofb.prototype.start=function(s){if(!("iv"in s))throw new Error("Invalid IV parameter.");this._iv=Y0(s.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};We.ofb.prototype.encrypt=function(s,e,t){var r=s.length();if(s.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var a=0;a<this._ints;++a)e.putInt32(s.getInt32()^this._outBlock[a]),this._inBlock[a]=this._outBlock[a];return}var n=(this.blockSize-r)%this.blockSize;n>0&&(n=this.blockSize-n),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialOutput.putInt32(s.getInt32()^this._outBlock[a]);if(n>0)s.read-=this.blockSize;else for(var a=0;a<this._ints;++a)this._inBlock[a]=this._outBlock[a];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),n>0&&!t)return e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=n,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};We.ofb.prototype.decrypt=We.ofb.prototype.encrypt;We.ctr=function(s){s=s||{},this.name="CTR",this.cipher=s.cipher,this.blockSize=s.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Xt.util.createBuffer(),this._partialBytes=0};We.ctr.prototype.start=function(s){if(!("iv"in s))throw new Error("Invalid IV parameter.");this._iv=Y0(s.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};We.ctr.prototype.encrypt=function(s,e,t){var r=s.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize)for(var a=0;a<this._ints;++a)e.putInt32(s.getInt32()^this._outBlock[a]);else{var n=(this.blockSize-r)%this.blockSize;n>0&&(n=this.blockSize-n),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialOutput.putInt32(s.getInt32()^this._outBlock[a]);if(n>0&&(s.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),n>0&&!t)return e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=n,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}z0(this._inBlock)};We.ctr.prototype.decrypt=We.ctr.prototype.encrypt;We.gcm=function(s){s=s||{},this.name="GCM",this.cipher=s.cipher,this.blockSize=s.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Xt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};We.gcm.prototype.start=function(s){if(!("iv"in s))throw new Error("Invalid IV parameter.");var e=Xt.util.createBuffer(s.iv);this._cipherLength=0;var t;if("additionalData"in s?t=Xt.util.createBuffer(s.additionalData):t=Xt.util.createBuffer(),"tagLength"in s?this._tagLength=s.tagLength:this._tagLength=128,this._tag=null,s.decrypt&&(this._tag=Xt.util.createBuffer(s.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var r=e.length();if(r===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Qd(r*8)))}this._inBlock=this._j0.slice(0),z0(this._inBlock),this._partialBytes=0,t=Xt.util.createBuffer(t),this._aDataLength=Qd(t.length()*8);var a=t.length()%this.blockSize;for(a&&t.fillWithByte(0,this.blockSize-a),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])};We.gcm.prototype.encrypt=function(s,e,t){var r=s.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var a=0;a<this._ints;++a)e.putInt32(this._outBlock[a]^=s.getInt32());this._cipherLength+=this.blockSize}else{var n=(this.blockSize-r)%this.blockSize;n>0&&(n=this.blockSize-n),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialOutput.putInt32(s.getInt32()^this._outBlock[a]);if(n<=0||t){if(t){var i=r%this.blockSize;this._cipherLength+=i,this._partialOutput.truncate(this.blockSize-i)}else this._cipherLength+=this.blockSize;for(var a=0;a<this._ints;++a)this._outBlock[a]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),n>0&&!t)return s.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=n,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),z0(this._inBlock)};We.gcm.prototype.decrypt=function(s,e,t){var r=s.length();if(r<this.blockSize&&!(t&&r>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),z0(this._inBlock),this._hashBlock[0]=s.getInt32(),this._hashBlock[1]=s.getInt32(),this._hashBlock[2]=s.getInt32(),this._hashBlock[3]=s.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var a=0;a<this._ints;++a)e.putInt32(this._outBlock[a]^this._hashBlock[a]);r<this.blockSize?this._cipherLength+=r%this.blockSize:this._cipherLength+=this.blockSize};We.gcm.prototype.afterFinish=function(s,e){var t=!0;e.decrypt&&e.overflow&&s.truncate(this.blockSize-e.overflow),this.tag=Xt.util.createBuffer();var r=this._aDataLength.concat(Qd(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,r);var a=[];this.cipher.encrypt(this._j0,a);for(var n=0;n<this._ints;++n)this.tag.putInt32(this._s[n]^a[n]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(t=!1),t};We.gcm.prototype.multiply=function(s,e){for(var t=[0,0,0,0],r=e.slice(0),a=0;a<128;++a){var n=s[a/32|0]&1<<31-a%32;n&&(t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3]),this.pow(r,r)}return t};We.gcm.prototype.pow=function(s,e){for(var t=s[3]&1,r=3;r>0;--r)e[r]=s[r]>>>1|(s[r-1]&1)<<31;e[0]=s[0]>>>1,t&&(e[0]^=this._R)};We.gcm.prototype.tableMultiply=function(s){for(var e=[0,0,0,0],t=0;t<32;++t){var r=t/8|0,a=s[r]>>>(7-t%8)*4&15,n=this._m[t][a];e[0]^=n[0],e[1]^=n[1],e[2]^=n[2],e[3]^=n[3]}return e};We.gcm.prototype.ghash=function(s,e,t){return e[0]^=t[0],e[1]^=t[1],e[2]^=t[2],e[3]^=t[3],this.tableMultiply(e)};We.gcm.prototype.generateHashTable=function(s,e){for(var t=8/e,r=4*t,a=16*t,n=new Array(a),i=0;i<a;++i){var o=[0,0,0,0],l=i/r|0,u=(r-1-i%r)*e;o[l]=1<<e-1<<u,n[i]=this.generateSubHashTable(this.multiply(o,s),e)}return n};We.gcm.prototype.generateSubHashTable=function(s,e){var t=1<<e,r=t>>>1,a=new Array(t);a[r]=s.slice(0);for(var n=r>>>1;n>0;)this.pow(a[2*n],a[n]=[]),n>>=1;for(n=2;n<r;){for(var i=1;i<n;++i){var o=a[n],l=a[i];a[n+i]=[o[0]^l[0],o[1]^l[1],o[2]^l[2],o[3]^l[3]]}n*=2}for(a[0]=[0,0,0,0],n=r+1;n<t;++n){var u=a[n^r];a[n]=[s[0]^u[0],s[1]^u[1],s[2]^u[2],s[3]^u[3]]}return a};function Y0(s,e){if(typeof s=="string"&&(s=Xt.util.createBuffer(s)),Xt.util.isArray(s)&&s.length>4){var t=s;s=Xt.util.createBuffer();for(var r=0;r<t.length;++r)s.putByte(t[r])}if(s.length()<e)throw new Error("Invalid IV length; got "+s.length()+" bytes and expected "+e+" bytes.");if(!Xt.util.isArray(s)){for(var a=[],n=e/4,r=0;r<n;++r)a.push(s.getInt32());s=a}return s}function z0(s){s[s.length-1]=s[s.length-1]+1&4294967295}function Qd(s){return[s/4294967296|0,s&4294967295]}var gt=Fe;gt.aes=gt.aes||{};gt.aes.startEncrypting=function(s,e,t,r){var a=X0({key:s,output:t,decrypt:!1,mode:r});return a.start(e),a};gt.aes.createEncryptionCipher=function(s,e){return X0({key:s,output:null,decrypt:!1,mode:e})};gt.aes.startDecrypting=function(s,e,t,r){var a=X0({key:s,output:t,decrypt:!0,mode:r});return a.start(e),a};gt.aes.createDecryptionCipher=function(s,e){return X0({key:s,output:null,decrypt:!0,mode:e})};gt.aes.Algorithm=function(s,e){Jg||Yp();var t=this;t.name=s,t.mode=new e({blockSize:16,cipher:{encrypt:function(r,a){return zd(t._w,r,a,!1)},decrypt:function(r,a){return zd(t._w,r,a,!0)}}}),t._init=!1};gt.aes.Algorithm.prototype.initialize=function(s){if(!this._init){var e=s.key,t;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=gt.util.createBuffer(e);else if(gt.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){t=e,e=gt.util.createBuffer();for(var r=0;r<t.length;++r)e.putByte(t[r])}if(!gt.util.isArray(e)){t=e,e=[];var a=t.length();if(a===16||a===24||a===32){a=a>>>2;for(var r=0;r<a;++r)e.push(t.getInt32())}}if(!gt.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var n=this.mode.name,i=["CFB","OFB","CTR","GCM"].indexOf(n)!==-1;this._w=zp(e,s.decrypt&&!i),this._init=!0}};gt.aes._expandKey=function(s,e){return Jg||Yp(),zp(s,e)};gt.aes._updateBlock=zd;cu("AES-ECB",gt.cipher.modes.ecb);cu("AES-CBC",gt.cipher.modes.cbc);cu("AES-CFB",gt.cipher.modes.cfb);cu("AES-OFB",gt.cipher.modes.ofb);cu("AES-CTR",gt.cipher.modes.ctr);cu("AES-GCM",gt.cipher.modes.gcm);function cu(s,e){var t=function(){return new gt.aes.Algorithm(s,e)};gt.cipher.registerAlgorithm(s,t)}var Jg=!1,ho=4,ur,Yd,Qp,Hi,cs;function Yp(){Jg=!0,Qp=[0,1,2,4,8,16,32,64,128,27,54];for(var s=new Array(256),e=0;e<128;++e)s[e]=e<<1,s[e+128]=e+128<<1^283;ur=new Array(256),Yd=new Array(256),Hi=new Array(4),cs=new Array(4);for(var e=0;e<4;++e)Hi[e]=new Array(256),cs[e]=new Array(256);for(var t=0,r=0,a,n,i,o,l,u,c,e=0;e<256;++e){o=r^r<<1^r<<2^r<<3^r<<4,o=o>>8^o&255^99,ur[t]=o,Yd[o]=t,l=s[o],a=s[t],n=s[a],i=s[n],u=l<<24^o<<16^o<<8^(o^l),c=(a^n^i)<<24^(t^i)<<16^(t^n^i)<<8^(t^a^i);for(var f=0;f<4;++f)Hi[f][t]=u,cs[f][o]=c,u=u<<24|u>>>8,c=c<<24|c>>>8;t===0?t=r=1:(t=a^s[s[s[a^i]]],r^=s[s[r]])}}function zp(s,e){for(var t=s.slice(0),r,a=1,n=t.length,i=n+6+1,o=ho*i,l=n;l<o;++l)r=t[l-1],l%n===0?(r=ur[r>>>16&255]<<24^ur[r>>>8&255]<<16^ur[r&255]<<8^ur[r>>>24]^Qp[a]<<24,a++):n>6&&l%n===4&&(r=ur[r>>>24]<<24^ur[r>>>16&255]<<16^ur[r>>>8&255]<<8^ur[r&255]),t[l]=t[l-n]^r;if(e){var u,c=cs[0],f=cs[1],g=cs[2],v=cs[3],p=t.slice(0);o=t.length;for(var l=0,h=o-ho;l<o;l+=ho,h-=ho)if(l===0||l===o-ho)p[l]=t[h],p[l+1]=t[h+3],p[l+2]=t[h+2],p[l+3]=t[h+1];else for(var d=0;d<ho;++d)u=t[h+d],p[l+(3&-d)]=c[ur[u>>>24]]^f[ur[u>>>16&255]]^g[ur[u>>>8&255]]^v[ur[u&255]];t=p}return t}function zd(s,e,t,r){var a=s.length/4-1,n,i,o,l,u;r?(n=cs[0],i=cs[1],o=cs[2],l=cs[3],u=Yd):(n=Hi[0],i=Hi[1],o=Hi[2],l=Hi[3],u=ur);var c,f,g,v,p,h,d;c=e[0]^s[0],f=e[r?3:1]^s[1],g=e[2]^s[2],v=e[r?1:3]^s[3];for(var y=3,E=1;E<a;++E)p=n[c>>>24]^i[f>>>16&255]^o[g>>>8&255]^l[v&255]^s[++y],h=n[f>>>24]^i[g>>>16&255]^o[v>>>8&255]^l[c&255]^s[++y],d=n[g>>>24]^i[v>>>16&255]^o[c>>>8&255]^l[f&255]^s[++y],v=n[v>>>24]^i[c>>>16&255]^o[f>>>8&255]^l[g&255]^s[++y],c=p,f=h,g=d;t[0]=u[c>>>24]<<24^u[f>>>16&255]<<16^u[g>>>8&255]<<8^u[v&255]^s[++y],t[r?3:1]=u[f>>>24]<<24^u[g>>>16&255]<<16^u[v>>>8&255]<<8^u[c&255]^s[++y],t[2]=u[g>>>24]<<24^u[v>>>16&255]<<16^u[c>>>8&255]<<8^u[f&255]^s[++y],t[r?1:3]=u[v>>>24]<<24^u[c>>>16&255]<<16^u[f>>>8&255]<<8^u[g&255]^s[++y]}function X0(s){s=s||{};var e=(s.mode||"CBC").toUpperCase(),t="AES-"+e,r;s.decrypt?r=gt.cipher.createDecipher(t,s.key):r=gt.cipher.createCipher(t,s.key);var a=r.start;return r.start=function(n,i){var o=null;i instanceof gt.util.ByteBuffer&&(o=i,i={}),i=i||{},i.output=o,i.iv=n,a.call(r,i)},r}var Rf=Fe;Rf.pki=Rf.pki||{};var Xd=Rf.pki.oids=Rf.oids=Rf.oids||{};function X(s,e){Xd[s]=e,Xd[e]=s}function at(s,e){Xd[s]=e}X("1.2.840.113549.1.1.1","rsaEncryption");X("1.2.840.113549.1.1.4","md5WithRSAEncryption");X("1.2.840.113549.1.1.5","sha1WithRSAEncryption");X("1.2.840.113549.1.1.7","RSAES-OAEP");X("1.2.840.113549.1.1.8","mgf1");X("1.2.840.113549.1.1.9","pSpecified");X("1.2.840.113549.1.1.10","RSASSA-PSS");X("1.2.840.113549.1.1.11","sha256WithRSAEncryption");X("1.2.840.113549.1.1.12","sha384WithRSAEncryption");X("1.2.840.113549.1.1.13","sha512WithRSAEncryption");X("1.3.101.112","EdDSA25519");X("1.2.840.10040.4.3","dsa-with-sha1");X("1.3.14.3.2.7","desCBC");X("1.3.14.3.2.26","sha1");X("1.3.14.3.2.29","sha1WithRSASignature");X("2.16.840.1.101.3.4.2.1","sha256");X("2.16.840.1.101.3.4.2.2","sha384");X("2.16.840.1.101.3.4.2.3","sha512");X("2.16.840.1.101.3.4.2.4","sha224");X("2.16.840.1.101.3.4.2.5","sha512-224");X("2.16.840.1.101.3.4.2.6","sha512-256");X("1.2.840.113549.2.2","md2");X("1.2.840.113549.2.5","md5");X("1.2.840.113549.1.7.1","data");X("1.2.840.113549.1.7.2","signedData");X("1.2.840.113549.1.7.3","envelopedData");X("1.2.840.113549.1.7.4","signedAndEnvelopedData");X("1.2.840.113549.1.7.5","digestedData");X("1.2.840.113549.1.7.6","encryptedData");X("1.2.840.113549.1.9.1","emailAddress");X("1.2.840.113549.1.9.2","unstructuredName");X("1.2.840.113549.1.9.3","contentType");X("1.2.840.113549.1.9.4","messageDigest");X("1.2.840.113549.1.9.5","signingTime");X("1.2.840.113549.1.9.6","counterSignature");X("1.2.840.113549.1.9.7","challengePassword");X("1.2.840.113549.1.9.8","unstructuredAddress");X("1.2.840.113549.1.9.14","extensionRequest");X("1.2.840.113549.1.9.20","friendlyName");X("1.2.840.113549.1.9.21","localKeyId");X("1.2.840.113549.1.9.22.1","x509Certificate");X("1.2.840.113549.1.12.10.1.1","keyBag");X("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");X("1.2.840.113549.1.12.10.1.3","certBag");X("1.2.840.113549.1.12.10.1.4","crlBag");X("1.2.840.113549.1.12.10.1.5","secretBag");X("1.2.840.113549.1.12.10.1.6","safeContentsBag");X("1.2.840.113549.1.5.13","pkcs5PBES2");X("1.2.840.113549.1.5.12","pkcs5PBKDF2");X("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");X("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");X("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");X("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");X("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");X("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");X("1.2.840.113549.2.7","hmacWithSHA1");X("1.2.840.113549.2.8","hmacWithSHA224");X("1.2.840.113549.2.9","hmacWithSHA256");X("1.2.840.113549.2.10","hmacWithSHA384");X("1.2.840.113549.2.11","hmacWithSHA512");X("1.2.840.113549.3.7","des-EDE3-CBC");X("2.16.840.1.101.3.4.1.2","aes128-CBC");X("2.16.840.1.101.3.4.1.22","aes192-CBC");X("2.16.840.1.101.3.4.1.42","aes256-CBC");X("2.5.4.3","commonName");X("2.5.4.4","surname");X("2.5.4.5","serialNumber");X("2.5.4.6","countryName");X("2.5.4.7","localityName");X("2.5.4.8","stateOrProvinceName");X("2.5.4.9","streetAddress");X("2.5.4.10","organizationName");X("2.5.4.11","organizationalUnitName");X("2.5.4.12","title");X("2.5.4.13","description");X("2.5.4.15","businessCategory");X("2.5.4.17","postalCode");X("2.5.4.42","givenName");X("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");X("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");X("2.16.840.1.113730.1.1","nsCertType");X("2.16.840.1.113730.1.13","nsComment");at("2.5.29.1","authorityKeyIdentifier");at("2.5.29.2","keyAttributes");at("2.5.29.3","certificatePolicies");at("2.5.29.4","keyUsageRestriction");at("2.5.29.5","policyMapping");at("2.5.29.6","subtreesConstraint");at("2.5.29.7","subjectAltName");at("2.5.29.8","issuerAltName");at("2.5.29.9","subjectDirectoryAttributes");at("2.5.29.10","basicConstraints");at("2.5.29.11","nameConstraints");at("2.5.29.12","policyConstraints");at("2.5.29.13","basicConstraints");X("2.5.29.14","subjectKeyIdentifier");X("2.5.29.15","keyUsage");at("2.5.29.16","privateKeyUsagePeriod");X("2.5.29.17","subjectAltName");X("2.5.29.18","issuerAltName");X("2.5.29.19","basicConstraints");at("2.5.29.20","cRLNumber");at("2.5.29.21","cRLReason");at("2.5.29.22","expirationDate");at("2.5.29.23","instructionCode");at("2.5.29.24","invalidityDate");at("2.5.29.25","cRLDistributionPoints");at("2.5.29.26","issuingDistributionPoint");at("2.5.29.27","deltaCRLIndicator");at("2.5.29.28","issuingDistributionPoint");at("2.5.29.29","certificateIssuer");at("2.5.29.30","nameConstraints");X("2.5.29.31","cRLDistributionPoints");X("2.5.29.32","certificatePolicies");at("2.5.29.33","policyMappings");at("2.5.29.34","policyConstraints");X("2.5.29.35","authorityKeyIdentifier");at("2.5.29.36","policyConstraints");X("2.5.29.37","extKeyUsage");at("2.5.29.46","freshestCRL");at("2.5.29.54","inhibitAnyPolicy");X("1.3.6.1.4.1.11129.2.4.2","timestampList");X("1.3.6.1.5.5.7.1.1","authorityInfoAccess");X("1.3.6.1.5.5.7.3.1","serverAuth");X("1.3.6.1.5.5.7.3.2","clientAuth");X("1.3.6.1.5.5.7.3.3","codeSigning");X("1.3.6.1.5.5.7.3.4","emailProtection");X("1.3.6.1.5.5.7.3.8","timeStamping");var pt=Fe,ue=pt.asn1=pt.asn1||{};ue.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};ue.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};ue.create=function(s,e,t,r,a){if(pt.util.isArray(r)){for(var n=[],i=0;i<r.length;++i)r[i]!==void 0&&n.push(r[i]);r=n}var o={tagClass:s,type:e,constructed:t,composed:t||pt.util.isArray(r),value:r};return a&&"bitStringContents"in a&&(o.bitStringContents=a.bitStringContents,o.original=ue.copy(o)),o};ue.copy=function(s,e){var t;if(pt.util.isArray(s)){t=[];for(var r=0;r<s.length;++r)t.push(ue.copy(s[r],e));return t}return typeof s=="string"?s:(t={tagClass:s.tagClass,type:s.type,constructed:s.constructed,composed:s.composed,value:ue.copy(s.value,e)},e&&!e.excludeBitStringContents&&(t.bitStringContents=s.bitStringContents),t)};ue.equals=function(s,e,t){if(pt.util.isArray(s)){if(!pt.util.isArray(e)||s.length!==e.length)return!1;for(var r=0;r<s.length;++r)if(!ue.equals(s[r],e[r]))return!1;return!0}if(typeof s!=typeof e)return!1;if(typeof s=="string")return s===e;var a=s.tagClass===e.tagClass&&s.type===e.type&&s.constructed===e.constructed&&s.composed===e.composed&&ue.equals(s.value,e.value);return t&&t.includeBitStringContents&&(a=a&&s.bitStringContents===e.bitStringContents),a};ue.getBerValueLength=function(s){var e=s.getByte();if(e!==128){var t,r=e&128;return r?t=s.getInt((e&127)<<3):t=e,t}};function _u(s,e,t){if(t>e){var r=new Error("Too few bytes to parse DER.");throw r.available=s.length(),r.remaining=e,r.requested=t,r}}var O1=function(s,e){var t=s.getByte();if(e--,t!==128){var r,a=t&128;if(!a)r=t;else{var n=t&127;_u(s,e,n),r=s.getInt(n<<3)}if(r<0)throw new Error("Negative length: "+r);return r}};ue.fromDer=function(s,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof s=="string"&&(s=pt.util.createBuffer(s));var t=s.length(),r=Lh(s,s.length(),0,e);if(e.parseAllBytes&&s.length()!==0){var a=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw a.byteCount=t,a.remaining=s.length(),a}return r};function Lh(s,e,t,r){var a;_u(s,e,2);var n=s.getByte();e--;var i=n&192,o=n&31;a=s.length();var l=O1(s,e);if(e-=a-s.length(),l!==void 0&&l>e){if(r.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=s.length(),u.remaining=e,u.requested=l,u}l=e}var c,f,g=(n&32)===32;if(g)if(c=[],l===void 0)for(;;){if(_u(s,e,2),s.bytes(2)===String.fromCharCode(0,0)){s.getBytes(2),e-=2;break}a=s.length(),c.push(Lh(s,e,t+1,r)),e-=a-s.length()}else for(;l>0;)a=s.length(),c.push(Lh(s,l,t+1,r)),e-=a-s.length(),l-=a-s.length();if(c===void 0&&i===ue.Class.UNIVERSAL&&o===ue.Type.BITSTRING&&(f=s.bytes(l)),c===void 0&&r.decodeBitStrings&&i===ue.Class.UNIVERSAL&&o===ue.Type.BITSTRING&&l>1){var v=s.read,p=e,h=0;if(o===ue.Type.BITSTRING&&(_u(s,e,1),h=s.getByte(),e--),h===0)try{a=s.length();var d={strict:!0,decodeBitStrings:!0},y=Lh(s,e,t+1,d),E=a-s.length();e-=E,o==ue.Type.BITSTRING&&E++;var k=y.tagClass;E===l&&(k===ue.Class.UNIVERSAL||k===ue.Class.CONTEXT_SPECIFIC)&&(c=[y])}catch{}c===void 0&&(s.read=v,e=p)}if(c===void 0){if(l===void 0){if(r.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");l=e}if(o===ue.Type.BMPSTRING)for(c="";l>0;l-=2)_u(s,e,2),c+=String.fromCharCode(s.getInt16()),e-=2;else c=s.getBytes(l),e-=l}var R=f===void 0?null:{bitStringContents:f};return ue.create(i,o,g,c,R)}ue.toDer=function(s){var e=pt.util.createBuffer(),t=s.tagClass|s.type,r=pt.util.createBuffer(),a=!1;if("bitStringContents"in s&&(a=!0,s.original&&(a=ue.equals(s,s.original))),a)r.putBytes(s.bitStringContents);else if(s.composed){s.constructed?t|=32:r.putByte(0);for(var n=0;n<s.value.length;++n)s.value[n]!==void 0&&r.putBuffer(ue.toDer(s.value[n]))}else if(s.type===ue.Type.BMPSTRING)for(var n=0;n<s.value.length;++n)r.putInt16(s.value.charCodeAt(n));else s.type===ue.Type.INTEGER&&s.value.length>1&&(s.value.charCodeAt(0)===0&&(s.value.charCodeAt(1)&128)===0||s.value.charCodeAt(0)===255&&(s.value.charCodeAt(1)&128)===128)?r.putBytes(s.value.substr(1)):r.putBytes(s.value);if(e.putByte(t),r.length()<=127)e.putByte(r.length()&127);else{var i=r.length(),o="";do o+=String.fromCharCode(i&255),i=i>>>8;while(i>0);e.putByte(o.length|128);for(var n=o.length-1;n>=0;--n)e.putByte(o.charCodeAt(n))}return e.putBuffer(r),e};ue.oidToDer=function(s){var e=s.split("."),t=pt.util.createBuffer();t.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var r,a,n,i,o=2;o<e.length;++o){r=!0,a=[],n=parseInt(e[o],10);do i=n&127,n=n>>>7,r||(i|=128),a.push(i),r=!1;while(n>0);for(var l=a.length-1;l>=0;--l)t.putByte(a[l])}return t};ue.derToOid=function(s){var e;typeof s=="string"&&(s=pt.util.createBuffer(s));var t=s.getByte();e=Math.floor(t/40)+"."+t%40;for(var r=0;s.length()>0;)t=s.getByte(),r=r<<7,t&128?r+=t&127:(e+="."+(r+t),r=0);return e};ue.utcTimeToDate=function(s){var e=new Date,t=parseInt(s.substr(0,2),10);t=t>=50?1900+t:2e3+t;var r=parseInt(s.substr(2,2),10)-1,a=parseInt(s.substr(4,2),10),n=parseInt(s.substr(6,2),10),i=parseInt(s.substr(8,2),10),o=0;if(s.length>11){var l=s.charAt(10),u=10;l!=="+"&&l!=="-"&&(o=parseInt(s.substr(10,2),10),u+=2)}if(e.setUTCFullYear(t,r,a),e.setUTCHours(n,i,o,0),u&&(l=s.charAt(u),l==="+"||l==="-")){var c=parseInt(s.substr(u+1,2),10),f=parseInt(s.substr(u+4,2),10),g=c*60+f;g*=6e4,l==="+"?e.setTime(+e-g):e.setTime(+e+g)}return e};ue.generalizedTimeToDate=function(s){var e=new Date,t=parseInt(s.substr(0,4),10),r=parseInt(s.substr(4,2),10)-1,a=parseInt(s.substr(6,2),10),n=parseInt(s.substr(8,2),10),i=parseInt(s.substr(10,2),10),o=parseInt(s.substr(12,2),10),l=0,u=0,c=!1;s.charAt(s.length-1)==="Z"&&(c=!0);var f=s.length-5,g=s.charAt(f);if(g==="+"||g==="-"){var v=parseInt(s.substr(f+1,2),10),p=parseInt(s.substr(f+4,2),10);u=v*60+p,u*=6e4,g==="+"&&(u*=-1),c=!0}return s.charAt(14)==="."&&(l=parseFloat(s.substr(14),10)*1e3),c?(e.setUTCFullYear(t,r,a),e.setUTCHours(n,i,o,l),e.setTime(+e+u)):(e.setFullYear(t,r,a),e.setHours(n,i,o,l)),e};ue.dateToUtcTime=function(s){if(typeof s=="string")return s;var e="",t=[];t.push((""+s.getUTCFullYear()).substr(2)),t.push(""+(s.getUTCMonth()+1)),t.push(""+s.getUTCDate()),t.push(""+s.getUTCHours()),t.push(""+s.getUTCMinutes()),t.push(""+s.getUTCSeconds());for(var r=0;r<t.length;++r)t[r].length<2&&(e+="0"),e+=t[r];return e+="Z",e};ue.dateToGeneralizedTime=function(s){if(typeof s=="string")return s;var e="",t=[];t.push(""+s.getUTCFullYear()),t.push(""+(s.getUTCMonth()+1)),t.push(""+s.getUTCDate()),t.push(""+s.getUTCHours()),t.push(""+s.getUTCMinutes()),t.push(""+s.getUTCSeconds());for(var r=0;r<t.length;++r)t[r].length<2&&(e+="0"),e+=t[r];return e+="Z",e};ue.integerToDer=function(s){var e=pt.util.createBuffer();if(s>=-128&&s<128)return e.putSignedInt(s,8);if(s>=-32768&&s<32768)return e.putSignedInt(s,16);if(s>=-8388608&&s<8388608)return e.putSignedInt(s,24);if(s>=-2147483648&&s<2147483648)return e.putSignedInt(s,32);var t=new Error("Integer too large; max is 32-bits.");throw t.integer=s,t};ue.derToInteger=function(s){typeof s=="string"&&(s=pt.util.createBuffer(s));var e=s.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return s.getSignedInt(e)};ue.validate=function(s,e,t,r){var a=!1;if((s.tagClass===e.tagClass||typeof e.tagClass>"u")&&(s.type===e.type||typeof e.type>"u"))if(s.constructed===e.constructed||typeof e.constructed>"u"){if(a=!0,e.value&&pt.util.isArray(e.value))for(var n=0,i=0;a&&i<e.value.length;++i)a=e.value[i].optional||!1,s.value[n]&&(a=ue.validate(s.value[n],e.value[i],t,r),a?++n:e.value[i].optional&&(a=!0)),!a&&r&&r.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+s.value.length+'"');if(a&&t&&(e.capture&&(t[e.capture]=s.value),e.captureAsn1&&(t[e.captureAsn1]=s),e.captureBitStringContents&&"bitStringContents"in s&&(t[e.captureBitStringContents]=s.bitStringContents),e.captureBitStringValue&&"bitStringContents"in s))if(s.bitStringContents.length<2)t[e.captureBitStringValue]="";else{var o=s.bitStringContents.charCodeAt(0);if(o!==0)throw new Error("captureBitStringValue only supported for zero unused bits");t[e.captureBitStringValue]=s.bitStringContents.slice(1)}}else r&&r.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+s.constructed+'"');else r&&(s.tagClass!==e.tagClass&&r.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+s.tagClass+'"'),s.type!==e.type&&r.push("["+e.name+'] Expected type "'+e.type+'", got "'+s.type+'"'));return a};var Dm=/[^\\u0000-\\u00ff]/;ue.prettyPrint=function(s,e,t){var r="";e=e||0,t=t||2,e>0&&(r+=`
`);for(var a="",n=0;n<e*t;++n)a+=" ";switch(r+=a+"Tag: ",s.tagClass){case ue.Class.UNIVERSAL:r+="Universal:";break;case ue.Class.APPLICATION:r+="Application:";break;case ue.Class.CONTEXT_SPECIFIC:r+="Context-Specific:";break;case ue.Class.PRIVATE:r+="Private:";break}if(s.tagClass===ue.Class.UNIVERSAL)switch(r+=s.type,s.type){case ue.Type.NONE:r+=" (None)";break;case ue.Type.BOOLEAN:r+=" (Boolean)";break;case ue.Type.INTEGER:r+=" (Integer)";break;case ue.Type.BITSTRING:r+=" (Bit string)";break;case ue.Type.OCTETSTRING:r+=" (Octet string)";break;case ue.Type.NULL:r+=" (Null)";break;case ue.Type.OID:r+=" (Object Identifier)";break;case ue.Type.ODESC:r+=" (Object Descriptor)";break;case ue.Type.EXTERNAL:r+=" (External or Instance of)";break;case ue.Type.REAL:r+=" (Real)";break;case ue.Type.ENUMERATED:r+=" (Enumerated)";break;case ue.Type.EMBEDDED:r+=" (Embedded PDV)";break;case ue.Type.UTF8:r+=" (UTF8)";break;case ue.Type.ROID:r+=" (Relative Object Identifier)";break;case ue.Type.SEQUENCE:r+=" (Sequence)";break;case ue.Type.SET:r+=" (Set)";break;case ue.Type.PRINTABLESTRING:r+=" (Printable String)";break;case ue.Type.IA5String:r+=" (IA5String (ASCII))";break;case ue.Type.UTCTIME:r+=" (UTC time)";break;case ue.Type.GENERALIZEDTIME:r+=" (Generalized time)";break;case ue.Type.BMPSTRING:r+=" (BMP String)";break}else r+=s.type;if(r+=`
`,r+=a+"Constructed: "+s.constructed+`
`,s.composed){for(var i=0,o="",n=0;n<s.value.length;++n)s.value[n]!==void 0&&(i+=1,o+=ue.prettyPrint(s.value[n],e+1,t),n+1<s.value.length&&(o+=","));r+=a+"Sub values: "+i+o}else{if(r+=a+"Value: ",s.type===ue.Type.OID){var l=ue.derToOid(s.value);r+=l,pt.pki&&pt.pki.oids&&l in pt.pki.oids&&(r+=" ("+pt.pki.oids[l]+") ")}if(s.type===ue.Type.INTEGER)try{r+=ue.derToInteger(s.value)}catch{r+="0x"+pt.util.bytesToHex(s.value)}else if(s.type===ue.Type.BITSTRING){if(s.value.length>1?r+="0x"+pt.util.bytesToHex(s.value.slice(1)):r+="(none)",s.value.length>0){var u=s.value.charCodeAt(0);u==1?r+=" (1 unused bit shown)":u>1&&(r+=" ("+u+" unused bits shown)")}}else if(s.type===ue.Type.OCTETSTRING)Dm.test(s.value)||(r+="("+s.value+") "),r+="0x"+pt.util.bytesToHex(s.value);else if(s.type===ue.Type.UTF8)try{r+=pt.util.decodeUtf8(s.value)}catch(c){if(c.message==="URI malformed")r+="0x"+pt.util.bytesToHex(s.value)+" (malformed UTF8)";else throw c}else s.type===ue.Type.PRINTABLESTRING||s.type===ue.Type.IA5String?r+=s.value:Dm.test(s.value)?r+="0x"+pt.util.bytesToHex(s.value):s.value.length===0?r+="[null]":r+=s.value}return r};var p0=Fe,P1=p0.md=p0.md||{};p0.md.algorithms=p0.md.algorithms||{};var Qs=Fe,U1=Qs.hmac=Qs.hmac||{};U1.create=function(){var s=null,e=null,t=null,r=null,a={};return a.start=function(n,i){if(n!==null)if(typeof n=="string")if(n=n.toLowerCase(),n in Qs.md.algorithms)e=Qs.md.algorithms[n].create();else throw new Error('Unknown hash algorithm "'+n+'"');else e=n;if(i===null)i=s;else{if(typeof i=="string")i=Qs.util.createBuffer(i);else if(Qs.util.isArray(i)){var o=i;i=Qs.util.createBuffer();for(var l=0;l<o.length;++l)i.putByte(o[l])}var u=i.length();u>e.blockLength&&(e.start(),e.update(i.bytes()),i=e.digest()),t=Qs.util.createBuffer(),r=Qs.util.createBuffer(),u=i.length();for(var l=0;l<u;++l){var o=i.at(l);t.putByte(54^o),r.putByte(92^o)}if(u<e.blockLength)for(var o=e.blockLength-u,l=0;l<o;++l)t.putByte(54),r.putByte(92);s=i,t=t.bytes(),r=r.bytes()}e.start(),e.update(t)},a.update=function(n){e.update(n)},a.getMac=function(){var n=e.digest().bytes();return e.start(),e.update(r),e.update(n),e.digest()},a.digest=a.getMac,a};var Es=Fe,Xp=Es.md5=Es.md5||{};Es.md.md5=Es.md.algorithms.md5=Xp;Xp.create=function(){Zp||K1();var s=null,e=Es.util.createBuffer(),t=new Array(16),r={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var a=r.messageLengthSize/4,n=0;n<a;++n)r.fullMessageLength.push(0);return e=Es.util.createBuffer(),s={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},r},r.start(),r.update=function(a,n){n==="utf8"&&(a=Es.util.encodeUtf8(a));var i=a.length;r.messageLength+=i,i=[i/4294967296>>>0,i>>>0];for(var o=r.fullMessageLength.length-1;o>=0;--o)r.fullMessageLength[o]+=i[1],i[1]=i[0]+(r.fullMessageLength[o]/4294967296>>>0),r.fullMessageLength[o]=r.fullMessageLength[o]>>>0,i[0]=i[1]/4294967296>>>0;return e.putBytes(a),Lm(s,t,e),(e.read>2048||e.length()===0)&&e.compact(),r},r.digest=function(){var a=Es.util.createBuffer();a.putBytes(e.bytes());var n=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,i=n&r.blockLength-1;a.putBytes(Zd.substr(0,r.blockLength-i));for(var o,l=0,u=r.fullMessageLength.length-1;u>=0;--u)o=r.fullMessageLength[u]*8+l,l=o/4294967296>>>0,a.putInt32Le(o>>>0);var c={h0:s.h0,h1:s.h1,h2:s.h2,h3:s.h3};Lm(c,t,a);var f=Es.util.createBuffer();return f.putInt32Le(c.h0),f.putInt32Le(c.h1),f.putInt32Le(c.h2),f.putInt32Le(c.h3),f},r};var Zd=null,Oh=null,$u=null,Hl=null,Zp=!1;function K1(){Zd=String.fromCharCode(128),Zd+=Es.util.fillString(String.fromCharCode(0),64),Oh=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],$u=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],Hl=new Array(64);for(var s=0;s<64;++s)Hl[s]=Math.floor(Math.abs(Math.sin(s+1))*4294967296);Zp=!0}function Lm(s,e,t){for(var r,a,n,i,o,l,u,c,f=t.length();f>=64;){for(a=s.h0,n=s.h1,i=s.h2,o=s.h3,c=0;c<16;++c)e[c]=t.getInt32Le(),l=o^n&(i^o),r=a+l+Hl[c]+e[c],u=$u[c],a=o,o=i,i=n,n+=r<<u|r>>>32-u;for(;c<32;++c)l=i^o&(n^i),r=a+l+Hl[c]+e[Oh[c]],u=$u[c],a=o,o=i,i=n,n+=r<<u|r>>>32-u;for(;c<48;++c)l=n^i^o,r=a+l+Hl[c]+e[Oh[c]],u=$u[c],a=o,o=i,i=n,n+=r<<u|r>>>32-u;for(;c<64;++c)l=i^(n|~o),r=a+l+Hl[c]+e[Oh[c]],u=$u[c],a=o,o=i,i=n,n+=r<<u|r>>>32-u;s.h0=s.h0+a|0,s.h1=s.h1+n|0,s.h2=s.h2+i|0,s.h3=s.h3+o|0,f-=64}}var y0=Fe,ey=y0.pem=y0.pem||{};ey.encode=function(s,e){e=e||{};var t="-----BEGIN "+s.type+`-----\r
`,r;if(s.procType&&(r={name:"Proc-Type",values:[String(s.procType.version),s.procType.type]},t+=nh(r)),s.contentDomain&&(r={name:"Content-Domain",values:[s.contentDomain]},t+=nh(r)),s.dekInfo&&(r={name:"DEK-Info",values:[s.dekInfo.algorithm]},s.dekInfo.parameters&&r.values.push(s.dekInfo.parameters),t+=nh(r)),s.headers)for(var a=0;a<s.headers.length;++a)t+=nh(s.headers[a]);return s.procType&&(t+=`\r
`),t+=y0.util.encode64(s.body,e.maxline||64)+`\r
`,t+="-----END "+s.type+`-----\r
`,t};ey.decode=function(s){for(var e=[],t=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,r=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,a=/\r?\n/,n;n=t.exec(s),!!n;){var i=n[1];i==="NEW CERTIFICATE REQUEST"&&(i="CERTIFICATE REQUEST");var o={type:i,procType:null,contentDomain:null,dekInfo:null,headers:[],body:y0.util.decode64(n[3])};if(e.push(o),!!n[2]){for(var l=n[2].split(a),u=0;n&&u<l.length;){for(var c=l[u].replace(/\s+$/,""),f=u+1;f<l.length;++f){var g=l[f];if(!/\s/.test(g[0]))break;c+=g,u=f}if(n=c.match(r),n){for(var v={name:n[1],values:[]},p=n[2].split(","),h=0;h<p.length;++h)v.values.push(M1(p[h]));if(o.procType)if(!o.contentDomain&&v.name==="Content-Domain")o.contentDomain=p[0]||"";else if(!o.dekInfo&&v.name==="DEK-Info"){if(v.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:p[0],parameters:p[1]||null}}else o.headers.push(v);else{if(v.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(v.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:p[0],type:p[1]}}}++u}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function nh(s){for(var e=s.name+": ",t=[],r=function(l,u){return" "+u},a=0;a<s.values.length;++a)t.push(s.values[a].replace(/^(\S+\r\n)/,r));e+=t.join(",")+`\r
`;for(var n=0,i=-1,a=0;a<e.length;++a,++n)if(n>65&&i!==-1){var o=e[i];o===","?(++i,e=e.substr(0,i)+`\r
 `+e.substr(i)):e=e.substr(0,i)+`\r
`+o+e.substr(i+1),n=a-i-1,i=-1,++a}else(e[a]===" "||e[a]==="	"||e[a]===",")&&(i=a);return e}function M1(s){return s.replace(/^\s+/,"")}var Et=Fe;Et.des=Et.des||{};Et.des.startEncrypting=function(s,e,t,r){var a=Z0({key:s,output:t,decrypt:!1,mode:r||(e===null?"ECB":"CBC")});return a.start(e),a};Et.des.createEncryptionCipher=function(s,e){return Z0({key:s,output:null,decrypt:!1,mode:e})};Et.des.startDecrypting=function(s,e,t,r){var a=Z0({key:s,output:t,decrypt:!0,mode:r||(e===null?"ECB":"CBC")});return a.start(e),a};Et.des.createDecryptionCipher=function(s,e){return Z0({key:s,output:null,decrypt:!0,mode:e})};Et.des.Algorithm=function(s,e){var t=this;t.name=s,t.mode=new e({blockSize:8,cipher:{encrypt:function(r,a){return Om(t._keys,r,a,!1)},decrypt:function(r,a){return Om(t._keys,r,a,!0)}}}),t._init=!1};Et.des.Algorithm.prototype.initialize=function(s){if(!this._init){var e=Et.util.createBuffer(s.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Y1(e),this._init=!0}};$s("DES-ECB",Et.cipher.modes.ecb);$s("DES-CBC",Et.cipher.modes.cbc);$s("DES-CFB",Et.cipher.modes.cfb);$s("DES-OFB",Et.cipher.modes.ofb);$s("DES-CTR",Et.cipher.modes.ctr);$s("3DES-ECB",Et.cipher.modes.ecb);$s("3DES-CBC",Et.cipher.modes.cbc);$s("3DES-CFB",Et.cipher.modes.cfb);$s("3DES-OFB",Et.cipher.modes.ofb);$s("3DES-CTR",Et.cipher.modes.ctr);function $s(s,e){var t=function(){return new Et.des.Algorithm(s,e)};Et.cipher.registerAlgorithm(s,t)}var H1=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],F1=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],q1=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],J1=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],G1=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],j1=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],W1=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Q1=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Y1(s){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],t=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],r=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],a=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],n=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],i=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],l=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],c=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],g=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],v=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],h=s.length()>8?3:1,d=[],y=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],E=0,k,R=0;R<h;R++){var V=s.getInt32(),L=s.getInt32();k=(V>>>4^L)&252645135,L^=k,V^=k<<4,k=(L>>>-16^V)&65535,V^=k,L^=k<<-16,k=(V>>>2^L)&858993459,L^=k,V^=k<<2,k=(L>>>-16^V)&65535,V^=k,L^=k<<-16,k=(V>>>1^L)&1431655765,L^=k,V^=k<<1,k=(L>>>8^V)&16711935,V^=k,L^=k<<8,k=(V>>>1^L)&1431655765,L^=k,V^=k<<1,k=V<<8|L>>>20&240,V=L<<24|L<<8&16711680|L>>>8&65280|L>>>24&240,L=k;for(var ne=0;ne<y.length;++ne){y[ne]?(V=V<<2|V>>>26,L=L<<2|L>>>26):(V=V<<1|V>>>27,L=L<<1|L>>>27),V&=-15,L&=-15;var se=e[V>>>28]|t[V>>>24&15]|r[V>>>20&15]|a[V>>>16&15]|n[V>>>12&15]|i[V>>>8&15]|o[V>>>4&15],Se=l[L>>>28]|u[L>>>24&15]|c[L>>>20&15]|f[L>>>16&15]|g[L>>>12&15]|v[L>>>8&15]|p[L>>>4&15];k=(Se>>>16^se)&65535,d[E++]=se^k,d[E++]=Se^k<<16}}return d}function Om(s,e,t,r){var a=s.length===32?3:9,n;a===3?n=r?[30,-2,-2]:[0,32,2]:n=r?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var i,o=e[0],l=e[1];i=(o>>>4^l)&252645135,l^=i,o^=i<<4,i=(o>>>16^l)&65535,l^=i,o^=i<<16,i=(l>>>2^o)&858993459,o^=i,l^=i<<2,i=(l>>>8^o)&16711935,o^=i,l^=i<<8,i=(o>>>1^l)&1431655765,l^=i,o^=i<<1,o=o<<1|o>>>31,l=l<<1|l>>>31;for(var u=0;u<a;u+=3){for(var c=n[u+1],f=n[u+2],g=n[u];g!=c;g+=f){var v=l^s[g],p=(l>>>4|l<<28)^s[g+1];i=o,o=l,l=i^(F1[v>>>24&63]|J1[v>>>16&63]|j1[v>>>8&63]|Q1[v&63]|H1[p>>>24&63]|q1[p>>>16&63]|G1[p>>>8&63]|W1[p&63])}i=o,o=l,l=i}o=o>>>1|o<<31,l=l>>>1|l<<31,i=(o>>>1^l)&1431655765,l^=i,o^=i<<1,i=(l>>>8^o)&16711935,o^=i,l^=i<<8,i=(l>>>2^o)&858993459,o^=i,l^=i<<2,i=(o>>>16^l)&65535,l^=i,o^=i<<16,i=(o>>>4^l)&252645135,l^=i,o^=i<<4,t[0]=o,t[1]=l}function Z0(s){s=s||{};var e=(s.mode||"CBC").toUpperCase(),t="DES-"+e,r;s.decrypt?r=Et.cipher.createDecipher(t,s.key):r=Et.cipher.createCipher(t,s.key);var a=r.start;return r.start=function(n,i){var o=null;i instanceof Et.util.ByteBuffer&&(o=i,i={}),i=i||{},i.output=o,i.iv=n,a.call(r,i)},r}const z1={},X1=Object.freeze(Object.defineProperty({__proto__:null,default:z1},Symbol.toStringTag,{value:"Module"})),Gg=x1(X1);var cr=Fe,Z1=cr.pkcs5=cr.pkcs5||{},Ls;cr.util.isNodejs&&!cr.options.usePureJavaScript&&(Ls=Gg);cr.pbkdf2=Z1.pbkdf2=function(s,e,t,r,a,n){if(typeof a=="function"&&(n=a,a=null),cr.util.isNodejs&&!cr.options.usePureJavaScript&&Ls.pbkdf2&&(a===null||typeof a!="object")&&(Ls.pbkdf2Sync.length>4||!a||a==="sha1"))return typeof a!="string"&&(a="sha1"),s=Buffer.from(s,"binary"),e=Buffer.from(e,"binary"),n?Ls.pbkdf2Sync.length===4?Ls.pbkdf2(s,e,t,r,function(k,R){if(k)return n(k);n(null,R.toString("binary"))}):Ls.pbkdf2(s,e,t,r,a,function(k,R){if(k)return n(k);n(null,R.toString("binary"))}):Ls.pbkdf2Sync.length===4?Ls.pbkdf2Sync(s,e,t,r).toString("binary"):Ls.pbkdf2Sync(s,e,t,r,a).toString("binary");if((typeof a>"u"||a===null)&&(a="sha1"),typeof a=="string"){if(!(a in cr.md.algorithms))throw new Error("Unknown hash algorithm: "+a);a=cr.md[a].create()}var i=a.digestLength;if(r>4294967295*i){var o=new Error("Derived key is too long.");if(n)return n(o);throw o}var l=Math.ceil(r/i),u=r-(l-1)*i,c=cr.hmac.create();c.start(a,s);var f="",g,v,p;if(!n){for(var h=1;h<=l;++h){c.start(null,null),c.update(e),c.update(cr.util.int32ToBytes(h)),g=p=c.digest().getBytes();for(var d=2;d<=t;++d)c.start(null,null),c.update(p),v=c.digest().getBytes(),g=cr.util.xorBytes(g,v,i),p=v;f+=h<l?g:g.substr(0,u)}return f}var h=1,d;function y(){if(h>l)return n(null,f);c.start(null,null),c.update(e),c.update(cr.util.int32ToBytes(h)),g=p=c.digest().getBytes(),d=2,E()}function E(){if(d<=t)return c.start(null,null),c.update(p),v=c.digest().getBytes(),g=cr.util.xorBytes(g,v,i),p=v,++d,cr.util.setImmediate(E);f+=h<l?g:g.substr(0,u),++h,y()}y()};var bs=Fe,ty=bs.sha256=bs.sha256||{};bs.md.sha256=bs.md.algorithms.sha256=ty;ty.create=function(){ry||ew();var s=null,e=bs.util.createBuffer(),t=new Array(64),r={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var a=r.messageLengthSize/4,n=0;n<a;++n)r.fullMessageLength.push(0);return e=bs.util.createBuffer(),s={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},r},r.start(),r.update=function(a,n){n==="utf8"&&(a=bs.util.encodeUtf8(a));var i=a.length;r.messageLength+=i,i=[i/4294967296>>>0,i>>>0];for(var o=r.fullMessageLength.length-1;o>=0;--o)r.fullMessageLength[o]+=i[1],i[1]=i[0]+(r.fullMessageLength[o]/4294967296>>>0),r.fullMessageLength[o]=r.fullMessageLength[o]>>>0,i[0]=i[1]/4294967296>>>0;return e.putBytes(a),Pm(s,t,e),(e.read>2048||e.length()===0)&&e.compact(),r},r.digest=function(){var a=bs.util.createBuffer();a.putBytes(e.bytes());var n=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,i=n&r.blockLength-1;a.putBytes(eg.substr(0,r.blockLength-i));for(var o,l,u=r.fullMessageLength[0]*8,c=0;c<r.fullMessageLength.length-1;++c)o=r.fullMessageLength[c+1]*8,l=o/4294967296>>>0,u+=l,a.putInt32(u>>>0),u=o>>>0;a.putInt32(u);var f={h0:s.h0,h1:s.h1,h2:s.h2,h3:s.h3,h4:s.h4,h5:s.h5,h6:s.h6,h7:s.h7};Pm(f,t,a);var g=bs.util.createBuffer();return g.putInt32(f.h0),g.putInt32(f.h1),g.putInt32(f.h2),g.putInt32(f.h3),g.putInt32(f.h4),g.putInt32(f.h5),g.putInt32(f.h6),g.putInt32(f.h7),g},r};var eg=null,ry=!1,sy=null;function ew(){eg=String.fromCharCode(128),eg+=bs.util.fillString(String.fromCharCode(0),64),sy=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],ry=!0}function Pm(s,e,t){for(var r,a,n,i,o,l,u,c,f,g,v,p,h,d,y,E=t.length();E>=64;){for(u=0;u<16;++u)e[u]=t.getInt32();for(;u<64;++u)r=e[u-2],r=(r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,a=e[u-15],a=(a>>>7|a<<25)^(a>>>18|a<<14)^a>>>3,e[u]=r+e[u-7]+a+e[u-16]|0;for(c=s.h0,f=s.h1,g=s.h2,v=s.h3,p=s.h4,h=s.h5,d=s.h6,y=s.h7,u=0;u<64;++u)i=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),o=d^p&(h^d),n=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),l=c&f|g&(c^f),r=y+i+o+sy[u]+e[u],a=n+l,y=d,d=h,h=p,p=v+r>>>0,v=g,g=f,f=c,c=r+a>>>0;s.h0=s.h0+c|0,s.h1=s.h1+f|0,s.h2=s.h2+g|0,s.h3=s.h3+v|0,s.h4=s.h4+p|0,s.h5=s.h5+h|0,s.h6=s.h6+d|0,s.h7=s.h7+y|0,E-=64}}var Cs=Fe,Ph=null;Cs.util.isNodejs&&!Cs.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Ph=Gg);var tw=Cs.prng=Cs.prng||{};tw.create=function(s){for(var e={plugin:s,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},t=s.md,r=new Array(32),a=0;a<32;++a)r[a]=t.create();e.pools=r,e.pool=0,e.generate=function(u,c){if(!c)return e.generateSync(u);var f=e.plugin.cipher,g=e.plugin.increment,v=e.plugin.formatKey,p=e.plugin.formatSeed,h=Cs.util.createBuffer();e.key=null,d();function d(y){if(y)return c(y);if(h.length()>=u)return c(null,h.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return Cs.util.nextTick(function(){n(d)});var E=f(e.key,e.seed);e.generated+=E.length,h.putBytes(E),e.key=v(f(e.key,g(e.seed))),e.seed=p(f(e.key,e.seed)),Cs.util.setImmediate(d)}},e.generateSync=function(u){var c=e.plugin.cipher,f=e.plugin.increment,g=e.plugin.formatKey,v=e.plugin.formatSeed;e.key=null;for(var p=Cs.util.createBuffer();p.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&i();var h=c(e.key,e.seed);e.generated+=h.length,p.putBytes(h),e.key=g(c(e.key,f(e.seed))),e.seed=v(c(e.key,e.seed))}return p.getBytes(u)};function n(u){if(e.pools[0].messageLength>=32)return o(),u();var c=32-e.pools[0].messageLength<<5;e.seedFile(c,function(f,g){if(f)return u(f);e.collect(g),o(),u()})}function i(){if(e.pools[0].messageLength>=32)return o();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),o()}function o(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var c=1,f=0;f<32;++f)e.reseeds%c===0&&(u.update(e.pools[f].digest().getBytes()),e.pools[f].start()),c=c<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var g=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(g),e.generated=0}function l(u){var c=null,f=Cs.util.globalScope,g=f.crypto||f.msCrypto;g&&g.getRandomValues&&(c=function(V){return g.getRandomValues(V)});var v=Cs.util.createBuffer();if(c)for(;v.length()<u;){var p=Math.max(1,Math.min(u-v.length(),65536)/4),h=new Uint32Array(Math.floor(p));try{c(h);for(var d=0;d<h.length;++d)v.putInt32(h[d])}catch(V){if(!(typeof QuotaExceededError<"u"&&V instanceof QuotaExceededError))throw V}}if(v.length()<u)for(var y,E,k,R=Math.floor(Math.random()*65536);v.length()<u;){E=16807*(R&65535),y=16807*(R>>16),E+=(y&32767)<<16,E+=y>>15,E=(E&2147483647)+(E>>31),R=E&4294967295;for(var d=0;d<3;++d)k=R>>>(d<<3),k^=Math.floor(Math.random()*256),v.putByte(k&255)}return v.getBytes(u)}return Ph?(e.seedFile=function(u,c){Ph.randomBytes(u,function(f,g){if(f)return c(f);c(null,g.toString())})},e.seedFileSync=function(u){return Ph.randomBytes(u).toString()}):(e.seedFile=function(u,c){try{c(null,l(u))}catch(f){c(f)}},e.seedFileSync=l),e.collect=function(u){for(var c=u.length,f=0;f<c;++f)e.pools[e.pool].update(u.substr(f,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,c){for(var f="",g=0;g<c;g+=8)f+=String.fromCharCode(u>>g&255);e.collect(f)},e.registerWorker=function(u){if(u===self)e.seedFile=function(f,g){function v(p){var h=p.data;h.forge&&h.forge.prng&&(self.removeEventListener("message",v),g(h.forge.prng.err,h.forge.prng.bytes))}self.addEventListener("message",v),self.postMessage({forge:{prng:{needed:f}}})};else{var c=function(f){var g=f.data;g.forge&&g.forge.prng&&e.seedFile(g.forge.prng.needed,function(v,p){u.postMessage({forge:{prng:{err:v,bytes:p}}})})};u.addEventListener("message",c)}},e};var jt=Fe;(function(){if(jt.random&&jt.random.getBytes){jt.random;return}(function(s){var e={},t=new Array(4),r=jt.util.createBuffer();e.formatKey=function(f){var g=jt.util.createBuffer(f);return f=new Array(4),f[0]=g.getInt32(),f[1]=g.getInt32(),f[2]=g.getInt32(),f[3]=g.getInt32(),jt.aes._expandKey(f,!1)},e.formatSeed=function(f){var g=jt.util.createBuffer(f);return f=new Array(4),f[0]=g.getInt32(),f[1]=g.getInt32(),f[2]=g.getInt32(),f[3]=g.getInt32(),f},e.cipher=function(f,g){return jt.aes._updateBlock(f,g,t,!1),r.putInt32(t[0]),r.putInt32(t[1]),r.putInt32(t[2]),r.putInt32(t[3]),r.getBytes()},e.increment=function(f){return++f[3],f},e.md=jt.md.sha256;function a(){var f=jt.prng.create(e);return f.getBytes=function(g,v){return f.generate(g,v)},f.getBytesSync=function(g){return f.generate(g)},f}var n=a(),i=null,o=jt.util.globalScope,l=o.crypto||o.msCrypto;if(l&&l.getRandomValues&&(i=function(f){return l.getRandomValues(f)}),jt.options.usePureJavaScript||!jt.util.isNodejs&&!i){if(n.collectInt(+new Date,32),typeof navigator<"u"){var u="";for(var c in navigator)try{typeof navigator[c]=="string"&&(u+=navigator[c])}catch{}n.collect(u),u=null}s&&(s().mousemove(function(f){n.collectInt(f.clientX,16),n.collectInt(f.clientY,16)}),s().keypress(function(f){n.collectInt(f.charCode,8)}))}if(!jt.random)jt.random=n;else for(var c in n)jt.random[c]=n[c];jt.random.createInstance=a,jt.random})(typeof jQuery<"u"?jQuery:null)})();var kr=Fe,hd=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Um=[1,2,3,5],rw=function(s,e){return s<<e&65535|(s&65535)>>16-e},sw=function(s,e){return(s&65535)>>e|s<<16-e&65535};kr.rc2=kr.rc2||{};kr.rc2.expandKey=function(s,e){typeof s=="string"&&(s=kr.util.createBuffer(s)),e=e||128;var t=s,r=s.length(),a=e,n=Math.ceil(a/8),i=255>>(a&7),o;for(o=r;o<128;o++)t.putByte(hd[t.at(o-1)+t.at(o-r)&255]);for(t.setAt(128-n,hd[t.at(128-n)&i]),o=127-n;o>=0;o--)t.setAt(o,hd[t.at(o+1)^t.at(o+n)]);return t};var ay=function(s,e,t){var r=!1,a=null,n=null,i=null,o,l,u,c,f=[];for(s=kr.rc2.expandKey(s,e),u=0;u<64;u++)f.push(s.getInt16Le());t?(o=function(p){for(u=0;u<4;u++)p[u]+=f[c]+(p[(u+3)%4]&p[(u+2)%4])+(~p[(u+3)%4]&p[(u+1)%4]),p[u]=rw(p[u],Um[u]),c++},l=function(p){for(u=0;u<4;u++)p[u]+=f[p[(u+3)%4]&63]}):(o=function(p){for(u=3;u>=0;u--)p[u]=sw(p[u],Um[u]),p[u]-=f[c]+(p[(u+3)%4]&p[(u+2)%4])+(~p[(u+3)%4]&p[(u+1)%4]),c--},l=function(p){for(u=3;u>=0;u--)p[u]-=f[p[(u+3)%4]&63]});var g=function(p){var h=[];for(u=0;u<4;u++){var d=a.getInt16Le();i!==null&&(t?d^=i.getInt16Le():i.putInt16Le(d)),h.push(d&65535)}c=t?0:63;for(var y=0;y<p.length;y++)for(var E=0;E<p[y][0];E++)p[y][1](h);for(u=0;u<4;u++)i!==null&&(t?i.putInt16Le(h[u]):h[u]^=i.getInt16Le()),n.putInt16Le(h[u])},v=null;return v={start:function(p,h){p&&typeof p=="string"&&(p=kr.util.createBuffer(p)),r=!1,a=kr.util.createBuffer(),n=h||new kr.util.createBuffer,i=p,v.output=n},update:function(p){for(r||a.putBuffer(p);a.length()>=8;)g([[5,o],[1,l],[6,o],[1,l],[5,o]])},finish:function(p){var h=!0;if(t)if(p)h=p(8,a,!t);else{var d=a.length()===8?8:8-a.length();a.fillWithByte(d,d)}if(h&&(r=!0,v.update()),!t&&(h=a.length()===0,h))if(p)h=p(8,n,!t);else{var y=n.length(),E=n.at(y-1);E>y?h=!1:n.truncate(E)}return h}},v};kr.rc2.startEncrypting=function(s,e,t){var r=kr.rc2.createEncryptionCipher(s,128);return r.start(e,t),r};kr.rc2.createEncryptionCipher=function(s,e){return ay(s,e,!0)};kr.rc2.startDecrypting=function(s,e,t){var r=kr.rc2.createDecryptionCipher(s,128);return r.start(e,t),r};kr.rc2.createDecryptionCipher=function(s,e){return ay(s,e,!1)};var tg=Fe;tg.jsbn=tg.jsbn||{};var zs;function Y(s,e,t){this.data=[],s!=null&&(typeof s=="number"?this.fromNumber(s,e,t):e==null&&typeof s!="string"?this.fromString(s,256):this.fromString(s,e))}tg.jsbn.BigInteger=Y;function et(){return new Y(null)}function aw(s,e,t,r,a,n){for(;--n>=0;){var i=e*this.data[s++]+t.data[r]+a;a=Math.floor(i/67108864),t.data[r++]=i&67108863}return a}function nw(s,e,t,r,a,n){for(var i=e&32767,o=e>>15;--n>=0;){var l=this.data[s]&32767,u=this.data[s++]>>15,c=o*l+u*i;l=i*l+((c&32767)<<15)+t.data[r]+(a&1073741823),a=(l>>>30)+(c>>>15)+o*u+(a>>>30),t.data[r++]=l&1073741823}return a}function Km(s,e,t,r,a,n){for(var i=e&16383,o=e>>14;--n>=0;){var l=this.data[s]&16383,u=this.data[s++]>>14,c=o*l+u*i;l=i*l+((c&16383)<<14)+t.data[r]+a,a=(l>>28)+(c>>14)+o*u,t.data[r++]=l&268435455}return a}typeof navigator>"u"?(Y.prototype.am=Km,zs=28):navigator.appName=="Microsoft Internet Explorer"?(Y.prototype.am=nw,zs=30):navigator.appName!="Netscape"?(Y.prototype.am=aw,zs=26):(Y.prototype.am=Km,zs=28);Y.prototype.DB=zs;Y.prototype.DM=(1<<zs)-1;Y.prototype.DV=1<<zs;var jg=52;Y.prototype.FV=Math.pow(2,jg);Y.prototype.F1=jg-zs;Y.prototype.F2=2*zs-jg;var iw="0123456789abcdefghijklmnopqrstuvwxyz",ed=new Array,fu,Yr;fu="0".charCodeAt(0);for(Yr=0;Yr<=9;++Yr)ed[fu++]=Yr;fu="a".charCodeAt(0);for(Yr=10;Yr<36;++Yr)ed[fu++]=Yr;fu="A".charCodeAt(0);for(Yr=10;Yr<36;++Yr)ed[fu++]=Yr;function Mm(s){return iw.charAt(s)}function ny(s,e){var t=ed[s.charCodeAt(e)];return t==null?-1:t}function ow(s){for(var e=this.t-1;e>=0;--e)s.data[e]=this.data[e];s.t=this.t,s.s=this.s}function lw(s){this.t=1,this.s=s<0?-1:0,s>0?this.data[0]=s:s<-1?this.data[0]=s+this.DV:this.t=0}function un(s){var e=et();return e.fromInt(s),e}function uw(s,e){var t;if(e==16)t=4;else if(e==8)t=3;else if(e==256)t=8;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else{this.fromRadix(s,e);return}this.t=0,this.s=0;for(var r=s.length,a=!1,n=0;--r>=0;){var i=t==8?s[r]&255:ny(s,r);if(i<0){s.charAt(r)=="-"&&(a=!0);continue}a=!1,n==0?this.data[this.t++]=i:n+t>this.DB?(this.data[this.t-1]|=(i&(1<<this.DB-n)-1)<<n,this.data[this.t++]=i>>this.DB-n):this.data[this.t-1]|=i<<n,n+=t,n>=this.DB&&(n-=this.DB)}t==8&&(s[0]&128)!=0&&(this.s=-1,n>0&&(this.data[this.t-1]|=(1<<this.DB-n)-1<<n)),this.clamp(),a&&Y.ZERO.subTo(this,this)}function cw(){for(var s=this.s&this.DM;this.t>0&&this.data[this.t-1]==s;)--this.t}function fw(s){if(this.s<0)return"-"+this.negate().toString(s);var e;if(s==16)e=4;else if(s==8)e=3;else if(s==2)e=1;else if(s==32)e=5;else if(s==4)e=2;else return this.toRadix(s);var t=(1<<e)-1,r,a=!1,n="",i=this.t,o=this.DB-i*this.DB%e;if(i-- >0)for(o<this.DB&&(r=this.data[i]>>o)>0&&(a=!0,n=Mm(r));i>=0;)o<e?(r=(this.data[i]&(1<<o)-1)<<e-o,r|=this.data[--i]>>(o+=this.DB-e)):(r=this.data[i]>>(o-=e)&t,o<=0&&(o+=this.DB,--i)),r>0&&(a=!0),a&&(n+=Mm(r));return a?n:"0"}function hw(){var s=et();return Y.ZERO.subTo(this,s),s}function dw(){return this.s<0?this.negate():this}function gw(s){var e=this.s-s.s;if(e!=0)return e;var t=this.t;if(e=t-s.t,e!=0)return this.s<0?-e:e;for(;--t>=0;)if((e=this.data[t]-s.data[t])!=0)return e;return 0}function td(s){var e=1,t;return(t=s>>>16)!=0&&(s=t,e+=16),(t=s>>8)!=0&&(s=t,e+=8),(t=s>>4)!=0&&(s=t,e+=4),(t=s>>2)!=0&&(s=t,e+=2),(t=s>>1)!=0&&(s=t,e+=1),e}function mw(){return this.t<=0?0:this.DB*(this.t-1)+td(this.data[this.t-1]^this.s&this.DM)}function pw(s,e){var t;for(t=this.t-1;t>=0;--t)e.data[t+s]=this.data[t];for(t=s-1;t>=0;--t)e.data[t]=0;e.t=this.t+s,e.s=this.s}function yw(s,e){for(var t=s;t<this.t;++t)e.data[t-s]=this.data[t];e.t=Math.max(this.t-s,0),e.s=this.s}function vw(s,e){var t=s%this.DB,r=this.DB-t,a=(1<<r)-1,n=Math.floor(s/this.DB),i=this.s<<t&this.DM,o;for(o=this.t-1;o>=0;--o)e.data[o+n+1]=this.data[o]>>r|i,i=(this.data[o]&a)<<t;for(o=n-1;o>=0;--o)e.data[o]=0;e.data[n]=i,e.t=this.t+n+1,e.s=this.s,e.clamp()}function ww(s,e){e.s=this.s;var t=Math.floor(s/this.DB);if(t>=this.t){e.t=0;return}var r=s%this.DB,a=this.DB-r,n=(1<<r)-1;e.data[0]=this.data[t]>>r;for(var i=t+1;i<this.t;++i)e.data[i-t-1]|=(this.data[i]&n)<<a,e.data[i-t]=this.data[i]>>r;r>0&&(e.data[this.t-t-1]|=(this.s&n)<<a),e.t=this.t-t,e.clamp()}function Sw(s,e){for(var t=0,r=0,a=Math.min(s.t,this.t);t<a;)r+=this.data[t]-s.data[t],e.data[t++]=r&this.DM,r>>=this.DB;if(s.t<this.t){for(r-=s.s;t<this.t;)r+=this.data[t],e.data[t++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;t<s.t;)r-=s.data[t],e.data[t++]=r&this.DM,r>>=this.DB;r-=s.s}e.s=r<0?-1:0,r<-1?e.data[t++]=this.DV+r:r>0&&(e.data[t++]=r),e.t=t,e.clamp()}function Cw(s,e){var t=this.abs(),r=s.abs(),a=t.t;for(e.t=a+r.t;--a>=0;)e.data[a]=0;for(a=0;a<r.t;++a)e.data[a+t.t]=t.am(0,r.data[a],e,a,0,t.t);e.s=0,e.clamp(),this.s!=s.s&&Y.ZERO.subTo(e,e)}function Aw(s){for(var e=this.abs(),t=s.t=2*e.t;--t>=0;)s.data[t]=0;for(t=0;t<e.t-1;++t){var r=e.am(t,e.data[t],s,2*t,0,1);(s.data[t+e.t]+=e.am(t+1,2*e.data[t],s,2*t+1,r,e.t-t-1))>=e.DV&&(s.data[t+e.t]-=e.DV,s.data[t+e.t+1]=1)}s.t>0&&(s.data[s.t-1]+=e.am(t,e.data[t],s,2*t,0,1)),s.s=0,s.clamp()}function Ew(s,e,t){var r=s.abs();if(!(r.t<=0)){var a=this.abs();if(a.t<r.t){e!=null&&e.fromInt(0),t!=null&&this.copyTo(t);return}t==null&&(t=et());var n=et(),i=this.s,o=s.s,l=this.DB-td(r.data[r.t-1]);l>0?(r.lShiftTo(l,n),a.lShiftTo(l,t)):(r.copyTo(n),a.copyTo(t));var u=n.t,c=n.data[u-1];if(c!=0){var f=c*(1<<this.F1)+(u>1?n.data[u-2]>>this.F2:0),g=this.FV/f,v=(1<<this.F1)/f,p=1<<this.F2,h=t.t,d=h-u,y=e==null?et():e;for(n.dlShiftTo(d,y),t.compareTo(y)>=0&&(t.data[t.t++]=1,t.subTo(y,t)),Y.ONE.dlShiftTo(u,y),y.subTo(n,n);n.t<u;)n.data[n.t++]=0;for(;--d>=0;){var E=t.data[--h]==c?this.DM:Math.floor(t.data[h]*g+(t.data[h-1]+p)*v);if((t.data[h]+=n.am(0,E,t,d,0,u))<E)for(n.dlShiftTo(d,y),t.subTo(y,t);t.data[h]<--E;)t.subTo(y,t)}e!=null&&(t.drShiftTo(u,e),i!=o&&Y.ZERO.subTo(e,e)),t.t=u,t.clamp(),l>0&&t.rShiftTo(l,t),i<0&&Y.ZERO.subTo(t,t)}}}function bw(s){var e=et();return this.abs().divRemTo(s,null,e),this.s<0&&e.compareTo(Y.ZERO)>0&&s.subTo(e,e),e}function no(s){this.m=s}function kw(s){return s.s<0||s.compareTo(this.m)>=0?s.mod(this.m):s}function Iw(s){return s}function Bw(s){s.divRemTo(this.m,null,s)}function xw(s,e,t){s.multiplyTo(e,t),this.reduce(t)}function Nw(s,e){s.squareTo(e),this.reduce(e)}no.prototype.convert=kw;no.prototype.revert=Iw;no.prototype.reduce=Bw;no.prototype.mulTo=xw;no.prototype.sqrTo=Nw;function Tw(){if(this.t<1)return 0;var s=this.data[0];if((s&1)==0)return 0;var e=s&3;return e=e*(2-(s&15)*e)&15,e=e*(2-(s&255)*e)&255,e=e*(2-((s&65535)*e&65535))&65535,e=e*(2-s*e%this.DV)%this.DV,e>0?this.DV-e:-e}function io(s){this.m=s,this.mp=s.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<s.DB-15)-1,this.mt2=2*s.t}function Rw(s){var e=et();return s.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),s.s<0&&e.compareTo(Y.ZERO)>0&&this.m.subTo(e,e),e}function Vw(s){var e=et();return s.copyTo(e),this.reduce(e),e}function _w(s){for(;s.t<=this.mt2;)s.data[s.t++]=0;for(var e=0;e<this.m.t;++e){var t=s.data[e]&32767,r=t*this.mpl+((t*this.mph+(s.data[e]>>15)*this.mpl&this.um)<<15)&s.DM;for(t=e+this.m.t,s.data[t]+=this.m.am(0,r,s,e,0,this.m.t);s.data[t]>=s.DV;)s.data[t]-=s.DV,s.data[++t]++}s.clamp(),s.drShiftTo(this.m.t,s),s.compareTo(this.m)>=0&&s.subTo(this.m,s)}function $w(s,e){s.squareTo(e),this.reduce(e)}function Dw(s,e,t){s.multiplyTo(e,t),this.reduce(t)}io.prototype.convert=Rw;io.prototype.revert=Vw;io.prototype.reduce=_w;io.prototype.mulTo=Dw;io.prototype.sqrTo=$w;function Lw(){return(this.t>0?this.data[0]&1:this.s)==0}function Ow(s,e){if(s>4294967295||s<1)return Y.ONE;var t=et(),r=et(),a=e.convert(this),n=td(s)-1;for(a.copyTo(t);--n>=0;)if(e.sqrTo(t,r),(s&1<<n)>0)e.mulTo(r,a,t);else{var i=t;t=r,r=i}return e.revert(t)}function Pw(s,e){var t;return s<256||e.isEven()?t=new no(e):t=new io(e),this.exp(s,t)}Y.prototype.copyTo=ow;Y.prototype.fromInt=lw;Y.prototype.fromString=uw;Y.prototype.clamp=cw;Y.prototype.dlShiftTo=pw;Y.prototype.drShiftTo=yw;Y.prototype.lShiftTo=vw;Y.prototype.rShiftTo=ww;Y.prototype.subTo=Sw;Y.prototype.multiplyTo=Cw;Y.prototype.squareTo=Aw;Y.prototype.divRemTo=Ew;Y.prototype.invDigit=Tw;Y.prototype.isEven=Lw;Y.prototype.exp=Ow;Y.prototype.toString=fw;Y.prototype.negate=hw;Y.prototype.abs=dw;Y.prototype.compareTo=gw;Y.prototype.bitLength=mw;Y.prototype.mod=bw;Y.prototype.modPowInt=Pw;Y.ZERO=un(0);Y.ONE=un(1);function Uw(){var s=et();return this.copyTo(s),s}function Kw(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Mw(){return this.t==0?this.s:this.data[0]<<24>>24}function Hw(){return this.t==0?this.s:this.data[0]<<16>>16}function Fw(s){return Math.floor(Math.LN2*this.DB/Math.log(s))}function qw(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Jw(s){if(s==null&&(s=10),this.signum()==0||s<2||s>36)return"0";var e=this.chunkSize(s),t=Math.pow(s,e),r=un(t),a=et(),n=et(),i="";for(this.divRemTo(r,a,n);a.signum()>0;)i=(t+n.intValue()).toString(s).substr(1)+i,a.divRemTo(r,a,n);return n.intValue().toString(s)+i}function Gw(s,e){this.fromInt(0),e==null&&(e=10);for(var t=this.chunkSize(e),r=Math.pow(e,t),a=!1,n=0,i=0,o=0;o<s.length;++o){var l=ny(s,o);if(l<0){s.charAt(o)=="-"&&this.signum()==0&&(a=!0);continue}i=e*i+l,++n>=t&&(this.dMultiply(r),this.dAddOffset(i,0),n=0,i=0)}n>0&&(this.dMultiply(Math.pow(e,n)),this.dAddOffset(i,0)),a&&Y.ZERO.subTo(this,this)}function jw(s,e,t){if(typeof e=="number")if(s<2)this.fromInt(1);else for(this.fromNumber(s,t),this.testBit(s-1)||this.bitwiseTo(Y.ONE.shiftLeft(s-1),Wg,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>s&&this.subTo(Y.ONE.shiftLeft(s-1),this);else{var r=new Array,a=s&7;r.length=(s>>3)+1,e.nextBytes(r),a>0?r[0]&=(1<<a)-1:r[0]=0,this.fromString(r,256)}}function Ww(){var s=this.t,e=new Array;e[0]=this.s;var t=this.DB-s*this.DB%8,r,a=0;if(s-- >0)for(t<this.DB&&(r=this.data[s]>>t)!=(this.s&this.DM)>>t&&(e[a++]=r|this.s<<this.DB-t);s>=0;)t<8?(r=(this.data[s]&(1<<t)-1)<<8-t,r|=this.data[--s]>>(t+=this.DB-8)):(r=this.data[s]>>(t-=8)&255,t<=0&&(t+=this.DB,--s)),(r&128)!=0&&(r|=-256),a==0&&(this.s&128)!=(r&128)&&++a,(a>0||r!=this.s)&&(e[a++]=r);return e}function Qw(s){return this.compareTo(s)==0}function Yw(s){return this.compareTo(s)<0?this:s}function zw(s){return this.compareTo(s)>0?this:s}function Xw(s,e,t){var r,a,n=Math.min(s.t,this.t);for(r=0;r<n;++r)t.data[r]=e(this.data[r],s.data[r]);if(s.t<this.t){for(a=s.s&this.DM,r=n;r<this.t;++r)t.data[r]=e(this.data[r],a);t.t=this.t}else{for(a=this.s&this.DM,r=n;r<s.t;++r)t.data[r]=e(a,s.data[r]);t.t=s.t}t.s=e(this.s,s.s),t.clamp()}function Zw(s,e){return s&e}function eS(s){var e=et();return this.bitwiseTo(s,Zw,e),e}function Wg(s,e){return s|e}function tS(s){var e=et();return this.bitwiseTo(s,Wg,e),e}function iy(s,e){return s^e}function rS(s){var e=et();return this.bitwiseTo(s,iy,e),e}function oy(s,e){return s&~e}function sS(s){var e=et();return this.bitwiseTo(s,oy,e),e}function aS(){for(var s=et(),e=0;e<this.t;++e)s.data[e]=this.DM&~this.data[e];return s.t=this.t,s.s=~this.s,s}function nS(s){var e=et();return s<0?this.rShiftTo(-s,e):this.lShiftTo(s,e),e}function iS(s){var e=et();return s<0?this.lShiftTo(-s,e):this.rShiftTo(s,e),e}function oS(s){if(s==0)return-1;var e=0;return(s&65535)==0&&(s>>=16,e+=16),(s&255)==0&&(s>>=8,e+=8),(s&15)==0&&(s>>=4,e+=4),(s&3)==0&&(s>>=2,e+=2),(s&1)==0&&++e,e}function lS(){for(var s=0;s<this.t;++s)if(this.data[s]!=0)return s*this.DB+oS(this.data[s]);return this.s<0?this.t*this.DB:-1}function uS(s){for(var e=0;s!=0;)s&=s-1,++e;return e}function cS(){for(var s=0,e=this.s&this.DM,t=0;t<this.t;++t)s+=uS(this.data[t]^e);return s}function fS(s){var e=Math.floor(s/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<s%this.DB)!=0}function hS(s,e){var t=Y.ONE.shiftLeft(s);return this.bitwiseTo(t,e,t),t}function dS(s){return this.changeBit(s,Wg)}function gS(s){return this.changeBit(s,oy)}function mS(s){return this.changeBit(s,iy)}function pS(s,e){for(var t=0,r=0,a=Math.min(s.t,this.t);t<a;)r+=this.data[t]+s.data[t],e.data[t++]=r&this.DM,r>>=this.DB;if(s.t<this.t){for(r+=s.s;t<this.t;)r+=this.data[t],e.data[t++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;t<s.t;)r+=s.data[t],e.data[t++]=r&this.DM,r>>=this.DB;r+=s.s}e.s=r<0?-1:0,r>0?e.data[t++]=r:r<-1&&(e.data[t++]=this.DV+r),e.t=t,e.clamp()}function yS(s){var e=et();return this.addTo(s,e),e}function vS(s){var e=et();return this.subTo(s,e),e}function wS(s){var e=et();return this.multiplyTo(s,e),e}function SS(s){var e=et();return this.divRemTo(s,e,null),e}function CS(s){var e=et();return this.divRemTo(s,null,e),e}function AS(s){var e=et(),t=et();return this.divRemTo(s,e,t),new Array(e,t)}function ES(s){this.data[this.t]=this.am(0,s-1,this,0,0,this.t),++this.t,this.clamp()}function bS(s,e){if(s!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=s;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function eh(){}function ly(s){return s}function kS(s,e,t){s.multiplyTo(e,t)}function IS(s,e){s.squareTo(e)}eh.prototype.convert=ly;eh.prototype.revert=ly;eh.prototype.mulTo=kS;eh.prototype.sqrTo=IS;function BS(s){return this.exp(s,new eh)}function xS(s,e,t){var r=Math.min(this.t+s.t,e);for(t.s=0,t.t=r;r>0;)t.data[--r]=0;var a;for(a=t.t-this.t;r<a;++r)t.data[r+this.t]=this.am(0,s.data[r],t,r,0,this.t);for(a=Math.min(s.t,e);r<a;++r)this.am(0,s.data[r],t,r,0,e-r);t.clamp()}function NS(s,e,t){--e;var r=t.t=this.t+s.t-e;for(t.s=0;--r>=0;)t.data[r]=0;for(r=Math.max(e-this.t,0);r<s.t;++r)t.data[this.t+r-e]=this.am(e-r,s.data[r],t,0,0,this.t+r-e);t.clamp(),t.drShiftTo(1,t)}function hu(s){this.r2=et(),this.q3=et(),Y.ONE.dlShiftTo(2*s.t,this.r2),this.mu=this.r2.divide(s),this.m=s}function TS(s){if(s.s<0||s.t>2*this.m.t)return s.mod(this.m);if(s.compareTo(this.m)<0)return s;var e=et();return s.copyTo(e),this.reduce(e),e}function RS(s){return s}function VS(s){for(s.drShiftTo(this.m.t-1,this.r2),s.t>this.m.t+1&&(s.t=this.m.t+1,s.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);s.compareTo(this.r2)<0;)s.dAddOffset(1,this.m.t+1);for(s.subTo(this.r2,s);s.compareTo(this.m)>=0;)s.subTo(this.m,s)}function _S(s,e){s.squareTo(e),this.reduce(e)}function $S(s,e,t){s.multiplyTo(e,t),this.reduce(t)}hu.prototype.convert=TS;hu.prototype.revert=RS;hu.prototype.reduce=VS;hu.prototype.mulTo=$S;hu.prototype.sqrTo=_S;function DS(s,e){var t=s.bitLength(),r,a=un(1),n;if(t<=0)return a;t<18?r=1:t<48?r=3:t<144?r=4:t<768?r=5:r=6,t<8?n=new no(e):e.isEven()?n=new hu(e):n=new io(e);var i=new Array,o=3,l=r-1,u=(1<<r)-1;if(i[1]=n.convert(this),r>1){var c=et();for(n.sqrTo(i[1],c);o<=u;)i[o]=et(),n.mulTo(c,i[o-2],i[o]),o+=2}var f=s.t-1,g,v=!0,p=et(),h;for(t=td(s.data[f])-1;f>=0;){for(t>=l?g=s.data[f]>>t-l&u:(g=(s.data[f]&(1<<t+1)-1)<<l-t,f>0&&(g|=s.data[f-1]>>this.DB+t-l)),o=r;(g&1)==0;)g>>=1,--o;if((t-=o)<0&&(t+=this.DB,--f),v)i[g].copyTo(a),v=!1;else{for(;o>1;)n.sqrTo(a,p),n.sqrTo(p,a),o-=2;o>0?n.sqrTo(a,p):(h=a,a=p,p=h),n.mulTo(p,i[g],a)}for(;f>=0&&(s.data[f]&1<<t)==0;)n.sqrTo(a,p),h=a,a=p,p=h,--t<0&&(t=this.DB-1,--f)}return n.revert(a)}function LS(s){var e=this.s<0?this.negate():this.clone(),t=s.s<0?s.negate():s.clone();if(e.compareTo(t)<0){var r=e;e=t,t=r}var a=e.getLowestSetBit(),n=t.getLowestSetBit();if(n<0)return e;for(a<n&&(n=a),n>0&&(e.rShiftTo(n,e),t.rShiftTo(n,t));e.signum()>0;)(a=e.getLowestSetBit())>0&&e.rShiftTo(a,e),(a=t.getLowestSetBit())>0&&t.rShiftTo(a,t),e.compareTo(t)>=0?(e.subTo(t,e),e.rShiftTo(1,e)):(t.subTo(e,t),t.rShiftTo(1,t));return n>0&&t.lShiftTo(n,t),t}function OS(s){if(s<=0)return 0;var e=this.DV%s,t=this.s<0?s-1:0;if(this.t>0)if(e==0)t=this.data[0]%s;else for(var r=this.t-1;r>=0;--r)t=(e*t+this.data[r])%s;return t}function PS(s){var e=s.isEven();if(this.isEven()&&e||s.signum()==0)return Y.ZERO;for(var t=s.clone(),r=this.clone(),a=un(1),n=un(0),i=un(0),o=un(1);t.signum()!=0;){for(;t.isEven();)t.rShiftTo(1,t),e?((!a.isEven()||!n.isEven())&&(a.addTo(this,a),n.subTo(s,n)),a.rShiftTo(1,a)):n.isEven()||n.subTo(s,n),n.rShiftTo(1,n);for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!o.isEven())&&(i.addTo(this,i),o.subTo(s,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(s,o),o.rShiftTo(1,o);t.compareTo(r)>=0?(t.subTo(r,t),e&&a.subTo(i,a),n.subTo(o,n)):(r.subTo(t,r),e&&i.subTo(a,i),o.subTo(n,o))}if(r.compareTo(Y.ONE)!=0)return Y.ZERO;if(o.compareTo(s)>=0)return o.subtract(s);if(o.signum()<0)o.addTo(s,o);else return o;return o.signum()<0?o.add(s):o}var as=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],US=(1<<26)/as[as.length-1];function KS(s){var e,t=this.abs();if(t.t==1&&t.data[0]<=as[as.length-1]){for(e=0;e<as.length;++e)if(t.data[0]==as[e])return!0;return!1}if(t.isEven())return!1;for(e=1;e<as.length;){for(var r=as[e],a=e+1;a<as.length&&r<US;)r*=as[a++];for(r=t.modInt(r);e<a;)if(r%as[e++]==0)return!1}return t.millerRabin(s)}function MS(s){var e=this.subtract(Y.ONE),t=e.getLowestSetBit();if(t<=0)return!1;for(var r=e.shiftRight(t),a=HS(),n,i=0;i<s;++i){do n=new Y(this.bitLength(),a);while(n.compareTo(Y.ONE)<=0||n.compareTo(e)>=0);var o=n.modPow(r,this);if(o.compareTo(Y.ONE)!=0&&o.compareTo(e)!=0){for(var l=1;l++<t&&o.compareTo(e)!=0;)if(o=o.modPowInt(2,this),o.compareTo(Y.ONE)==0)return!1;if(o.compareTo(e)!=0)return!1}}return!0}function HS(){return{nextBytes:function(s){for(var e=0;e<s.length;++e)s[e]=Math.floor(Math.random()*256)}}}Y.prototype.chunkSize=Fw;Y.prototype.toRadix=Jw;Y.prototype.fromRadix=Gw;Y.prototype.fromNumber=jw;Y.prototype.bitwiseTo=Xw;Y.prototype.changeBit=hS;Y.prototype.addTo=pS;Y.prototype.dMultiply=ES;Y.prototype.dAddOffset=bS;Y.prototype.multiplyLowerTo=xS;Y.prototype.multiplyUpperTo=NS;Y.prototype.modInt=OS;Y.prototype.millerRabin=MS;Y.prototype.clone=Uw;Y.prototype.intValue=Kw;Y.prototype.byteValue=Mw;Y.prototype.shortValue=Hw;Y.prototype.signum=qw;Y.prototype.toByteArray=Ww;Y.prototype.equals=Qw;Y.prototype.min=Yw;Y.prototype.max=zw;Y.prototype.and=eS;Y.prototype.or=tS;Y.prototype.xor=rS;Y.prototype.andNot=sS;Y.prototype.not=aS;Y.prototype.shiftLeft=nS;Y.prototype.shiftRight=iS;Y.prototype.getLowestSetBit=lS;Y.prototype.bitCount=cS;Y.prototype.testBit=fS;Y.prototype.setBit=dS;Y.prototype.clearBit=gS;Y.prototype.flipBit=mS;Y.prototype.add=yS;Y.prototype.subtract=vS;Y.prototype.multiply=wS;Y.prototype.divide=SS;Y.prototype.remainder=CS;Y.prototype.divideAndRemainder=AS;Y.prototype.modPow=DS;Y.prototype.modInverse=PS;Y.prototype.pow=BS;Y.prototype.gcd=LS;Y.prototype.isProbablePrime=KS;var ks=Fe,uy=ks.sha1=ks.sha1||{};ks.md.sha1=ks.md.algorithms.sha1=uy;uy.create=function(){cy||FS();var s=null,e=ks.util.createBuffer(),t=new Array(80),r={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var a=r.messageLengthSize/4,n=0;n<a;++n)r.fullMessageLength.push(0);return e=ks.util.createBuffer(),s={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},r},r.start(),r.update=function(a,n){n==="utf8"&&(a=ks.util.encodeUtf8(a));var i=a.length;r.messageLength+=i,i=[i/4294967296>>>0,i>>>0];for(var o=r.fullMessageLength.length-1;o>=0;--o)r.fullMessageLength[o]+=i[1],i[1]=i[0]+(r.fullMessageLength[o]/4294967296>>>0),r.fullMessageLength[o]=r.fullMessageLength[o]>>>0,i[0]=i[1]/4294967296>>>0;return e.putBytes(a),Hm(s,t,e),(e.read>2048||e.length()===0)&&e.compact(),r},r.digest=function(){var a=ks.util.createBuffer();a.putBytes(e.bytes());var n=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,i=n&r.blockLength-1;a.putBytes(rg.substr(0,r.blockLength-i));for(var o,l,u=r.fullMessageLength[0]*8,c=0;c<r.fullMessageLength.length-1;++c)o=r.fullMessageLength[c+1]*8,l=o/4294967296>>>0,u+=l,a.putInt32(u>>>0),u=o>>>0;a.putInt32(u);var f={h0:s.h0,h1:s.h1,h2:s.h2,h3:s.h3,h4:s.h4};Hm(f,t,a);var g=ks.util.createBuffer();return g.putInt32(f.h0),g.putInt32(f.h1),g.putInt32(f.h2),g.putInt32(f.h3),g.putInt32(f.h4),g},r};var rg=null,cy=!1;function FS(){rg=String.fromCharCode(128),rg+=ks.util.fillString(String.fromCharCode(0),64),cy=!0}function Hm(s,e,t){for(var r,a,n,i,o,l,u,c,f=t.length();f>=64;){for(a=s.h0,n=s.h1,i=s.h2,o=s.h3,l=s.h4,c=0;c<16;++c)r=t.getInt32(),e[c]=r,u=o^n&(i^o),r=(a<<5|a>>>27)+u+l+1518500249+r,l=o,o=i,i=(n<<30|n>>>2)>>>0,n=a,a=r;for(;c<20;++c)r=e[c-3]^e[c-8]^e[c-14]^e[c-16],r=r<<1|r>>>31,e[c]=r,u=o^n&(i^o),r=(a<<5|a>>>27)+u+l+1518500249+r,l=o,o=i,i=(n<<30|n>>>2)>>>0,n=a,a=r;for(;c<32;++c)r=e[c-3]^e[c-8]^e[c-14]^e[c-16],r=r<<1|r>>>31,e[c]=r,u=n^i^o,r=(a<<5|a>>>27)+u+l+1859775393+r,l=o,o=i,i=(n<<30|n>>>2)>>>0,n=a,a=r;for(;c<40;++c)r=e[c-6]^e[c-16]^e[c-28]^e[c-32],r=r<<2|r>>>30,e[c]=r,u=n^i^o,r=(a<<5|a>>>27)+u+l+1859775393+r,l=o,o=i,i=(n<<30|n>>>2)>>>0,n=a,a=r;for(;c<60;++c)r=e[c-6]^e[c-16]^e[c-28]^e[c-32],r=r<<2|r>>>30,e[c]=r,u=n&i|o&(n^i),r=(a<<5|a>>>27)+u+l+2400959708+r,l=o,o=i,i=(n<<30|n>>>2)>>>0,n=a,a=r;for(;c<80;++c)r=e[c-6]^e[c-16]^e[c-28]^e[c-32],r=r<<2|r>>>30,e[c]=r,u=n^i^o,r=(a<<5|a>>>27)+u+l+3395469782+r,l=o,o=i,i=(n<<30|n>>>2)>>>0,n=a,a=r;s.h0=s.h0+a|0,s.h1=s.h1+n|0,s.h2=s.h2+i|0,s.h3=s.h3+o|0,s.h4=s.h4+l|0,f-=64}}var Bs=Fe,fy=Bs.pkcs1=Bs.pkcs1||{};fy.encode_rsa_oaep=function(s,e,t){var r,a,n,i;typeof t=="string"?(r=t,a=arguments[3]||void 0,n=arguments[4]||void 0):t&&(r=t.label||void 0,a=t.seed||void 0,n=t.md||void 0,t.mgf1&&t.mgf1.md&&(i=t.mgf1.md)),n?n.start():n=Bs.md.sha1.create(),i||(i=n);var o=Math.ceil(s.n.bitLength()/8),l=o-2*n.digestLength-2;if(e.length>l){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=l,u}r||(r=""),n.update(r,"raw");for(var c=n.digest(),f="",g=l-e.length,v=0;v<g;v++)f+="\0";var p=c.getBytes()+f+""+e;if(!a)a=Bs.random.getBytes(n.digestLength);else if(a.length!==n.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=a.length,u.digestLength=n.digestLength,u}var h=v0(a,o-n.digestLength-1,i),d=Bs.util.xorBytes(p,h,p.length),y=v0(d,n.digestLength,i),E=Bs.util.xorBytes(a,y,a.length);return"\0"+E+d};fy.decode_rsa_oaep=function(s,e,t){var r,a,n;typeof t=="string"?(r=t,a=arguments[3]||void 0):t&&(r=t.label||void 0,a=t.md||void 0,t.mgf1&&t.mgf1.md&&(n=t.mgf1.md));var i=Math.ceil(s.n.bitLength()/8);if(e.length!==i){var d=new Error("RSAES-OAEP encoded message length is invalid.");throw d.length=e.length,d.expectedLength=i,d}if(a===void 0?a=Bs.md.sha1.create():a.start(),n||(n=a),i<2*a.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");r||(r=""),a.update(r,"raw");for(var o=a.digest().getBytes(),l=e.charAt(0),u=e.substring(1,a.digestLength+1),c=e.substring(1+a.digestLength),f=v0(c,a.digestLength,n),g=Bs.util.xorBytes(u,f,u.length),v=v0(g,i-a.digestLength-1,n),p=Bs.util.xorBytes(c,v,c.length),h=p.substring(0,a.digestLength),d=l!=="\0",y=0;y<a.digestLength;++y)d|=o.charAt(y)!==h.charAt(y);for(var E=1,k=a.digestLength,R=a.digestLength;R<p.length;R++){var V=p.charCodeAt(R),L=V&1^1,ne=E?65534:0;d|=V&ne,E=E&L,k+=E}if(d||p.charCodeAt(k)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(k+1)};function v0(s,e,t){t||(t=Bs.md.sha1.create());for(var r="",a=Math.ceil(e/t.digestLength),n=0;n<a;++n){var i=String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255);t.start(),t.update(s+i),r+=t.digest().getBytes()}return r.substring(0,e)}var ga=Fe;(function(){if(ga.prime){ga.prime;return}var s=ga.prime=ga.prime||{},e=ga.jsbn.BigInteger,t=[6,4,2,4,2,4,6,2],r=new e(null);r.fromInt(30);var a=function(f,g){return f|g};s.generateProbablePrime=function(f,g,v){typeof g=="function"&&(v=g,g={}),g=g||{};var p=g.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var h=g.prng||ga.random,d={nextBytes:function(y){for(var E=h.getBytesSync(y.length),k=0;k<y.length;++k)y[k]=E.charCodeAt(k)}};if(p.name==="PRIMEINC")return n(f,d,p.options,v);throw new Error("Invalid prime generation algorithm: "+p.name)};function n(f,g,v,p){return"workers"in v?l(f,g,v,p):i(f,g,v,p)}function i(f,g,v,p){var h=u(f,g),d=0,y=c(h.bitLength());"millerRabinTests"in v&&(y=v.millerRabinTests);var E=10;"maxBlockTime"in v&&(E=v.maxBlockTime),o(h,f,g,d,y,E,p)}function o(f,g,v,p,h,d,y){var E=+new Date;do{if(f.bitLength()>g&&(f=u(g,v)),f.isProbablePrime(h))return y(null,f);f.dAddOffset(t[p++%8],0)}while(d<0||+new Date-E<d);ga.util.setImmediate(function(){o(f,g,v,p,h,d,y)})}function l(f,g,v,p){if(typeof Worker>"u")return i(f,g,v,p);var h=u(f,g),d=v.workers,y=v.workLoad||100,E=y*30/8,k=v.workerScript||"forge/prime.worker.js";if(d===-1)return ga.util.estimateCores(function(V,L){V&&(L=2),d=L-1,R()});R();function R(){d=Math.max(1,d);for(var V=[],L=0;L<d;++L)V[L]=new Worker(k);for(var L=0;L<d;++L)V[L].addEventListener("message",se);var ne=!1;function se(Se){if(!ne){var Te=Se.data;if(Te.found){for(var ye=0;ye<V.length;++ye)V[ye].terminate();return ne=!0,p(null,new e(Te.prime,16))}h.bitLength()>f&&(h=u(f,g));var Ce=h.toString(16);Se.target.postMessage({hex:Ce,workLoad:y}),h.dAddOffset(E,0)}}}}function u(f,g){var v=new e(f,g),p=f-1;return v.testBit(p)||v.bitwiseTo(e.ONE.shiftLeft(p),a,v),v.dAddOffset(31-v.mod(r).byteValue(),0),v}function c(f){return f<=100?27:f<=150?18:f<=200?15:f<=250?12:f<=300?9:f<=350?8:f<=400?7:f<=500?6:f<=600?5:f<=800?4:f<=1250?3:2}})();var ve=Fe;if(typeof Ze>"u")var Ze=ve.jsbn.BigInteger;var sg=ve.util.isNodejs?Gg:null,T=ve.asn1,zr=ve.util;ve.pki=ve.pki||{};ve.pki.rsa=ve.rsa=ve.rsa||{};var De=ve.pki,qS=[6,4,2,4,2,4,6,2],Qg={name:"PrivateKeyInfo",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:T.Class.UNIVERSAL,type:T.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:T.Class.UNIVERSAL,type:T.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:T.Class.UNIVERSAL,type:T.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},JS={name:"RSAPrivateKey",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:T.Class.UNIVERSAL,type:T.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:T.Class.UNIVERSAL,type:T.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:T.Class.UNIVERSAL,type:T.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:T.Class.UNIVERSAL,type:T.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:T.Class.UNIVERSAL,type:T.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:T.Class.UNIVERSAL,type:T.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:T.Class.UNIVERSAL,type:T.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:T.Class.UNIVERSAL,type:T.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:T.Class.UNIVERSAL,type:T.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},GS={name:"RSAPublicKey",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:T.Class.UNIVERSAL,type:T.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:T.Class.UNIVERSAL,type:T.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},jS=ve.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:T.Class.UNIVERSAL,type:T.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:T.Class.UNIVERSAL,type:T.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},WS={name:"DigestInfo",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:T.Class.UNIVERSAL,type:T.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:T.Class.UNIVERSAL,type:T.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:T.Class.UNIVERSAL,type:T.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},QS=function(s){var e;if(s.algorithm in De.oids)e=De.oids[s.algorithm];else{var t=new Error("Unknown message digest algorithm.");throw t.algorithm=s.algorithm,t}var r=T.oidToDer(e).getBytes(),a=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[]),n=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[]);n.value.push(T.create(T.Class.UNIVERSAL,T.Type.OID,!1,r)),n.value.push(T.create(T.Class.UNIVERSAL,T.Type.NULL,!1,""));var i=T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,s.digest().getBytes());return a.value.push(n),a.value.push(i),T.toDer(a).getBytes()},hy=function(s,e,t){if(t)return s.modPow(e.e,e.n);if(!e.p||!e.q)return s.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(Ze.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(Ze.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var r;do r=new Ze(ve.util.bytesToHex(ve.random.getBytes(e.n.bitLength()/8)),16);while(r.compareTo(e.n)>=0||!r.gcd(e.n).equals(Ze.ONE));s=s.multiply(r.modPow(e.e,e.n)).mod(e.n);for(var a=s.mod(e.p).modPow(e.dP,e.p),n=s.mod(e.q).modPow(e.dQ,e.q);a.compareTo(n)<0;)a=a.add(e.p);var i=a.subtract(n).multiply(e.qInv).mod(e.p).multiply(e.q).add(n);return i=i.multiply(r.modInverse(e.n)).mod(e.n),i};De.rsa.encrypt=function(s,e,t){var r=t,a,n=Math.ceil(e.n.bitLength()/8);t!==!1&&t!==!0?(r=t===2,a=dy(s,e,t)):(a=ve.util.createBuffer(),a.putBytes(s));for(var i=new Ze(a.toHex(),16),o=hy(i,e,r),l=o.toString(16),u=ve.util.createBuffer(),c=n-Math.ceil(l.length/2);c>0;)u.putByte(0),--c;return u.putBytes(ve.util.hexToBytes(l)),u.getBytes()};De.rsa.decrypt=function(s,e,t,r){var a=Math.ceil(e.n.bitLength()/8);if(s.length!==a){var n=new Error("Encrypted message length is invalid.");throw n.length=s.length,n.expected=a,n}var i=new Ze(ve.util.createBuffer(s).toHex(),16);if(i.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=hy(i,e,t),l=o.toString(16),u=ve.util.createBuffer(),c=a-Math.ceil(l.length/2);c>0;)u.putByte(0),--c;return u.putBytes(ve.util.hexToBytes(l)),r!==!1?w0(u.getBytes(),e,t):u.getBytes()};De.rsa.createKeyPairGenerationState=function(s,e,t){typeof s=="string"&&(s=parseInt(s,10)),s=s||2048,t=t||{};var r=t.prng||ve.random,a={nextBytes:function(o){for(var l=r.getBytesSync(o.length),u=0;u<o.length;++u)o[u]=l.charCodeAt(u)}},n=t.algorithm||"PRIMEINC",i;if(n==="PRIMEINC")i={algorithm:n,state:0,bits:s,rng:a,eInt:e||65537,e:new Ze(null),p:null,q:null,qBits:s>>1,pBits:s-(s>>1),pqState:0,num:null,keys:null},i.e.fromInt(i.eInt);else throw new Error("Invalid key generation algorithm: "+n);return i};De.rsa.stepKeyPairGenerationState=function(s,e){"algorithm"in s||(s.algorithm="PRIMEINC");var t=new Ze(null);t.fromInt(30);for(var r=0,a=function(f,g){return f|g},n=+new Date,i,o=0;s.keys===null&&(e<=0||o<e);){if(s.state===0){var l=s.p===null?s.pBits:s.qBits,u=l-1;s.pqState===0?(s.num=new Ze(l,s.rng),s.num.testBit(u)||s.num.bitwiseTo(Ze.ONE.shiftLeft(u),a,s.num),s.num.dAddOffset(31-s.num.mod(t).byteValue(),0),r=0,++s.pqState):s.pqState===1?s.num.bitLength()>l?s.pqState=0:s.num.isProbablePrime(zS(s.num.bitLength()))?++s.pqState:s.num.dAddOffset(qS[r++%8],0):s.pqState===2?s.pqState=s.num.subtract(Ze.ONE).gcd(s.e).compareTo(Ze.ONE)===0?3:0:s.pqState===3&&(s.pqState=0,s.p===null?s.p=s.num:s.q=s.num,s.p!==null&&s.q!==null&&++s.state,s.num=null)}else if(s.state===1)s.p.compareTo(s.q)<0&&(s.num=s.p,s.p=s.q,s.q=s.num),++s.state;else if(s.state===2)s.p1=s.p.subtract(Ze.ONE),s.q1=s.q.subtract(Ze.ONE),s.phi=s.p1.multiply(s.q1),++s.state;else if(s.state===3)s.phi.gcd(s.e).compareTo(Ze.ONE)===0?++s.state:(s.p=null,s.q=null,s.state=0);else if(s.state===4)s.n=s.p.multiply(s.q),s.n.bitLength()===s.bits?++s.state:(s.q=null,s.state=0);else if(s.state===5){var c=s.e.modInverse(s.phi);s.keys={privateKey:De.rsa.setPrivateKey(s.n,s.e,c,s.p,s.q,c.mod(s.p1),c.mod(s.q1),s.q.modInverse(s.p)),publicKey:De.rsa.setPublicKey(s.n,s.e)}}i=+new Date,o+=i-n,n=i}return s.keys!==null};De.rsa.generateKeyPair=function(s,e,t,r){if(arguments.length===1?typeof s=="object"?(t=s,s=void 0):typeof s=="function"&&(r=s,s=void 0):arguments.length===2?typeof s=="number"?typeof e=="function"?(r=e,e=void 0):typeof e!="number"&&(t=e,e=void 0):(t=s,r=e,s=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof t=="function"&&(r=t,t=void 0):(r=t,t=e,e=void 0)),t=t||{},s===void 0&&(s=t.bits||2048),e===void 0&&(e=t.e||65537),!ve.options.usePureJavaScript&&!t.prng&&s>=256&&s<=16384&&(e===65537||e===3)){if(r){if(Fm("generateKeyPair"))return sg.generateKeyPair("rsa",{modulusLength:s,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,l,u){if(o)return r(o);r(null,{privateKey:De.privateKeyFromPem(u),publicKey:De.publicKeyFromPem(l)})});if(qm("generateKey")&&qm("exportKey"))return zr.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:s,publicExponent:Gm(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return zr.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){r(o)}).then(function(o){if(o){var l=De.privateKeyFromAsn1(T.fromDer(ve.util.createBuffer(o)));r(null,{privateKey:l,publicKey:De.setRsaPublicKey(l.n,l.e)})}});if(Jm("generateKey")&&Jm("exportKey")){var a=zr.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:s,publicExponent:Gm(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);a.oncomplete=function(o){var l=o.target.result,u=zr.globalScope.msCrypto.subtle.exportKey("pkcs8",l.privateKey);u.oncomplete=function(c){var f=c.target.result,g=De.privateKeyFromAsn1(T.fromDer(ve.util.createBuffer(f)));r(null,{privateKey:g,publicKey:De.setRsaPublicKey(g.n,g.e)})},u.onerror=function(c){r(c)}},a.onerror=function(o){r(o)};return}}else if(Fm("generateKeyPairSync")){var n=sg.generateKeyPairSync("rsa",{modulusLength:s,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:De.privateKeyFromPem(n.privateKey),publicKey:De.publicKeyFromPem(n.publicKey)}}}var i=De.rsa.createKeyPairGenerationState(s,e,t);if(!r)return De.rsa.stepKeyPairGenerationState(i,0),i.keys;YS(i,t,r)};De.setRsaPublicKey=De.rsa.setPublicKey=function(s,e){var t={n:s,e};return t.encrypt=function(r,a,n){if(typeof a=="string"?a=a.toUpperCase():a===void 0&&(a="RSAES-PKCS1-V1_5"),a==="RSAES-PKCS1-V1_5")a={encode:function(o,l,u){return dy(o,l,2).getBytes()}};else if(a==="RSA-OAEP"||a==="RSAES-OAEP")a={encode:function(o,l){return ve.pkcs1.encode_rsa_oaep(l,o,n)}};else if(["RAW","NONE","NULL",null].indexOf(a)!==-1)a={encode:function(o){return o}};else if(typeof a=="string")throw new Error('Unsupported encryption scheme: "'+a+'".');var i=a.encode(r,t,!0);return De.rsa.encrypt(i,t,!0)},t.verify=function(r,a,n,i){typeof n=="string"?n=n.toUpperCase():n===void 0&&(n="RSASSA-PKCS1-V1_5"),i===void 0&&(i={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in i||(i._parseAllDigestBytes=!0),n==="RSASSA-PKCS1-V1_5"?n={verify:function(l,u){u=w0(u,t,!0);var c=T.fromDer(u,{parseAllBytes:i._parseAllDigestBytes}),f={},g=[];if(!T.validate(c,WS,f,g)){var v=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw v.errors=g,v}var p=T.derToOid(f.algorithmIdentifier);if(!(p===ve.oids.md2||p===ve.oids.md5||p===ve.oids.sha1||p===ve.oids.sha224||p===ve.oids.sha256||p===ve.oids.sha384||p===ve.oids.sha512||p===ve.oids["sha512-224"]||p===ve.oids["sha512-256"])){var v=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw v.oid=p,v}if((p===ve.oids.md2||p===ve.oids.md5)&&!("parameters"in f))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return l===f.digest}}:(n==="NONE"||n==="NULL"||n===null)&&(n={verify:function(l,u){return u=w0(u,t,!0),l===u}});var o=De.rsa.decrypt(a,t,!0,!1);return n.verify(r,o,t.n.bitLength())},t};De.setRsaPrivateKey=De.rsa.setPrivateKey=function(s,e,t,r,a,n,i,o){var l={n:s,e,d:t,p:r,q:a,dP:n,dQ:i,qInv:o};return l.decrypt=function(u,c,f){typeof c=="string"?c=c.toUpperCase():c===void 0&&(c="RSAES-PKCS1-V1_5");var g=De.rsa.decrypt(u,l,!1,!1);if(c==="RSAES-PKCS1-V1_5")c={decode:w0};else if(c==="RSA-OAEP"||c==="RSAES-OAEP")c={decode:function(v,p){return ve.pkcs1.decode_rsa_oaep(p,v,f)}};else if(["RAW","NONE","NULL",null].indexOf(c)!==-1)c={decode:function(v){return v}};else throw new Error('Unsupported encryption scheme: "'+c+'".');return c.decode(g,l,!1)},l.sign=function(u,c){var f=!1;typeof c=="string"&&(c=c.toUpperCase()),c===void 0||c==="RSASSA-PKCS1-V1_5"?(c={encode:QS},f=1):(c==="NONE"||c==="NULL"||c===null)&&(c={encode:function(){return u}},f=1);var g=c.encode(u,l.n.bitLength());return De.rsa.encrypt(g,l,f)},l};De.wrapRsaPrivateKey=function(s){return T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,T.integerToDer(0).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(De.oids.rsaEncryption).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.NULL,!1,"")]),T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,T.toDer(s).getBytes())])};De.getPrivateKeyOid=function(s){var e={},t=[];T.validate(s,Qg,e,t)&&(s=T.fromDer(ve.util.createBuffer(e.privateKey)));var r=ve.asn1.derToOid(e.privateKeyOid);return console.log(r),r};De.getPrivateKeyData=function(s){var e={},t=[],r="";return T.validate(s,Qg,e,t)&&(r=T.fromDer(ve.util.createBuffer(e.privateKey))),r};De.privateKeyFromAsn1=function(s){var e={},t=[];if(T.validate(s,Qg,e,t)&&(s=T.fromDer(ve.util.createBuffer(e.privateKey))),e={},t=[],!T.validate(s,JS,e,t)){var r=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey. ");throw r.errors=t,r}var a,n,i,o,l,u,c,f;return a=ve.util.createBuffer(e.privateKeyModulus).toHex(),n=ve.util.createBuffer(e.privateKeyPublicExponent).toHex(),i=ve.util.createBuffer(e.privateKeyPrivateExponent).toHex(),o=ve.util.createBuffer(e.privateKeyPrime1).toHex(),l=ve.util.createBuffer(e.privateKeyPrime2).toHex(),u=ve.util.createBuffer(e.privateKeyExponent1).toHex(),c=ve.util.createBuffer(e.privateKeyExponent2).toHex(),f=ve.util.createBuffer(e.privateKeyCoefficient).toHex(),De.setRsaPrivateKey(new Ze(a,16),new Ze(n,16),new Ze(i,16),new Ze(o,16),new Ze(l,16),new Ze(u,16),new Ze(c,16),new Ze(f,16))};De.privateKeyToAsn1=De.privateKeyToRSAPrivateKey=function(s){return T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,T.integerToDer(0).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,ws(s.n)),T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,ws(s.e)),T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,ws(s.d)),T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,ws(s.p)),T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,ws(s.q)),T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,ws(s.dP)),T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,ws(s.dQ)),T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,ws(s.qInv))])};De.publicKeyFromAsn1=function(s){var e={},t=[];if(T.validate(s,jS,e,t)){var r=T.derToOid(e.publicKeyOid);if(r!==De.oids.rsaEncryption){var a=new Error("Cannot read public key. Unknown OID.");throw a.oid=r,a}s=e.rsaPublicKey}if(t=[],!T.validate(s,GS,e,t)){var a=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw a.errors=t,a}var n=ve.util.createBuffer(e.publicKeyModulus).toHex(),i=ve.util.createBuffer(e.publicKeyExponent).toHex();return De.setRsaPublicKey(new Ze(n,16),new Ze(i,16))};De.publicKeyToAsn1=De.publicKeyToSubjectPublicKeyInfo=function(s){return T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(De.oids.rsaEncryption).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.NULL,!1,"")]),T.create(T.Class.UNIVERSAL,T.Type.BITSTRING,!1,[De.publicKeyToRSAPublicKey(s)])])};De.publicKeyToRSAPublicKey=function(s){return T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,ws(s.n)),T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,ws(s.e))])};function dy(s,e,t){var r=ve.util.createBuffer(),a=Math.ceil(e.n.bitLength()/8);if(s.length>a-11){var n=new Error("Message is too long for PKCS#1 v1.5 padding.");throw n.length=s.length,n.max=a-11,n}r.putByte(0),r.putByte(t);var i=a-3-s.length,o;if(t===0||t===1){o=t===0?0:255;for(var l=0;l<i;++l)r.putByte(o)}else for(;i>0;){for(var u=0,c=ve.random.getBytes(i),l=0;l<i;++l)o=c.charCodeAt(l),o===0?++u:r.putByte(o);i=u}return r.putByte(0),r.putBytes(s),r}function w0(s,e,t,r){var a=Math.ceil(e.n.bitLength()/8),n=ve.util.createBuffer(s),i=n.getByte(),o=n.getByte();if(i!==0||t&&o!==0&&o!==1||!t&&o!=2||t&&o===0&&typeof r>"u")throw new Error("Encryption block is invalid.");var l=0;if(o===0){l=a-3-r;for(var u=0;u<l;++u)if(n.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(l=0;n.length()>1;){if(n.getByte()!==255){--n.read;break}++l}else if(o===2)for(l=0;n.length()>1;){if(n.getByte()===0){--n.read;break}++l}var c=n.getByte();if(c!==0||l!==a-3-n.length())throw new Error("Encryption block is invalid.");return n.getBytes()}function YS(s,e,t){typeof e=="function"&&(t=e,e={}),e=e||{};var r={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(r.prng=e.prng),a();function a(){n(s.pBits,function(o,l){if(o)return t(o);if(s.p=l,s.q!==null)return i(o,s.q);n(s.qBits,i)})}function n(o,l){ve.prime.generateProbablePrime(o,r,l)}function i(o,l){if(o)return t(o);if(s.q=l,s.p.compareTo(s.q)<0){var u=s.p;s.p=s.q,s.q=u}if(s.p.subtract(Ze.ONE).gcd(s.e).compareTo(Ze.ONE)!==0){s.p=null,a();return}if(s.q.subtract(Ze.ONE).gcd(s.e).compareTo(Ze.ONE)!==0){s.q=null,n(s.qBits,i);return}if(s.p1=s.p.subtract(Ze.ONE),s.q1=s.q.subtract(Ze.ONE),s.phi=s.p1.multiply(s.q1),s.phi.gcd(s.e).compareTo(Ze.ONE)!==0){s.p=s.q=null,a();return}if(s.n=s.p.multiply(s.q),s.n.bitLength()!==s.bits){s.q=null,n(s.qBits,i);return}var c=s.e.modInverse(s.phi);s.keys={privateKey:De.rsa.setPrivateKey(s.n,s.e,c,s.p,s.q,c.mod(s.p1),c.mod(s.q1),s.q.modInverse(s.p)),publicKey:De.rsa.setPublicKey(s.n,s.e)},t(null,s.keys)}}function ws(s){var e=s.toString(16);e[0]>="8"&&(e="00"+e);var t=ve.util.hexToBytes(e);return t.length>1&&(t.charCodeAt(0)===0&&(t.charCodeAt(1)&128)===0||t.charCodeAt(0)===255&&(t.charCodeAt(1)&128)===128)?t.substr(1):t}function zS(s){return s<=100?27:s<=150?18:s<=200?15:s<=250?12:s<=300?9:s<=350?8:s<=400?7:s<=500?6:s<=600?5:s<=800?4:s<=1250?3:2}function Fm(s){return ve.util.isNodejs&&typeof sg[s]=="function"}function qm(s){return typeof zr.globalScope<"u"&&typeof zr.globalScope.crypto=="object"&&typeof zr.globalScope.crypto.subtle=="object"&&typeof zr.globalScope.crypto.subtle[s]=="function"}function Jm(s){return typeof zr.globalScope<"u"&&typeof zr.globalScope.msCrypto=="object"&&typeof zr.globalScope.msCrypto.subtle=="object"&&typeof zr.globalScope.msCrypto.subtle[s]=="function"}function Gm(s){for(var e=ve.util.hexToBytes(s.toString(16)),t=new Uint8Array(e.length),r=0;r<e.length;++r)t[r]=e.charCodeAt(r);return t}var de=Fe;if(typeof XS>"u")var XS=de.jsbn.BigInteger;var U=de.asn1,Ke=de.pki=de.pki||{};Ke.pbe=de.pbe=de.pbe||{};var Rn=Ke.oids,ZS={name:"EncryptedPrivateKeyInfo",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:U.Class.UNIVERSAL,type:U.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},eC={name:"PBES2Algorithms",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:U.Class.UNIVERSAL,type:U.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:U.Class.UNIVERSAL,type:U.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},tC={name:"pkcs-12PbeParams",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:U.Class.UNIVERSAL,type:U.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"iterations"}]};Ke.encryptPrivateKeyInfo=function(s,e,t){t=t||{},t.saltSize=t.saltSize||8,t.count=t.count||2048,t.algorithm=t.algorithm||"aes128",t.prfAlgorithm=t.prfAlgorithm||"sha1";var r=de.random.getBytesSync(t.saltSize),a=t.count,n=U.integerToDer(a),i,o,l;if(t.algorithm.indexOf("aes")===0||t.algorithm==="des"){var u,c,f;switch(t.algorithm){case"aes128":i=16,u=16,c=Rn["aes128-CBC"],f=de.aes.createEncryptionCipher;break;case"aes192":i=24,u=16,c=Rn["aes192-CBC"],f=de.aes.createEncryptionCipher;break;case"aes256":i=32,u=16,c=Rn["aes256-CBC"],f=de.aes.createEncryptionCipher;break;case"des":i=8,u=8,c=Rn.desCBC,f=de.des.createEncryptionCipher;break;default:var g=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw g.algorithm=t.algorithm,g}var v="hmacWith"+t.prfAlgorithm.toUpperCase(),p=my(v),h=de.pkcs5.pbkdf2(e,r,a,i,p),d=de.random.getBytesSync(u),y=f(h);y.start(d),y.update(U.toDer(s)),y.finish(),l=y.output.getBytes();var E=rC(r,n,i,v);o=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(Rn.pkcs5PBES2).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(Rn.pkcs5PBKDF2).getBytes()),E]),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(c).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,d)])])])}else if(t.algorithm==="3des"){i=24;var k=new de.util.ByteBuffer(r),h=Ke.pbe.generatePkcs12Key(e,k,1,a,i),d=Ke.pbe.generatePkcs12Key(e,k,2,a,i),y=de.des.createEncryptionCipher(h);y.start(d),y.update(U.toDer(s)),y.finish(),l=y.output.getBytes(),o=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(Rn["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,r),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,n.getBytes())])])}else{var g=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw g.algorithm=t.algorithm,g}var R=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[o,U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,l)]);return R};Ke.decryptPrivateKeyInfo=function(s,e){var t=null,r={},a=[];if(!U.validate(s,ZS,r,a)){var n=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw n.errors=a,n}var i=U.derToOid(r.encryptionOid),o=Ke.pbe.getCipher(i,r.encryptionParams,e),l=de.util.createBuffer(r.encryptedData);return o.update(l),o.finish()&&(t=U.fromDer(o.output)),t};Ke.encryptedPrivateKeyToPem=function(s,e){var t={type:"ENCRYPTED PRIVATE KEY",body:U.toDer(s).getBytes()};return de.pem.encode(t,{maxline:e})};Ke.encryptedPrivateKeyFromPem=function(s){var e=de.pem.decode(s)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var t=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return U.fromDer(e.body)};Ke.encryptRsaPrivateKey=function(s,e,t){if(t=t||{},!t.legacy){var r=Ke.wrapRsaPrivateKey(Ke.privateKeyToAsn1(s));return r=Ke.encryptPrivateKeyInfo(r,e,t),Ke.encryptedPrivateKeyToPem(r)}var a,n,i,o;switch(t.algorithm){case"aes128":a="AES-128-CBC",i=16,n=de.random.getBytesSync(16),o=de.aes.createEncryptionCipher;break;case"aes192":a="AES-192-CBC",i=24,n=de.random.getBytesSync(16),o=de.aes.createEncryptionCipher;break;case"aes256":a="AES-256-CBC",i=32,n=de.random.getBytesSync(16),o=de.aes.createEncryptionCipher;break;case"3des":a="DES-EDE3-CBC",i=24,n=de.random.getBytesSync(8),o=de.des.createEncryptionCipher;break;case"des":a="DES-CBC",i=8,n=de.random.getBytesSync(8),o=de.des.createEncryptionCipher;break;default:var l=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+t.algorithm+'".');throw l.algorithm=t.algorithm,l}var u=de.pbe.opensslDeriveBytes(e,n.substr(0,8),i),c=o(u);c.start(n),c.update(U.toDer(Ke.privateKeyToAsn1(s))),c.finish();var f={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:a,parameters:de.util.bytesToHex(n).toUpperCase()},body:c.output.getBytes()};return de.pem.encode(f)};Ke.decryptRsaPrivateKey=function(s,e){var t=null,r=de.pem.decode(s)[0];if(r.type!=="ENCRYPTED PRIVATE KEY"&&r.type!=="PRIVATE KEY"&&r.type!=="RSA PRIVATE KEY"){var a=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw a.headerType=a,a}if(r.procType&&r.procType.type==="ENCRYPTED"){var n,i;switch(r.dekInfo.algorithm){case"DES-CBC":n=8,i=de.des.createDecryptionCipher;break;case"DES-EDE3-CBC":n=24,i=de.des.createDecryptionCipher;break;case"AES-128-CBC":n=16,i=de.aes.createDecryptionCipher;break;case"AES-192-CBC":n=24,i=de.aes.createDecryptionCipher;break;case"AES-256-CBC":n=32,i=de.aes.createDecryptionCipher;break;case"RC2-40-CBC":n=5,i=function(f){return de.rc2.createDecryptionCipher(f,40)};break;case"RC2-64-CBC":n=8,i=function(f){return de.rc2.createDecryptionCipher(f,64)};break;case"RC2-128-CBC":n=16,i=function(f){return de.rc2.createDecryptionCipher(f,128)};break;default:var a=new Error('Could not decrypt private key; unsupported encryption algorithm "'+r.dekInfo.algorithm+'".');throw a.algorithm=r.dekInfo.algorithm,a}var o=de.util.hexToBytes(r.dekInfo.parameters),l=de.pbe.opensslDeriveBytes(e,o.substr(0,8),n),u=i(l);if(u.start(o),u.update(de.util.createBuffer(r.body)),u.finish())t=u.output.getBytes();else return t}else t=r.body;return r.type==="ENCRYPTED PRIVATE KEY"?t=Ke.decryptPrivateKeyInfo(U.fromDer(t),e):t=U.fromDer(t),t!==null&&(t=Ke.privateKeyFromAsn1(t)),t};Ke.pbe.generatePkcs12Key=function(s,e,t,r,a,n){var i,o;if(typeof n>"u"||n===null){if(!("sha1"in de.md))throw new Error('"sha1" hash algorithm unavailable.');n=de.md.sha1.create()}var l=n.digestLength,u=n.blockLength,c=new de.util.ByteBuffer,f=new de.util.ByteBuffer;if(s!=null){for(o=0;o<s.length;o++)f.putInt16(s.charCodeAt(o));f.putInt16(0)}var g=f.length(),v=e.length(),p=new de.util.ByteBuffer;p.fillWithByte(t,u);var h=u*Math.ceil(v/u),d=new de.util.ByteBuffer;for(o=0;o<h;o++)d.putByte(e.at(o%v));var y=u*Math.ceil(g/u),E=new de.util.ByteBuffer;for(o=0;o<y;o++)E.putByte(f.at(o%g));var k=d;k.putBuffer(E);for(var R=Math.ceil(a/l),V=1;V<=R;V++){var L=new de.util.ByteBuffer;L.putBytes(p.bytes()),L.putBytes(k.bytes());for(var ne=0;ne<r;ne++)n.start(),n.update(L.getBytes()),L=n.digest();var se=new de.util.ByteBuffer;for(o=0;o<u;o++)se.putByte(L.at(o%l));var Se=Math.ceil(v/u)+Math.ceil(g/u),Te=new de.util.ByteBuffer;for(i=0;i<Se;i++){var ye=new de.util.ByteBuffer(k.getBytes(u)),Ce=511;for(o=se.length()-1;o>=0;o--)Ce=Ce>>8,Ce+=se.at(o)+ye.at(o),ye.setAt(o,Ce&255);Te.putBuffer(ye)}k=Te,c.putBuffer(L)}return c.truncate(c.length()-a),c};Ke.pbe.getCipher=function(s,e,t){switch(s){case Ke.oids.pkcs5PBES2:return Ke.pbe.getCipherForPBES2(s,e,t);case Ke.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case Ke.oids["pbewithSHAAnd40BitRC2-CBC"]:return Ke.pbe.getCipherForPKCS12PBE(s,e,t);default:var r=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw r.oid=s,r.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],r}};Ke.pbe.getCipherForPBES2=function(s,e,t){var r={},a=[];if(!U.validate(e,eC,r,a)){var n=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw n.errors=a,n}if(s=U.derToOid(r.kdfOid),s!==Ke.oids.pkcs5PBKDF2){var n=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw n.oid=s,n.supportedOids=["pkcs5PBKDF2"],n}if(s=U.derToOid(r.encOid),s!==Ke.oids["aes128-CBC"]&&s!==Ke.oids["aes192-CBC"]&&s!==Ke.oids["aes256-CBC"]&&s!==Ke.oids["des-EDE3-CBC"]&&s!==Ke.oids.desCBC){var n=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw n.oid=s,n.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],n}var i=r.kdfSalt,o=de.util.createBuffer(r.kdfIterationCount);o=o.getInt(o.length()<<3);var l,u;switch(Ke.oids[s]){case"aes128-CBC":l=16,u=de.aes.createDecryptionCipher;break;case"aes192-CBC":l=24,u=de.aes.createDecryptionCipher;break;case"aes256-CBC":l=32,u=de.aes.createDecryptionCipher;break;case"des-EDE3-CBC":l=24,u=de.des.createDecryptionCipher;break;case"desCBC":l=8,u=de.des.createDecryptionCipher;break}var c=gy(r.prfOid),f=de.pkcs5.pbkdf2(t,i,o,l,c),g=r.encIv,v=u(f);return v.start(g),v};Ke.pbe.getCipherForPKCS12PBE=function(s,e,t){var r={},a=[];if(!U.validate(e,tC,r,a)){var n=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw n.errors=a,n}var i=de.util.createBuffer(r.salt),o=de.util.createBuffer(r.iterations);o=o.getInt(o.length()<<3);var l,u,c;switch(s){case Ke.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:l=24,u=8,c=de.des.startDecrypting;break;case Ke.oids["pbewithSHAAnd40BitRC2-CBC"]:l=5,u=8,c=function(h,d){var y=de.rc2.createDecryptionCipher(h,40);return y.start(d,null),y};break;default:var n=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw n.oid=s,n}var f=gy(r.prfOid),g=Ke.pbe.generatePkcs12Key(t,i,1,o,l,f);f.start();var v=Ke.pbe.generatePkcs12Key(t,i,2,o,u,f);return c(g,v)};Ke.pbe.opensslDeriveBytes=function(s,e,t,r){if(typeof r>"u"||r===null){if(!("md5"in de.md))throw new Error('"md5" hash algorithm unavailable.');r=de.md.md5.create()}e===null&&(e="");for(var a=[jm(r,s+e)],n=16,i=1;n<t;++i,n+=16)a.push(jm(r,a[i-1]+s+e));return a.join("").substr(0,t)};function jm(s,e){return s.start().update(e).digest().getBytes()}function gy(s){var e;if(!s)e="hmacWithSHA1";else if(e=Ke.oids[U.derToOid(s)],!e){var t=new Error("Unsupported PRF OID.");throw t.oid=s,t.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],t}return my(e)}function my(s){var e=de.md;switch(s){case"hmacWithSHA224":e=de.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":s=s.substr(8).toLowerCase();break;default:var t=new Error("Unsupported PRF algorithm.");throw t.algorithm=s,t.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],t}if(!e||!(s in e))throw new Error("Unknown hash algorithm: "+s);return e[s].create()}function rC(s,e,t,r){var a=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,s),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,e.getBytes())]);return r!=="hmacWithSHA1"&&a.value.push(U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,de.util.hexToBytes(t.toString(16))),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(Ke.oids[r]).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,"")])),a}var eu=Fe,ce=eu.asn1,du=eu.pkcs7asn1=eu.pkcs7asn1||{};eu.pkcs7=eu.pkcs7||{};eu.pkcs7.asn1=du;var py={name:"ContentInfo",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:ce.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};du.contentInfoValidator=py;var yy={name:"EncryptedContentInfo",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:ce.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:ce.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};du.envelopedDataValidator={name:"EnvelopedData",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:ce.Class.UNIVERSAL,type:ce.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(yy)};du.encryptedDataValidator={name:"EncryptedData",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:ce.Class.UNIVERSAL,type:ce.Type.INTEGER,constructed:!1,capture:"version"}].concat(yy)};var sC={name:"SignerInfo",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:ce.Class.UNIVERSAL,type:ce.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:ce.Class.UNIVERSAL,type:ce.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:ce.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:ce.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:ce.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};du.signedDataValidator={name:"SignedData",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:ce.Class.UNIVERSAL,type:ce.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},py,{name:"SignedData.Certificates",tagClass:ce.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:ce.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SET,capture:"signerInfos",optional:!0,value:[sC]}]};du.recipientInfoValidator={name:"RecipientInfo",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:ce.Class.UNIVERSAL,type:ce.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:ce.Class.UNIVERSAL,type:ce.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:ce.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]};var Gi=Fe;Gi.mgf=Gi.mgf||{};var aC=Gi.mgf.mgf1=Gi.mgf1=Gi.mgf1||{};aC.create=function(s){var e={generate:function(t,r){for(var a=new Gi.util.ByteBuffer,n=Math.ceil(r/s.digestLength),i=0;i<n;i++){var o=new Gi.util.ByteBuffer;o.putInt32(i),s.start(),s.update(t+o.getBytes()),a.putBuffer(s.digest())}return a.truncate(a.length()-r),a.getBytes()}};return e};var S0=Fe;S0.mgf=S0.mgf||{};S0.mgf.mgf1=S0.mgf1;var Li=Fe,nC=Li.pss=Li.pss||{};nC.create=function(s){arguments.length===3&&(s={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=s.md,t=s.mgf,r=e.digestLength,a=s.salt||null;typeof a=="string"&&(a=Li.util.createBuffer(a));var n;if("saltLength"in s)n=s.saltLength;else if(a!==null)n=a.length();else throw new Error("Salt length not specified or specific salt not given.");if(a!==null&&a.length()!==n)throw new Error("Given salt length does not match length of given salt.");var i=s.prng||Li.random,o={};return o.encode=function(l,u){var c,f=u-1,g=Math.ceil(f/8),v=l.digest().getBytes();if(g<r+n+2)throw new Error("Message is too long to encrypt.");var p;a===null?p=i.getBytesSync(n):p=a.bytes();var h=new Li.util.ByteBuffer;h.fillWithByte(0,8),h.putBytes(v),h.putBytes(p),e.start(),e.update(h.getBytes());var d=e.digest().getBytes(),y=new Li.util.ByteBuffer;y.fillWithByte(0,g-n-r-2),y.putByte(1),y.putBytes(p);var E=y.getBytes(),k=g-r-1,R=t.generate(d,k),V="";for(c=0;c<k;c++)V+=String.fromCharCode(E.charCodeAt(c)^R.charCodeAt(c));var L=65280>>8*g-f&255;return V=String.fromCharCode(V.charCodeAt(0)&~L)+V.substr(1),V+d+String.fromCharCode(188)},o.verify=function(l,u,c){var f,g=c-1,v=Math.ceil(g/8);if(u=u.substr(-v),v<r+n+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(u.charCodeAt(v-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var p=v-r-1,h=u.substr(0,p),d=u.substr(p,r),y=65280>>8*v-g&255;if((h.charCodeAt(0)&y)!==0)throw new Error("Bits beyond keysize not zero as expected.");var E=t.generate(d,p),k="";for(f=0;f<p;f++)k+=String.fromCharCode(h.charCodeAt(f)^E.charCodeAt(f));k=String.fromCharCode(k.charCodeAt(0)&~y)+k.substr(1);var R=v-r-n-2;for(f=0;f<R;f++)if(k.charCodeAt(f)!==0)throw new Error("Leftmost octets not zero as expected");if(k.charCodeAt(R)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var V=k.substr(-n),L=new Li.util.ByteBuffer;L.fillWithByte(0,8),L.putBytes(l),L.putBytes(V),e.start(),e.update(L.getBytes());var ne=e.digest().getBytes();return d===ne},o};var Be=Fe,w=Be.asn1,re=Be.pki=Be.pki||{},Ye=re.oids,xt={};xt.CN=Ye.commonName;xt.commonName="CN";xt.C=Ye.countryName;xt.countryName="C";xt.L=Ye.localityName;xt.localityName="L";xt.ST=Ye.stateOrProvinceName;xt.stateOrProvinceName="ST";xt.O=Ye.organizationName;xt.organizationName="O";xt.OU=Ye.organizationalUnitName;xt.organizationalUnitName="OU";xt.E=Ye.emailAddress;xt.emailAddress="E";var vy=Be.pki.rsa.publicKeyValidator,iC={name:"Certificate",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:w.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:w.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:w.Class.UNIVERSAL,type:w.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:w.Class.UNIVERSAL,type:w.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:w.Class.UNIVERSAL,type:w.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:w.Class.UNIVERSAL,type:w.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},vy,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:w.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:w.Class.UNIVERSAL,type:w.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:w.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:w.Class.UNIVERSAL,type:w.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:w.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:w.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:w.Class.UNIVERSAL,type:w.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},oC={name:"rsapss",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:w.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:w.Class.UNIVERSAL,type:w.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:w.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:w.Class.UNIVERSAL,type:w.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:w.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:w.Class.UNIVERSAL,type:w.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:w.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:w.Class.UNIVERSAL,type:w.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},lC={name:"CertificationRequestInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},vy,{name:"CertificationRequestInfo.attributes",tagClass:w.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:w.Class.UNIVERSAL,type:w.Type.SET,constructed:!0}]}]}]},uC={name:"CertificationRequest",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[lC,{name:"CertificationRequest.signatureAlgorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:w.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:w.Class.UNIVERSAL,type:w.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};re.RDNAttributesAsArray=function(s,e){for(var t=[],r,a,n,i=0;i<s.value.length;++i){r=s.value[i];for(var o=0;o<r.value.length;++o)n={},a=r.value[o],n.type=w.derToOid(a.value[0].value),n.value=a.value[1].value,n.valueTagClass=a.value[1].type,n.type in Ye&&(n.name=Ye[n.type],n.name in xt&&(n.shortName=xt[n.name])),e&&(e.update(n.type),e.update(n.value)),t.push(n)}return t};re.CRIAttributesAsArray=function(s){for(var e=[],t=0;t<s.length;++t)for(var r=s[t],a=w.derToOid(r.value[0].value),n=r.value[1].value,i=0;i<n.length;++i){var o={};if(o.type=a,o.value=n[i].value,o.valueTagClass=n[i].type,o.type in Ye&&(o.name=Ye[o.type],o.name in xt&&(o.shortName=xt[o.name])),o.type===Ye.extensionRequest){o.extensions=[];for(var l=0;l<o.value.length;++l)o.extensions.push(re.certificateExtensionFromAsn1(o.value[l]))}e.push(o)}return e};function bn(s,e){typeof e=="string"&&(e={shortName:e});for(var t=null,r,a=0;t===null&&a<s.attributes.length;++a)r=s.attributes[a],(e.type&&e.type===r.type||e.name&&e.name===r.name||e.shortName&&e.shortName===r.shortName)&&(t=r);return t}var C0=function(s,e,t){var r={};if(s!==Ye["RSASSA-PSS"])return r;t&&(r={hash:{algorithmOid:Ye.sha1},mgf:{algorithmOid:Ye.mgf1,hash:{algorithmOid:Ye.sha1}},saltLength:20});var a={},n=[];if(!w.validate(e,oC,a,n)){var i=new Error("Cannot read RSASSA-PSS parameter block.");throw i.errors=n,i}return a.hashOid!==void 0&&(r.hash=r.hash||{},r.hash.algorithmOid=w.derToOid(a.hashOid)),a.maskGenOid!==void 0&&(r.mgf=r.mgf||{},r.mgf.algorithmOid=w.derToOid(a.maskGenOid),r.mgf.hash=r.mgf.hash||{},r.mgf.hash.algorithmOid=w.derToOid(a.maskGenHashOid)),a.saltLength!==void 0&&(r.saltLength=a.saltLength.charCodeAt(0)),r},rd=function(s){switch(Ye[s.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return Be.md.sha1.create();case"md5WithRSAEncryption":return Be.md.md5.create();case"sha256WithRSAEncryption":return Be.md.sha256.create();case"sha384WithRSAEncryption":return Be.md.sha384.create();case"sha512WithRSAEncryption":return Be.md.sha512.create();case"RSASSA-PSS":return Be.md.sha256.create();default:var e=new Error("Could not compute "+s.type+" digest. Unknown signature OID.");throw e.signatureOid=s.signatureOid,e}},wy=function(s){var e=s.certificate,t;switch(e.signatureOid){case Ye.sha1WithRSAEncryption:case Ye.sha1WithRSASignature:break;case Ye["RSASSA-PSS"]:var r,a;if(r=Ye[e.signatureParameters.mgf.hash.algorithmOid],r===void 0||Be.md[r]===void 0){var n=new Error("Unsupported MGF hash function.");throw n.oid=e.signatureParameters.mgf.hash.algorithmOid,n.name=r,n}if(a=Ye[e.signatureParameters.mgf.algorithmOid],a===void 0||Be.mgf[a]===void 0){var n=new Error("Unsupported MGF function.");throw n.oid=e.signatureParameters.mgf.algorithmOid,n.name=a,n}if(a=Be.mgf[a].create(Be.md[r].create()),r=Ye[e.signatureParameters.hash.algorithmOid],r===void 0||Be.md[r]===void 0){var n=new Error("Unsupported RSASSA-PSS hash function.");throw n.oid=e.signatureParameters.hash.algorithmOid,n.name=r,n}t=Be.pss.create(Be.md[r].create(),a,e.signatureParameters.saltLength);break}return e.publicKey.verify(s.md.digest().getBytes(),s.signature,t)};re.certificateFromPem=function(s,e,t){var r=Be.pem.decode(s)[0];if(r.type!=="CERTIFICATE"&&r.type!=="X509 CERTIFICATE"&&r.type!=="TRUSTED CERTIFICATE"){var a=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw a.headerType=r.type,a}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var n=w.fromDer(r.body,t);return re.certificateFromAsn1(n,e)};re.certificateToPem=function(s,e){var t={type:"CERTIFICATE",body:w.toDer(re.certificateToAsn1(s)).getBytes()};return Be.pem.encode(t,{maxline:e})};re.publicKeyFromPem=function(s){var e=Be.pem.decode(s)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var t=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var r=w.fromDer(e.body);return re.publicKeyFromAsn1(r)};re.publicKeyToPem=function(s,e){var t={type:"PUBLIC KEY",body:w.toDer(re.publicKeyToAsn1(s)).getBytes()};return Be.pem.encode(t,{maxline:e})};re.publicKeyToRSAPublicKeyPem=function(s,e){var t={type:"RSA PUBLIC KEY",body:w.toDer(re.publicKeyToRSAPublicKey(s)).getBytes()};return Be.pem.encode(t,{maxline:e})};re.getPublicKeyFingerprint=function(s,e){e=e||{};var t=e.md||Be.md.sha1.create(),r=e.type||"RSAPublicKey",a;switch(r){case"RSAPublicKey":a=w.toDer(re.publicKeyToRSAPublicKey(s)).getBytes();break;case"SubjectPublicKeyInfo":a=w.toDer(re.publicKeyToAsn1(s)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}t.start(),t.update(a);var n=t.digest();if(e.encoding==="hex"){var i=n.toHex();return e.delimiter?i.match(/.{2}/g).join(e.delimiter):i}else{if(e.encoding==="binary")return n.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return n};re.certificationRequestFromPem=function(s,e,t){var r=Be.pem.decode(s)[0];if(r.type!=="CERTIFICATE REQUEST"){var a=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw a.headerType=r.type,a}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var n=w.fromDer(r.body,t);return re.certificationRequestFromAsn1(n,e)};re.certificationRequestToPem=function(s,e){var t={type:"CERTIFICATE REQUEST",body:w.toDer(re.certificationRequestToAsn1(s)).getBytes()};return Be.pem.encode(t,{maxline:e})};re.createCertificate=function(){var s={};return s.version=2,s.serialNumber="00",s.signatureOid=null,s.signature=null,s.siginfo={},s.siginfo.algorithmOid=null,s.validity={},s.validity.notBefore=new Date,s.validity.notAfter=new Date,s.issuer={},s.issuer.getField=function(e){return bn(s.issuer,e)},s.issuer.addField=function(e){Xr([e]),s.issuer.attributes.push(e)},s.issuer.attributes=[],s.issuer.hash=null,s.subject={},s.subject.getField=function(e){return bn(s.subject,e)},s.subject.addField=function(e){Xr([e]),s.subject.attributes.push(e)},s.subject.attributes=[],s.subject.hash=null,s.extensions=[],s.publicKey=null,s.md=null,s.setSubject=function(e,t){Xr(e),s.subject.attributes=e,delete s.subject.uniqueId,t&&(s.subject.uniqueId=t),s.subject.hash=null},s.setIssuer=function(e,t){Xr(e),s.issuer.attributes=e,delete s.issuer.uniqueId,t&&(s.issuer.uniqueId=t),s.issuer.hash=null},s.setExtensions=function(e){for(var t=0;t<e.length;++t)Sy(e[t],{cert:s});s.extensions=e},s.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var t=null,r,a=0;t===null&&a<s.extensions.length;++a)r=s.extensions[a],(e.id&&r.id===e.id||e.name&&r.name===e.name)&&(t=r);return t},s.sign=function(e,t){s.md=t||Be.md.sha1.create();var r=Ye[s.md.algorithm+"WithRSAEncryption"];if(!r){var a=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw a.algorithm=s.md.algorithm,a}s.signatureOid=s.siginfo.algorithmOid=r,s.tbsCertificate=re.getTBSCertificate(s);var n=w.toDer(s.tbsCertificate);s.md.update(n.getBytes()),s.signature=e.sign(s.md)},s.verify=function(e){var t=!1;if(!s.issued(e)){var r=e.issuer,a=s.subject,n=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw n.expectedIssuer=a.attributes,n.actualIssuer=r.attributes,n}var i=e.md;if(i===null){i=rd({signatureOid:e.signatureOid,type:"certificate"});var o=e.tbsCertificate||re.getTBSCertificate(e),l=w.toDer(o);i.update(l.getBytes())}return i!==null&&(t=wy({certificate:s,md:i,signature:e.signature})),t},s.isIssuer=function(e){var t=!1,r=s.issuer,a=e.subject;if(r.hash&&a.hash)t=r.hash===a.hash;else if(r.attributes.length===a.attributes.length){t=!0;for(var n,i,o=0;t&&o<r.attributes.length;++o)n=r.attributes[o],i=a.attributes[o],(n.type!==i.type||n.value!==i.value)&&(t=!1)}return t},s.issued=function(e){return e.isIssuer(s)},s.generateSubjectKeyIdentifier=function(){return re.getPublicKeyFingerprint(s.publicKey,{type:"RSAPublicKey"})},s.verifySubjectKeyIdentifier=function(){for(var e=Ye.subjectKeyIdentifier,t=0;t<s.extensions.length;++t){var r=s.extensions[t];if(r.id===e){var a=s.generateSubjectKeyIdentifier().getBytes();return Be.util.hexToBytes(r.subjectKeyIdentifier)===a}}return!1},s};re.certificateFromAsn1=function(s,e){var t={},r=[];if(!w.validate(s,iC,t,r)){var a=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw a.errors=r,a}var n=w.derToOid(t.publicKeyOid);if(n!==re.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var i=re.createCertificate();i.version=t.certVersion?t.certVersion.charCodeAt(0):0;var o=Be.util.createBuffer(t.certSerialNumber);i.serialNumber=o.toHex(),i.signatureOid=Be.asn1.derToOid(t.certSignatureOid),i.signatureParameters=C0(i.signatureOid,t.certSignatureParams,!0),i.siginfo.algorithmOid=Be.asn1.derToOid(t.certinfoSignatureOid),i.siginfo.parameters=C0(i.siginfo.algorithmOid,t.certinfoSignatureParams,!1),i.signature=t.certSignature;var l=[];if(t.certValidity1UTCTime!==void 0&&l.push(w.utcTimeToDate(t.certValidity1UTCTime)),t.certValidity2GeneralizedTime!==void 0&&l.push(w.generalizedTimeToDate(t.certValidity2GeneralizedTime)),t.certValidity3UTCTime!==void 0&&l.push(w.utcTimeToDate(t.certValidity3UTCTime)),t.certValidity4GeneralizedTime!==void 0&&l.push(w.generalizedTimeToDate(t.certValidity4GeneralizedTime)),l.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(l.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(i.validity.notBefore=l[0],i.validity.notAfter=l[1],i.tbsCertificate=t.tbsCertificate,e){i.md=rd({signatureOid:i.signatureOid,type:"certificate"});var u=w.toDer(i.tbsCertificate);i.md.update(u.getBytes())}var c=Be.md.sha1.create(),f=w.toDer(t.certIssuer);c.update(f.getBytes()),i.issuer.getField=function(p){return bn(i.issuer,p)},i.issuer.addField=function(p){Xr([p]),i.issuer.attributes.push(p)},i.issuer.attributes=re.RDNAttributesAsArray(t.certIssuer),t.certIssuerUniqueId&&(i.issuer.uniqueId=t.certIssuerUniqueId),i.issuer.hash=c.digest().toHex();var g=Be.md.sha1.create(),v=w.toDer(t.certSubject);return g.update(v.getBytes()),i.subject.getField=function(p){return bn(i.subject,p)},i.subject.addField=function(p){Xr([p]),i.subject.attributes.push(p)},i.subject.attributes=re.RDNAttributesAsArray(t.certSubject),t.certSubjectUniqueId&&(i.subject.uniqueId=t.certSubjectUniqueId),i.subject.hash=g.digest().toHex(),t.certExtensions?i.extensions=re.certificateExtensionsFromAsn1(t.certExtensions):i.extensions=[],i.publicKey=re.publicKeyFromAsn1(t.subjectPublicKeyInfo),i};re.certificateExtensionsFromAsn1=function(s){for(var e=[],t=0;t<s.value.length;++t)for(var r=s.value[t],a=0;a<r.value.length;++a)e.push(re.certificateExtensionFromAsn1(r.value[a]));return e};re.certificateExtensionFromAsn1=function(s){var e={};if(e.id=w.derToOid(s.value[0].value),e.critical=!1,s.value[1].type===w.Type.BOOLEAN?(e.critical=s.value[1].value.charCodeAt(0)!==0,e.value=s.value[2].value):e.value=s.value[1].value,e.id in Ye){if(e.name=Ye[e.id],e.name==="keyUsage"){var t=w.fromDer(e.value),r=0,a=0;t.value.length>1&&(r=t.value.charCodeAt(1),a=t.value.length>2?t.value.charCodeAt(2):0),e.digitalSignature=(r&128)===128,e.nonRepudiation=(r&64)===64,e.keyEncipherment=(r&32)===32,e.dataEncipherment=(r&16)===16,e.keyAgreement=(r&8)===8,e.keyCertSign=(r&4)===4,e.cRLSign=(r&2)===2,e.encipherOnly=(r&1)===1,e.decipherOnly=(a&128)===128}else if(e.name==="basicConstraints"){var t=w.fromDer(e.value);t.value.length>0&&t.value[0].type===w.Type.BOOLEAN?e.cA=t.value[0].value.charCodeAt(0)!==0:e.cA=!1;var n=null;t.value.length>0&&t.value[0].type===w.Type.INTEGER?n=t.value[0].value:t.value.length>1&&(n=t.value[1].value),n!==null&&(e.pathLenConstraint=w.derToInteger(n))}else if(e.name==="extKeyUsage")for(var t=w.fromDer(e.value),i=0;i<t.value.length;++i){var o=w.derToOid(t.value[i].value);o in Ye?e[Ye[o]]=!0:e[o]=!0}else if(e.name==="nsCertType"){var t=w.fromDer(e.value),r=0;t.value.length>1&&(r=t.value.charCodeAt(1)),e.client=(r&128)===128,e.server=(r&64)===64,e.email=(r&32)===32,e.objsign=(r&16)===16,e.reserved=(r&8)===8,e.sslCA=(r&4)===4,e.emailCA=(r&2)===2,e.objCA=(r&1)===1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var l,t=w.fromDer(e.value),u=0;u<t.value.length;++u){l=t.value[u];var c={type:l.type,value:l.value};switch(e.altNames.push(c),l.type){case 1:case 2:case 6:break;case 7:c.ip=Be.util.bytesToIP(l.value);break;case 8:c.oid=w.derToOid(l.value);break}}}else if(e.name==="subjectKeyIdentifier"){var t=w.fromDer(e.value);e.subjectKeyIdentifier=Be.util.bytesToHex(t.value)}}return e};re.certificationRequestFromAsn1=function(s,e){var t={},r=[];if(!w.validate(s,uC,t,r)){var a=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw a.errors=r,a}var n=w.derToOid(t.publicKeyOid);if(n!==re.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var i=re.createCertificationRequest();if(i.version=t.csrVersion?t.csrVersion.charCodeAt(0):0,i.signatureOid=Be.asn1.derToOid(t.csrSignatureOid),i.signatureParameters=C0(i.signatureOid,t.csrSignatureParams,!0),i.siginfo.algorithmOid=Be.asn1.derToOid(t.csrSignatureOid),i.siginfo.parameters=C0(i.siginfo.algorithmOid,t.csrSignatureParams,!1),i.signature=t.csrSignature,i.certificationRequestInfo=t.certificationRequestInfo,e){i.md=rd({signatureOid:i.signatureOid,type:"certification request"});var o=w.toDer(i.certificationRequestInfo);i.md.update(o.getBytes())}var l=Be.md.sha1.create();return i.subject.getField=function(u){return bn(i.subject,u)},i.subject.addField=function(u){Xr([u]),i.subject.attributes.push(u)},i.subject.attributes=re.RDNAttributesAsArray(t.certificationRequestInfoSubject,l),i.subject.hash=l.digest().toHex(),i.publicKey=re.publicKeyFromAsn1(t.subjectPublicKeyInfo),i.getAttribute=function(u){return bn(i,u)},i.addAttribute=function(u){Xr([u]),i.attributes.push(u)},i.attributes=re.CRIAttributesAsArray(t.certificationRequestInfoAttributes||[]),i};re.createCertificationRequest=function(){var s={};return s.version=0,s.signatureOid=null,s.signature=null,s.siginfo={},s.siginfo.algorithmOid=null,s.subject={},s.subject.getField=function(e){return bn(s.subject,e)},s.subject.addField=function(e){Xr([e]),s.subject.attributes.push(e)},s.subject.attributes=[],s.subject.hash=null,s.publicKey=null,s.attributes=[],s.getAttribute=function(e){return bn(s,e)},s.addAttribute=function(e){Xr([e]),s.attributes.push(e)},s.md=null,s.setSubject=function(e){Xr(e),s.subject.attributes=e,s.subject.hash=null},s.setAttributes=function(e){Xr(e),s.attributes=e},s.sign=function(e,t){s.md=t||Be.md.sha1.create();var r=Ye[s.md.algorithm+"WithRSAEncryption"];if(!r){var a=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw a.algorithm=s.md.algorithm,a}s.signatureOid=s.siginfo.algorithmOid=r,s.certificationRequestInfo=re.getCertificationRequestInfo(s);var n=w.toDer(s.certificationRequestInfo);s.md.update(n.getBytes()),s.signature=e.sign(s.md)},s.verify=function(){var e=!1,t=s.md;if(t===null){t=rd({signatureOid:s.signatureOid,type:"certification request"});var r=s.certificationRequestInfo||re.getCertificationRequestInfo(s),a=w.toDer(r);t.update(a.getBytes())}return t!==null&&(e=wy({certificate:s,md:t,signature:s.signature})),e},s};function tu(s){for(var e=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]),t,r,a=s.attributes,n=0;n<a.length;++n){t=a[n];var i=t.value,o=w.Type.PRINTABLESTRING;"valueTagClass"in t&&(o=t.valueTagClass,o===w.Type.UTF8&&(i=Be.util.encodeUtf8(i))),r=w.create(w.Class.UNIVERSAL,w.Type.SET,!0,[w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(t.type).getBytes()),w.create(w.Class.UNIVERSAL,o,!1,i)])]),e.value.push(r)}return e}function Xr(s){for(var e,t=0;t<s.length;++t){if(e=s[t],typeof e.name>"u"&&(e.type&&e.type in re.oids?e.name=re.oids[e.type]:e.shortName&&e.shortName in xt&&(e.name=re.oids[xt[e.shortName]])),typeof e.type>"u")if(e.name&&e.name in re.oids)e.type=re.oids[e.name];else{var r=new Error("Attribute type not specified.");throw r.attribute=e,r}if(typeof e.shortName>"u"&&e.name&&e.name in xt&&(e.shortName=xt[e.name]),e.type===Ye.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=w.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var a=0;a<e.extensions.length;++a)e.value.push(re.certificateExtensionToAsn1(Sy(e.extensions[a])))}if(typeof e.value>"u"){var r=new Error("Attribute value not specified.");throw r.attribute=e,r}}}function Sy(s,e){if(e=e||{},typeof s.name>"u"&&s.id&&s.id in re.oids&&(s.name=re.oids[s.id]),typeof s.id>"u")if(s.name&&s.name in re.oids)s.id=re.oids[s.name];else{var t=new Error("Extension ID not specified.");throw t.extension=s,t}if(typeof s.value<"u")return s;if(s.name==="keyUsage"){var r=0,a=0,n=0;s.digitalSignature&&(a|=128,r=7),s.nonRepudiation&&(a|=64,r=6),s.keyEncipherment&&(a|=32,r=5),s.dataEncipherment&&(a|=16,r=4),s.keyAgreement&&(a|=8,r=3),s.keyCertSign&&(a|=4,r=2),s.cRLSign&&(a|=2,r=1),s.encipherOnly&&(a|=1,r=0),s.decipherOnly&&(n|=128,r=7);var i=String.fromCharCode(r);n!==0?i+=String.fromCharCode(a)+String.fromCharCode(n):a!==0&&(i+=String.fromCharCode(a)),s.value=w.create(w.Class.UNIVERSAL,w.Type.BITSTRING,!1,i)}else if(s.name==="basicConstraints")s.value=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]),s.cA&&s.value.value.push(w.create(w.Class.UNIVERSAL,w.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in s&&s.value.value.push(w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,w.integerToDer(s.pathLenConstraint).getBytes()));else if(s.name==="extKeyUsage"){s.value=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]);var o=s.value.value;for(var l in s)s[l]===!0&&(l in Ye?o.push(w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(Ye[l]).getBytes())):l.indexOf(".")!==-1&&o.push(w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(l).getBytes())))}else if(s.name==="nsCertType"){var r=0,a=0;s.client&&(a|=128,r=7),s.server&&(a|=64,r=6),s.email&&(a|=32,r=5),s.objsign&&(a|=16,r=4),s.reserved&&(a|=8,r=3),s.sslCA&&(a|=4,r=2),s.emailCA&&(a|=2,r=1),s.objCA&&(a|=1,r=0);var i=String.fromCharCode(r);a!==0&&(i+=String.fromCharCode(a)),s.value=w.create(w.Class.UNIVERSAL,w.Type.BITSTRING,!1,i)}else if(s.name==="subjectAltName"||s.name==="issuerAltName"){s.value=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]);for(var u,c=0;c<s.altNames.length;++c){u=s.altNames[c];var i=u.value;if(u.type===7&&u.ip){if(i=Be.util.bytesFromIP(u.ip),i===null){var t=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw t.extension=s,t}}else u.type===8&&(u.oid?i=w.oidToDer(w.oidToDer(u.oid)):i=w.oidToDer(i));s.value.value.push(w.create(w.Class.CONTEXT_SPECIFIC,u.type,!1,i))}}else if(s.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(s.comment)||s.comment.length<1||s.comment.length>128)throw new Error('Invalid "nsComment" content.');s.value=w.create(w.Class.UNIVERSAL,w.Type.IA5STRING,!1,s.comment)}else if(s.name==="subjectKeyIdentifier"&&e.cert){var f=e.cert.generateSubjectKeyIdentifier();s.subjectKeyIdentifier=f.toHex(),s.value=w.create(w.Class.UNIVERSAL,w.Type.OCTETSTRING,!1,f.getBytes())}else if(s.name==="authorityKeyIdentifier"&&e.cert){s.value=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]);var o=s.value.value;if(s.keyIdentifier){var g=s.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():s.keyIdentifier;o.push(w.create(w.Class.CONTEXT_SPECIFIC,0,!1,g))}if(s.authorityCertIssuer){var v=[w.create(w.Class.CONTEXT_SPECIFIC,4,!0,[tu(s.authorityCertIssuer===!0?e.cert.issuer:s.authorityCertIssuer)])];o.push(w.create(w.Class.CONTEXT_SPECIFIC,1,!0,v))}if(s.serialNumber){var p=Be.util.hexToBytes(s.serialNumber===!0?e.cert.serialNumber:s.serialNumber);o.push(w.create(w.Class.CONTEXT_SPECIFIC,2,!1,p))}}else if(s.name==="cRLDistributionPoints"){s.value=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]);for(var o=s.value.value,h=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]),d=w.create(w.Class.CONTEXT_SPECIFIC,0,!0,[]),u,c=0;c<s.altNames.length;++c){u=s.altNames[c];var i=u.value;if(u.type===7&&u.ip){if(i=Be.util.bytesFromIP(u.ip),i===null){var t=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw t.extension=s,t}}else u.type===8&&(u.oid?i=w.oidToDer(w.oidToDer(u.oid)):i=w.oidToDer(i));d.value.push(w.create(w.Class.CONTEXT_SPECIFIC,u.type,!1,i))}h.value.push(w.create(w.Class.CONTEXT_SPECIFIC,0,!0,[d])),o.push(h)}if(typeof s.value>"u"){var t=new Error("Extension value not specified.");throw t.extension=s,t}return s}function Yg(s,e){switch(s){case Ye["RSASSA-PSS"]:var t=[];return e.hash.algorithmOid!==void 0&&t.push(w.create(w.Class.CONTEXT_SPECIFIC,0,!0,[w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(e.hash.algorithmOid).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&t.push(w.create(w.Class.CONTEXT_SPECIFIC,1,!0,[w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(e.mgf.algorithmOid).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(e.mgf.hash.algorithmOid).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&t.push(w.create(w.Class.CONTEXT_SPECIFIC,2,!0,[w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,w.integerToDer(e.saltLength).getBytes())])),w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,t);default:return w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,"")}}function cC(s){var e=w.create(w.Class.CONTEXT_SPECIFIC,0,!0,[]);if(s.attributes.length===0)return e;for(var t=s.attributes,r=0;r<t.length;++r){var a=t[r],n=a.value,i=w.Type.UTF8;"valueTagClass"in a&&(i=a.valueTagClass),i===w.Type.UTF8&&(n=Be.util.encodeUtf8(n));var o=!1;"valueConstructed"in a&&(o=a.valueConstructed);var l=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(a.type).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.SET,!0,[w.create(w.Class.UNIVERSAL,i,o,n)])]);e.value.push(l)}return e}var fC=new Date("1950-01-01T00:00:00Z"),hC=new Date("2050-01-01T00:00:00Z");function Wm(s){return s>=fC&&s<hC?w.create(w.Class.UNIVERSAL,w.Type.UTCTIME,!1,w.dateToUtcTime(s)):w.create(w.Class.UNIVERSAL,w.Type.GENERALIZEDTIME,!1,w.dateToGeneralizedTime(s))}re.getTBSCertificate=function(s){var e=Wm(s.validity.notBefore),t=Wm(s.validity.notAfter),r=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.CONTEXT_SPECIFIC,0,!0,[w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,w.integerToDer(s.version).getBytes())]),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Be.util.hexToBytes(s.serialNumber)),w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(s.siginfo.algorithmOid).getBytes()),Yg(s.siginfo.algorithmOid,s.siginfo.parameters)]),tu(s.issuer),w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[e,t]),tu(s.subject),re.publicKeyToAsn1(s.publicKey)]);return s.issuer.uniqueId&&r.value.push(w.create(w.Class.CONTEXT_SPECIFIC,1,!0,[w.create(w.Class.UNIVERSAL,w.Type.BITSTRING,!1,String.fromCharCode(0)+s.issuer.uniqueId)])),s.subject.uniqueId&&r.value.push(w.create(w.Class.CONTEXT_SPECIFIC,2,!0,[w.create(w.Class.UNIVERSAL,w.Type.BITSTRING,!1,String.fromCharCode(0)+s.subject.uniqueId)])),s.extensions.length>0&&r.value.push(re.certificateExtensionsToAsn1(s.extensions)),r};re.getCertificationRequestInfo=function(s){var e=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,w.integerToDer(s.version).getBytes()),tu(s.subject),re.publicKeyToAsn1(s.publicKey),cC(s)]);return e};re.distinguishedNameToAsn1=function(s){return tu(s)};re.certificateToAsn1=function(s){var e=s.tbsCertificate||re.getTBSCertificate(s);return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[e,w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(s.signatureOid).getBytes()),Yg(s.signatureOid,s.signatureParameters)]),w.create(w.Class.UNIVERSAL,w.Type.BITSTRING,!1,String.fromCharCode(0)+s.signature)])};re.certificateExtensionsToAsn1=function(s){var e=w.create(w.Class.CONTEXT_SPECIFIC,3,!0,[]),t=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]);e.value.push(t);for(var r=0;r<s.length;++r)t.value.push(re.certificateExtensionToAsn1(s[r]));return e};re.certificateExtensionToAsn1=function(s){var e=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]);e.value.push(w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(s.id).getBytes())),s.critical&&e.value.push(w.create(w.Class.UNIVERSAL,w.Type.BOOLEAN,!1,String.fromCharCode(255)));var t=s.value;return typeof s.value!="string"&&(t=w.toDer(t).getBytes()),e.value.push(w.create(w.Class.UNIVERSAL,w.Type.OCTETSTRING,!1,t)),e};re.certificationRequestToAsn1=function(s){var e=s.certificationRequestInfo||re.getCertificationRequestInfo(s);return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[e,w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(s.signatureOid).getBytes()),Yg(s.signatureOid,s.signatureParameters)]),w.create(w.Class.UNIVERSAL,w.Type.BITSTRING,!1,String.fromCharCode(0)+s.signature)])};re.createCaStore=function(s){var e={certs:{}};e.getIssuer=function(i){var o=t(i.issuer);return o},e.addCertificate=function(i){if(typeof i=="string"&&(i=Be.pki.certificateFromPem(i)),r(i.subject),!e.hasCertificate(i))if(i.subject.hash in e.certs){var o=e.certs[i.subject.hash];Be.util.isArray(o)||(o=[o]),o.push(i),e.certs[i.subject.hash]=o}else e.certs[i.subject.hash]=i},e.hasCertificate=function(i){typeof i=="string"&&(i=Be.pki.certificateFromPem(i));var o=t(i.subject);if(!o)return!1;Be.util.isArray(o)||(o=[o]);for(var l=w.toDer(re.certificateToAsn1(i)).getBytes(),u=0;u<o.length;++u){var c=w.toDer(re.certificateToAsn1(o[u])).getBytes();if(l===c)return!0}return!1},e.listAllCertificates=function(){var i=[];for(var o in e.certs)if(e.certs.hasOwnProperty(o)){var l=e.certs[o];if(!Be.util.isArray(l))i.push(l);else for(var u=0;u<l.length;++u)i.push(l[u])}return i},e.removeCertificate=function(i){var o;if(typeof i=="string"&&(i=Be.pki.certificateFromPem(i)),r(i.subject),!e.hasCertificate(i))return null;var l=t(i.subject);if(!Be.util.isArray(l))return o=e.certs[i.subject.hash],delete e.certs[i.subject.hash],o;for(var u=w.toDer(re.certificateToAsn1(i)).getBytes(),c=0;c<l.length;++c){var f=w.toDer(re.certificateToAsn1(l[c])).getBytes();u===f&&(o=l[c],l.splice(c,1))}return l.length===0&&delete e.certs[i.subject.hash],o};function t(i){return r(i),e.certs[i.hash]||null}function r(i){if(!i.hash){var o=Be.md.sha1.create();i.attributes=re.RDNAttributesAsArray(tu(i),o),i.hash=o.digest().toHex()}}if(s)for(var a=0;a<s.length;++a){var n=s[a];e.addCertificate(n)}return e};re.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};re.verifyCertificateChain=function(s,e,t){typeof t=="function"&&(t={verify:t}),t=t||{},e=e.slice(0);var r=e.slice(0),a=t.validityCheckDate;typeof a>"u"&&(a=new Date);var n=!0,i=null,o=0;do{var l=e.shift(),u=null,c=!1;if(a&&(a<l.validity.notBefore||a>l.validity.notAfter)&&(i={message:"Certificate is not valid yet or has expired.",error:re.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:a}),i===null){if(u=e[0]||s.getIssuer(l),u===null&&l.isIssuer(l)&&(c=!0,u=l),u){var f=u;Be.util.isArray(f)||(f=[f]);for(var g=!1;!g&&f.length>0;){u=f.shift();try{g=u.verify(l)}catch{}}g||(i={message:"Certificate signature is invalid.",error:re.certificateError.bad_certificate})}i===null&&(!u||c)&&!s.hasCertificate(l)&&(i={message:"Certificate is not trusted.",error:re.certificateError.unknown_ca})}if(i===null&&u&&!l.isIssuer(u)&&(i={message:"Certificate issuer is invalid.",error:re.certificateError.bad_certificate}),i===null)for(var v={keyUsage:!0,basicConstraints:!0},p=0;i===null&&p<l.extensions.length;++p){var h=l.extensions[p];h.critical&&!(h.name in v)&&(i={message:"Certificate has an unsupported critical extension.",error:re.certificateError.unsupported_certificate})}if(i===null&&(!n||e.length===0&&(!u||c))){var d=l.getExtension("basicConstraints"),y=l.getExtension("keyUsage");if(y!==null&&(!y.keyCertSign||d===null)&&(i={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:re.certificateError.bad_certificate}),i===null&&d!==null&&!d.cA&&(i={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:re.certificateError.bad_certificate}),i===null&&y!==null&&"pathLenConstraint"in d){var E=o-1;E>d.pathLenConstraint&&(i={message:"Certificate basicConstraints pathLenConstraint violated.",error:re.certificateError.bad_certificate})}}var k=i===null?!0:i.error,R=t.verify?t.verify(k,o,r):k;if(R===!0)i=null;else throw k===!0&&(i={message:"The application rejected the certificate.",error:re.certificateError.bad_certificate}),(R||R===0)&&(typeof R=="object"&&!Be.util.isArray(R)?(R.message&&(i.message=R.message),R.error&&(i.error=R.error)):typeof R=="string"&&(i.error=R)),i;n=!1,++o}while(e.length>0);return!0};var dt=Fe,I=dt.asn1,Je=dt.pki,Of=dt.pkcs12=dt.pkcs12||{},Cy={name:"ContentInfo",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:I.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},dC={name:"PFX",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"version"},Cy,{name:"PFX.macData",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:I.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},gC={name:"SafeBag",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:I.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:I.Class.UNIVERSAL,type:I.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},mC={name:"Attribute",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:I.Class.UNIVERSAL,type:I.Type.SET,constructed:!0,capture:"values"}]},pC={name:"CertBag",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:I.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:I.Class.UNIVERSAL,type:I.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function yu(s,e,t,r){for(var a=[],n=0;n<s.length;n++)for(var i=0;i<s[n].safeBags.length;i++){var o=s[n].safeBags[i];if(!(r!==void 0&&o.type!==r)){if(e===null){a.push(o);continue}o.attributes[e]!==void 0&&o.attributes[e].indexOf(t)>=0&&a.push(o)}}return a}Of.pkcs12FromAsn1=function(s,e,t){typeof e=="string"?(t=e,e=!0):e===void 0&&(e=!0);var r={},a=[];if(!I.validate(s,dC,r,a)){var n=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw n.errors=n,n}var i={version:r.version.charCodeAt(0),safeContents:[],getBags:function(d){var y={},E;return"localKeyId"in d?E=d.localKeyId:"localKeyIdHex"in d&&(E=dt.util.hexToBytes(d.localKeyIdHex)),E===void 0&&!("friendlyName"in d)&&"bagType"in d&&(y[d.bagType]=yu(i.safeContents,null,null,d.bagType)),E!==void 0&&(y.localKeyId=yu(i.safeContents,"localKeyId",E,d.bagType)),"friendlyName"in d&&(y.friendlyName=yu(i.safeContents,"friendlyName",d.friendlyName,d.bagType)),y},getBagsByFriendlyName:function(d,y){return yu(i.safeContents,"friendlyName",d,y)},getBagsByLocalKeyId:function(d,y){return yu(i.safeContents,"localKeyId",d,y)}};if(r.version.charCodeAt(0)!==3){var n=new Error("PKCS#12 PFX of version other than 3 not supported.");throw n.version=r.version.charCodeAt(0),n}if(I.derToOid(r.contentType)!==Je.oids.data){var n=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw n.oid=I.derToOid(r.contentType),n}var o=r.content.value[0];if(o.tagClass!==I.Class.UNIVERSAL||o.type!==I.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(o=zg(o),r.mac){var l=null,u=0,c=I.derToOid(r.macAlgorithm);switch(c){case Je.oids.sha1:l=dt.md.sha1.create(),u=20;break;case Je.oids.sha256:l=dt.md.sha256.create(),u=32;break;case Je.oids.sha384:l=dt.md.sha384.create(),u=48;break;case Je.oids.sha512:l=dt.md.sha512.create(),u=64;break;case Je.oids.md5:l=dt.md.md5.create(),u=16;break}if(l===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+c);var f=new dt.util.ByteBuffer(r.macSalt),g="macIterations"in r?parseInt(dt.util.bytesToHex(r.macIterations),16):1,v=Of.generateKey(t,f,3,g,u,l),p=dt.hmac.create();p.start(l,v),p.update(o.value);var h=p.getMac();if(h.getBytes()!==r.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return yC(i,o.value,e,t),i};function zg(s){if(s.composed||s.constructed){for(var e=dt.util.createBuffer(),t=0;t<s.value.length;++t)e.putBytes(s.value[t].value);s.composed=s.constructed=!1,s.value=e.getBytes()}return s}function yC(s,e,t,r){if(e=I.fromDer(e,t),e.tagClass!==I.Class.UNIVERSAL||e.type!==I.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var a=0;a<e.value.length;a++){var n=e.value[a],i={},o=[];if(!I.validate(n,Cy,i,o)){var l=new Error("Cannot read ContentInfo.");throw l.errors=o,l}var u={encrypted:!1},c=null,f=i.content.value[0];switch(I.derToOid(i.contentType)){case Je.oids.data:if(f.tagClass!==I.Class.UNIVERSAL||f.type!==I.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");c=zg(f).value;break;case Je.oids.encryptedData:c=vC(f,r),u.encrypted=!0;break;default:var l=new Error("Unsupported PKCS#12 contentType.");throw l.contentType=I.derToOid(i.contentType),l}u.safeBags=wC(c,t,r),s.safeContents.push(u)}}function vC(s,e){var t={},r=[];if(!I.validate(s,dt.pkcs7.asn1.encryptedDataValidator,t,r)){var a=new Error("Cannot read EncryptedContentInfo.");throw a.errors=r,a}var n=I.derToOid(t.contentType);if(n!==Je.oids.data){var a=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw a.oid=n,a}n=I.derToOid(t.encAlgorithm);var i=Je.pbe.getCipher(n,t.encParameter,e),o=zg(t.encryptedContentAsn1),l=dt.util.createBuffer(o.value);if(i.update(l),!i.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return i.output.getBytes()}function wC(s,e,t){if(!e&&s.length===0)return[];if(s=I.fromDer(s,e),s.tagClass!==I.Class.UNIVERSAL||s.type!==I.Type.SEQUENCE||s.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var r=[],a=0;a<s.value.length;a++){var n=s.value[a],i={},o=[];if(!I.validate(n,gC,i,o)){var l=new Error("Cannot read SafeBag.");throw l.errors=o,l}var u={type:I.derToOid(i.bagId),attributes:SC(i.bagAttributes)};r.push(u);var c,f,g=i.bagValue.value[0];switch(u.type){case Je.oids.pkcs8ShroudedKeyBag:if(g=Je.decryptPrivateKeyInfo(g,t),g===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case Je.oids.keyBag:try{u.key=Je.privateKeyFromAsn1(g)}catch{u.key=null,u.asn1=g}continue;case Je.oids.certBag:c=pC,f=function(){if(I.derToOid(i.certId)!==Je.oids.x509Certificate){var p=new Error("Unsupported certificate type, only X.509 supported.");throw p.oid=I.derToOid(i.certId),p}var h=I.fromDer(i.cert,e);try{u.cert=Je.certificateFromAsn1(h,!0)}catch{u.cert=null,u.asn1=h}};break;default:var l=new Error("Unsupported PKCS#12 SafeBag type.");throw l.oid=u.type,l}if(c!==void 0&&!I.validate(g,c,i,o)){var l=new Error("Cannot read PKCS#12 "+c.name);throw l.errors=o,l}f()}return r}function SC(s){var e={};if(s!==void 0)for(var t=0;t<s.length;++t){var r={},a=[];if(!I.validate(s[t],mC,r,a)){var n=new Error("Cannot read PKCS#12 BagAttribute.");throw n.errors=a,n}var i=I.derToOid(r.oid);if(Je.oids[i]!==void 0){e[Je.oids[i]]=[];for(var o=0;o<r.values.length;++o)e[Je.oids[i]].push(r.values[o].value)}}return e}Of.toPkcs12Asn1=function(s,e,t,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||r.encAlgorithm||"aes128","useMac"in r||(r.useMac=!0),"localKeyId"in r||(r.localKeyId=null),"generateLocalKeyId"in r||(r.generateLocalKeyId=!0);var a=r.localKeyId,n;if(a!==null)a=dt.util.hexToBytes(a);else if(r.generateLocalKeyId)if(e){var i=dt.util.isArray(e)?e[0]:e;typeof i=="string"&&(i=Je.certificateFromPem(i));var o=dt.md.sha1.create();o.update(I.toDer(Je.certificateToAsn1(i)).getBytes()),a=o.digest().getBytes()}else a=dt.random.getBytes(20);var l=[];a!==null&&l.push(I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(Je.oids.localKeyId).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SET,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,a)])])),"friendlyName"in r&&l.push(I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(Je.oids.friendlyName).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SET,!0,[I.create(I.Class.UNIVERSAL,I.Type.BMPSTRING,!1,r.friendlyName)])])),l.length>0&&(n=I.create(I.Class.UNIVERSAL,I.Type.SET,!0,l));var u=[],c=[];e!==null&&(dt.util.isArray(e)?c=e:c=[e]);for(var f=[],g=0;g<c.length;++g){e=c[g],typeof e=="string"&&(e=Je.certificateFromPem(e));var v=g===0?n:void 0,p=Je.certificateToAsn1(e),h=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(Je.oids.certBag).getBytes()),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(Je.oids.x509Certificate).getBytes()),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,I.toDer(p).getBytes())])])]),v]);f.push(h)}if(f.length>0){var d=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,f),y=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(Je.oids.data).getBytes()),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,I.toDer(d).getBytes())])]);u.push(y)}var E=null;if(s!==null){var k=Je.wrapRsaPrivateKey(Je.privateKeyToAsn1(s));t===null?E=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(Je.oids.keyBag).getBytes()),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[k]),n]):E=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(Je.oids.pkcs8ShroudedKeyBag).getBytes()),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[Je.encryptPrivateKeyInfo(k,t,r)]),n]);var R=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[E]),V=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(Je.oids.data).getBytes()),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,I.toDer(R).getBytes())])]);u.push(V)}var L=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,u),ne;if(r.useMac){var o=dt.md.sha1.create(),se=new dt.util.ByteBuffer(dt.random.getBytes(r.saltSize)),Se=r.count,s=Of.generateKey(t,se,3,Se,20),Te=dt.hmac.create();Te.start(o,s),Te.update(I.toDer(L).getBytes());var ye=Te.getMac();ne=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(Je.oids.sha1).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")]),I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,ye.getBytes())]),I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,se.getBytes()),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(Se).getBytes())])}return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(3).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(Je.oids.data).getBytes()),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,I.toDer(L).getBytes())])]),ne])};Of.generateKey=dt.pbe.generatePkcs12Key;var kn=Fe,Xg=kn.asn1,ru=kn.pki=kn.pki||{};ru.pemToDer=function(s){var e=kn.pem.decode(s)[0];if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return kn.util.createBuffer(e.body)};ru.privateKeyFromPem=function(s){var e=kn.pem.decode(s)[0];if(e.type!=="PRIVATE KEY"&&e.type!=="RSA PRIVATE KEY"){var t=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var r=Xg.fromDer(e.body);return ru.privateKeyFromAsn1(r)};ru.privateKeyToPem=function(s,e){var t={type:"RSA PRIVATE KEY",body:Xg.toDer(ru.privateKeyToAsn1(s)).getBytes()};return kn.pem.encode(t,{maxline:e})};ru.privateKeyInfoToPem=function(s,e){var t={type:"PRIVATE KEY",body:Xg.toDer(s).getBytes()};return kn.pem.encode(t,{maxline:e})};var Q=Fe,sd=function(s,e,t,r){var a=Q.util.createBuffer(),n=s.length>>1,i=n+(s.length&1),o=s.substr(0,i),l=s.substr(n,i),u=Q.util.createBuffer(),c=Q.hmac.create();t=e+t;var f=Math.ceil(r/16),g=Math.ceil(r/20);c.start("MD5",o);var v=Q.util.createBuffer();u.putBytes(t);for(var p=0;p<f;++p)c.start(null,null),c.update(u.getBytes()),u.putBuffer(c.digest()),c.start(null,null),c.update(u.bytes()+t),v.putBuffer(c.digest());c.start("SHA1",l);var h=Q.util.createBuffer();u.clear(),u.putBytes(t);for(var p=0;p<g;++p)c.start(null,null),c.update(u.getBytes()),u.putBuffer(c.digest()),c.start(null,null),c.update(u.bytes()+t),h.putBuffer(c.digest());return a.putBytes(Q.util.xorBytes(v.getBytes(),h.getBytes(),r)),a},CC=function(s,e,t){var r=Q.hmac.create();r.start("SHA1",s);var a=Q.util.createBuffer();return a.putInt32(e[0]),a.putInt32(e[1]),a.putByte(t.type),a.putByte(t.version.major),a.putByte(t.version.minor),a.putInt16(t.length),a.putBytes(t.fragment.bytes()),r.update(a.getBytes()),r.digest().getBytes()},AC=function(s,e,t){var r=!1;try{var a=s.deflate(e.fragment.getBytes());e.fragment=Q.util.createBuffer(a),e.length=a.length,r=!0}catch{}return r},EC=function(s,e,t){var r=!1;try{var a=s.inflate(e.fragment.getBytes());e.fragment=Q.util.createBuffer(a),e.length=a.length,r=!0}catch{}return r},Vr=function(s,e){var t=0;switch(e){case 1:t=s.getByte();break;case 2:t=s.getInt16();break;case 3:t=s.getInt24();break;case 4:t=s.getInt32();break}return Q.util.createBuffer(s.getBytes(t))},Fr=function(s,e,t){s.putInt(t.length(),e<<3),s.putBuffer(t)},A={};A.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};A.SupportedVersions=[A.Versions.TLS_1_1,A.Versions.TLS_1_0];A.Version=A.SupportedVersions[0];A.MaxFragment=16384-1024;A.ConnectionEnd={server:0,client:1};A.PRFAlgorithm={tls_prf_sha256:0};A.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};A.CipherType={stream:0,block:1,aead:2};A.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};A.CompressionMethod={none:0,deflate:1};A.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};A.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};A.Alert={};A.Alert.Level={warning:1,fatal:2};A.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};A.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};A.CipherSuites={};A.getCipherSuite=function(s){var e=null;for(var t in A.CipherSuites){var r=A.CipherSuites[t];if(r.id[0]===s.charCodeAt(0)&&r.id[1]===s.charCodeAt(1)){e=r;break}}return e};A.handleUnexpected=function(s,e){var t=!s.open&&s.entity===A.ConnectionEnd.client;t||s.error(s,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.unexpected_message}})};A.handleHelloRequest=function(s,e,t){!s.handshaking&&s.handshakes>0&&(A.queue(s,A.createAlert(s,{level:A.Alert.Level.warning,description:A.Alert.Description.no_renegotiation})),A.flush(s)),s.process()};A.parseHelloMessage=function(s,e,t){var r=null,a=s.entity===A.ConnectionEnd.client;if(t<38)s.error(s,{message:a?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.illegal_parameter}});else{var n=e.fragment,i=n.length();if(r={version:{major:n.getByte(),minor:n.getByte()},random:Q.util.createBuffer(n.getBytes(32)),session_id:Vr(n,1),extensions:[]},a?(r.cipher_suite=n.getBytes(2),r.compression_method=n.getByte()):(r.cipher_suites=Vr(n,2),r.compression_methods=Vr(n,1)),i=t-(i-n.length()),i>0){for(var o=Vr(n,2);o.length()>0;)r.extensions.push({type:[o.getByte(),o.getByte()],data:Vr(o,2)});if(!a)for(var l=0;l<r.extensions.length;++l){var u=r.extensions[l];if(u.type[0]===0&&u.type[1]===0)for(var c=Vr(u.data,2);c.length()>0;){var f=c.getByte();if(f!==0)break;s.session.extensions.server_name.serverNameList.push(Vr(c,2).getBytes())}}}if(s.session.version&&(r.version.major!==s.session.version.major||r.version.minor!==s.session.version.minor))return s.error(s,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.protocol_version}});if(a)s.session.cipherSuite=A.getCipherSuite(r.cipher_suite);else for(var g=Q.util.createBuffer(r.cipher_suites.bytes());g.length()>0&&(s.session.cipherSuite=A.getCipherSuite(g.getBytes(2)),s.session.cipherSuite===null););if(s.session.cipherSuite===null)return s.error(s,{message:"No cipher suites in common.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.handshake_failure},cipherSuite:Q.util.bytesToHex(r.cipher_suite)});a?s.session.compressionMethod=r.compression_method:s.session.compressionMethod=A.CompressionMethod.none}return r};A.createSecurityParameters=function(s,e){var t=s.entity===A.ConnectionEnd.client,r=e.random.bytes(),a=t?s.session.sp.client_random:r,n=t?r:A.createRandom().getBytes();s.session.sp={entity:s.entity,prf_algorithm:A.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:s.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:a,server_random:n}};A.handleServerHello=function(s,e,t){var r=A.parseHelloMessage(s,e,t);if(!s.fail){if(r.version.minor<=s.version.minor)s.version.minor=r.version.minor;else return s.error(s,{message:"Incompatible TLS version.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.protocol_version}});s.session.version=s.version;var a=r.session_id.bytes();a.length>0&&a===s.session.id?(s.expect=Ay,s.session.resuming=!0,s.session.sp.server_random=r.random.bytes()):(s.expect=kC,s.session.resuming=!1,A.createSecurityParameters(s,r)),s.session.id=a,s.process()}};A.handleClientHello=function(s,e,t){var r=A.parseHelloMessage(s,e,t);if(!s.fail){var a=r.session_id.bytes(),n=null;if(s.sessionCache&&(n=s.sessionCache.getSession(a),n===null?a="":(n.version.major!==r.version.major||n.version.minor>r.version.minor)&&(n=null,a="")),a.length===0&&(a=Q.random.getBytes(32)),s.session.id=a,s.session.clientHelloVersion=r.version,s.session.sp={},n)s.version=s.session.version=n.version,s.session.sp=n.sp;else{for(var i,o=1;o<A.SupportedVersions.length&&(i=A.SupportedVersions[o],!(i.minor<=r.version.minor));++o);s.version={major:i.major,minor:i.minor},s.session.version=s.version}n!==null?(s.expect=Zg,s.session.resuming=!0,s.session.sp.client_random=r.random.bytes()):(s.expect=s.verifyClient!==!1?VC:ag,s.session.resuming=!1,A.createSecurityParameters(s,r)),s.open=!0,A.queue(s,A.createRecord(s,{type:A.ContentType.handshake,data:A.createServerHello(s)})),s.session.resuming?(A.queue(s,A.createRecord(s,{type:A.ContentType.change_cipher_spec,data:A.createChangeCipherSpec()})),s.state.pending=A.createConnectionState(s),s.state.current.write=s.state.pending.write,A.queue(s,A.createRecord(s,{type:A.ContentType.handshake,data:A.createFinished(s)}))):(A.queue(s,A.createRecord(s,{type:A.ContentType.handshake,data:A.createCertificate(s)})),s.fail||(A.queue(s,A.createRecord(s,{type:A.ContentType.handshake,data:A.createServerKeyExchange(s)})),s.verifyClient!==!1&&A.queue(s,A.createRecord(s,{type:A.ContentType.handshake,data:A.createCertificateRequest(s)})),A.queue(s,A.createRecord(s,{type:A.ContentType.handshake,data:A.createServerHelloDone(s)})))),A.flush(s),s.process()}};A.handleCertificate=function(s,e,t){if(t<3)return s.error(s,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.illegal_parameter}});var r=e.fragment,a={certificate_list:Vr(r,3)},n,i,o=[];try{for(;a.certificate_list.length()>0;)n=Vr(a.certificate_list,3),i=Q.asn1.fromDer(n),n=Q.pki.certificateFromAsn1(i,!0),o.push(n)}catch(u){return s.error(s,{message:"Could not parse certificate list.",cause:u,send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.bad_certificate}})}var l=s.entity===A.ConnectionEnd.client;(l||s.verifyClient===!0)&&o.length===0?s.error(s,{message:l?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.illegal_parameter}}):o.length===0?s.expect=l?Qm:ag:(l?s.session.serverCertificate=o[0]:s.session.clientCertificate=o[0],A.verifyCertificateChain(s,o)&&(s.expect=l?Qm:ag)),s.process()};A.handleServerKeyExchange=function(s,e,t){if(t>0)return s.error(s,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.unsupported_certificate}});s.expect=IC,s.process()};A.handleClientKeyExchange=function(s,e,t){if(t<48)return s.error(s,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.unsupported_certificate}});var r=e.fragment,a={enc_pre_master_secret:Vr(r,2).getBytes()},n=null;if(s.getPrivateKey)try{n=s.getPrivateKey(s,s.session.serverCertificate),n=Q.pki.privateKeyFromPem(n)}catch(l){s.error(s,{message:"Could not get private key.",cause:l,send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.internal_error}})}if(n===null)return s.error(s,{message:"No private key set.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.internal_error}});try{var i=s.session.sp;i.pre_master_secret=n.decrypt(a.enc_pre_master_secret);var o=s.session.clientHelloVersion;if(o.major!==i.pre_master_secret.charCodeAt(0)||o.minor!==i.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{i.pre_master_secret=Q.random.getBytes(48)}s.expect=Zg,s.session.clientCertificate!==null&&(s.expect=_C),s.process()};A.handleCertificateRequest=function(s,e,t){if(t<3)return s.error(s,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.illegal_parameter}});var r=e.fragment,a={certificate_types:Vr(r,1),certificate_authorities:Vr(r,2)};s.session.certificateRequest=a,s.expect=BC,s.process()};A.handleCertificateVerify=function(s,e,t){if(t<2)return s.error(s,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.illegal_parameter}});var r=e.fragment;r.read-=4;var a=r.bytes();r.read+=4;var n={signature:Vr(r,2).getBytes()},i=Q.util.createBuffer();i.putBuffer(s.session.md5.digest()),i.putBuffer(s.session.sha1.digest()),i=i.getBytes();try{var o=s.session.clientCertificate;if(!o.publicKey.verify(i,n.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");s.session.md5.update(a),s.session.sha1.update(a)}catch{return s.error(s,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.handshake_failure}})}s.expect=Zg,s.process()};A.handleServerHelloDone=function(s,e,t){if(t>0)return s.error(s,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.record_overflow}});if(s.serverCertificate===null){var r={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.insufficient_security}},a=0,n=s.verify(s,r.alert.description,a,[]);if(n!==!0)return(n||n===0)&&(typeof n=="object"&&!Q.util.isArray(n)?(n.message&&(r.message=n.message),n.alert&&(r.alert.description=n.alert)):typeof n=="number"&&(r.alert.description=n)),s.error(s,r)}s.session.certificateRequest!==null&&(e=A.createRecord(s,{type:A.ContentType.handshake,data:A.createCertificate(s)}),A.queue(s,e)),e=A.createRecord(s,{type:A.ContentType.handshake,data:A.createClientKeyExchange(s)}),A.queue(s,e),s.expect=TC;var i=function(o,l){o.session.certificateRequest!==null&&o.session.clientCertificate!==null&&A.queue(o,A.createRecord(o,{type:A.ContentType.handshake,data:A.createCertificateVerify(o,l)})),A.queue(o,A.createRecord(o,{type:A.ContentType.change_cipher_spec,data:A.createChangeCipherSpec()})),o.state.pending=A.createConnectionState(o),o.state.current.write=o.state.pending.write,A.queue(o,A.createRecord(o,{type:A.ContentType.handshake,data:A.createFinished(o)})),o.expect=Ay,A.flush(o),o.process()};if(s.session.certificateRequest===null||s.session.clientCertificate===null)return i(s,null);A.getClientSignature(s,i)};A.handleChangeCipherSpec=function(s,e){if(e.fragment.getByte()!==1)return s.error(s,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.illegal_parameter}});var t=s.entity===A.ConnectionEnd.client;(s.session.resuming&&t||!s.session.resuming&&!t)&&(s.state.pending=A.createConnectionState(s)),s.state.current.read=s.state.pending.read,(!s.session.resuming&&t||s.session.resuming&&!t)&&(s.state.pending=null),s.expect=t?xC:$C,s.process()};A.handleFinished=function(s,e,t){var r=e.fragment;r.read-=4;var a=r.bytes();r.read+=4;var n=e.fragment.getBytes();r=Q.util.createBuffer(),r.putBuffer(s.session.md5.digest()),r.putBuffer(s.session.sha1.digest());var i=s.entity===A.ConnectionEnd.client,o=i?"server finished":"client finished",l=s.session.sp,u=12,c=sd;if(r=c(l.master_secret,o,r.getBytes(),u),r.getBytes()!==n)return s.error(s,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.decrypt_error}});s.session.md5.update(a),s.session.sha1.update(a),(s.session.resuming&&i||!s.session.resuming&&!i)&&(A.queue(s,A.createRecord(s,{type:A.ContentType.change_cipher_spec,data:A.createChangeCipherSpec()})),s.state.current.write=s.state.pending.write,s.state.pending=null,A.queue(s,A.createRecord(s,{type:A.ContentType.handshake,data:A.createFinished(s)}))),s.expect=i?NC:DC,s.handshaking=!1,++s.handshakes,s.peerCertificate=i?s.session.serverCertificate:s.session.clientCertificate,A.flush(s),s.isConnected=!0,s.connected(s),s.process()};A.handleAlert=function(s,e){var t=e.fragment,r={level:t.getByte(),description:t.getByte()},a;switch(r.description){case A.Alert.Description.close_notify:a="Connection closed.";break;case A.Alert.Description.unexpected_message:a="Unexpected message.";break;case A.Alert.Description.bad_record_mac:a="Bad record MAC.";break;case A.Alert.Description.decryption_failed:a="Decryption failed.";break;case A.Alert.Description.record_overflow:a="Record overflow.";break;case A.Alert.Description.decompression_failure:a="Decompression failed.";break;case A.Alert.Description.handshake_failure:a="Handshake failure.";break;case A.Alert.Description.bad_certificate:a="Bad certificate.";break;case A.Alert.Description.unsupported_certificate:a="Unsupported certificate.";break;case A.Alert.Description.certificate_revoked:a="Certificate revoked.";break;case A.Alert.Description.certificate_expired:a="Certificate expired.";break;case A.Alert.Description.certificate_unknown:a="Certificate unknown.";break;case A.Alert.Description.illegal_parameter:a="Illegal parameter.";break;case A.Alert.Description.unknown_ca:a="Unknown certificate authority.";break;case A.Alert.Description.access_denied:a="Access denied.";break;case A.Alert.Description.decode_error:a="Decode error.";break;case A.Alert.Description.decrypt_error:a="Decrypt error.";break;case A.Alert.Description.export_restriction:a="Export restriction.";break;case A.Alert.Description.protocol_version:a="Unsupported protocol version.";break;case A.Alert.Description.insufficient_security:a="Insufficient security.";break;case A.Alert.Description.internal_error:a="Internal error.";break;case A.Alert.Description.user_canceled:a="User canceled.";break;case A.Alert.Description.no_renegotiation:a="Renegotiation not supported.";break;default:a="Unknown error.";break}if(r.description===A.Alert.Description.close_notify)return s.close();s.error(s,{message:a,send:!1,origin:s.entity===A.ConnectionEnd.client?"server":"client",alert:r}),s.process()};A.handleHandshake=function(s,e){var t=e.fragment,r=t.getByte(),a=t.getInt24();if(a>t.length())return s.fragmented=e,e.fragment=Q.util.createBuffer(),t.read-=4,s.process();s.fragmented=null,t.read-=4;var n=t.bytes(a+4);t.read+=4,r in A0[s.entity][s.expect]?(s.entity===A.ConnectionEnd.server&&!s.open&&!s.fail&&(s.handshaking=!0,s.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:Q.md.md5.create(),sha1:Q.md.sha1.create()}),r!==A.HandshakeType.hello_request&&r!==A.HandshakeType.certificate_verify&&r!==A.HandshakeType.finished&&(s.session.md5.update(n),s.session.sha1.update(n)),A0[s.entity][s.expect][r](s,e,a)):A.handleUnexpected(s,e)};A.handleApplicationData=function(s,e){s.data.putBuffer(e.fragment),s.dataReady(s),s.process()};A.handleHeartbeat=function(s,e){var t=e.fragment,r=t.getByte(),a=t.getInt16(),n=t.getBytes(a);if(r===A.HeartbeatMessageType.heartbeat_request){if(s.handshaking||a>n.length)return s.process();A.queue(s,A.createRecord(s,{type:A.ContentType.heartbeat,data:A.createHeartbeat(A.HeartbeatMessageType.heartbeat_response,n)})),A.flush(s)}else if(r===A.HeartbeatMessageType.heartbeat_response){if(n!==s.expectedHeartbeatPayload)return s.process();s.heartbeatReceived&&s.heartbeatReceived(s,Q.util.createBuffer(n))}s.process()};var bC=0,kC=1,Qm=2,IC=3,BC=4,Ay=5,xC=6,NC=7,TC=8,RC=0,VC=1,ag=2,_C=3,Zg=4,$C=5,DC=6,C=A.handleUnexpected,Ey=A.handleChangeCipherSpec,tr=A.handleAlert,gr=A.handleHandshake,by=A.handleApplicationData,rr=A.handleHeartbeat,em=[];em[A.ConnectionEnd.client]=[[C,tr,gr,C,rr],[C,tr,gr,C,rr],[C,tr,gr,C,rr],[C,tr,gr,C,rr],[C,tr,gr,C,rr],[Ey,tr,C,C,rr],[C,tr,gr,C,rr],[C,tr,gr,by,rr],[C,tr,gr,C,rr]];em[A.ConnectionEnd.server]=[[C,tr,gr,C,rr],[C,tr,gr,C,rr],[C,tr,gr,C,rr],[C,tr,gr,C,rr],[Ey,tr,C,C,rr],[C,tr,gr,C,rr],[C,tr,gr,by,rr],[C,tr,gr,C,rr]];var ma=A.handleHelloRequest,LC=A.handleServerHello,ky=A.handleCertificate,Ym=A.handleServerKeyExchange,dd=A.handleCertificateRequest,ih=A.handleServerHelloDone,Iy=A.handleFinished,A0=[];A0[A.ConnectionEnd.client]=[[C,C,LC,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[ma,C,C,C,C,C,C,C,C,C,C,ky,Ym,dd,ih,C,C,C,C,C,C],[ma,C,C,C,C,C,C,C,C,C,C,C,Ym,dd,ih,C,C,C,C,C,C],[ma,C,C,C,C,C,C,C,C,C,C,C,C,dd,ih,C,C,C,C,C,C],[ma,C,C,C,C,C,C,C,C,C,C,C,C,C,ih,C,C,C,C,C,C],[ma,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[ma,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,Iy],[ma,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[ma,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]];var OC=A.handleClientHello,PC=A.handleClientKeyExchange,UC=A.handleCertificateVerify;A0[A.ConnectionEnd.server]=[[C,OC,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,ky,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,PC,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,UC,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,Iy],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]];A.generateKeys=function(s,e){var t=sd,r=e.client_random+e.server_random;s.session.resuming||(e.master_secret=t(e.pre_master_secret,"master secret",r,48).bytes(),e.pre_master_secret=null),r=e.server_random+e.client_random;var a=2*e.mac_key_length+2*e.enc_key_length,n=s.version.major===A.Versions.TLS_1_0.major&&s.version.minor===A.Versions.TLS_1_0.minor;n&&(a+=2*e.fixed_iv_length);var i=t(e.master_secret,"key expansion",r,a),o={client_write_MAC_key:i.getBytes(e.mac_key_length),server_write_MAC_key:i.getBytes(e.mac_key_length),client_write_key:i.getBytes(e.enc_key_length),server_write_key:i.getBytes(e.enc_key_length)};return n&&(o.client_write_IV=i.getBytes(e.fixed_iv_length),o.server_write_IV=i.getBytes(e.fixed_iv_length)),o};A.createConnectionState=function(s){var e=s.entity===A.ConnectionEnd.client,t=function(){var n={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(i){return!0},compressionState:null,compressFunction:function(i){return!0},updateSequenceNumber:function(){n.sequenceNumber[1]===4294967295?(n.sequenceNumber[1]=0,++n.sequenceNumber[0]):++n.sequenceNumber[1]}};return n},r={read:t(),write:t()};if(r.read.update=function(n,i){return r.read.cipherFunction(i,r.read)?r.read.compressFunction(n,i,r.read)||n.error(n,{message:"Could not decompress record.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.decompression_failure}}):n.error(n,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.bad_record_mac}}),!n.fail},r.write.update=function(n,i){return r.write.compressFunction(n,i,r.write)?r.write.cipherFunction(i,r.write)||n.error(n,{message:"Could not encrypt record.",send:!1,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.internal_error}}):n.error(n,{message:"Could not compress record.",send:!1,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.internal_error}}),!n.fail},s.session){var a=s.session.sp;switch(s.session.cipherSuite.initSecurityParameters(a),a.keys=A.generateKeys(s,a),r.read.macKey=e?a.keys.server_write_MAC_key:a.keys.client_write_MAC_key,r.write.macKey=e?a.keys.client_write_MAC_key:a.keys.server_write_MAC_key,s.session.cipherSuite.initConnectionState(r,s,a),a.compression_algorithm){case A.CompressionMethod.none:break;case A.CompressionMethod.deflate:r.read.compressFunction=EC,r.write.compressFunction=AC;break;default:throw new Error("Unsupported compression algorithm.")}}return r};A.createRandom=function(){var s=new Date,e=+s+s.getTimezoneOffset()*6e4,t=Q.util.createBuffer();return t.putInt32(e),t.putBytes(Q.random.getBytes(28)),t};A.createRecord=function(s,e){if(!e.data)return null;var t={type:e.type,version:{major:s.version.major,minor:s.version.minor},length:e.data.length(),fragment:e.data};return t};A.createAlert=function(s,e){var t=Q.util.createBuffer();return t.putByte(e.level),t.putByte(e.description),A.createRecord(s,{type:A.ContentType.alert,data:t})};A.createClientHello=function(s){s.session.clientHelloVersion={major:s.version.major,minor:s.version.minor};for(var e=Q.util.createBuffer(),t=0;t<s.cipherSuites.length;++t){var r=s.cipherSuites[t];e.putByte(r.id[0]),e.putByte(r.id[1])}var a=e.length(),n=Q.util.createBuffer();n.putByte(A.CompressionMethod.none);var i=n.length(),o=Q.util.createBuffer();if(s.virtualHost){var l=Q.util.createBuffer();l.putByte(0),l.putByte(0);var u=Q.util.createBuffer();u.putByte(0),Fr(u,2,Q.util.createBuffer(s.virtualHost));var c=Q.util.createBuffer();Fr(c,2,u),Fr(l,2,c),o.putBuffer(l)}var f=o.length();f>0&&(f+=2);var g=s.session.id,v=g.length+1+2+4+28+2+a+1+i+f,p=Q.util.createBuffer();return p.putByte(A.HandshakeType.client_hello),p.putInt24(v),p.putByte(s.version.major),p.putByte(s.version.minor),p.putBytes(s.session.sp.client_random),Fr(p,1,Q.util.createBuffer(g)),Fr(p,2,e),Fr(p,1,n),f>0&&Fr(p,2,o),p};A.createServerHello=function(s){var e=s.session.id,t=e.length+1+2+4+28+2+1,r=Q.util.createBuffer();return r.putByte(A.HandshakeType.server_hello),r.putInt24(t),r.putByte(s.version.major),r.putByte(s.version.minor),r.putBytes(s.session.sp.server_random),Fr(r,1,Q.util.createBuffer(e)),r.putByte(s.session.cipherSuite.id[0]),r.putByte(s.session.cipherSuite.id[1]),r.putByte(s.session.compressionMethod),r};A.createCertificate=function(s){var e=s.entity===A.ConnectionEnd.client,t=null;if(s.getCertificate){var r;e?r=s.session.certificateRequest:r=s.session.extensions.server_name.serverNameList,t=s.getCertificate(s,r)}var a=Q.util.createBuffer();if(t!==null)try{Q.util.isArray(t)||(t=[t]);for(var n=null,i=0;i<t.length;++i){var o=Q.pem.decode(t[i])[0];if(o.type!=="CERTIFICATE"&&o.type!=="X509 CERTIFICATE"&&o.type!=="TRUSTED CERTIFICATE"){var l=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw l.headerType=o.type,l}if(o.procType&&o.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var u=Q.util.createBuffer(o.body);n===null&&(n=Q.asn1.fromDer(u.bytes(),!1));var c=Q.util.createBuffer();Fr(c,3,u),a.putBuffer(c)}t=Q.pki.certificateFromAsn1(n),e?s.session.clientCertificate=t:s.session.serverCertificate=t}catch(v){return s.error(s,{message:"Could not send certificate list.",cause:v,send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.bad_certificate}})}var f=3+a.length(),g=Q.util.createBuffer();return g.putByte(A.HandshakeType.certificate),g.putInt24(f),Fr(g,3,a),g};A.createClientKeyExchange=function(s){var e=Q.util.createBuffer();e.putByte(s.session.clientHelloVersion.major),e.putByte(s.session.clientHelloVersion.minor),e.putBytes(Q.random.getBytes(46));var t=s.session.sp;t.pre_master_secret=e.getBytes();var r=s.session.serverCertificate.publicKey;e=r.encrypt(t.pre_master_secret);var a=e.length+2,n=Q.util.createBuffer();return n.putByte(A.HandshakeType.client_key_exchange),n.putInt24(a),n.putInt16(e.length),n.putBytes(e),n};A.createServerKeyExchange=function(s){var e=Q.util.createBuffer();return e};A.getClientSignature=function(s,e){var t=Q.util.createBuffer();t.putBuffer(s.session.md5.digest()),t.putBuffer(s.session.sha1.digest()),t=t.getBytes(),s.getSignature=s.getSignature||function(r,a,n){var i=null;if(r.getPrivateKey)try{i=r.getPrivateKey(r,r.session.clientCertificate),i=Q.pki.privateKeyFromPem(i)}catch(o){r.error(r,{message:"Could not get private key.",cause:o,send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.internal_error}})}i===null?r.error(r,{message:"No private key set.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.internal_error}}):a=i.sign(a,null),n(r,a)},s.getSignature(s,t,e)};A.createCertificateVerify=function(s,e){var t=e.length+2,r=Q.util.createBuffer();return r.putByte(A.HandshakeType.certificate_verify),r.putInt24(t),r.putInt16(e.length),r.putBytes(e),r};A.createCertificateRequest=function(s){var e=Q.util.createBuffer();e.putByte(1);var t=Q.util.createBuffer();for(var r in s.caStore.certs){var a=s.caStore.certs[r],n=Q.pki.distinguishedNameToAsn1(a.subject),i=Q.asn1.toDer(n);t.putInt16(i.length()),t.putBuffer(i)}var o=1+e.length()+2+t.length(),l=Q.util.createBuffer();return l.putByte(A.HandshakeType.certificate_request),l.putInt24(o),Fr(l,1,e),Fr(l,2,t),l};A.createServerHelloDone=function(s){var e=Q.util.createBuffer();return e.putByte(A.HandshakeType.server_hello_done),e.putInt24(0),e};A.createChangeCipherSpec=function(){var s=Q.util.createBuffer();return s.putByte(1),s};A.createFinished=function(s){var e=Q.util.createBuffer();e.putBuffer(s.session.md5.digest()),e.putBuffer(s.session.sha1.digest());var t=s.entity===A.ConnectionEnd.client,r=s.session.sp,a=12,n=sd,i=t?"client finished":"server finished";e=n(r.master_secret,i,e.getBytes(),a);var o=Q.util.createBuffer();return o.putByte(A.HandshakeType.finished),o.putInt24(e.length()),o.putBuffer(e),o};A.createHeartbeat=function(s,e,t){typeof t>"u"&&(t=e.length);var r=Q.util.createBuffer();r.putByte(s),r.putInt16(t),r.putBytes(e);var a=r.length(),n=Math.max(16,a-t-3);return r.putBytes(Q.random.getBytes(n)),r};A.queue=function(s,e){if(!!e&&!(e.fragment.length()===0&&(e.type===A.ContentType.handshake||e.type===A.ContentType.alert||e.type===A.ContentType.change_cipher_spec))){if(e.type===A.ContentType.handshake){var t=e.fragment.bytes();s.session.md5.update(t),s.session.sha1.update(t),t=null}var r;if(e.fragment.length()<=A.MaxFragment)r=[e];else{r=[];for(var a=e.fragment.bytes();a.length>A.MaxFragment;)r.push(A.createRecord(s,{type:e.type,data:Q.util.createBuffer(a.slice(0,A.MaxFragment))})),a=a.slice(A.MaxFragment);a.length>0&&r.push(A.createRecord(s,{type:e.type,data:Q.util.createBuffer(a)}))}for(var n=0;n<r.length&&!s.fail;++n){var i=r[n],o=s.state.current.write;o.update(s,i)&&s.records.push(i)}}};A.flush=function(s){for(var e=0;e<s.records.length;++e){var t=s.records[e];s.tlsData.putByte(t.type),s.tlsData.putByte(t.version.major),s.tlsData.putByte(t.version.minor),s.tlsData.putInt16(t.fragment.length()),s.tlsData.putBuffer(s.records[e].fragment)}return s.records=[],s.tlsDataReady(s)};var gd=function(s){switch(s){case!0:return!0;case Q.pki.certificateError.bad_certificate:return A.Alert.Description.bad_certificate;case Q.pki.certificateError.unsupported_certificate:return A.Alert.Description.unsupported_certificate;case Q.pki.certificateError.certificate_revoked:return A.Alert.Description.certificate_revoked;case Q.pki.certificateError.certificate_expired:return A.Alert.Description.certificate_expired;case Q.pki.certificateError.certificate_unknown:return A.Alert.Description.certificate_unknown;case Q.pki.certificateError.unknown_ca:return A.Alert.Description.unknown_ca;default:return A.Alert.Description.bad_certificate}},KC=function(s){switch(s){case!0:return!0;case A.Alert.Description.bad_certificate:return Q.pki.certificateError.bad_certificate;case A.Alert.Description.unsupported_certificate:return Q.pki.certificateError.unsupported_certificate;case A.Alert.Description.certificate_revoked:return Q.pki.certificateError.certificate_revoked;case A.Alert.Description.certificate_expired:return Q.pki.certificateError.certificate_expired;case A.Alert.Description.certificate_unknown:return Q.pki.certificateError.certificate_unknown;case A.Alert.Description.unknown_ca:return Q.pki.certificateError.unknown_ca;default:return Q.pki.certificateError.bad_certificate}};A.verifyCertificateChain=function(s,e){try{var t={};for(var r in s.verifyOptions)t[r]=s.verifyOptions[r];t.verify=function(n,i,o){var l=gd(n),u=s.verify(s,n,i,o);if(u!==!0){if(typeof u=="object"&&!Q.util.isArray(u)){var c=new Error("The application rejected the certificate.");throw c.send=!0,c.alert={level:A.Alert.Level.fatal,description:A.Alert.Description.bad_certificate},u.message&&(c.message=u.message),u.alert&&(c.alert.description=u.alert),c}u!==n&&(u=KC(u))}return u},Q.pki.verifyCertificateChain(s.caStore,e,t)}catch(n){var a=n;(typeof a!="object"||Q.util.isArray(a))&&(a={send:!0,alert:{level:A.Alert.Level.fatal,description:gd(n)}}),"send"in a||(a.send=!0),"alert"in a||(a.alert={level:A.Alert.Level.fatal,description:gd(a.error)}),s.error(s,a)}return!s.fail};A.createSessionCache=function(s,e){var t=null;if(s&&s.getSession&&s.setSession&&s.order)t=s;else{t={},t.cache=s||{},t.capacity=Math.max(e||100,1),t.order=[];for(var r in s)t.order.length<=e?t.order.push(r):delete s[r];t.getSession=function(a){var n=null,i=null;if(a?i=Q.util.bytesToHex(a):t.order.length>0&&(i=t.order[0]),i!==null&&i in t.cache){n=t.cache[i],delete t.cache[i];for(var o in t.order)if(t.order[o]===i){t.order.splice(o,1);break}}return n},t.setSession=function(a,n){if(t.order.length===t.capacity){var i=t.order.shift();delete t.cache[i]}var i=Q.util.bytesToHex(a);t.order.push(i),t.cache[i]=n}}return t};A.createConnection=function(s){var e=null;s.caStore?Q.util.isArray(s.caStore)?e=Q.pki.createCaStore(s.caStore):e=s.caStore:e=Q.pki.createCaStore();var t=s.cipherSuites||null;if(t===null){t=[];for(var r in A.CipherSuites)t.push(A.CipherSuites[r])}var a=s.server?A.ConnectionEnd.server:A.ConnectionEnd.client,n=s.sessionCache?A.createSessionCache(s.sessionCache):null,i={version:{major:A.Version.major,minor:A.Version.minor},entity:a,sessionId:s.sessionId,caStore:e,sessionCache:n,cipherSuites:t,connected:s.connected,virtualHost:s.virtualHost||null,verifyClient:s.verifyClient||!1,verify:s.verify||function(c,f,g,v){return f},verifyOptions:s.verifyOptions||{},getCertificate:s.getCertificate||null,getPrivateKey:s.getPrivateKey||null,getSignature:s.getSignature||null,input:Q.util.createBuffer(),tlsData:Q.util.createBuffer(),data:Q.util.createBuffer(),tlsDataReady:s.tlsDataReady,dataReady:s.dataReady,heartbeatReceived:s.heartbeatReceived,closed:s.closed,error:function(c,f){f.origin=f.origin||(c.entity===A.ConnectionEnd.client?"client":"server"),f.send&&(A.queue(c,A.createAlert(c,f.alert)),A.flush(c));var g=f.fatal!==!1;g&&(c.fail=!0),s.error(c,f),g&&c.close(!1)},deflate:s.deflate||null,inflate:s.inflate||null};i.reset=function(c){i.version={major:A.Version.major,minor:A.Version.minor},i.record=null,i.session=null,i.peerCertificate=null,i.state={pending:null,current:null},i.expect=i.entity===A.ConnectionEnd.client?bC:RC,i.fragmented=null,i.records=[],i.open=!1,i.handshakes=0,i.handshaking=!1,i.isConnected=!1,i.fail=!(c||typeof c>"u"),i.input.clear(),i.tlsData.clear(),i.data.clear(),i.state.current=A.createConnectionState(i)},i.reset();var o=function(c,f){var g=f.type-A.ContentType.change_cipher_spec,v=em[c.entity][c.expect];g in v?v[g](c,f):A.handleUnexpected(c,f)},l=function(c){var f=0,g=c.input,v=g.length();if(v<5)f=5-v;else{c.record={type:g.getByte(),version:{major:g.getByte(),minor:g.getByte()},length:g.getInt16(),fragment:Q.util.createBuffer(),ready:!1};var p=c.record.version.major===c.version.major;p&&c.session&&c.session.version&&(p=c.record.version.minor===c.version.minor),p||c.error(c,{message:"Incompatible TLS version.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.protocol_version}})}return f},u=function(c){var f=0,g=c.input,v=g.length();if(v<c.record.length)f=c.record.length-v;else{c.record.fragment.putBytes(g.getBytes(c.record.length)),g.compact();var p=c.state.current.read;p.update(c,c.record)&&(c.fragmented!==null&&(c.fragmented.type===c.record.type?(c.fragmented.fragment.putBuffer(c.record.fragment),c.record=c.fragmented):c.error(c,{message:"Invalid fragmented record.",send:!0,alert:{level:A.Alert.Level.fatal,description:A.Alert.Description.unexpected_message}})),c.record.ready=!0)}return f};return i.handshake=function(c){if(i.entity!==A.ConnectionEnd.client)i.error(i,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(i.handshaking)i.error(i,{message:"Handshake already in progress.",fatal:!1});else{i.fail&&!i.open&&i.handshakes===0&&(i.fail=!1),i.handshaking=!0,c=c||"";var f=null;c.length>0&&(i.sessionCache&&(f=i.sessionCache.getSession(c)),f===null&&(c="")),c.length===0&&i.sessionCache&&(f=i.sessionCache.getSession(),f!==null&&(c=f.id)),i.session={id:c,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:Q.md.md5.create(),sha1:Q.md.sha1.create()},f&&(i.version=f.version,i.session.sp=f.sp),i.session.sp.client_random=A.createRandom().getBytes(),i.open=!0,A.queue(i,A.createRecord(i,{type:A.ContentType.handshake,data:A.createClientHello(i)})),A.flush(i)}},i.process=function(c){var f=0;return c&&i.input.putBytes(c),i.fail||(i.record!==null&&i.record.ready&&i.record.fragment.isEmpty()&&(i.record=null),i.record===null&&(f=l(i)),!i.fail&&i.record!==null&&!i.record.ready&&(f=u(i)),!i.fail&&i.record!==null&&i.record.ready&&o(i,i.record)),f},i.prepare=function(c){return A.queue(i,A.createRecord(i,{type:A.ContentType.application_data,data:Q.util.createBuffer(c)})),A.flush(i)},i.prepareHeartbeatRequest=function(c,f){return c instanceof Q.util.ByteBuffer&&(c=c.bytes()),typeof f>"u"&&(f=c.length),i.expectedHeartbeatPayload=c,A.queue(i,A.createRecord(i,{type:A.ContentType.heartbeat,data:A.createHeartbeat(A.HeartbeatMessageType.heartbeat_request,c,f)})),A.flush(i)},i.close=function(c){if(!i.fail&&i.sessionCache&&i.session){var f={id:i.session.id,version:i.session.version,sp:i.session.sp};f.sp.keys=null,i.sessionCache.setSession(f.id,f)}i.open&&(i.open=!1,i.input.clear(),(i.isConnected||i.handshaking)&&(i.isConnected=i.handshaking=!1,A.queue(i,A.createAlert(i,{level:A.Alert.Level.warning,description:A.Alert.Description.close_notify})),A.flush(i)),i.closed(i)),i.reset(c)},i};Q.tls=Q.tls||{};for(var md in A)typeof A[md]!="function"&&(Q.tls[md]=A[md]);Q.tls.prf_tls1=sd;Q.tls.hmac_sha1=CC;Q.tls.createSessionCache=A.createSessionCache;Q.tls.createConnection=A.createConnection;var vn=Fe,Zr=vn.tls;Zr.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(s){s.bulk_cipher_algorithm=Zr.BulkCipherAlgorithm.aes,s.cipher_type=Zr.CipherType.block,s.enc_key_length=16,s.block_length=16,s.fixed_iv_length=16,s.record_iv_length=16,s.mac_algorithm=Zr.MACAlgorithm.hmac_sha1,s.mac_length=20,s.mac_key_length=20},initConnectionState:By};Zr.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(s){s.bulk_cipher_algorithm=Zr.BulkCipherAlgorithm.aes,s.cipher_type=Zr.CipherType.block,s.enc_key_length=32,s.block_length=16,s.fixed_iv_length=16,s.record_iv_length=16,s.mac_algorithm=Zr.MACAlgorithm.hmac_sha1,s.mac_length=20,s.mac_key_length=20},initConnectionState:By};function By(s,e,t){var r=e.entity===vn.tls.ConnectionEnd.client;s.read.cipherState={init:!1,cipher:vn.cipher.createDecipher("AES-CBC",r?t.keys.server_write_key:t.keys.client_write_key),iv:r?t.keys.server_write_IV:t.keys.client_write_IV},s.write.cipherState={init:!1,cipher:vn.cipher.createCipher("AES-CBC",r?t.keys.client_write_key:t.keys.server_write_key),iv:r?t.keys.client_write_IV:t.keys.server_write_IV},s.read.cipherFunction=qC,s.write.cipherFunction=MC,s.read.macLength=s.write.macLength=t.mac_length,s.read.macFunction=s.write.macFunction=Zr.hmac_sha1}function MC(s,e){var t=!1,r=e.macFunction(e.macKey,e.sequenceNumber,s);s.fragment.putBytes(r),e.updateSequenceNumber();var a;s.version.minor===Zr.Versions.TLS_1_0.minor?a=e.cipherState.init?null:e.cipherState.iv:a=vn.random.getBytesSync(16),e.cipherState.init=!0;var n=e.cipherState.cipher;return n.start({iv:a}),s.version.minor>=Zr.Versions.TLS_1_1.minor&&n.output.putBytes(a),n.update(s.fragment),n.finish(HC)&&(s.fragment=n.output,s.length=s.fragment.length(),t=!0),t}function HC(s,e,t){if(!t){var r=s-e.length()%s;e.fillWithByte(r-1,r)}return!0}function FC(s,e,t){var r=!0;if(t){for(var a=e.length(),n=e.last(),i=a-1-n;i<a-1;++i)r=r&&e.at(i)==n;r&&e.truncate(n+1)}return r}function qC(s,e){var t=!1,r;s.version.minor===Zr.Versions.TLS_1_0.minor?r=e.cipherState.init?null:e.cipherState.iv:r=s.fragment.getBytes(16),e.cipherState.init=!0;var a=e.cipherState.cipher;a.start({iv:r}),a.update(s.fragment),t=a.finish(FC);var n=e.macLength,i=vn.random.getBytesSync(n),o=a.output.length();o>=n?(s.fragment=a.output.getBytes(o-n),i=a.output.getBytes(n)):s.fragment=a.output.getBytes(),s.fragment=vn.util.createBuffer(s.fragment),s.length=s.fragment.length();var l=e.macFunction(e.macKey,e.sequenceNumber,s);return e.updateSequenceNumber(),t=JC(e.macKey,i,l)&&t,t}function JC(s,e,t){var r=vn.hmac.create();return r.start("SHA1",s),r.update(e),e=r.digest().getBytes(),r.start(null,null),r.update(t),t=r.digest().getBytes(),e===t}var yt=Fe,th=yt.sha512=yt.sha512||{};yt.md.sha512=yt.md.algorithms.sha512=th;var xy=yt.sha384=yt.sha512.sha384=yt.sha512.sha384||{};xy.create=function(){return th.create("SHA-384")};yt.md.sha384=yt.md.algorithms.sha384=xy;yt.sha512.sha256=yt.sha512.sha256||{create:function(){return th.create("SHA-512/256")}};yt.md["sha512/256"]=yt.md.algorithms["sha512/256"]=yt.sha512.sha256;yt.sha512.sha224=yt.sha512.sha224||{create:function(){return th.create("SHA-512/224")}};yt.md["sha512/224"]=yt.md.algorithms["sha512/224"]=yt.sha512.sha224;th.create=function(s){if(Ny||GC(),typeof s>"u"&&(s="SHA-512"),!(s in Oi))throw new Error("Invalid SHA-512 algorithm: "+s);for(var e=Oi[s],t=null,r=yt.util.createBuffer(),a=new Array(80),n=0;n<80;++n)a[n]=new Array(2);var i=64;switch(s){case"SHA-384":i=48;break;case"SHA-512/256":i=32;break;case"SHA-512/224":i=28;break}var o={algorithm:s.replace("-","").toLowerCase(),blockLength:128,digestLength:i,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var l=o.messageLengthSize/4,u=0;u<l;++u)o.fullMessageLength.push(0);r=yt.util.createBuffer(),t=new Array(e.length);for(var u=0;u<e.length;++u)t[u]=e[u].slice(0);return o},o.start(),o.update=function(l,u){u==="utf8"&&(l=yt.util.encodeUtf8(l));var c=l.length;o.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var f=o.fullMessageLength.length-1;f>=0;--f)o.fullMessageLength[f]+=c[1],c[1]=c[0]+(o.fullMessageLength[f]/4294967296>>>0),o.fullMessageLength[f]=o.fullMessageLength[f]>>>0,c[0]=c[1]/4294967296>>>0;return r.putBytes(l),zm(t,a,r),(r.read>2048||r.length()===0)&&r.compact(),o},o.digest=function(){var l=yt.util.createBuffer();l.putBytes(r.bytes());var u=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,c=u&o.blockLength-1;l.putBytes(ng.substr(0,o.blockLength-c));for(var f,g,v=o.fullMessageLength[0]*8,p=0;p<o.fullMessageLength.length-1;++p)f=o.fullMessageLength[p+1]*8,g=f/4294967296>>>0,v+=g,l.putInt32(v>>>0),v=f>>>0;l.putInt32(v);for(var h=new Array(t.length),p=0;p<t.length;++p)h[p]=t[p].slice(0);zm(h,a,l);var d=yt.util.createBuffer(),y;s==="SHA-512"?y=h.length:s==="SHA-384"?y=h.length-2:y=h.length-4;for(var p=0;p<y;++p)d.putInt32(h[p][0]),(p!==y-1||s!=="SHA-512/224")&&d.putInt32(h[p][1]);return d},o};var ng=null,Ny=!1,ig=null,Oi=null;function GC(){ng=String.fromCharCode(128),ng+=yt.util.fillString(String.fromCharCode(0),128),ig=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Oi={},Oi["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Oi["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Oi["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Oi["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],Ny=!0}function zm(s,e,t){for(var r,a,n,i,o,l,u,c,f,g,v,p,h,d,y,E,k,R,V,L,ne,se,Se,Te,ye,Ce,Ve,Pe,pe,$e,ie,ot,Me,te,le,ae=t.length();ae>=128;){for(pe=0;pe<16;++pe)e[pe][0]=t.getInt32()>>>0,e[pe][1]=t.getInt32()>>>0;for(;pe<80;++pe)ot=e[pe-2],$e=ot[0],ie=ot[1],r=(($e>>>19|ie<<13)^(ie>>>29|$e<<3)^$e>>>6)>>>0,a=(($e<<13|ie>>>19)^(ie<<3|$e>>>29)^($e<<26|ie>>>6))>>>0,te=e[pe-15],$e=te[0],ie=te[1],n=(($e>>>1|ie<<31)^($e>>>8|ie<<24)^$e>>>7)>>>0,i=(($e<<31|ie>>>1)^($e<<24|ie>>>8)^($e<<25|ie>>>7))>>>0,Me=e[pe-7],le=e[pe-16],ie=a+Me[1]+i+le[1],e[pe][0]=r+Me[0]+n+le[0]+(ie/4294967296>>>0)>>>0,e[pe][1]=ie>>>0;for(h=s[0][0],d=s[0][1],y=s[1][0],E=s[1][1],k=s[2][0],R=s[2][1],V=s[3][0],L=s[3][1],ne=s[4][0],se=s[4][1],Se=s[5][0],Te=s[5][1],ye=s[6][0],Ce=s[6][1],Ve=s[7][0],Pe=s[7][1],pe=0;pe<80;++pe)u=((ne>>>14|se<<18)^(ne>>>18|se<<14)^(se>>>9|ne<<23))>>>0,c=((ne<<18|se>>>14)^(ne<<14|se>>>18)^(se<<23|ne>>>9))>>>0,f=(ye^ne&(Se^ye))>>>0,g=(Ce^se&(Te^Ce))>>>0,o=((h>>>28|d<<4)^(d>>>2|h<<30)^(d>>>7|h<<25))>>>0,l=((h<<4|d>>>28)^(d<<30|h>>>2)^(d<<25|h>>>7))>>>0,v=(h&y|k&(h^y))>>>0,p=(d&E|R&(d^E))>>>0,ie=Pe+c+g+ig[pe][1]+e[pe][1],r=Ve+u+f+ig[pe][0]+e[pe][0]+(ie/4294967296>>>0)>>>0,a=ie>>>0,ie=l+p,n=o+v+(ie/4294967296>>>0)>>>0,i=ie>>>0,Ve=ye,Pe=Ce,ye=Se,Ce=Te,Se=ne,Te=se,ie=L+a,ne=V+r+(ie/4294967296>>>0)>>>0,se=ie>>>0,V=k,L=R,k=y,R=E,y=h,E=d,ie=a+i,h=r+n+(ie/4294967296>>>0)>>>0,d=ie>>>0;ie=s[0][1]+d,s[0][0]=s[0][0]+h+(ie/4294967296>>>0)>>>0,s[0][1]=ie>>>0,ie=s[1][1]+E,s[1][0]=s[1][0]+y+(ie/4294967296>>>0)>>>0,s[1][1]=ie>>>0,ie=s[2][1]+R,s[2][0]=s[2][0]+k+(ie/4294967296>>>0)>>>0,s[2][1]=ie>>>0,ie=s[3][1]+L,s[3][0]=s[3][0]+V+(ie/4294967296>>>0)>>>0,s[3][1]=ie>>>0,ie=s[4][1]+se,s[4][0]=s[4][0]+ne+(ie/4294967296>>>0)>>>0,s[4][1]=ie>>>0,ie=s[5][1]+Te,s[5][0]=s[5][0]+Se+(ie/4294967296>>>0)>>>0,s[5][1]=ie>>>0,ie=s[6][1]+Ce,s[6][0]=s[6][0]+ye+(ie/4294967296>>>0)>>>0,s[6][1]=ie>>>0,ie=s[7][1]+Pe,s[7][0]=s[7][0]+Ve+(ie/4294967296>>>0)>>>0,s[7][1]=ie>>>0,ae-=128}}var tm={},jC=Fe,Yt=jC.asn1;tm.privateKeyValidator={name:"PrivateKeyInfo",tagClass:Yt.Class.UNIVERSAL,type:Yt.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:Yt.Class.UNIVERSAL,type:Yt.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:Yt.Class.UNIVERSAL,type:Yt.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Yt.Class.UNIVERSAL,type:Yt.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:Yt.Class.UNIVERSAL,type:Yt.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};tm.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:Yt.Class.UNIVERSAL,type:Yt.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:Yt.Class.UNIVERSAL,type:Yt.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Yt.Class.UNIVERSAL,type:Yt.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:Yt.Class.UNIVERSAL,type:Yt.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]};var ar=Fe,Ty=tm,WC=Ty.publicKeyValidator,QC=Ty.privateKeyValidator;if(typeof YC>"u")var YC=ar.jsbn.BigInteger;var og=ar.util.ByteBuffer,Ir=typeof Buffer>"u"?Uint8Array:Buffer;ar.pki=ar.pki||{};ar.pki.ed25519=ar.ed25519=ar.ed25519||{};var je=ar.ed25519;je.constants={};je.constants.PUBLIC_KEY_BYTE_LENGTH=32;je.constants.PRIVATE_KEY_BYTE_LENGTH=64;je.constants.SEED_BYTE_LENGTH=32;je.constants.SIGN_BYTE_LENGTH=64;je.constants.HASH_BYTE_LENGTH=64;je.generateKeyPair=function(s){s=s||{};var e=s.seed;if(e===void 0)e=ar.random.getBytesSync(je.constants.SEED_BYTE_LENGTH);else if(typeof e=="string"){if(e.length!==je.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+je.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');e=na({message:e,encoding:"binary"});for(var t=new Ir(je.constants.PUBLIC_KEY_BYTE_LENGTH),r=new Ir(je.constants.PRIVATE_KEY_BYTE_LENGTH),a=0;a<32;++a)r[a]=e[a];return eA(t,r),{publicKey:t,privateKey:r}};je.privateKeyFromAsn1=function(s){var e={},t=[],r=ar.asn1.validate(s,QC,e,t);if(!r){var a=new Error("Invalid Key.");throw a.errors=t,a}var n=ar.asn1.derToOid(e.privateKeyOid),i=ar.oids.EdDSA25519;if(n!==i)throw new Error('Invalid OID "'+n+'"; OID must be "'+i+'".');var o=e.privateKey,l=na({message:ar.asn1.fromDer(o).value,encoding:"binary"});return{privateKeyBytes:l}};je.publicKeyFromAsn1=function(s){var e={},t=[],r=ar.asn1.validate(s,WC,e,t);if(!r){var a=new Error("Invalid Key.");throw a.errors=t,a}var n=ar.asn1.derToOid(e.publicKeyOid),i=ar.oids.EdDSA25519;if(n!==i)throw new Error('Invalid OID "'+n+'"; OID must be "'+i+'".');var o=e.ed25519PublicKey;if(o.length!==je.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return na({message:o,encoding:"binary"})};je.publicKeyFromPrivateKey=function(s){s=s||{};var e=na({message:s.privateKey,encoding:"binary"});if(e.length!==je.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+je.constants.PRIVATE_KEY_BYTE_LENGTH);for(var t=new Ir(je.constants.PUBLIC_KEY_BYTE_LENGTH),r=0;r<t.length;++r)t[r]=e[32+r];return t};je.sign=function(s){s=s||{};var e=na(s),t=na({message:s.privateKey,encoding:"binary"});if(t.length===je.constants.SEED_BYTE_LENGTH){var r=je.generateKeyPair({seed:t});t=r.privateKey}else if(t.length!==je.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+je.constants.SEED_BYTE_LENGTH+" or "+je.constants.PRIVATE_KEY_BYTE_LENGTH);var a=new Ir(je.constants.SIGN_BYTE_LENGTH+e.length);tA(a,e,e.length,t);for(var n=new Ir(je.constants.SIGN_BYTE_LENGTH),i=0;i<n.length;++i)n[i]=a[i];return n};je.verify=function(s){s=s||{};var e=na(s);if(s.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var t=na({message:s.signature,encoding:"binary"});if(t.length!==je.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+je.constants.SIGN_BYTE_LENGTH);var r=na({message:s.publicKey,encoding:"binary"});if(r.length!==je.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+je.constants.PUBLIC_KEY_BYTE_LENGTH);var a=new Ir(je.constants.SIGN_BYTE_LENGTH+e.length),n=new Ir(je.constants.SIGN_BYTE_LENGTH+e.length),i;for(i=0;i<je.constants.SIGN_BYTE_LENGTH;++i)a[i]=t[i];for(i=0;i<e.length;++i)a[i+je.constants.SIGN_BYTE_LENGTH]=e[i];return rA(n,a,a.length,r)>=0};function na(s){var e=s.message;if(e instanceof Uint8Array||e instanceof Ir)return e;var t=s.encoding;if(e===void 0)if(s.md)e=s.md.digest().getBytes(),t="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof e=="string"&&!t)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.from(e,t);e=new og(e,t)}else if(!(e instanceof og))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var r=new Ir(e.length()),a=0;a<r.length;++a)r[a]=e.at(a);return r}var lg=Re(),E0=Re([1]),zC=Re([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),XC=Re([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),Xm=Re([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Zm=Re([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),pd=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),ZC=Re([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Vf(s,e){var t=ar.md.sha512.create(),r=new og(s);t.update(r.getBytes(e),"binary");var a=t.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(a,"binary");for(var n=new Ir(je.constants.HASH_BYTE_LENGTH),i=0;i<64;++i)n[i]=a.charCodeAt(i);return n}function eA(s,e){var t=[Re(),Re(),Re(),Re()],r,a=Vf(e,32);for(a[0]&=248,a[31]&=127,a[31]|=64,sm(t,a),rm(s,t),r=0;r<32;++r)e[r+32]=s[r];return 0}function tA(s,e,t,r){var a,n,i=new Float64Array(64),o=[Re(),Re(),Re(),Re()],l=Vf(r,32);l[0]&=248,l[31]&=127,l[31]|=64;var u=t+64;for(a=0;a<t;++a)s[64+a]=e[a];for(a=0;a<32;++a)s[32+a]=l[32+a];var c=Vf(s.subarray(32),t+32);for(ug(c),sm(o,c),rm(s,o),a=32;a<64;++a)s[a]=r[a];var f=Vf(s,t+64);for(ug(f),a=32;a<64;++a)i[a]=0;for(a=0;a<32;++a)i[a]=c[a];for(a=0;a<32;++a)for(n=0;n<32;n++)i[a+n]+=f[a]*l[n];return Ry(s.subarray(32),i),u}function rA(s,e,t,r){var a,n,i=new Ir(32),o=[Re(),Re(),Re(),Re()],l=[Re(),Re(),Re(),Re()];if(n=-1,t<64||sA(l,r))return-1;for(a=0;a<t;++a)s[a]=e[a];for(a=0;a<32;++a)s[a+32]=r[a];var u=Vf(s,t);if(ug(u),$y(o,l,u),sm(l,e.subarray(32)),cg(o,l),rm(i,o),t-=64,Vy(e,0,i,0)){for(a=0;a<t;++a)s[a]=0;return-1}for(a=0;a<t;++a)s[a]=e[a+64];return n=t,n}function Ry(s,e){var t,r,a,n;for(r=63;r>=32;--r){for(t=0,a=r-32,n=r-12;a<n;++a)e[a]+=t-16*e[r]*pd[a-(r-32)],t=e[a]+128>>8,e[a]-=t*256;e[a]+=t,e[r]=0}for(t=0,a=0;a<32;++a)e[a]+=t-(e[31]>>4)*pd[a],t=e[a]>>8,e[a]&=255;for(a=0;a<32;++a)e[a]-=t*pd[a];for(r=0;r<32;++r)e[r+1]+=e[r]>>8,s[r]=e[r]&255}function ug(s){for(var e=new Float64Array(64),t=0;t<64;++t)e[t]=s[t],s[t]=0;Ry(s,e)}function cg(s,e){var t=Re(),r=Re(),a=Re(),n=Re(),i=Re(),o=Re(),l=Re(),u=Re(),c=Re();Fl(t,s[1],s[0]),Fl(c,e[1],e[0]),ct(t,t,c),Co(r,s[0],s[1]),Co(c,e[0],e[1]),ct(r,r,c),ct(a,s[3],e[3]),ct(a,a,XC),ct(n,s[2],e[2]),Co(n,n,n),Fl(i,r,t),Fl(o,n,a),Co(l,n,a),Co(u,r,t),ct(s[0],i,o),ct(s[1],u,l),ct(s[2],l,o),ct(s[3],i,u)}function ep(s,e,t){for(var r=0;r<4;++r)Dy(s[r],e[r],t)}function rm(s,e){var t=Re(),r=Re(),a=Re();oA(a,e[2]),ct(t,e[0],a),ct(r,e[1],a),b0(s,r),s[31]^=_y(t)<<7}function b0(s,e){var t,r,a,n=Re(),i=Re();for(t=0;t<16;++t)i[t]=e[t];for(yd(i),yd(i),yd(i),r=0;r<2;++r){for(n[0]=i[0]-65517,t=1;t<15;++t)n[t]=i[t]-65535-(n[t-1]>>16&1),n[t-1]&=65535;n[15]=i[15]-32767-(n[14]>>16&1),a=n[15]>>16&1,n[14]&=65535,Dy(i,n,1-a)}for(t=0;t<16;t++)s[2*t]=i[t]&255,s[2*t+1]=i[t]>>8}function sA(s,e){var t=Re(),r=Re(),a=Re(),n=Re(),i=Re(),o=Re(),l=Re();return cn(s[2],E0),aA(s[1],e),Pi(a,s[1]),ct(n,a,zC),Fl(a,a,s[2]),Co(n,s[2],n),Pi(i,n),Pi(o,i),ct(l,o,i),ct(t,l,a),ct(t,t,n),nA(t,t),ct(t,t,a),ct(t,t,n),ct(t,t,n),ct(s[0],t,n),Pi(r,s[0]),ct(r,r,n),tp(r,a)&&ct(s[0],s[0],ZC),Pi(r,s[0]),ct(r,r,n),tp(r,a)?-1:(_y(s[0])===e[31]>>7&&Fl(s[0],lg,s[0]),ct(s[3],s[0],s[1]),0)}function aA(s,e){var t;for(t=0;t<16;++t)s[t]=e[2*t]+(e[2*t+1]<<8);s[15]&=32767}function nA(s,e){var t=Re(),r;for(r=0;r<16;++r)t[r]=e[r];for(r=250;r>=0;--r)Pi(t,t),r!==1&&ct(t,t,e);for(r=0;r<16;++r)s[r]=t[r]}function tp(s,e){var t=new Ir(32),r=new Ir(32);return b0(t,s),b0(r,e),Vy(t,0,r,0)}function Vy(s,e,t,r){return iA(s,e,t,r,32)}function iA(s,e,t,r,a){var n,i=0;for(n=0;n<a;++n)i|=s[e+n]^t[r+n];return(1&i-1>>>8)-1}function _y(s){var e=new Ir(32);return b0(e,s),e[0]&1}function $y(s,e,t){var r,a;for(cn(s[0],lg),cn(s[1],E0),cn(s[2],E0),cn(s[3],lg),a=255;a>=0;--a)r=t[a/8|0]>>(a&7)&1,ep(s,e,r),cg(e,s),cg(s,s),ep(s,e,r)}function sm(s,e){var t=[Re(),Re(),Re(),Re()];cn(t[0],Xm),cn(t[1],Zm),cn(t[2],E0),ct(t[3],Xm,Zm),$y(s,t,e)}function cn(s,e){var t;for(t=0;t<16;t++)s[t]=e[t]|0}function oA(s,e){var t=Re(),r;for(r=0;r<16;++r)t[r]=e[r];for(r=253;r>=0;--r)Pi(t,t),r!==2&&r!==4&&ct(t,t,e);for(r=0;r<16;++r)s[r]=t[r]}function yd(s){var e,t,r=1;for(e=0;e<16;++e)t=s[e]+r+65535,r=Math.floor(t/65536),s[e]=t-r*65536;s[0]+=r-1+37*(r-1)}function Dy(s,e,t){for(var r,a=~(t-1),n=0;n<16;++n)r=a&(s[n]^e[n]),s[n]^=r,e[n]^=r}function Re(s){var e,t=new Float64Array(16);if(s)for(e=0;e<s.length;++e)t[e]=s[e];return t}function Co(s,e,t){for(var r=0;r<16;++r)s[r]=e[r]+t[r]}function Fl(s,e,t){for(var r=0;r<16;++r)s[r]=e[r]-t[r]}function Pi(s,e){ct(s,e,e)}function ct(s,e,t){var r,a,n=0,i=0,o=0,l=0,u=0,c=0,f=0,g=0,v=0,p=0,h=0,d=0,y=0,E=0,k=0,R=0,V=0,L=0,ne=0,se=0,Se=0,Te=0,ye=0,Ce=0,Ve=0,Pe=0,pe=0,$e=0,ie=0,ot=0,Me=0,te=t[0],le=t[1],ae=t[2],me=t[3],Ae=t[4],qe=t[5],nt=t[6],Ue=t[7],Ne=t[8],fe=t[9],ht=t[10],lt=t[11],ut=t[12],Oe=t[13],qt=t[14],Jt=t[15];r=e[0],n+=r*te,i+=r*le,o+=r*ae,l+=r*me,u+=r*Ae,c+=r*qe,f+=r*nt,g+=r*Ue,v+=r*Ne,p+=r*fe,h+=r*ht,d+=r*lt,y+=r*ut,E+=r*Oe,k+=r*qt,R+=r*Jt,r=e[1],i+=r*te,o+=r*le,l+=r*ae,u+=r*me,c+=r*Ae,f+=r*qe,g+=r*nt,v+=r*Ue,p+=r*Ne,h+=r*fe,d+=r*ht,y+=r*lt,E+=r*ut,k+=r*Oe,R+=r*qt,V+=r*Jt,r=e[2],o+=r*te,l+=r*le,u+=r*ae,c+=r*me,f+=r*Ae,g+=r*qe,v+=r*nt,p+=r*Ue,h+=r*Ne,d+=r*fe,y+=r*ht,E+=r*lt,k+=r*ut,R+=r*Oe,V+=r*qt,L+=r*Jt,r=e[3],l+=r*te,u+=r*le,c+=r*ae,f+=r*me,g+=r*Ae,v+=r*qe,p+=r*nt,h+=r*Ue,d+=r*Ne,y+=r*fe,E+=r*ht,k+=r*lt,R+=r*ut,V+=r*Oe,L+=r*qt,ne+=r*Jt,r=e[4],u+=r*te,c+=r*le,f+=r*ae,g+=r*me,v+=r*Ae,p+=r*qe,h+=r*nt,d+=r*Ue,y+=r*Ne,E+=r*fe,k+=r*ht,R+=r*lt,V+=r*ut,L+=r*Oe,ne+=r*qt,se+=r*Jt,r=e[5],c+=r*te,f+=r*le,g+=r*ae,v+=r*me,p+=r*Ae,h+=r*qe,d+=r*nt,y+=r*Ue,E+=r*Ne,k+=r*fe,R+=r*ht,V+=r*lt,L+=r*ut,ne+=r*Oe,se+=r*qt,Se+=r*Jt,r=e[6],f+=r*te,g+=r*le,v+=r*ae,p+=r*me,h+=r*Ae,d+=r*qe,y+=r*nt,E+=r*Ue,k+=r*Ne,R+=r*fe,V+=r*ht,L+=r*lt,ne+=r*ut,se+=r*Oe,Se+=r*qt,Te+=r*Jt,r=e[7],g+=r*te,v+=r*le,p+=r*ae,h+=r*me,d+=r*Ae,y+=r*qe,E+=r*nt,k+=r*Ue,R+=r*Ne,V+=r*fe,L+=r*ht,ne+=r*lt,se+=r*ut,Se+=r*Oe,Te+=r*qt,ye+=r*Jt,r=e[8],v+=r*te,p+=r*le,h+=r*ae,d+=r*me,y+=r*Ae,E+=r*qe,k+=r*nt,R+=r*Ue,V+=r*Ne,L+=r*fe,ne+=r*ht,se+=r*lt,Se+=r*ut,Te+=r*Oe,ye+=r*qt,Ce+=r*Jt,r=e[9],p+=r*te,h+=r*le,d+=r*ae,y+=r*me,E+=r*Ae,k+=r*qe,R+=r*nt,V+=r*Ue,L+=r*Ne,ne+=r*fe,se+=r*ht,Se+=r*lt,Te+=r*ut,ye+=r*Oe,Ce+=r*qt,Ve+=r*Jt,r=e[10],h+=r*te,d+=r*le,y+=r*ae,E+=r*me,k+=r*Ae,R+=r*qe,V+=r*nt,L+=r*Ue,ne+=r*Ne,se+=r*fe,Se+=r*ht,Te+=r*lt,ye+=r*ut,Ce+=r*Oe,Ve+=r*qt,Pe+=r*Jt,r=e[11],d+=r*te,y+=r*le,E+=r*ae,k+=r*me,R+=r*Ae,V+=r*qe,L+=r*nt,ne+=r*Ue,se+=r*Ne,Se+=r*fe,Te+=r*ht,ye+=r*lt,Ce+=r*ut,Ve+=r*Oe,Pe+=r*qt,pe+=r*Jt,r=e[12],y+=r*te,E+=r*le,k+=r*ae,R+=r*me,V+=r*Ae,L+=r*qe,ne+=r*nt,se+=r*Ue,Se+=r*Ne,Te+=r*fe,ye+=r*ht,Ce+=r*lt,Ve+=r*ut,Pe+=r*Oe,pe+=r*qt,$e+=r*Jt,r=e[13],E+=r*te,k+=r*le,R+=r*ae,V+=r*me,L+=r*Ae,ne+=r*qe,se+=r*nt,Se+=r*Ue,Te+=r*Ne,ye+=r*fe,Ce+=r*ht,Ve+=r*lt,Pe+=r*ut,pe+=r*Oe,$e+=r*qt,ie+=r*Jt,r=e[14],k+=r*te,R+=r*le,V+=r*ae,L+=r*me,ne+=r*Ae,se+=r*qe,Se+=r*nt,Te+=r*Ue,ye+=r*Ne,Ce+=r*fe,Ve+=r*ht,Pe+=r*lt,pe+=r*ut,$e+=r*Oe,ie+=r*qt,ot+=r*Jt,r=e[15],R+=r*te,V+=r*le,L+=r*ae,ne+=r*me,se+=r*Ae,Se+=r*qe,Te+=r*nt,ye+=r*Ue,Ce+=r*Ne,Ve+=r*fe,Pe+=r*ht,pe+=r*lt,$e+=r*ut,ie+=r*Oe,ot+=r*qt,Me+=r*Jt,n+=38*V,i+=38*L,o+=38*ne,l+=38*se,u+=38*Se,c+=38*Te,f+=38*ye,g+=38*Ce,v+=38*Ve,p+=38*Pe,h+=38*pe,d+=38*$e,y+=38*ie,E+=38*ot,k+=38*Me,a=1,r=n+a+65535,a=Math.floor(r/65536),n=r-a*65536,r=i+a+65535,a=Math.floor(r/65536),i=r-a*65536,r=o+a+65535,a=Math.floor(r/65536),o=r-a*65536,r=l+a+65535,a=Math.floor(r/65536),l=r-a*65536,r=u+a+65535,a=Math.floor(r/65536),u=r-a*65536,r=c+a+65535,a=Math.floor(r/65536),c=r-a*65536,r=f+a+65535,a=Math.floor(r/65536),f=r-a*65536,r=g+a+65535,a=Math.floor(r/65536),g=r-a*65536,r=v+a+65535,a=Math.floor(r/65536),v=r-a*65536,r=p+a+65535,a=Math.floor(r/65536),p=r-a*65536,r=h+a+65535,a=Math.floor(r/65536),h=r-a*65536,r=d+a+65535,a=Math.floor(r/65536),d=r-a*65536,r=y+a+65535,a=Math.floor(r/65536),y=r-a*65536,r=E+a+65535,a=Math.floor(r/65536),E=r-a*65536,r=k+a+65535,a=Math.floor(r/65536),k=r-a*65536,r=R+a+65535,a=Math.floor(r/65536),R=r-a*65536,n+=a-1+37*(a-1),a=1,r=n+a+65535,a=Math.floor(r/65536),n=r-a*65536,r=i+a+65535,a=Math.floor(r/65536),i=r-a*65536,r=o+a+65535,a=Math.floor(r/65536),o=r-a*65536,r=l+a+65535,a=Math.floor(r/65536),l=r-a*65536,r=u+a+65535,a=Math.floor(r/65536),u=r-a*65536,r=c+a+65535,a=Math.floor(r/65536),c=r-a*65536,r=f+a+65535,a=Math.floor(r/65536),f=r-a*65536,r=g+a+65535,a=Math.floor(r/65536),g=r-a*65536,r=v+a+65535,a=Math.floor(r/65536),v=r-a*65536,r=p+a+65535,a=Math.floor(r/65536),p=r-a*65536,r=h+a+65535,a=Math.floor(r/65536),h=r-a*65536,r=d+a+65535,a=Math.floor(r/65536),d=r-a*65536,r=y+a+65535,a=Math.floor(r/65536),y=r-a*65536,r=E+a+65535,a=Math.floor(r/65536),E=r-a*65536,r=k+a+65535,a=Math.floor(r/65536),k=r-a*65536,r=R+a+65535,a=Math.floor(r/65536),R=r-a*65536,n+=a-1+37*(a-1),s[0]=n,s[1]=i,s[2]=o,s[3]=l,s[4]=u,s[5]=c,s[6]=f,s[7]=g,s[8]=v,s[9]=p,s[10]=h,s[11]=d,s[12]=y,s[13]=E,s[14]=k,s[15]=R}var Lr=Fe;Lr.kem=Lr.kem||{};var rp=Lr.jsbn.BigInteger;Lr.kem.rsa={};Lr.kem.rsa.create=function(s,e){e=e||{};var t=e.prng||Lr.random,r={};return r.encrypt=function(a,n){var i=Math.ceil(a.n.bitLength()/8),o;do o=new rp(Lr.util.bytesToHex(t.getBytesSync(i)),16).mod(a.n);while(o.compareTo(rp.ONE)<=0);o=Lr.util.hexToBytes(o.toString(16));var l=i-o.length;l>0&&(o=Lr.util.fillString(String.fromCharCode(0),l)+o);var u=a.encrypt(o,"NONE"),c=s.generate(o,n);return{encapsulation:u,key:c}},r.decrypt=function(a,n,i){var o=a.decrypt(n,"NONE");return s.generate(o,i)},r};Lr.kem.kdf1=function(s,e){Ly(this,s,0,e||s.digestLength)};Lr.kem.kdf2=function(s,e){Ly(this,s,1,e||s.digestLength)};function Ly(s,e,t,r){s.generate=function(a,n){for(var i=new Lr.util.ByteBuffer,o=Math.ceil(n/r)+t,l=new Lr.util.ByteBuffer,u=t;u<o;++u){l.putInt32(u),e.start(),e.update(a+l.getBytes());var c=e.digest();i.putBytes(c.getBytes(r))}return i.truncate(i.length()-n),i.getBytes()}}var Qe=Fe;Qe.log=Qe.log||{};Qe.log.levels=["none","error","warning","info","debug","verbose","max"];var k0={},fg=[],_f=null;Qe.log.LEVEL_LOCKED=1<<1;Qe.log.NO_LEVEL_CHECK=1<<2;Qe.log.INTERPOLATE=1<<3;for(var fn=0;fn<Qe.log.levels.length;++fn){var sp=Qe.log.levels[fn];k0[sp]={index:fn,name:sp.toUpperCase()}}Qe.log.logMessage=function(s){for(var e=k0[s.level].index,t=0;t<fg.length;++t){var r=fg[t];if(r.flags&Qe.log.NO_LEVEL_CHECK)r.f(s);else{var a=k0[r.level].index;e<=a&&r.f(r,s)}}};Qe.log.prepareStandard=function(s){"standard"in s||(s.standard=k0[s.level].name+" ["+s.category+"] "+s.message)};Qe.log.prepareFull=function(s){if(!("full"in s)){var e=[s.message];e=e.concat([]),s.full=Qe.util.format.apply(this,e)}};Qe.log.prepareStandardFull=function(s){"standardFull"in s||(Qe.log.prepareStandard(s),s.standardFull=s.standard)};for(var ap=["error","warning","info","debug","verbose"],fn=0;fn<ap.length;++fn)(function(e){Qe.log[e]=function(t,r){var a=Array.prototype.slice.call(arguments).slice(2),n={timestamp:new Date,level:e,category:t,message:r,arguments:a};Qe.log.logMessage(n)}})(ap[fn]);Qe.log.makeLogger=function(s){var e={flags:0,f:s};return Qe.log.setLevel(e,"none"),e};Qe.log.setLevel=function(s,e){var t=!1;if(s&&!(s.flags&Qe.log.LEVEL_LOCKED))for(var r=0;r<Qe.log.levels.length;++r){var a=Qe.log.levels[r];if(e==a){s.level=e,t=!0;break}}return t};Qe.log.lock=function(s,e){typeof e>"u"||e?s.flags|=Qe.log.LEVEL_LOCKED:s.flags&=~Qe.log.LEVEL_LOCKED};Qe.log.addLogger=function(s){fg.push(s)};if(typeof console<"u"&&"log"in console){var vu;if(console.error&&console.warn&&console.info&&console.debug){var lA={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},am=function(s,e){Qe.log.prepareStandard(e);var t=lA[e.level],r=[e.standard];r=r.concat(e.arguments.slice()),t.apply(console,r)};vu=Qe.log.makeLogger(am)}else{var am=function(e,t){Qe.log.prepareStandardFull(t),console.log(t.standardFull)};vu=Qe.log.makeLogger(am)}Qe.log.setLevel(vu,"debug"),Qe.log.addLogger(vu),_f=vu}else console={log:function(){}};if(_f!==null&&typeof window<"u"&&window.location){var oh=new URL(window.location.href).searchParams;if(oh.has("console.level")&&Qe.log.setLevel(_f,oh.get("console.level").slice(-1)[0]),oh.has("console.lock")){var uA=oh.get("console.lock").slice(-1)[0];uA=="true"&&Qe.log.lock(_f)}}Qe.log.consoleLogger=_f;var cA={exports:{}};(function(s){s.exports=P1})(cA);var oe=Fe,B=oe.asn1,yr=oe.pkcs7=oe.pkcs7||{};yr.messageFromPem=function(s){var e=oe.pem.decode(s)[0];if(e.type!=="PKCS7"){var t=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var r=B.fromDer(e.body);return yr.messageFromAsn1(r)};yr.messageToPem=function(s,e){var t={type:"PKCS7",body:B.toDer(s.toAsn1()).getBytes()};return oe.pem.encode(t,{maxline:e})};yr.messageFromAsn1=function(s){var e={},t=[];if(!B.validate(s,yr.asn1.contentInfoValidator,e,t)){var r=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw r.errors=t,r}var a=B.derToOid(e.contentType),n;switch(a){case oe.pki.oids.envelopedData:n=yr.createEnvelopedData();break;case oe.pki.oids.encryptedData:n=yr.createEncryptedData();break;case oe.pki.oids.signedData:n=yr.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+a+" is not (yet) supported.")}return n.fromAsn1(e.content.value[0]),n};yr.createSignedData=function(){var s=null;return s={type:oe.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(r){if(nm(s,r,yr.asn1.signedDataValidator),s.certificates=[],s.crls=[],s.digestAlgorithmIdentifiers=[],s.contentInfo=null,s.signerInfos=[],s.rawCapture.certificates)for(var a=s.rawCapture.certificates.value,n=0;n<a.length;++n)s.certificates.push(oe.pki.certificateFromAsn1(a[n]))},toAsn1:function(){s.contentInfo||s.sign();for(var r=[],a=0;a<s.certificates.length;++a)r.push(oe.pki.certificateToAsn1(s.certificates[a]));var n=[],i=B.create(B.Class.CONTEXT_SPECIFIC,0,!0,[B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,B.integerToDer(s.version).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SET,!0,s.digestAlgorithmIdentifiers),s.contentInfo])]);return r.length>0&&i.value[0].value.push(B.create(B.Class.CONTEXT_SPECIFIC,0,!0,r)),n.length>0&&i.value[0].value.push(B.create(B.Class.CONTEXT_SPECIFIC,1,!0,n)),i.value[0].value.push(B.create(B.Class.UNIVERSAL,B.Type.SET,!0,s.signerInfos)),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(s.type).getBytes()),i])},addSigner:function(r){var a=r.issuer,n=r.serialNumber;if(r.certificate){var i=r.certificate;typeof i=="string"&&(i=oe.pki.certificateFromPem(i)),a=i.issuer.attributes,n=i.serialNumber}var o=r.key;if(!o)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof o=="string"&&(o=oe.pki.privateKeyFromPem(o));var l=r.digestAlgorithm||oe.pki.oids.sha1;switch(l){case oe.pki.oids.sha1:case oe.pki.oids.sha256:case oe.pki.oids.sha384:case oe.pki.oids.sha512:case oe.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+l)}var u=r.authenticatedAttributes||[];if(u.length>0){for(var c=!1,f=!1,g=0;g<u.length;++g){var v=u[g];if(!c&&v.type===oe.pki.oids.contentType){if(c=!0,f)break;continue}if(!f&&v.type===oe.pki.oids.messageDigest){if(f=!0,c)break;continue}}if(!c||!f)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}s.signers.push({key:o,version:1,issuer:a,serialNumber:n,digestAlgorithm:l,signatureAlgorithm:oe.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(r){if(r=r||{},(typeof s.content!="object"||s.contentInfo===null)&&(s.contentInfo=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(oe.pki.oids.data).getBytes())]),"content"in s)){var a;s.content instanceof oe.util.ByteBuffer?a=s.content.bytes():typeof s.content=="string"&&(a=oe.util.encodeUtf8(s.content)),r.detached?s.detachedContent=B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,a):s.contentInfo.value.push(B.create(B.Class.CONTEXT_SPECIFIC,0,!0,[B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,a)]))}if(s.signers.length!==0){var n=e();t(n)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(r){typeof r=="string"&&(r=oe.pki.certificateFromPem(r)),s.certificates.push(r)},addCertificateRevokationList:function(r){throw new Error("PKCS#7 CRL support not yet implemented.")}},s;function e(){for(var r={},a=0;a<s.signers.length;++a){var n=s.signers[a],i=n.digestAlgorithm;i in r||(r[i]=oe.md[oe.pki.oids[i]].create()),n.authenticatedAttributes.length===0?n.md=r[i]:n.md=oe.md[oe.pki.oids[i]].create()}s.digestAlgorithmIdentifiers=[];for(var i in r)s.digestAlgorithmIdentifiers.push(B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(i).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.NULL,!1,"")]));return r}function t(r){var a;if(s.detachedContent?a=s.detachedContent:(a=s.contentInfo.value[1],a=a.value[0]),!a)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var n=B.derToOid(s.contentInfo.value[0].value),i=B.toDer(a);i.getByte(),B.getBerValueLength(i),i=i.getBytes();for(var o in r)r[o].start().update(i);for(var l=new Date,u=0;u<s.signers.length;++u){var c=s.signers[u];if(c.authenticatedAttributes.length===0){if(n!==oe.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{c.authenticatedAttributesAsn1=B.create(B.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var f=B.create(B.Class.UNIVERSAL,B.Type.SET,!0,[]),g=0;g<c.authenticatedAttributes.length;++g){var v=c.authenticatedAttributes[g];v.type===oe.pki.oids.messageDigest?v.value=r[c.digestAlgorithm].digest():v.type===oe.pki.oids.signingTime&&(v.value||(v.value=l)),f.value.push(hg(v)),c.authenticatedAttributesAsn1.value.push(hg(v))}i=B.toDer(f).getBytes(),c.md.start().update(i)}c.signature=c.key.sign(c.md,"RSASSA-PKCS1-V1_5")}s.signerInfos=pA(s.signers)}};yr.createEncryptedData=function(){var s=null;return s={type:oe.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:oe.pki.oids["aes256-CBC"]},fromAsn1:function(e){nm(s,e,yr.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(s.encryptedContent.key=e),Oy(s)}},s};yr.createEnvelopedData=function(){var s=null;return s={type:oe.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:oe.pki.oids["aes256-CBC"]},fromAsn1:function(e){var t=nm(s,e,yr.asn1.envelopedDataValidator);s.recipients=dA(t.recipientInfos.value)},toAsn1:function(){return B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(s.type).getBytes()),B.create(B.Class.CONTEXT_SPECIFIC,0,!0,[B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,B.integerToDer(s.version).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SET,!0,gA(s.recipients)),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,yA(s.encryptedContent))])])])},findRecipient:function(e){for(var t=e.issuer.attributes,r=0;r<s.recipients.length;++r){var a=s.recipients[r],n=a.issuer;if(a.serialNumber===e.serialNumber&&n.length===t.length){for(var i=!0,o=0;o<t.length;++o)if(n[o].type!==t[o].type||n[o].value!==t[o].value){i=!1;break}if(i)return a}}return null},decrypt:function(e,t){if(s.encryptedContent.key===void 0&&e!==void 0&&t!==void 0)switch(e.encryptedContent.algorithm){case oe.pki.oids.rsaEncryption:case oe.pki.oids.desCBC:var r=t.decrypt(e.encryptedContent.content);s.encryptedContent.key=oe.util.createBuffer(r);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}Oy(s)},addRecipient:function(e){s.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:oe.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,t){if(s.encryptedContent.content===void 0){t=t||s.encryptedContent.algorithm,e=e||s.encryptedContent.key;var r,a,n;switch(t){case oe.pki.oids["aes128-CBC"]:r=16,a=16,n=oe.aes.createEncryptionCipher;break;case oe.pki.oids["aes192-CBC"]:r=24,a=16,n=oe.aes.createEncryptionCipher;break;case oe.pki.oids["aes256-CBC"]:r=32,a=16,n=oe.aes.createEncryptionCipher;break;case oe.pki.oids["des-EDE3-CBC"]:r=24,a=8,n=oe.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+t)}if(e===void 0)e=oe.util.createBuffer(oe.random.getBytes(r));else if(e.length()!=r)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+r+".");s.encryptedContent.algorithm=t,s.encryptedContent.key=e,s.encryptedContent.parameter=oe.util.createBuffer(oe.random.getBytes(a));var i=n(e);if(i.start(s.encryptedContent.parameter.copy()),i.update(s.content),!i.finish())throw new Error("Symmetric encryption failed.");s.encryptedContent.content=i.output}for(var o=0;o<s.recipients.length;++o){var l=s.recipients[o];if(l.encryptedContent.content===void 0)switch(l.encryptedContent.algorithm){case oe.pki.oids.rsaEncryption:l.encryptedContent.content=l.encryptedContent.key.encrypt(s.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+l.encryptedContent.algorithm)}}}},s};function fA(s){var e={},t=[];if(!B.validate(s,yr.asn1.recipientInfoValidator,e,t)){var r=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw r.errors=t,r}return{version:e.version.charCodeAt(0),issuer:oe.pki.RDNAttributesAsArray(e.issuer),serialNumber:oe.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:B.derToOid(e.encAlgorithm),parameter:e.encParameter?e.encParameter.value:void 0,content:e.encKey}}}function hA(s){return B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,B.integerToDer(s.version).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[oe.pki.distinguishedNameToAsn1({attributes:s.issuer}),B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,oe.util.hexToBytes(s.serialNumber))]),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(s.encryptedContent.algorithm).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.NULL,!1,"")]),B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,s.encryptedContent.content)])}function dA(s){for(var e=[],t=0;t<s.length;++t)e.push(fA(s[t]));return e}function gA(s){for(var e=[],t=0;t<s.length;++t)e.push(hA(s[t]));return e}function mA(s){var e=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,B.integerToDer(s.version).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[oe.pki.distinguishedNameToAsn1({attributes:s.issuer}),B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,oe.util.hexToBytes(s.serialNumber))]),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(s.digestAlgorithm).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.NULL,!1,"")])]);if(s.authenticatedAttributesAsn1&&e.value.push(s.authenticatedAttributesAsn1),e.value.push(B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(s.signatureAlgorithm).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.NULL,!1,"")])),e.value.push(B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,s.signature)),s.unauthenticatedAttributes.length>0){for(var t=B.create(B.Class.CONTEXT_SPECIFIC,1,!0,[]),r=0;r<s.unauthenticatedAttributes.length;++r){var a=s.unauthenticatedAttributes[r];t.values.push(hg(a))}e.value.push(t)}return e}function pA(s){for(var e=[],t=0;t<s.length;++t)e.push(mA(s[t]));return e}function hg(s){var e;if(s.type===oe.pki.oids.contentType)e=B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(s.value).getBytes());else if(s.type===oe.pki.oids.messageDigest)e=B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,s.value.bytes());else if(s.type===oe.pki.oids.signingTime){var t=new Date("1950-01-01T00:00:00Z"),r=new Date("2050-01-01T00:00:00Z"),a=s.value;if(typeof a=="string"){var n=Date.parse(a);isNaN(n)?a.length===13?a=B.utcTimeToDate(a):a=B.generalizedTimeToDate(a):a=new Date(n)}a>=t&&a<r?e=B.create(B.Class.UNIVERSAL,B.Type.UTCTIME,!1,B.dateToUtcTime(a)):e=B.create(B.Class.UNIVERSAL,B.Type.GENERALIZEDTIME,!1,B.dateToGeneralizedTime(a))}return B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(s.type).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SET,!0,[e])])}function yA(s){return[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(oe.pki.oids.data).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(s.algorithm).getBytes()),s.parameter?B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,s.parameter.getBytes()):void 0]),B.create(B.Class.CONTEXT_SPECIFIC,0,!0,[B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,s.content.getBytes())])]}function nm(s,e,t){var r={},a=[];if(!B.validate(e,t,r,a)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw n.errors=n,n}var i=B.derToOid(r.contentType);if(i!==oe.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(r.encryptedContent){var o="";if(oe.util.isArray(r.encryptedContent))for(var l=0;l<r.encryptedContent.length;++l){if(r.encryptedContent[l].type!==B.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");o+=r.encryptedContent[l].value}else o=r.encryptedContent;s.encryptedContent={algorithm:B.derToOid(r.encAlgorithm),parameter:oe.util.createBuffer(r.encParameter.value),content:oe.util.createBuffer(o)}}if(r.content){var o="";if(oe.util.isArray(r.content))for(var l=0;l<r.content.length;++l){if(r.content[l].type!==B.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");o+=r.content[l].value}else o=r.content;s.content=oe.util.createBuffer(o)}return s.version=r.version.charCodeAt(0),s.rawCapture=r,r}function Oy(s){if(s.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(s.content===void 0){var e;switch(s.encryptedContent.algorithm){case oe.pki.oids["aes128-CBC"]:case oe.pki.oids["aes192-CBC"]:case oe.pki.oids["aes256-CBC"]:e=oe.aes.createDecryptionCipher(s.encryptedContent.key);break;case oe.pki.oids.desCBC:case oe.pki.oids["des-EDE3-CBC"]:e=oe.des.createDecryptionCipher(s.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+s.encryptedContent.algorithm)}if(e.start(s.encryptedContent.parameter),e.update(s.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");s.content=e.output}}var Pt=Fe,ad=Pt.ssh=Pt.ssh||{};ad.privateKeyToPutty=function(s,e,t){t=t||"",e=e||"";var r="ssh-rsa",a=e===""?"none":"aes256-cbc",n="PuTTY-User-Key-File-2: "+r+`\r
`;n+="Encryption: "+a+`\r
`,n+="Comment: "+t+`\r
`;var i=Pt.util.createBuffer();ql(i,r),As(i,s.e),As(i,s.n);var o=Pt.util.encode64(i.bytes(),64),l=Math.floor(o.length/66)+1;n+="Public-Lines: "+l+`\r
`,n+=o;var u=Pt.util.createBuffer();As(u,s.d),As(u,s.p),As(u,s.q),As(u,s.qInv);var c;if(!e)c=Pt.util.encode64(u.bytes(),64);else{var f=u.length()+16-1;f-=f%16;var g=lh(u.bytes());g.truncate(g.length()-f+u.length()),u.putBuffer(g);var v=Pt.util.createBuffer();v.putBuffer(lh("\0\0\0\0",e)),v.putBuffer(lh("\0\0\0",e));var p=Pt.aes.createEncryptionCipher(v.truncate(8),"CBC");p.start(Pt.util.createBuffer().fillWithByte(0,16)),p.update(u.copy()),p.finish();var h=p.output;h.truncate(16),c=Pt.util.encode64(h.bytes(),64)}l=Math.floor(c.length/66)+1,n+=`\r
Private-Lines: `+l+`\r
`,n+=c;var d=lh("putty-private-key-file-mac-key",e),y=Pt.util.createBuffer();ql(y,r),ql(y,a),ql(y,t),y.putInt32(i.length()),y.putBuffer(i),y.putInt32(u.length()),y.putBuffer(u);var E=Pt.hmac.create();return E.start("sha1",d),E.update(y.bytes()),n+=`\r
Private-MAC: `+E.digest().toHex()+`\r
`,n};ad.publicKeyToOpenSSH=function(s,e){var t="ssh-rsa";e=e||"";var r=Pt.util.createBuffer();return ql(r,t),As(r,s.e),As(r,s.n),t+" "+Pt.util.encode64(r.bytes())+" "+e};ad.privateKeyToOpenSSH=function(s,e){return e?Pt.pki.encryptRsaPrivateKey(s,e,{legacy:!0,algorithm:"aes128"}):Pt.pki.privateKeyToPem(s)};ad.getPublicKeyFingerprint=function(s,e){e=e||{};var t=e.md||Pt.md.md5.create(),r="ssh-rsa",a=Pt.util.createBuffer();ql(a,r),As(a,s.e),As(a,s.n),t.start(),t.update(a.getBytes());var n=t.digest();if(e.encoding==="hex"){var i=n.toHex();return e.delimiter?i.match(/.{2}/g).join(e.delimiter):i}else{if(e.encoding==="binary")return n.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return n};function As(s,e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=Pt.util.hexToBytes(t);s.putInt32(r.length),s.putBytes(r)}function ql(s,e){s.putInt32(e.length),s.putString(e)}function lh(){for(var s=Pt.md.sha1.create(),e=arguments.length,t=0;t<e;++t)s.update(arguments[t]);return s.digest()}(function(s){s.exports=Fe})(jp);const Cr=B1(jp.exports);/*!
 * MIT License
 * 
 * Copyright (c) 2017-2022 Peculiar Ventures, LLC
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */const vA="[object ArrayBuffer]";class Ee{static isArrayBuffer(e){return Object.prototype.toString.call(e)===vA}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength||e.byteOffset===0&&e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e.buffer).slice(e.byteOffset,e.byteOffset+e.byteLength).buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){const r=Ee.toUint8Array(e),a=Ee.toUint8Array(t);if(r.length!==a.byteLength)return!1;for(let n=0;n<r.length;n++)if(r[n]!==a[n])return!1;return!0}static concat(...e){let t;Array.isArray(e[0])&&!(e[1]instanceof Function)||Array.isArray(e[0])&&e[1]instanceof Function?t=e[0]:e[e.length-1]instanceof Function?t=e.slice(0,e.length-1):t=e;let r=0;for(const i of t)r+=i.byteLength;const a=new Uint8Array(r);let n=0;for(const i of t){const o=this.toUint8Array(i);a.set(o,n),n+=o.length}return e[e.length-1]instanceof Function?this.toView(a,e[e.length-1]):a.buffer}}const vd="string",wA=/^[0-9a-f]+$/i,SA=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,CA=/^[a-zA-Z0-9-_]+$/;class np{static fromString(e){const t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return r.buffer}static toString(e){const t=Ee.toUint8Array(e);let r="";for(let n=0;n<t.length;n++)r+=String.fromCharCode(t[n]);return decodeURIComponent(escape(r))}}class ys{static toString(e,t=!1){const r=Ee.toArrayBuffer(e),a=new DataView(r);let n="";for(let i=0;i<r.byteLength;i+=2){const o=a.getUint16(i,t);n+=String.fromCharCode(o)}return n}static fromString(e,t=!1){const r=new ArrayBuffer(e.length*2),a=new DataView(r);for(let n=0;n<e.length;n++)a.setUint16(n*2,e.charCodeAt(n),t);return r}}class ke{static isHex(e){return typeof e===vd&&wA.test(e)}static isBase64(e){return typeof e===vd&&SA.test(e)}static isBase64Url(e){return typeof e===vd&&CA.test(e)}static ToString(e,t="utf8"){const r=Ee.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(r);case"binary":return this.ToBinary(r);case"hex":return this.ToHex(r);case"base64":return this.ToBase64(r);case"base64url":return this.ToBase64Url(r);case"utf16le":return ys.toString(r,!0);case"utf16":case"utf16be":return ys.toString(r);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return ys.fromString(e,!0);case"utf16":case"utf16be":return ys.fromString(e);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){const t=Ee.toUint8Array(e);if(typeof btoa<"u"){const r=this.ToString(t,"binary");return btoa(r)}else return Buffer.from(t).toString("base64")}static FromBase64(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!ke.isBase64(t))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return typeof atob<"u"?this.FromBinary(atob(t)):new Uint8Array(Buffer.from(t,"base64")).buffer}static FromBase64Url(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!ke.isBase64Url(t))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=ke.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return np.fromString(e);case"utf16":case"utf16be":return ys.fromString(e);case"utf16le":case"usc2":return ys.fromString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=ke.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return np.toString(e);case"utf16":case"utf16be":return ys.toString(e);case"utf16le":case"usc2":return ys.toString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){const t=e.length,r=new Uint8Array(t);for(let a=0;a<t;a++)r[a]=e.charCodeAt(a);return r.buffer}static ToBinary(e){const t=Ee.toUint8Array(e);let r="";for(let a=0;a<t.length;a++)r+=String.fromCharCode(t[a]);return r}static ToHex(e){const t=Ee.toUint8Array(e);let r="";const a=t.length;for(let n=0;n<a;n++){const i=t[n];i<16&&(r+="0"),r+=i.toString(16)}return r}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!ke.isHex(t))throw new TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);const r=new Uint8Array(t.length/2);for(let a=0;a<t.length;a=a+2){const n=t.slice(a,a+2);r[a/2]=parseInt(n,16)}return r.buffer}static ToUtf16String(e,t=!1){return ys.toString(e,t)}static FromUtf16String(e,t=!1){return ys.fromString(e,t)}static Base64Padding(e){const t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return(e==null?void 0:e.replace(/[\n\r\t ]/g,""))||""}}ke.DEFAULT_UTF8_ENCODING="utf8";/*!
 Copyright (c) Peculiar Ventures, LLC
*/function m(s,e,t){var r;return s instanceof Object&&(r=s[e])!==null&&r!==void 0?r:t}function ip(s,e=0,t=s.byteLength-e,r=!1){let a="";for(const n of new Uint8Array(s,e,t)){const i=n.toString(16).toUpperCase();i.length===1&&(a+="0"),a+=i,r&&(a+=" ")}return a.trim()}function so(s,e){let t=0;if(s.length===1)return s[0];for(let r=s.length-1;r>=0;r--)t+=s[s.length-1-r]*Math.pow(2,e*r);return t}function ua(s,e,t=-1){const r=t;let a=s,n=0,i=Math.pow(2,e);for(let o=1;o<8;o++){if(s<i){let l;if(r<0)l=new ArrayBuffer(o),n=o;else{if(r<o)return new ArrayBuffer(0);l=new ArrayBuffer(r),n=r}const u=new Uint8Array(l);for(let c=o-1;c>=0;c--){const f=Math.pow(2,c*e);u[n-c-1]=Math.floor(a/f),a-=u[n-c-1]*f}return l}i*=Math.pow(2,e)}return new ArrayBuffer(0)}function jl(...s){let e=0,t=0;for(const n of s)e+=n.byteLength;const r=new ArrayBuffer(e),a=new Uint8Array(r);for(const n of s)a.set(new Uint8Array(n),t),t+=n.byteLength;return r}function dg(...s){let e=0,t=0;for(const n of s)e+=n.length;const r=new ArrayBuffer(e),a=new Uint8Array(r);for(const n of s)a.set(n,t),t+=n.length;return a}function Py(){const s=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const o=s[0]===255&&s[1]&128,l=s[0]===0&&(s[1]&128)===0;(o||l)&&this.warnings.push("Needlessly long format")}const e=new ArrayBuffer(this.valueHex.byteLength),t=new Uint8Array(e);for(let o=0;o<this.valueHex.byteLength;o++)t[o]=0;t[0]=s[0]&128;const r=so(t,8),a=new ArrayBuffer(this.valueHex.byteLength),n=new Uint8Array(a);for(let o=0;o<this.valueHex.byteLength;o++)n[o]=s[o];return n[0]&=127,so(n,8)-r}function AA(s){const e=s<0?s*-1:s;let t=128;for(let r=1;r<8;r++){if(e<=t){if(s<0){const i=t-e,o=ua(i,8,r),l=new Uint8Array(o);return l[0]|=128,o}let a=ua(e,8,r),n=new Uint8Array(a);if(n[0]&128){const i=a.slice(0),o=new Uint8Array(i);a=new ArrayBuffer(a.byteLength+1),n=new Uint8Array(a);for(let l=0;l<i.byteLength;l++)n[l+1]=o[l];n[0]=0}return a}t*=Math.pow(2,8)}return new ArrayBuffer(0)}function su(s,e){if(s.byteLength!==e.byteLength)return!1;const t=new Uint8Array(s),r=new Uint8Array(e);for(let a=0;a<t.length;a++)if(t[a]!==r[a])return!1;return!0}function _r(s,e){const t=s.toString(10);if(e<t.length)return"";const r=e-t.length,a=new Array(r);for(let i=0;i<r;i++)a[i]="0";return a.join("").concat(t)}const Uy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ky="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";function gg(s,e=!1,t=!1,r=!1){let a=0,n=0,i=0,o="";const l=e?Ky:Uy;if(r){let u=0;for(let c=0;c<s.length;c++)if(s.charCodeAt(c)!==0){u=c;break}s=s.slice(u)}for(;a<s.length;){const u=s.charCodeAt(a++);a>=s.length&&(n=1);const c=s.charCodeAt(a++);a>=s.length&&(i=1);const f=s.charCodeAt(a++),g=u>>2,v=(u&3)<<4|c>>4;let p=(c&15)<<2|f>>6,h=f&63;n===1?p=h=64:i===1&&(h=64),t?p===64?o+=`${l.charAt(g)}${l.charAt(v)}`:h===64?o+=`${l.charAt(g)}${l.charAt(v)}${l.charAt(p)}`:o+=`${l.charAt(g)}${l.charAt(v)}${l.charAt(p)}${l.charAt(h)}`:o+=`${l.charAt(g)}${l.charAt(v)}${l.charAt(p)}${l.charAt(h)}`}return o}function Pf(s,e=!1,t=!1){const r=e?Ky:Uy;function a(l){for(let u=0;u<64;u++)if(r.charAt(u)===l)return u;return 64}function n(l){return l===64?0:l}let i=0,o="";for(;i<s.length;){const l=a(s.charAt(i++)),u=i>=s.length?0:a(s.charAt(i++)),c=i>=s.length?0:a(s.charAt(i++)),f=i>=s.length?0:a(s.charAt(i++)),g=n(l)<<2|n(u)>>4,v=(n(u)&15)<<4|n(c)>>2,p=(n(c)&3)<<6|n(f);o+=String.fromCharCode(g),c!==64&&(o+=String.fromCharCode(v)),f!==64&&(o+=String.fromCharCode(p))}if(t){const l=o.length;let u=-1;for(let c=l-1;c>=0;c--)if(o.charCodeAt(c)!==0){u=c;break}u!==-1?o=o.slice(0,u+1):o=""}return o}function I0(s){let e="";const t=new Uint8Array(s);for(const r of t)e+=String.fromCharCode(r);return e}function au(s){const e=s.length,t=new ArrayBuffer(e),r=new Uint8Array(t);for(let a=0;a<e;a++)r[a]=s.charCodeAt(a);return t}const EA=Math.log(2);function bA(s){const e=Math.log(s)/EA,t=Math.floor(e),r=Math.round(e);return t===r?t:r}function W(s,e){for(const t of e)delete s[t]}/*!
 * Copyright (c) 2014, GMO GlobalSign
 * Copyright (c) 2015-2022, Peculiar Ventures
 * All rights reserved.
 * 
 * Author 2014-2019, Yury Strozhevsky
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * * Redistributions of source code must retain the above copyright notice, this
 *   list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice, this
 *   list of conditions and the following disclaimer in the documentation and/or
 *   other materials provided with the distribution.
 * 
 * * Neither the name of the copyright holder nor the names of its
 *   contributors may be used to endorse or promote products derived from
 *   this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 * 
 */function B0(){if(typeof BigInt>"u")throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function im(s){let e=0,t=0;for(let a=0;a<s.length;a++){const n=s[a];e+=n.byteLength}const r=new Uint8Array(e);for(let a=0;a<s.length;a++){const n=s[a];r.set(new Uint8Array(n),t),t+=n.byteLength}return r.buffer}function ca(s,e,t,r){return e instanceof Uint8Array?e.byteLength?t<0?(s.error="Wrong parameter: inputOffset less than zero",!1):r<0?(s.error="Wrong parameter: inputLength less than zero",!1):e.byteLength-t-r<0?(s.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):!0:(s.error="Wrong parameter: inputBuffer has zero length",!1):(s.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class om{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return im(this.items)}}const wu=[new Uint8Array([1])],op="0123456789",wd="name",lp="valueHexView",kA="isHexOnly",IA="idBlock",BA="tagClass",xA="tagNumber",NA="isConstructed",TA="fromBER",RA="toBER",VA="local",Er="",ms=new ArrayBuffer(0),nd=new Uint8Array(0),Uf="EndOfContent",My="OCTET STRING",Hy="BIT STRING";function fa(s){var e;return e=class extends s{constructor(...r){var a;super(...r);const n=r[0]||{};this.isHexOnly=(a=n.isHexOnly)!==null&&a!==void 0?a:!1,this.valueHexView=n.valueHex?Ee.toUint8Array(n.valueHex):nd}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(r){this.valueHexView=new Uint8Array(r)}fromBER(r,a,n){const i=r instanceof ArrayBuffer?new Uint8Array(r):r;if(!ca(this,i,a,n))return-1;const o=a+n;return this.valueHexView=i.subarray(a,o),this.valueHexView.length?(this.blockLength=n,o):(this.warnings.push("Zero buffer length"),a)}toBER(r=!1){return this.isHexOnly?r?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",ms)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:ke.ToHex(this.valueHexView)}}},e.NAME="hexBlock",e}class oo{constructor({blockLength:e=0,error:t=Er,warnings:r=[],valueBeforeDecode:a=nd}={}){this.blockLength=e,this.error=t,this.warnings=r,this.valueBeforeDecodeView=Ee.toUint8Array(a)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:ke.ToHex(this.valueBeforeDecodeView)}}}oo.NAME="baseBlock";class Br extends oo{fromBER(e,t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}Br.NAME="valueBlock";class Fy extends fa(oo){constructor({idBlock:e={}}={}){var t,r,a,n;super(),e?(this.isHexOnly=(t=e.isHexOnly)!==null&&t!==void 0?t:!1,this.valueHexView=e.valueHex?Ee.toUint8Array(e.valueHex):nd,this.tagClass=(r=e.tagClass)!==null&&r!==void 0?r:-1,this.tagNumber=(a=e.tagNumber)!==null&&a!==void 0?a:-1,this.isConstructed=(n=e.isConstructed)!==null&&n!==void 0?n:!1):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",ms}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){const a=new Uint8Array(1);if(!e){let n=this.tagNumber;n&=31,t|=n,a[0]=t}return a.buffer}if(!this.isHexOnly){const a=ua(this.tagNumber,7),n=new Uint8Array(a),i=a.byteLength,o=new Uint8Array(i+1);if(o[0]=t|31,!e){for(let l=0;l<i-1;l++)o[l+1]=n[l]|128;o[i]=n[i-1]}return o.buffer}const r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=t|31,!e){const a=this.valueHexView;for(let n=0;n<a.length-1;n++)r[n+1]=a[n]|128;r[this.valueHexView.byteLength]=a[a.length-1]}return r.buffer}fromBER(e,t,r){const a=Ee.toUint8Array(e);if(!ca(this,a,t,r))return-1;const n=a.subarray(t,t+r);if(n.length===0)return this.error="Zero buffer length",-1;switch(n[0]&192){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(n[0]&32)===32,this.isHexOnly=!1;const o=n[0]&31;if(o!==31)this.tagNumber=o,this.blockLength=1;else{let l=1,u=this.valueHexView=new Uint8Array(255),c=255;for(;n[l]&128;){if(u[l-1]=n[l]&127,l++,l>=n.length)return this.error="End of input reached before message was fully decoded",-1;if(l===c){c+=255;const g=new Uint8Array(c);for(let v=0;v<u.length;v++)g[v]=u[v];u=this.valueHexView=new Uint8Array(c)}}this.blockLength=l+1,u[l-1]=n[l]&127;const f=new Uint8Array(l);for(let g=0;g<l;g++)f[g]=u[g];u=this.valueHexView=new Uint8Array(l),u.set(f),this.blockLength<=9?this.tagNumber=so(u,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(this.tagClass===1&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}Fy.NAME="identificationBlock";class qy extends oo{constructor({lenBlock:e={}}={}){var t,r,a;super(),this.isIndefiniteForm=(t=e.isIndefiniteForm)!==null&&t!==void 0?t:!1,this.longFormUsed=(r=e.longFormUsed)!==null&&r!==void 0?r:!1,this.length=(a=e.length)!==null&&a!==void 0?a:0}fromBER(e,t,r){const a=Ee.toUint8Array(e);if(!ca(this,a,t,r))return-1;const n=a.subarray(t,t+r);if(n.length===0)return this.error="Zero buffer length",-1;if(n[0]===255)return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=n[0]===128,this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(n[0]&128),this.longFormUsed===!1)return this.length=n[0],this.blockLength=1,t+this.blockLength;const i=n[0]&127;if(i>8)return this.error="Too big integer",-1;if(i+1>n.length)return this.error="End of input reached before message was fully decoded",-1;const o=t+1,l=a.subarray(o,o+i);return l[i-1]===0&&this.warnings.push("Needlessly long encoded length"),this.length=so(l,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=i+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),e===!1&&(r=new Uint8Array(t),r[0]=128),t;if(this.longFormUsed){const a=ua(this.length,8);if(a.byteLength>127)return this.error="Too big length",ms;if(t=new ArrayBuffer(a.byteLength+1),e)return t;const n=new Uint8Array(a);r=new Uint8Array(t),r[0]=a.byteLength|128;for(let i=0;i<a.byteLength;i++)r[i+1]=n[i];return t}return t=new ArrayBuffer(1),e===!1&&(r=new Uint8Array(t),r[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}qy.NAME="lengthBlock";const ge={};class Sr extends oo{constructor({name:e=Er,optional:t=!1,primitiveSchema:r,...a}={},n){super(a),this.name=e,this.optional=t,r&&(this.primitiveSchema=r),this.idBlock=new Fy(a),this.lenBlock=new qy(a),this.valueBlock=n?new n(a):new Br(a)}fromBER(e,t,r){const a=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return a===-1?(this.error=this.valueBlock.error,a):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),a)}toBER(e,t){const r=t||new om;t||Jy(this);const a=this.idBlock.toBER(e);if(r.write(a),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{const n=this.valueBlock.toBER(e);this.lenBlock.length=n.byteLength;const i=this.lenBlock.toBER(e);r.write(i),r.write(n)}return t?ms:r.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return e==="ascii"?this.onAsciiEncoding():ke.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${ke.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;const t=this.toBER(),r=e.toBER();return su(t,r)}}Sr.NAME="BaseBlock";function Jy(s){if(s instanceof ge.Constructed)for(const e of s.valueBlock.value)Jy(e)&&(s.lenBlock.isIndefiniteForm=!0);return!!s.lenBlock.isIndefiniteForm}class Gy extends Sr{constructor({value:e=Er,...t}={},r){super(t,r),e&&this.fromString(e)}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}fromBER(e,t,r){const a=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return a===-1?(this.error=this.valueBlock.error,a):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),a)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}Gy.NAME="BaseStringBlock";class jy extends fa(Br){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}jy.NAME="PrimitiveValueBlock";var Wy;class Ie extends Sr{constructor(e={}){super(e,jy),this.idBlock.isConstructed=!1}}Wy=Ie;ge.Primitive=Wy;Ie.NAME="PRIMITIVE";function _A(s,e){if(s instanceof e)return s;const t=new e;return t.idBlock=s.idBlock,t.lenBlock=s.lenBlock,t.warnings=s.warnings,t.valueBeforeDecodeView=s.valueBeforeDecodeView,t}function rh(s,e=0,t=s.length){const r=e;let a=new Sr({},Br);const n=new oo;if(!ca(n,s,e,t))return a.error=n.error,{offset:-1,result:a};if(!s.subarray(e,e+t).length)return a.error="Zero buffer length",{offset:-1,result:a};let o=a.idBlock.fromBER(s,e,t);if(a.idBlock.warnings.length&&a.warnings.concat(a.idBlock.warnings),o===-1)return a.error=a.idBlock.error,{offset:-1,result:a};if(e=o,t-=a.idBlock.blockLength,o=a.lenBlock.fromBER(s,e,t),a.lenBlock.warnings.length&&a.warnings.concat(a.lenBlock.warnings),o===-1)return a.error=a.lenBlock.error,{offset:-1,result:a};if(e=o,t-=a.lenBlock.blockLength,!a.idBlock.isConstructed&&a.lenBlock.isIndefiniteForm)return a.error="Indefinite length form used for primitive encoding form",{offset:-1,result:a};let l=Sr;switch(a.idBlock.tagClass){case 1:if(a.idBlock.tagNumber>=37&&a.idBlock.isHexOnly===!1)return a.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:a};switch(a.idBlock.tagNumber){case 0:if(a.idBlock.isConstructed&&a.lenBlock.length>0)return a.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:a};l=ge.EndOfContent;break;case 1:l=ge.Boolean;break;case 2:l=ge.Integer;break;case 3:l=ge.BitString;break;case 4:l=ge.OctetString;break;case 5:l=ge.Null;break;case 6:l=ge.ObjectIdentifier;break;case 10:l=ge.Enumerated;break;case 12:l=ge.Utf8String;break;case 13:l=ge.RelativeObjectIdentifier;break;case 14:l=ge.TIME;break;case 15:return a.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:a};case 16:l=ge.Sequence;break;case 17:l=ge.Set;break;case 18:l=ge.NumericString;break;case 19:l=ge.PrintableString;break;case 20:l=ge.TeletexString;break;case 21:l=ge.VideotexString;break;case 22:l=ge.IA5String;break;case 23:l=ge.UTCTime;break;case 24:l=ge.GeneralizedTime;break;case 25:l=ge.GraphicString;break;case 26:l=ge.VisibleString;break;case 27:l=ge.GeneralString;break;case 28:l=ge.UniversalString;break;case 29:l=ge.CharacterString;break;case 30:l=ge.BmpString;break;case 31:l=ge.DATE;break;case 32:l=ge.TimeOfDay;break;case 33:l=ge.DateTime;break;case 34:l=ge.Duration;break;default:{const u=a.idBlock.isConstructed?new ge.Constructed:new ge.Primitive;u.idBlock=a.idBlock,u.lenBlock=a.lenBlock,u.warnings=a.warnings,a=u}}break;case 2:case 3:case 4:default:l=a.idBlock.isConstructed?ge.Constructed:ge.Primitive}return a=_A(a,l),o=a.fromBER(s,e,a.lenBlock.isIndefiniteForm?t:a.lenBlock.length),a.valueBeforeDecodeView=s.subarray(r,r+a.blockLength),{offset:o,result:a}}function _t(s){if(!s.byteLength){const e=new Sr({},Br);return e.error="Input buffer has zero length",{offset:-1,result:e}}return rh(Ee.toUint8Array(s).slice(),0,s.byteLength)}function $A(s,e){return s?1:e}class wn extends Br{constructor({value:e=[],isIndefiniteForm:t=!1,...r}={}){super(r),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,r){const a=Ee.toUint8Array(e);if(!ca(this,a,t,r))return-1;if(this.valueBeforeDecodeView=a.subarray(t,t+r),this.valueBeforeDecodeView.length===0)return this.warnings.push("Zero buffer length"),t;let n=t;for(;$A(this.isIndefiniteForm,r)>0;){const i=rh(a,n,r);if(i.offset===-1)return this.error=i.result.error,this.warnings.concat(i.result.warnings),-1;if(n=i.offset,this.blockLength+=i.result.blockLength,r-=i.result.blockLength,this.value.push(i.result),this.isIndefiniteForm&&i.result.constructor.NAME===Uf)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===Uf?this.value.pop():this.warnings.push("No EndOfContent block encoded")),n}toBER(e,t){const r=t||new om;for(let a=0;a<this.value.length;a++)this.value[a].toBER(e,r);return t?ms:r.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const t of this.value)e.value.push(t.toJSON());return e}}wn.NAME="ConstructedValueBlock";var Qy;class N extends Sr{constructor(e={}){super(e,wn),this.idBlock.isConstructed=!0}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const a=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return a===-1?(this.error=this.valueBlock.error,a):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),a)}onAsciiEncoding(){const e=[];for(const r of this.valueBlock.value)e.push(r.toString("ascii").split(`
`).map(a=>`  ${a}`).join(`
`));const t=this.idBlock.tagClass===3?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :
${e.join(`
`)}`:`${t} :`}}Qy=N;ge.Constructed=Qy;N.NAME="CONSTRUCTED";class Yy extends Br{fromBER(e,t,r){return t}toBER(e){return ms}}Yy.override="EndOfContentValueBlock";var zy;class Xy extends Sr{constructor(e={}){super(e,Yy),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}zy=Xy;ge.EndOfContent=zy;Xy.NAME=Uf;var Zy;class It extends Sr{constructor(e={}){super(e,Br),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e,t){const r=new ArrayBuffer(2);if(!e){const a=new Uint8Array(r);a[0]=5,a[1]=0}return t&&t.write(r),r}onAsciiEncoding(){return`${this.constructor.NAME}`}}Zy=It;ge.Null=Zy;It.NAME="NULL";class ev extends fa(Br){constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=Ee.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}fromBER(e,t,r){const a=Ee.toUint8Array(e);return ca(this,a,t,r)?(this.valueHexView=a.subarray(t,t+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,Py.call(this),this.blockLength=r,t+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}ev.NAME="BooleanValueBlock";var tv;class _s extends Sr{constructor(e={}){super(e,ev),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}tv=_s;ge.Boolean=tv;_s.NAME="BOOLEAN";class rv extends fa(wn){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,r){let a=0;if(this.isConstructed){if(this.isHexOnly=!1,a=wn.prototype.fromBER.call(this,e,t,r),a===-1)return a;for(let n=0;n<this.value.length;n++){const i=this.value[n].constructor.NAME;if(i===Uf){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(i!==My)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,a=super.fromBER(e,t,r),this.blockLength=r;return a}toBER(e,t){return this.isConstructed?wn.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}rv.NAME="OctetStringValueBlock";var sv;class z extends Sr{constructor({idBlock:e={},lenBlock:t={},...r}={}){var a,n;(a=r.isConstructed)!==null&&a!==void 0||(r.isConstructed=!!(!((n=r.value)===null||n===void 0)&&n.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},rv),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,r===0)return this.idBlock.error.length===0&&(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length===0&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const n=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+r);try{if(n.byteLength){const i=rh(n,0,n.byteLength);i.offset!==-1&&i.offset===r&&(this.valueBlock.value=[i.result])}}catch{}}return super.fromBER(e,t,r)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?N.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${ke.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const e=[];for(const t of this.valueBlock.value)t instanceof z&&e.push(t.valueBlock.valueHexView);return Ee.concat(e)}}sv=z;ge.OctetString=sv;z.NAME=My;class av extends fa(wn){constructor({unusedBits:e=0,isConstructed:t=!1,...r}={}){super(r),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,r){if(!r)return t;let a=-1;if(this.isConstructed){if(a=wn.prototype.fromBER.call(this,e,t,r),a===-1)return a;for(const o of this.value){const l=o.constructor.NAME;if(l===Uf){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(l!==Hy)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const u=o.valueBlock;if(this.unusedBits>0&&u.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=u.unusedBits}return a}const n=Ee.toUint8Array(e);if(!ca(this,n,t,r))return-1;const i=n.subarray(t,t+r);if(this.unusedBits=i[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const o=i.subarray(1);try{if(o.byteLength){const l=rh(o,0,o.byteLength);l.offset!==-1&&l.offset===r-1&&(this.value=[l.result])}}catch{}}return this.valueHexView=i.subarray(1),this.blockLength=i.length,t+r}toBER(e,t){if(this.isConstructed)return wn.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return ms;const r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}av.NAME="BitStringValueBlock";var nv;class He extends Sr{constructor({idBlock:e={},lenBlock:t={},...r}={}){var a,n;(a=r.isConstructed)!==null&&a!==void 0||(r.isConstructed=!!(!((n=r.value)===null||n===void 0)&&n.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},av),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return N.prototype.onAsciiEncoding.call(this);{const e=[],t=this.valueBlock.valueHexView;for(const a of t)e.push(a.toString(2).padStart(8,"0"));const r=e.join("");return`${this.constructor.NAME} : ${r.substring(0,r.length-this.valueBlock.unusedBits)}`}}}nv=He;ge.BitString=nv;He.NAME=Hy;var iv;function DA(s,e){const t=new Uint8Array([0]),r=new Uint8Array(s),a=new Uint8Array(e);let n=r.slice(0);const i=n.length-1,o=a.slice(0),l=o.length-1;let u=0;const c=l<i?i:l;let f=0;for(let g=c;g>=0;g--,f++){switch(!0){case f<o.length:u=n[i-f]+o[l-f]+t[0];break;default:u=n[i-f]+t[0]}switch(t[0]=u/10,!0){case f>=n.length:n=dg(new Uint8Array([u%10]),n);break;default:n[i-f]=u%10}}return t[0]>0&&(n=dg(t,n)),n}function up(s){if(s>=wu.length)for(let e=wu.length;e<=s;e++){const t=new Uint8Array([0]);let r=wu[e-1].slice(0);for(let a=r.length-1;a>=0;a--){const n=new Uint8Array([(r[a]<<1)+t[0]]);t[0]=n[0]/10,r[a]=n[0]%10}t[0]>0&&(r=dg(t,r)),wu.push(r)}return wu[s]}function LA(s,e){let t=0;const r=new Uint8Array(s),a=new Uint8Array(e),n=r.slice(0),i=n.length-1,o=a.slice(0),l=o.length-1;let u,c=0;for(let f=l;f>=0;f--,c++)switch(u=n[i-c]-o[l-c]-t,!0){case u<0:t=1,n[i-c]=u+10;break;default:t=0,n[i-c]=u}if(t>0)for(let f=i-l+1;f>=0;f--,c++)if(u=n[i-c]-t,u<0)t=1,n[i-c]=u+10;else{t=0,n[i-c]=u;break}return n.slice()}class lm extends fa(Br){constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),e!==void 0&&(this.valueDec=e)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=Py.call(this)))}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(AA(e))}get valueDec(){return this._valueDec}fromDER(e,t,r,a=0){const n=this.fromBER(e,t,r);if(n===-1)return n;const i=this.valueHexView;return i[0]===0&&(i[1]&128)!==0?this.valueHexView=i.subarray(1):a!==0&&i.length<a&&(a-i.length>1&&(a=i.length+1),this.valueHexView=i.subarray(a-i.length)),n}toDER(e=!1){const t=this.valueHexView;switch(!0){case(t[0]&128)!==0:{const r=new Uint8Array(this.valueHexView.length+1);r[0]=0,r.set(t,1),this.valueHexView=r}break;case(t[0]===0&&(t[1]&128)===0):this.valueHexView=this.valueHexView.subarray(1);break}return this.toBER(e)}fromBER(e,t,r){const a=super.fromBER(e,t,r);return a===-1||this.setValueHex(),a}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const e=this.valueHexView.length*8-1;let t=new Uint8Array(this.valueHexView.length*8/3),r=0,a;const n=this.valueHexView;let i="",o=!1;for(let l=n.byteLength-1;l>=0;l--){a=n[l];for(let u=0;u<8;u++){if((a&1)===1)switch(r){case e:t=LA(up(r),t),i="-";break;default:t=DA(t,up(r))}r++,a>>=1}}for(let l=0;l<t.length;l++)t[l]&&(o=!0),o&&(i+=op.charAt(t[l]));return o===!1&&(i+=op.charAt(0)),i}}iv=lm;lm.NAME="IntegerValueBlock";Object.defineProperty(iv.prototype,"valueHex",{set:function(s){this.valueHexView=new Uint8Array(s),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});var ov;class _ extends Sr{constructor(e={}){super(e,lm),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return B0(),BigInt(this.valueBlock.toString())}static fromBigInt(e){B0();const t=BigInt(e),r=new om,a=t.toString(16).replace(/^-/,""),n=new Uint8Array(ke.FromHex(a));if(t<0){const o=new Uint8Array(n.length+(n[0]&128?1:0));o[0]|=128;const u=BigInt(`0x${ke.ToHex(o)}`)+t,c=Ee.toUint8Array(ke.FromHex(u.toString(16)));c[0]|=128,r.write(c)}else n[0]&128&&r.write(new Uint8Array([0])),r.write(n);return new _({valueHex:r.final()})}convertToDER(){const e=new _({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new _({valueHex:this.valueBlock.valueHexView[0]===0?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}ov=_;ge.Integer=ov;_.NAME="INTEGER";var lv;class ao extends _{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}lv=ao;ge.Enumerated=lv;ao.NAME="ENUMERATED";class mg extends fa(Br){constructor({valueDec:e=-1,isFirstSid:t=!1,...r}={}){super(r),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,r){if(!r)return t;const a=Ee.toUint8Array(e);if(!ca(this,a,t,r))return-1;const n=a.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let o=0;o<r&&(this.valueHexView[o]=n[o]&127,this.blockLength++,(n[o]&128)!==0);o++);const i=new Uint8Array(this.blockLength);for(let o=0;o<this.blockLength;o++)i[o]=this.valueHexView[o];return this.valueHexView=i,(n[this.blockLength-1]&128)!==0?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=so(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){B0();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const r=new Uint8Array(t.length/7);for(let a=0;a<r.length;a++)r[a]=parseInt(t.slice(a*7,a*7+7),2)+(a+1<r.length?128:0);this.fromBER(r.buffer,0,r.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const a=this.valueHexView,n=new Uint8Array(this.blockLength);for(let i=0;i<this.blockLength-1;i++)n[i]=a[i]|128;return n[this.blockLength-1]=a[this.blockLength-1],n.buffer}const t=ua(this.valueDec,7);if(t.byteLength===0)return this.error="Error during encoding SID value",ms;const r=new Uint8Array(t.byteLength);if(!e){const a=new Uint8Array(t),n=t.byteLength-1;for(let i=0;i<n;i++)r[i]=a[i]|128;r[n]=a[n]}return r}toString(){let e="";if(this.isHexOnly)e=ke.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}mg.NAME="sidBlock";class uv extends Br{constructor({value:e=Er,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let a=t;for(;r>0;){const n=new mg;if(a=n.fromBER(e,a,r),a===-1)return this.blockLength=0,this.error=n.error,a;this.value.length===0&&(n.isFirstSid=!0),this.blockLength+=n.blockLength,r-=n.blockLength,this.value.push(n)}return a}toBER(e){const t=[];for(let r=0;r<this.value.length;r++){const a=this.value[r].toBER(e);if(a.byteLength===0)return this.error=this.value[r].error,ms;t.push(a)}return im(t)}fromString(e){this.value=[];let t=0,r=0,a="",n=!1;do if(r=e.indexOf(".",t),r===-1?a=e.substring(t):a=e.substring(t,r),t=r+1,n){const i=this.value[0];let o=0;switch(i.valueDec){case 0:break;case 1:o=40;break;case 2:o=80;break;default:this.value=[];return}const l=parseInt(a,10);if(isNaN(l))return;i.valueDec=l+o,n=!1}else{const i=new mg;if(a>Number.MAX_SAFE_INTEGER){B0();const o=BigInt(a);i.valueBigInt=o}else if(i.valueDec=parseInt(a,10),isNaN(i.valueDec))return;this.value.length||(i.isFirstSid=!0,n=!0),this.value.push(i)}while(r!==-1)}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let a=this.value[r].toString();r!==0&&(e=`${e}.`),t?(a=`{${a}}`,this.value[r].isFirstSid?e=`2.{${a} - 80}`:e+=a):e+=a}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}uv.NAME="ObjectIdentifierValueBlock";var cv;class he extends Sr{constructor(e={}){super(e,uv),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}cv=he;ge.ObjectIdentifier=cv;he.NAME="OBJECT IDENTIFIER";class pg extends fa(oo){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,r){if(r===0)return t;const a=Ee.toUint8Array(e);if(!ca(this,a,t,r))return-1;const n=a.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let o=0;o<r&&(this.valueHexView[o]=n[o]&127,this.blockLength++,(n[o]&128)!==0);o++);const i=new Uint8Array(this.blockLength);for(let o=0;o<this.blockLength;o++)i[o]=this.valueHexView[o];return this.valueHexView=i,(n[this.blockLength-1]&128)!==0?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=so(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const a=this.valueHexView,n=new Uint8Array(this.blockLength);for(let i=0;i<this.blockLength-1;i++)n[i]=a[i]|128;return n[this.blockLength-1]=a[this.blockLength-1],n.buffer}const t=ua(this.valueDec,7);if(t.byteLength===0)return this.error="Error during encoding SID value",ms;const r=new Uint8Array(t.byteLength);if(!e){const a=new Uint8Array(t),n=t.byteLength-1;for(let i=0;i<n;i++)r[i]=a[i]|128;r[n]=a[n]}return r.buffer}toString(){let e="";return this.isHexOnly?e=ke.ToHex(this.valueHexView):e=this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}pg.NAME="relativeSidBlock";class fv extends Br{constructor({value:e=Er,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let a=t;for(;r>0;){const n=new pg;if(a=n.fromBER(e,a,r),a===-1)return this.blockLength=0,this.error=n.error,a;this.blockLength+=n.blockLength,r-=n.blockLength,this.value.push(n)}return a}toBER(e,t){const r=[];for(let a=0;a<this.value.length;a++){const n=this.value[a].toBER(e);if(n.byteLength===0)return this.error=this.value[a].error,ms;r.push(n)}return im(r)}fromString(e){this.value=[];let t=0,r=0,a="";do{r=e.indexOf(".",t),r===-1?a=e.substring(t):a=e.substring(t,r),t=r+1;const n=new pg;if(n.valueDec=parseInt(a,10),isNaN(n.valueDec))return!0;this.value.push(n)}while(r!==-1);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let a=this.value[r].toString();r!==0&&(e=`${e}.`),t&&(a=`{${a}}`),e+=a}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}fv.NAME="RelativeObjectIdentifierValueBlock";var hv;class dv extends Sr{constructor(e={}){super(e,fv),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}hv=dv;ge.RelativeObjectIdentifier=hv;dv.NAME="RelativeObjectIdentifier";var gv;class b extends N{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}gv=b;ge.Sequence=gv;b.NAME="SEQUENCE";var mv;class Bt extends N{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}mv=Bt;ge.Set=mv;Bt.NAME="SET";class pv extends fa(Br){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=Er}toJSON(){return{...super.toJSON(),value:this.value}}}pv.NAME="StringValueBlock";class yv extends pv{}yv.NAME="SimpleStringValueBlock";class Ur extends Gy{constructor({...e}={}){super(e,yv)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,Ee.toUint8Array(e))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t);for(let a=0;a<t;a++)r[a]=e.charCodeAt(a);this.valueBlock.value=e}}Ur.NAME="SIMPLE STRING";class vv extends Ur{fromBuffer(e){this.valueBlock.valueHexView=Ee.toUint8Array(e);try{this.valueBlock.value=ke.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=ke.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(ke.FromUtf8String(e)),this.valueBlock.value=e}}vv.NAME="Utf8StringValueBlock";var wv;class gs extends vv{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}wv=gs;ge.Utf8String=wv;gs.NAME="UTF8String";class Sv extends Ur{fromBuffer(e){this.valueBlock.value=ke.ToUtf16String(e),this.valueBlock.valueHexView=Ee.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(ke.FromUtf16String(e))}}Sv.NAME="BmpStringValueBlock";var Cv;class Kf extends Sv{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}Cv=Kf;ge.BmpString=Cv;Kf.NAME="BMPString";class Av extends Ur{fromBuffer(e){const t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),r=new Uint8Array(t);for(let a=0;a<r.length;a+=4)r[a]=r[a+3],r[a+1]=r[a+2],r[a+2]=0,r[a+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t*4);for(let a=0;a<t;a++){const n=ua(e.charCodeAt(a),8),i=new Uint8Array(n);if(i.length>4)continue;const o=4-i.length;for(let l=i.length-1;l>=0;l--)r[a*4+l+o]=i[l]}this.valueBlock.value=e}}Av.NAME="UniversalStringValueBlock";var Ev;class Mf extends Av{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}Ev=Mf;ge.UniversalString=Ev;Mf.NAME="UniversalString";var bv;class Wl extends Ur{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}bv=Wl;ge.NumericString=bv;Wl.NAME="NumericString";var kv;class fs extends Ur{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}kv=fs;ge.PrintableString=kv;fs.NAME="PrintableString";var Iv;class Hf extends Ur{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}Iv=Hf;ge.TeletexString=Iv;Hf.NAME="TeletexString";var Bv;class um extends Ur{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}Bv=um;ge.VideotexString=Bv;um.NAME="VideotexString";var xv;class id extends Ur{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}xv=id;ge.IA5String=xv;id.NAME="IA5String";var Nv;class cm extends Ur{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}Nv=cm;ge.GraphicString=Nv;cm.NAME="GraphicString";var Tv;class od extends Ur{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}Tv=od;ge.VisibleString=Tv;od.NAME="VisibleString";var Rv;class fm extends Ur{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}Rv=fm;ge.GeneralString=Rv;fm.NAME="GeneralString";var Vv;class hm extends Ur{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}Vv=hm;ge.CharacterString=Vv;hm.NAME="CharacterString";var _v;class nu extends od{constructor({value:e,valueDate:t,...r}={}){if(super(r),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let a=0;a<e.length;a++)this.valueBlock.valueHexView[a]=e.charCodeAt(a)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,Ee.toUint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let a=0;a<e.length;a++)r[a]=e.charCodeAt(a);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const r=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(e);if(r===null){this.error="Wrong input string for conversion";return}const a=parseInt(r[1],10);a>=50?this.year=1900+a:this.year=2e3+a,this.month=parseInt(r[2],10),this.day=parseInt(r[3],10),this.hour=parseInt(r[4],10),this.minute=parseInt(r[5],10),this.second=parseInt(r[6],10)}toString(e="iso"){if(e==="iso"){const t=new Array(7);return t[0]=_r(this.year<2e3?this.year-1900:this.year-2e3,2),t[1]=_r(this.month,2),t[2]=_r(this.day,2),t[3]=_r(this.hour,2),t[4]=_r(this.minute,2),t[5]=_r(this.second,2),t[6]="Z",t.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}_v=nu;ge.UTCTime=_v;nu.NAME="UTCTime";var $v;class vt extends nu{constructor(e={}){var t;super(e),(t=this.millisecond)!==null&&t!==void 0||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t=!1,r="",a="",n=0,i,o=0,l=0;if(e[e.length-1]==="Z")r=e.substring(0,e.length-1),t=!0;else{const f=new Number(e[e.length-1]);if(isNaN(f.valueOf()))throw new Error("Wrong input string for conversion");r=e}if(t){if(r.indexOf("+")!==-1)throw new Error("Wrong input string for conversion");if(r.indexOf("-")!==-1)throw new Error("Wrong input string for conversion")}else{let f=1,g=r.indexOf("+"),v="";if(g===-1&&(g=r.indexOf("-"),f=-1),g!==-1){if(v=r.substring(g+1),r=r.substring(0,g),v.length!==2&&v.length!==4)throw new Error("Wrong input string for conversion");let p=parseInt(v.substring(0,2),10);if(isNaN(p.valueOf()))throw new Error("Wrong input string for conversion");if(o=f*p,v.length===4){if(p=parseInt(v.substring(2,4),10),isNaN(p.valueOf()))throw new Error("Wrong input string for conversion");l=f*p}}}let u=r.indexOf(".");if(u===-1&&(u=r.indexOf(",")),u!==-1){const f=new Number(`0${r.substring(u)}`);if(isNaN(f.valueOf()))throw new Error("Wrong input string for conversion");n=f.valueOf(),a=r.substring(0,u)}else a=r;switch(!0){case a.length===8:if(i=/(\d{4})(\d{2})(\d{2})/ig,u!==-1)throw new Error("Wrong input string for conversion");break;case a.length===10:if(i=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,u!==-1){let f=60*n;this.minute=Math.floor(f),f=60*(f-this.minute),this.second=Math.floor(f),f=1e3*(f-this.second),this.millisecond=Math.floor(f)}break;case a.length===12:if(i=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,u!==-1){let f=60*n;this.second=Math.floor(f),f=1e3*(f-this.second),this.millisecond=Math.floor(f)}break;case a.length===14:if(i=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,u!==-1){const f=1e3*n;this.millisecond=Math.floor(f)}break;default:throw new Error("Wrong input string for conversion")}const c=i.exec(a);if(c===null)throw new Error("Wrong input string for conversion");for(let f=1;f<c.length;f++)switch(f){case 1:this.year=parseInt(c[f],10);break;case 2:this.month=parseInt(c[f],10);break;case 3:this.day=parseInt(c[f],10);break;case 4:this.hour=parseInt(c[f],10)+o;break;case 5:this.minute=parseInt(c[f],10)+l;break;case 6:this.second=parseInt(c[f],10);break;default:throw new Error("Wrong input string for conversion")}if(t===!1){const f=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=f.getUTCFullYear(),this.month=f.getUTCMonth(),this.day=f.getUTCDay(),this.hour=f.getUTCHours(),this.minute=f.getUTCMinutes(),this.second=f.getUTCSeconds(),this.millisecond=f.getUTCMilliseconds()}}toString(e="iso"){if(e==="iso"){const t=[];return t.push(_r(this.year,4)),t.push(_r(this.month,2)),t.push(_r(this.day,2)),t.push(_r(this.hour,2)),t.push(_r(this.minute,2)),t.push(_r(this.second,2)),this.millisecond!==0&&(t.push("."),t.push(_r(this.millisecond,3))),t.push("Z"),t.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}$v=vt;ge.GeneralizedTime=$v;vt.NAME="GeneralizedTime";var Dv;class Lv extends gs{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}Dv=Lv;ge.DATE=Dv;Lv.NAME="DATE";var Ov;class Pv extends gs{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}Ov=Pv;ge.TimeOfDay=Ov;Pv.NAME="TimeOfDay";var Uv;class Kv extends gs{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}Uv=Kv;ge.DateTime=Uv;Kv.NAME="DateTime";var Mv;class Hv extends gs{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}Mv=Hv;ge.Duration=Mv;Hv.NAME="Duration";var Fv;class qv extends gs{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}Fv=qv;ge.TIME=Fv;qv.NAME="TIME";class xe{constructor({name:e=Er,optional:t=!1}={}){this.name=e,this.optional=t}}class wt extends xe{constructor({value:e=[],...t}={}){super(t),this.value=e}}class _e extends xe{constructor({value:e=new xe,local:t=!1,...r}={}){super(r),this.value=e,this.local=t}}class x0{constructor({data:e=nd}={}){this.dataView=Ee.toUint8Array(e)}get data(){return this.dataView.slice().buffer}set data(e){this.dataView=Ee.toUint8Array(e)}fromBER(e,t,r){const a=t+r;return this.dataView=Ee.toUint8Array(e).subarray(t,a),a}toBER(e){return this.dataView.slice().buffer}}function j(s,e,t){if(t instanceof wt){for(let n=0;n<t.value.length;n++)if(j(s,e,t.value[n]).verified)return{verified:!0,result:s};{const n={verified:!1,result:{error:"Wrong values for Choice type"}};return t.hasOwnProperty(wd)&&(n.name=t.name),n}}if(t instanceof xe)return t.hasOwnProperty(wd)&&(s[t.name]=e),{verified:!0,result:s};if(!(s instanceof Object))return{verified:!1,result:{error:"Wrong root object"}};if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(!(t instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(IA in t))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(TA in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(RA in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const r=t.idBlock.toBER(!1);if(r.byteLength===0)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(t.idBlock.fromBER(r,0,r.byteLength)===-1)return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(t.idBlock.hasOwnProperty(BA)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.tagClass!==e.idBlock.tagClass)return{verified:!1,result:s};if(t.idBlock.hasOwnProperty(xA)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.tagNumber!==e.idBlock.tagNumber)return{verified:!1,result:s};if(t.idBlock.hasOwnProperty(NA)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.isConstructed!==e.idBlock.isConstructed)return{verified:!1,result:s};if(!(kA in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.isHexOnly!==e.idBlock.isHexOnly)return{verified:!1,result:s};if(t.idBlock.isHexOnly){if(!(lp in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=t.idBlock.valueHexView,i=e.idBlock.valueHexView;if(n.length!==i.length)return{verified:!1,result:s};for(let o=0;o<n.length;o++)if(n[o]!==i[1])return{verified:!1,result:s}}if(t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,Er),t.name&&(s[t.name]=e)),t instanceof ge.Constructed){let n=0,i={verified:!1,result:{error:"Unknown error"}},o=t.valueBlock.value.length;if(o>0&&t.valueBlock.value[0]instanceof _e&&(o=e.valueBlock.value.length),o===0)return{verified:!0,result:s};if(e.valueBlock.value.length===0&&t.valueBlock.value.length!==0){let l=!0;for(let u=0;u<t.valueBlock.value.length;u++)l=l&&(t.valueBlock.value[u].optional||!1);return l?{verified:!0,result:s}:(t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,Er),t.name&&delete s[t.name]),s.error="Inconsistent object length",{verified:!1,result:s})}for(let l=0;l<o;l++)if(l-n>=e.valueBlock.value.length){if(t.valueBlock.value[l].optional===!1){const u={verified:!1,result:s};return s.error="Inconsistent length between ASN.1 data and schema",t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,Er),t.name&&(delete s[t.name],u.name=t.name)),u}}else if(t.valueBlock.value[0]instanceof _e){if(i=j(s,e.valueBlock.value[l],t.valueBlock.value[0].value),i.verified===!1)if(t.valueBlock.value[0].optional)n++;else return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,Er),t.name&&delete s[t.name]),i;if(wd in t.valueBlock.value[0]&&t.valueBlock.value[0].name.length>0){let u={};VA in t.valueBlock.value[0]&&t.valueBlock.value[0].local?u=e:u=s,typeof u[t.valueBlock.value[0].name]>"u"&&(u[t.valueBlock.value[0].name]=[]),u[t.valueBlock.value[0].name].push(e.valueBlock.value[l])}}else if(i=j(s,e.valueBlock.value[l-n],t.valueBlock.value[l]),i.verified===!1)if(t.valueBlock.value[l].optional)n++;else return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,Er),t.name&&delete s[t.name]),i;if(i.verified===!1){const l={verified:!1,result:s};return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,Er),t.name&&(delete s[t.name],l.name=t.name)),l}return{verified:!0,result:s}}if(t.primitiveSchema&&lp in e.valueBlock){const n=rh(e.valueBlock.valueHexView);if(n.offset===-1){const i={verified:!1,result:n.result};return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,Er),t.name&&(delete s[t.name],i.name=t.name)),i}return j(s,n.result,t.primitiveSchema)}return{verified:!0,result:s}}class At{constructor(e={}){if("view"in e)this.fromUint8Array(e.view);else if("buffer"in e)this.fromArrayBuffer(e.buffer);else if("string"in e)this.fromString(e.string);else if("hexstring"in e)this.fromHexString(e.hexstring);else if("length"in e&&e.length>0){if(this.length=e.length,e.stub)for(let t=0;t<this._view.length;t++)this._view[t]=e.stub}else this.length=0}set buffer(e){this._buffer=e,this._view=new Uint8Array(this._buffer)}get buffer(){return this._buffer}set view(e){this._buffer=new ArrayBuffer(e.length),this._view=new Uint8Array(this._buffer),this._view.set(e)}get view(){return this._view}get length(){return this.view.byteLength}set length(e){this._buffer=new ArrayBuffer(e),this._view=new Uint8Array(this._buffer)}clear(){this._buffer=new ArrayBuffer(0),this._view=new Uint8Array(this._buffer)}fromArrayBuffer(e){this._buffer=e,this._view=new Uint8Array(this._buffer)}fromUint8Array(e){this.fromArrayBuffer(new Uint8Array(e).buffer)}fromString(e){const t=e.length;this.length=t;for(let r=0;r<t;r++)this.view[r]=e.charCodeAt(r)}toString(e=0,t=this.view.length-e){let r="";(e>=this.view.length||e<0)&&(e=0),(t>=this.view.length||t<0)&&(t=this.view.length-e);for(let a=e;a<e+t;a++)r+=String.fromCharCode(this.view[a]);return r}fromHexString(e){const t=e.length;this.buffer=new ArrayBuffer(t>>1),this.view=new Uint8Array(this.buffer);const r=new Map;r.set("0",0),r.set("1",1),r.set("2",2),r.set("3",3),r.set("4",4),r.set("5",5),r.set("6",6),r.set("7",7),r.set("8",8),r.set("9",9),r.set("A",10),r.set("a",10),r.set("B",11),r.set("b",11),r.set("C",12),r.set("c",12),r.set("D",13),r.set("d",13),r.set("E",14),r.set("e",14),r.set("F",15),r.set("f",15);let a=0,n=0;for(let i=0;i<t;i++)i%2?(n|=r.get(e.charAt(i)),this.view[a]=n,a++):n=r.get(e.charAt(i))<<4}toHexString(e=0,t=this.view.length-e){let r="";(e>=this.view.length||e<0)&&(e=0),(t>=this.view.length||t<0)&&(t=this.view.length-e);for(let a=e;a<e+t;a++){const n=this.view[a].toString(16).toUpperCase();r=r+(n.length==1?"0":"")+n}return r}copy(e=0,t=this.length-e){if(!e&&!this.length)return new At;if(e<0||e>this.length-1)throw new Error(`Wrong start position: ${e}`);return new At({buffer:this._buffer.slice(e,e+t)})}slice(e=0,t=this.length){if(!e&&!this.length)return new At;if(e<0||e>this.length-1)throw new Error(`Wrong start position: ${e}`);return new At({buffer:this._buffer.slice(e,t)})}realloc(e){const t=new ArrayBuffer(e),r=new Uint8Array(t);e>this._view.length?r.set(this._view):r.set(new Uint8Array(this._buffer,0,e)),this._buffer=t,this._view=new Uint8Array(this._buffer)}append(e){const t=this.length,r=e.length,a=e._view.subarray();this.realloc(t+r),this._view.set(a,t)}insert(e,t=0,r=this.length-t){return t>this.length-1?!1:(r>this.length-t&&(r=this.length-t),r>e.length&&(r=e.length),r==e.length?this._view.set(e._view,t):this._view.set(e._view.subarray(0,r),t),!0)}isEqual(e){if(this.length!=e.length)return!1;for(let t=0;t<e.length;t++)if(this.view[t]!=e.view[t])return!1;return!0}isEqualView(e){if(e.length!=this.view.length)return!1;for(let t=0;t<e.length;t++)if(this.view[t]!=e[t])return!1;return!0}findPattern(e,t,r,a){const{start:n,length:i,backward:o}=this.prepareFindParameters(t,r,a),l=e.length;if(l>i)return-1;const u=[];for(let c=0;c<l;c++)u.push(e.view[c]);for(let c=0;c<=i-l;c++){let f=!0;const g=o?n-l-c:n+c;for(let v=0;v<l;v++)if(this.view[v+g]!=u[v]){f=!1;break}if(f)return o?n-l-c:n+l+c}return-1}findFirstIn(e,t,r,a){const{start:n,length:i,backward:o}=this.prepareFindParameters(t,r,a),l={id:-1,position:o?0:n+i,length:0};for(let u=0;u<e.length;u++){const c=this.findPattern(e[u],n,i,o);if(c!=-1){let f=!1;const g=e[u].length;o?c-g>=l.position-l.length&&(f=!0):c-g<=l.position-l.length&&(f=!0),f&&(l.position=c,l.id=u,l.length=g)}}return l}findAllIn(e,t,r){let{start:a,length:n}=this.prepareFindParameters(t,r);const i=[];let o={id:-1,position:a};do{const l=o.position;if(o=this.findFirstIn(e,o.position,n),o.id==-1)break;n-=o.position-l,i.push({id:o.id,position:o.position})}while(!0);return i}findAllPatternIn(e,t,r){const{start:a,length:n}=this.prepareFindParameters(t,r),i=[],o=e.length;if(o>n)return-1;const l=Array.from(e.view);for(let u=0;u<=n-o;u++){let c=!0;const f=a+u;for(let g=0;g<o;g++)if(this.view[g+f]!=l[g]){c=!1;break}c&&(i.push(a+o+u),u+=o-1)}return i}findFirstNotIn(e,t,r,a){let{start:n,length:i,backward:o}=this.prepareFindParameters(t,r,a);const l={left:{id:-1,position:n},right:{id:-1,position:0},value:new At};let u=i;for(;u>0;){if(l.right=this.findFirstIn(e,o?n-i+u:n+i-u,u,o),l.right.id==-1){i=u,o?n-=i:n=l.left.position,l.value=new At({buffer:this._buffer.slice(n,n+i)});break}if(l.right.position!=(o?l.left.position-e[l.right.id].length:l.left.position+e[l.right.id].length)){o?(n=l.right.position+e[l.right.id].length,i=l.left.position-l.right.position-e[l.right.id].length):(n=l.left.position,i=l.right.position-l.left.position-e[l.right.id].length),l.value=new At({buffer:this._buffer.slice(n,n+i)});break}l.left=l.right,u-=e[l.right.id].length}if(o){const c=l.right;l.right=l.left,l.left=c}return l}findAllNotIn(e,t,r){let{start:a,length:n}=this.prepareFindParameters(t,r);const i=[];let o={left:{id:-1,position:a},right:{id:-1,position:a},value:new At};do{const l=o.right.position;o=this.findFirstNotIn(e,o.right.position,n),n-=o.right.position-l,i.push({left:{id:o.left.id,position:o.left.position},right:{id:o.right.id,position:o.right.position},value:o.value})}while(o.right.id!=-1);return i}findFirstSequence(e,t,r,a){let{start:n,length:i,backward:o}=this.prepareFindParameters(t,r,a);const l=this.skipNotPatterns(e,n,i,o);if(l==-1)return{position:-1,value:new At};const u=this.skipPatterns(e,l,i-(o?n-l:l-n),o);o?(n=u,i=l-u):(n=l,i=u-l);const c=new At({buffer:this._buffer.slice(n,n+i)});return{position:u,value:c}}findAllSequences(e,t,r){let{start:a,length:n}=this.prepareFindParameters(t,r);const i=[];let o={position:a,value:new At};do{const l=o.position;o=this.findFirstSequence(e,o.position,n),o.position!=-1&&(n-=o.position-l,i.push({position:o.position,value:o.value}))}while(o.position!=-1);return i}findPairedPatterns(e,t,r,a){const n=[];if(e.isEqual(t))return n;const{start:i,length:o}=this.prepareFindParameters(r,a);let l=0;const u=this.findAllPatternIn(e,i,o);if(!Array.isArray(u)||u.length==0)return n;const c=this.findAllPatternIn(t,i,o);if(!Array.isArray(c)||c.length==0)return n;for(;l<u.length&&c.length!=0;){if(u[0]==c[0]){n.push({left:u[0],right:c[0]}),u.splice(0,1),c.splice(0,1);continue}if(u[l]>c[0])break;for(;u[l]<c[0]&&(l++,!(l>=u.length)););n.push({left:u[l-1],right:c[0]}),u.splice(l-1,1),c.splice(0,1),l=0}return n.sort((f,g)=>f.left-g.left),n}findPairedArrays(e,t,r,a){const{start:n,length:i}=this.prepareFindParameters(r,a),o=[];let l=0;const u=this.findAllIn(e,n,i);if(u.length==0)return o;const c=this.findAllIn(t,n,i);if(c.length==0)return o;for(;l<u.length&&c.length!=0;){if(u[0].position==c[0].position){o.push({left:u[0],right:c[0]}),u.splice(0,1),c.splice(0,1);continue}if(u[l].position>c[0].position)break;for(;u[l].position<c[0].position&&(l++,!(l>=u.length)););o.push({left:u[l-1],right:c[0]}),u.splice(l-1,1),c.splice(0,1),l=0}return o.sort((f,g)=>f.left.position-g.left.position),o}replacePattern(e,t,r,a,n=null){let i=[],o;const l={status:-1,searchPatternPositions:[],replacePatternPositions:[]},{start:u,length:c}=this.prepareFindParameters(r,a);if(n==null){if(i=this.findAllIn([e],u,c),i.length==0)return l}else i=n;l.searchPatternPositions.push(...Array.from(i,p=>p.position));const f=e.length-t.length,g=new ArrayBuffer(this.view.length-i.length*f),v=new Uint8Array(g);for(v.set(new Uint8Array(this.buffer,0,u)),o=0;o<i.length;o++){const p=o==0?u:i[o-1].position;v.set(new Uint8Array(this.buffer,p,i[o].position-e.length-p),p-o*f),v.set(t.view,i[o].position-e.length-o*f),l.replacePatternPositions.push(i[o].position-e.length-o*f)}return o--,v.set(new Uint8Array(this.buffer,i[o].position,this.length-i[o].position),i[o].position-e.length+t.length-o*f),this.buffer=g,this.view=new Uint8Array(this.buffer),l.status=1,l}skipPatterns(e,t,r,a){const{start:n,length:i,backward:o}=this.prepareFindParameters(t,r,a);let l=n;for(let u=0;u<e.length;u++){const c=e[u].length,f=o?l-c:l;let g=!0;for(let v=0;v<c;v++)if(this.view[v+f]!=e[u].view[v]){g=!1;break}if(g){if(u=-1,o){if(l-=c,l<=0)return l}else if(l+=c,l>=n+i)return l}}return l}skipNotPatterns(e,t,r,a){const{start:n,length:i,backward:o}=this.prepareFindParameters(t,r,a);let l=-1;for(let u=0;u<i;u++){for(let c=0;c<e.length;c++){const f=e[c].length,g=o?n-u-f:n+u;let v=!0;for(let p=0;p<f;p++)if(this.view[p+g]!=e[c].view[p]){v=!1;break}if(v){l=o?n-u:n+u;break}}if(l!=-1)break}return l}prepareFindParameters(e=null,t=null,r=!1){return e===null&&(e=r?this.length:0),e>this.length&&(e=this.length),r?(t===null&&(t=e),t>e&&(t=e)):(t===null&&(t=this.length-e),t>this.length-e&&(t=this.length-e)),{start:e,length:t,backward:r}}}const OA=16777216;class Sn{constructor(e={}){this._stream=new At,this._length=0,this._start=0,this.backward=!1,this.appendBlock=0,this.prevLength=0,this.prevStart=0,"view"in e?this.stream=new At({view:e.view}):"buffer"in e?this.stream=new At({buffer:e.buffer}):"string"in e?this.stream=new At({string:e.string}):"hexstring"in e?this.stream=new At({hexstring:e.hexstring}):"stream"in e?this.stream=e.stream.slice():this.stream=new At,"backward"in e&&e.backward&&(this.backward=e.backward,this._start=this.stream.length),"length"in e&&e.length>0&&(this._length=e.length),"start"in e&&e.start&&e.start>0&&(this._start=e.start),"appendBlock"in e&&e.appendBlock&&e.appendBlock>0&&(this.appendBlock=e.appendBlock)}set stream(e){this._stream=e,this.prevLength=this._length,this._length=e.length,this.prevStart=this._start,this._start=0}get stream(){return this._stream}set length(e){this.prevLength=this._length,this._length=e}get length(){return this.appendBlock?this.start:this._length}set start(e){e>this.stream.length||(this.prevStart=this._start,this.prevLength=this._length,this._length-=this.backward?this._start-e:e-this._start,this._start=e)}get start(){return this._start}get buffer(){return this._stream.buffer.slice(0,this._length)}resetPosition(){this._start=this.prevStart,this._length=this.prevLength}findPattern(e,t=null){(t==null||t>this.length)&&(t=this.length);const r=this.stream.findPattern(e,this.start,this.length,this.backward);if(r==-1)return r;if(this.backward){if(r<this.start-e.length-t)return-1}else if(r>this.start+e.length+t)return-1;return this.start=r,r}findFirstIn(e,t=null){(t==null||t>this.length)&&(t=this.length);const r=this.stream.findFirstIn(e,this.start,this.length,this.backward);if(r.id==-1)return r;if(this.backward){if(r.position<this.start-e[r.id].length-t)return{id:-1,position:this.backward?0:this.start+this.length}}else if(r.position>this.start+e[r.id].length+t)return{id:-1,position:this.backward?0:this.start+this.length};return this.start=r.position,r}findAllIn(e){const t=this.backward?this.start-this.length:this.start;return this.stream.findAllIn(e,t,this.length)}findFirstNotIn(e,t=null){(t==null||t>this._length)&&(t=this._length);const r=this._stream.findFirstNotIn(e,this._start,this._length,this.backward);if(r.left.id==-1&&r.right.id==-1)return r;if(this.backward){if(r.right.id!=-1&&r.right.position<this._start-e[r.right.id].length-t)return{left:{id:-1,position:this._start},right:{id:-1,position:0},value:new At}}else if(r.left.id!=-1&&r.left.position>this._start+e[r.left.id].length+t)return{left:{id:-1,position:this._start},right:{id:-1,position:0},value:new At};return this.backward?r.left.id==-1?this.start=0:this.start=r.left.position:r.right.id==-1?this.start=this._start+this._length:this.start=r.right.position,r}findAllNotIn(e){const t=this.backward?this._start-this._length:this._start;return this._stream.findAllNotIn(e,t,this._length)}findFirstSequence(e,t=null,r=null){(t==null||t>this._length)&&(t=this._length),(r==null||r>t)&&(r=t);const a=this._stream.findFirstSequence(e,this._start,t,this.backward);if(a.value.length==0)return a;if(this.backward){if(a.position<this._start-a.value.length-r)return{position:-1,value:new At}}else if(a.position>this._start+a.value.length+r)return{position:-1,value:new At};return this.start=a.position,a}findAllSequences(e){const t=this.backward?this.start-this.length:this.start;return this.stream.findAllSequences(e,t,this.length)}findPairedPatterns(e,t,r=null){(r==null||r>this.length)&&(r=this.length);const a=this.backward?this.start-this.length:this.start,n=this.stream.findPairedPatterns(e,t,a,this.length);if(n.length){if(this.backward){if(n[0].right<this.start-t.length-r)return[]}else if(n[0].left>this.start+e.length+r)return[]}return n}findPairedArrays(e,t,r=null){(r==null||r>this.length)&&(r=this.length);const a=this.backward?this.start-this.length:this.start,n=this.stream.findPairedArrays(e,t,a,this.length);if(n.length){if(this.backward){if(n[0].right.position<this.start-t[n[0].right.id].length-r)return[]}else if(n[0].left.position>this.start+e[n[0].left.id].length+r)return[]}return n}replacePattern(e,t){const r=this.backward?this.start-this.length:this.start;return this.stream.replacePattern(e,t,r,this.length)}skipPatterns(e){const t=this.stream.skipPatterns(e,this.start,this.length,this.backward);return this.start=t,t}skipNotPatterns(e){const t=this.stream.skipNotPatterns(e,this.start,this.length,this.backward);return t==-1?-1:(this.start=t,t)}append(e){this.beforeAppend(e.length),this._stream.view.set(e.view,this._start),this._length+=e.length*2,this.start=this._start+e.length,this.prevLength-=e.length*2}appendView(e){this.beforeAppend(e.length),this._stream.view.set(e,this._start),this._length+=e.length*2,this.start=this._start+e.length,this.prevLength-=e.length*2}appendChar(e){this.beforeAppend(1),this._stream.view[this._start]=e,this._length+=2,this.start=this._start+1,this.prevLength-=2}appendUint16(e){this.beforeAppend(2);const t=new Uint16Array([e]),r=new Uint8Array(t.buffer);this.stream.view[this._start]=r[1],this._stream.view[this._start+1]=r[0],this._length+=4,this.start=this._start+2,this.prevLength-=4}appendUint24(e){this.beforeAppend(3);const t=new Uint32Array([e]),r=new Uint8Array(t.buffer);this._stream.view[this._start]=r[2],this._stream.view[this._start+1]=r[1],this._stream.view[this._start+2]=r[0],this._length+=6,this.start=this._start+3,this.prevLength-=6}appendUint32(e){this.beforeAppend(4);const t=new Uint32Array([e]),r=new Uint8Array(t.buffer);this._stream.view[this._start]=r[3],this._stream.view[this._start+1]=r[2],this._stream.view[this._start+2]=r[1],this._stream.view[this._start+3]=r[0],this._length+=8,this.start=this._start+4,this.prevLength-=8}appendInt16(e){this.beforeAppend(2);const t=new Int16Array([e]),r=new Uint8Array(t.buffer);this._stream.view[this._start]=r[1],this._stream.view[this._start+1]=r[0],this._length+=4,this.start=this._start+2,this.prevLength-=4}appendInt32(e){this.beforeAppend(4);const t=new Int32Array([e]),r=new Uint8Array(t.buffer);this._stream.view[this._start]=r[3],this._stream.view[this._start+1]=r[2],this._stream.view[this._start+2]=r[1],this._stream.view[this._start+3]=r[0],this._length+=8,this.start=this._start+4,this.prevLength-=8}getBlock(e,t=!0){if(this._length<=0)return new Uint8Array(0);this._length<e&&(e=this._length);let r;if(this.backward){const a=this._stream.view.subarray(this._length-e,this._length);r=new Uint8Array(e);for(let n=0;n<e;n++)r[e-1-n]=a[n]}else r=this._stream.view.subarray(this._start,this._start+e);return t&&(this.start+=this.backward?-1*e:e),r}getUint16(e=!0){const t=this.getBlock(2,e);return t.length<2?0:t[0]<<8|t[1]}getInt16(e=!0){const t=this.getUint16(e),r=32768;return t&r?-(r-(t^r)):t}getUint24(e=!0){const t=this.getBlock(4,e);return t.length<3?0:t[0]<<16|t[1]<<8|t[2]}getUint32(e=!0){const t=this.getBlock(4,e);return t.length<4?0:t[0]*OA+(t[1]<<16)+(t[2]<<8)+t[3]}getInt32(e=!0){const t=this.getUint32(e),r=2147483648;return t&r?-(r-(t^r)):t}beforeAppend(e){this._start+e>this._stream.length&&(e>this.appendBlock&&(this.appendBlock=e+Sn.APPEND_BLOCK),this._stream.realloc(this._stream.length+this.appendBlock))}}Sn.APPEND_BLOCK=1e3;/*!
 * Copyright (c) 2014, GlobalSign
 * Copyright (c) 2015-2019, Peculiar Ventures
 * All rights reserved.
 * 
 * Author 2014-2019, Yury Strozhevsky
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * * Redistributions of source code must retain the above copyright notice, this
 *   list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice, this
 *   list of conditions and the following disclaimer in the documentation and/or
 *   other materials provided with the distribution.
 * 
 * * Neither the name of the {organization} nor the names of its
 *   contributors may be used to endorse or promote products derived from
 *   this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 * 
 */const $t=new ArrayBuffer(0),S="";class tt extends TypeError{constructor(){super(...arguments),this.name=tt.NAME}static isType(e,t){if(typeof t=="string"){if(t==="Array"&&Array.isArray(e))return!0;if(t==="ArrayBuffer"&&e instanceof ArrayBuffer)return!0;if(t==="ArrayBufferView"&&ArrayBuffer.isView(e))return!0;if(typeof e===t)return!0}else if(e instanceof t)return!0;return!1}static assert(e,t,...r){for(const n of r)if(this.isType(e,n))return;const a=r.map(n=>n instanceof Function&&"name"in n?n.name:`${n}`);throw new tt(`Parameter '${t}' is not of type ${a.length>1?`(${a.join(" or ")})`:a[0]}`)}}tt.NAME="ArgumentError";class Ge extends TypeError{constructor(e,t=null,r){super(),this.name=Ge.NAME,this.field=e,t&&(this.target=t),r?this.message=r:this.message=`Absent mandatory parameter '${e}' ${t?` in '${t}'`:S}`}static assert(...e){let t=null,r,a;typeof e[0]=="string"?(t=e[0],r=e[1],a=e.slice(2)):(r=e[0],a=e.slice(1)),tt.assert(r,"parameters","object");for(const n of a){const i=r[n];if(i==null)throw new Ge(n,t)}}static assertEmpty(e,t,r){if(e==null)throw new Ge(t,r)}}Ge.NAME="ParameterError";class P extends Error{static assertSchema(e,t){if(!e.verified)throw new Error(`Object's schema was not verified against input data for ${t}`)}static assert(e,t){if(e.offset===-1)throw new P(`Error during parsing of ASN.1 data. Data is not correct for '${t}'.`)}constructor(e){super(e),this.name="AsnError"}}class G{static blockName(){return this.CLASS_NAME}static fromBER(e){const t=_t(e);P.assert(t,this.name);try{return new this({schema:t.result})}catch{throw new P(`Cannot create '${this.CLASS_NAME}' from ASN.1 object`)}}static defaultValues(e){throw new Error(`Invalid member name for ${this.CLASS_NAME} class: ${e}`)}static schema(e={}){throw new Error(`Method '${this.CLASS_NAME}.schema' should be overridden`)}get className(){return this.constructor.CLASS_NAME}toString(e="hex"){let t;try{t=this.toSchema()}catch{t=this.toSchema(!0)}return ke.ToString(t.toBER(),e)}}G.CLASS_NAME="PkiObject";function tn(s){let e=!1,t=S;const r=s.trim();for(let a=0;a<r.length;a++)r.charCodeAt(a)===32?e===!1&&(e=!0):(e&&(t+=" ",e=!1),t+=r[a]);return t.toLowerCase()}const Su="type",Sd="value";class hn extends G{constructor(e={}){super(),this.type=m(e,Su,hn.defaultValues(Su)),this.value=m(e,Sd,hn.defaultValues(Sd)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Su:return S;case Sd:return{};default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.type||S}),new xe({name:t.value||S})]})}fromSchema(e){W(e,[Su,"typeValue"]);const t=j(e,e,hn.schema({names:{type:Su,value:"typeValue"}}));P.assertSchema(t,this.className),this.type=t.result.type.valueBlock.toString(),this.value=t.result.typeValue}toSchema(){return new b({value:[new he({value:this.type}),this.value]})}toJSON(){const e={type:this.type};return Object.keys(this.value).length!==0?e.value=this.value.toJSON():e.value=this.value,e}isEqual(e){const t=[gs.blockName(),Kf.blockName(),Mf.blockName(),Wl.blockName(),fs.blockName(),Hf.blockName(),um.blockName(),id.blockName(),cm.blockName(),od.blockName(),fm.blockName(),hm.blockName()];if(e instanceof ArrayBuffer)return Ee.isEqual(this.value.valueBeforeDecodeView,e);if(e.constructor.blockName()===hn.blockName()){if(this.type!==e.type)return!1;const r=[!1,!1],a=this.value.constructor.blockName();for(const i of t)a===i&&(r[0]=!0),e.value.constructor.blockName()===i&&(r[1]=!0);if(r[0]!==r[1])return!1;if(r[0]&&r[1]){const i=tn(this.value.valueBlock.value),o=tn(e.value.valueBlock.value);if(i.localeCompare(o)!==0)return!1}else if(!Ee.isEqual(this.value.valueBeforeDecodeView,e.value.valueBeforeDecodeView))return!1;return!0}return!1}}hn.CLASS_NAME="AttributeTypeAndValue";const Vn="typesAndValues",uh="valueBeforeDecode",cp="RDN";class rt extends G{constructor(e={}){super(),this.typesAndValues=m(e,Vn,rt.defaultValues(Vn)),this.valueBeforeDecode=m(e,uh,rt.defaultValues(uh)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Vn:return[];case uh:return $t;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Vn:return t.length===0;case uh:return t.byteLength===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _e({name:t.repeatedSequence||S,value:new Bt({value:[new _e({name:t.repeatedSet||S,value:hn.schema(t.typeAndValue||{})})]})})]})}fromSchema(e){W(e,[cp,Vn]);const t=j(e,e,rt.schema({names:{blockName:cp,repeatedSet:Vn}}));P.assertSchema(t,this.className),Vn in t.result&&(this.typesAndValues=Array.from(t.result.typesAndValues,r=>new hn({schema:r}))),this.valueBeforeDecode=t.result.RDN.valueBeforeDecodeView.slice().buffer}toSchema(){if(this.valueBeforeDecode.byteLength===0)return new b({value:[new Bt({value:Array.from(this.typesAndValues,t=>t.toSchema())})]});const e=_t(this.valueBeforeDecode);if(P.assert(e,"RelativeDistinguishedNames"),!(e.result instanceof b))throw new Error("ASN.1 result should be SEQUENCE");return e.result}toJSON(){return{typesAndValues:Array.from(this.typesAndValues,e=>e.toJSON())}}isEqual(e){if(e instanceof rt){if(this.typesAndValues.length!==e.typesAndValues.length)return!1;for(const[t,r]of this.typesAndValues.entries())if(r.isEqual(e.typesAndValues[t])===!1)return!1;return!0}return e instanceof ArrayBuffer?su(this.valueBeforeDecode,e):!1}}rt.CLASS_NAME="RelativeDistinguishedNames";const Du="type",Lu="value";function PA(s={},e=!1){const t=m(s,"names",{});return new b({optional:e,value:[new N({optional:!0,idBlock:{tagClass:2,tagNumber:1},name:t.country_name||S,value:[new wt({value:[new Wl,new fs]})]}),new N({optional:!0,idBlock:{tagClass:2,tagNumber:2},name:t.administration_domain_name||S,value:[new wt({value:[new Wl,new fs]})]}),new Ie({optional:!0,idBlock:{tagClass:3,tagNumber:0},name:t.network_address||S,isHexOnly:!0}),new Ie({optional:!0,idBlock:{tagClass:3,tagNumber:1},name:t.terminal_identifier||S,isHexOnly:!0}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:2},name:t.private_domain_name||S,value:[new wt({value:[new Wl,new fs]})]}),new Ie({optional:!0,idBlock:{tagClass:3,tagNumber:3},name:t.organization_name||S,isHexOnly:!0}),new Ie({optional:!0,name:t.numeric_user_identifier||S,idBlock:{tagClass:3,tagNumber:4},isHexOnly:!0}),new N({optional:!0,name:t.personal_name||S,idBlock:{tagClass:3,tagNumber:5},value:[new Ie({idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new Ie({optional:!0,idBlock:{tagClass:3,tagNumber:1},isHexOnly:!0}),new Ie({optional:!0,idBlock:{tagClass:3,tagNumber:2},isHexOnly:!0}),new Ie({optional:!0,idBlock:{tagClass:3,tagNumber:3},isHexOnly:!0})]}),new N({optional:!0,name:t.organizational_unit_names||S,idBlock:{tagClass:3,tagNumber:6},value:[new _e({value:new fs})]})]})}function UA(s=!1){return new b({optional:s,value:[new fs,new fs]})}function KA(s=!1){return new Bt({optional:s,value:[new Ie({optional:!0,idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new xe]})]})}class ze extends G{constructor(e={}){super(),this.type=m(e,Du,ze.defaultValues(Du)),this.value=m(e,Lu,ze.defaultValues(Lu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Du:return 9;case Lu:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Du:return t===ze.defaultValues(e);case Lu:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new wt({value:[new N({idBlock:{tagClass:3,tagNumber:0},name:t.blockName||S,value:[new he,new N({idBlock:{tagClass:3,tagNumber:0},value:[new xe]})]}),new Ie({name:t.blockName||S,idBlock:{tagClass:3,tagNumber:1}}),new Ie({name:t.blockName||S,idBlock:{tagClass:3,tagNumber:2}}),new N({idBlock:{tagClass:3,tagNumber:3},name:t.blockName||S,value:[PA(t.builtInStandardAttributes||{},!1),UA(!0),KA(!0)]}),new N({idBlock:{tagClass:3,tagNumber:4},name:t.blockName||S,value:[rt.schema(t.directoryName||{})]}),new N({idBlock:{tagClass:3,tagNumber:5},name:t.blockName||S,value:[new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new wt({value:[new Hf,new fs,new Mf,new gs,new Kf]})]}),new N({idBlock:{tagClass:3,tagNumber:1},value:[new wt({value:[new Hf,new fs,new Mf,new gs,new Kf]})]})]}),new Ie({name:t.blockName||S,idBlock:{tagClass:3,tagNumber:6}}),new Ie({name:t.blockName||S,idBlock:{tagClass:3,tagNumber:7}}),new Ie({name:t.blockName||S,idBlock:{tagClass:3,tagNumber:8}})]})}fromSchema(e){W(e,["blockName","otherName","rfc822Name","dNSName","x400Address","directoryName","ediPartyName","uniformResourceIdentifier","iPAddress","registeredID"]);const t=j(e,e,ze.schema({names:{blockName:"blockName",otherName:"otherName",rfc822Name:"rfc822Name",dNSName:"dNSName",x400Address:"x400Address",directoryName:{names:{blockName:"directoryName"}},ediPartyName:"ediPartyName",uniformResourceIdentifier:"uniformResourceIdentifier",iPAddress:"iPAddress",registeredID:"registeredID"}}));switch(P.assertSchema(t,this.className),this.type=t.result.blockName.idBlock.tagNumber,this.type){case 0:this.value=t.result.blockName;break;case 1:case 2:case 6:{const r=t.result.blockName;r.idBlock.tagClass=1,r.idBlock.tagNumber=22;const a=r.toBER(!1),n=_t(a);P.assert(n,"GeneralName value"),this.value=n.result.valueBlock.value}break;case 3:this.value=t.result.blockName;break;case 4:this.value=new rt({schema:t.result.directoryName});break;case 5:this.value=t.result.ediPartyName;break;case 7:this.value=new z({valueHex:t.result.blockName.valueBlock.valueHex});break;case 8:{const r=t.result.blockName;r.idBlock.tagClass=1,r.idBlock.tagNumber=6;const a=r.toBER(!1),n=_t(a);P.assert(n,"GeneralName registeredID"),this.value=n.result.valueBlock.toString()}break}}toSchema(){switch(this.type){case 0:case 3:case 5:return new N({idBlock:{tagClass:3,tagNumber:this.type},value:[this.value]});case 1:case 2:case 6:{const e=new id({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 4:return new N({idBlock:{tagClass:3,tagNumber:4},value:[this.value.toSchema()]});case 7:{const e=this.value;return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 8:{const e=new he({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}default:return ze.schema()}}toJSON(){const e={type:this.type,value:S};if(typeof this.value=="string")e.value=this.value;else try{e.value=this.value.toJSON()}catch{}return e}}ze.CLASS_NAME="GeneralName";const Ou="accessMethod",Pu="accessLocation",MA=[Ou,Pu];class ji extends G{constructor(e={}){super(),this.accessMethod=m(e,Ou,ji.defaultValues(Ou)),this.accessLocation=m(e,Pu,ji.defaultValues(Pu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ou:return S;case Pu:return new ze;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.accessMethod||S}),ze.schema(t.accessLocation||{})]})}fromSchema(e){W(e,MA);const t=j(e,e,ji.schema({names:{accessMethod:Ou,accessLocation:{names:{blockName:Pu}}}}));P.assertSchema(t,this.className),this.accessMethod=t.result.accessMethod.valueBlock.toString(),this.accessLocation=new ze({schema:t.result.accessLocation})}toSchema(){return new b({value:[new he({value:this.accessMethod}),this.accessLocation.toSchema()]})}toJSON(){return{accessMethod:this.accessMethod,accessLocation:this.accessLocation.toJSON()}}}ji.CLASS_NAME="AccessDescription";const ya="seconds",va="millis",wa="micros";class $r extends G{constructor(e={}){super(),ya in e&&(this.seconds=m(e,ya,$r.defaultValues(ya))),va in e&&(this.millis=m(e,va,$r.defaultValues(va))),wa in e&&(this.micros=m(e,wa,$r.defaultValues(wa))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ya:case va:case wa:return 0;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ya:case va:case wa:return t===$r.defaultValues(e);default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,optional:!0,value:[new _({optional:!0,name:t.seconds||S}),new Ie({name:t.millis||S,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Ie({name:t.micros||S,optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){W(e,[ya,va,wa]);const t=j(e,e,$r.schema({names:{seconds:ya,millis:va,micros:wa}}));if(P.assertSchema(t,this.className),"seconds"in t.result&&(this.seconds=t.result.seconds.valueBlock.valueDec),"millis"in t.result){const r=new _({valueHex:t.result.millis.valueBlock.valueHex});this.millis=r.valueBlock.valueDec}if("micros"in t.result){const r=new _({valueHex:t.result.micros.valueBlock.valueHex});this.micros=r.valueBlock.valueDec}}toSchema(){const e=[];if(this.seconds!==void 0&&e.push(new _({value:this.seconds})),this.millis!==void 0){const t=new _({value:this.millis});e.push(new Ie({idBlock:{tagClass:3,tagNumber:0},valueHex:t.valueBlock.valueHexView}))}if(this.micros!==void 0){const t=new _({value:this.micros});e.push(new Ie({idBlock:{tagClass:3,tagNumber:1},valueHex:t.valueBlock.valueHexView}))}return new b({value:e})}toJSON(){const e={};return this.seconds!==void 0&&(e.seconds=this.seconds),this.millis!==void 0&&(e.millis=this.millis),this.micros!==void 0&&(e.micros=this.micros),e}}$r.CLASS_NAME="Accuracy";const ch="algorithmId",Cu="algorithmParams",Jv="algorithm",yg="params",HA=[Jv,yg];class $ extends G{constructor(e={}){super(),this.algorithmId=m(e,ch,$.defaultValues(ch)),Cu in e&&(this.algorithmParams=m(e,Cu,$.defaultValues(Cu))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ch:return S;case Cu:return new xe;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ch:return t===S;case Cu:return t instanceof xe;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,optional:t.optional||!1,value:[new he({name:t.algorithmIdentifier||S}),new xe({name:t.algorithmParams||S,optional:!0})]})}fromSchema(e){W(e,HA);const t=j(e,e,$.schema({names:{algorithmIdentifier:Jv,algorithmParams:yg}}));P.assertSchema(t,this.className),this.algorithmId=t.result.algorithm.valueBlock.toString(),yg in t.result&&(this.algorithmParams=t.result.params)}toSchema(){const e=[];return e.push(new he({value:this.algorithmId})),this.algorithmParams&&!(this.algorithmParams instanceof xe)&&e.push(this.algorithmParams),new b({value:e})}toJSON(){const e={algorithmId:this.algorithmId};return this.algorithmParams&&!(this.algorithmParams instanceof xe)&&(e.algorithmParams=this.algorithmParams.toJSON()),e}isEqual(e){return!(e instanceof $)||this.algorithmId!==e.algorithmId?!1:this.algorithmParams?e.algorithmParams?JSON.stringify(this.algorithmParams)===JSON.stringify(e.algorithmParams):!1:!e.algorithmParams}}$.CLASS_NAME="AlgorithmIdentifier";const Ao="altNames",FA=[Ao];class iu extends G{constructor(e={}){super(),this.altNames=m(e,Ao,iu.defaultValues(Ao)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ao:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _e({name:t.altNames||S,value:ze.schema()})]})}fromSchema(e){W(e,FA);const t=j(e,e,iu.schema({names:{altNames:Ao}}));P.assertSchema(t,this.className),Ao in t.result&&(this.altNames=Array.from(t.result.altNames,r=>new ze({schema:r})))}toSchema(){return new b({value:Array.from(this.altNames,e=>e.toSchema())})}toJSON(){return{altNames:Array.from(this.altNames,e=>e.toJSON())}}}iu.CLASS_NAME="AltName";const Eo="type",bo="values",qA=[Eo,bo];class mt extends G{constructor(e={}){super(),this.type=m(e,Eo,mt.defaultValues(Eo)),this.values=m(e,bo,mt.defaultValues(bo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Eo:return S;case bo:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Eo:return t===S;case bo:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.type||S}),new Bt({name:t.setName||S,value:[new _e({name:t.values||S,value:new xe})]})]})}fromSchema(e){W(e,qA);const t=j(e,e,mt.schema({names:{type:Eo,values:bo}}));P.assertSchema(t,this.className),this.type=t.result.type.valueBlock.toString(),this.values=t.result.values}toSchema(){return new b({value:[new he({value:this.type}),new Bt({value:this.values})]})}toJSON(){return{type:this.type,values:Array.from(this.values,e=>e.toJSON())}}}mt.CLASS_NAME="Attribute";const Uu="notBeforeTime",Ku="notAfterTime",JA=[Uu,Ku];class hs extends G{constructor(e={}){super(),this.notBeforeTime=m(e,Uu,hs.defaultValues(Uu)),this.notAfterTime=m(e,Ku,hs.defaultValues(Ku)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Uu:case Ku:return new Date(0,0,0);default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new vt({name:t.notBeforeTime||S}),new vt({name:t.notAfterTime||S})]})}fromSchema(e){W(e,JA);const t=j(e,e,hs.schema({names:{notBeforeTime:Uu,notAfterTime:Ku}}));P.assertSchema(t,this.className),this.notBeforeTime=t.result.notBeforeTime.toDate(),this.notAfterTime=t.result.notAfterTime.toDate()}toSchema(){return new b({value:[new vt({valueDate:this.notBeforeTime}),new vt({valueDate:this.notAfterTime})]})}toJSON(){return{notBeforeTime:this.notBeforeTime,notAfterTime:this.notAfterTime}}}hs.CLASS_NAME="AttCertValidityPeriod";const Au="names",fp="generalNames";class Ut extends G{constructor(e={}){super(),this.names=m(e,Au,Ut.defaultValues(Au)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"names":return[];default:return super.defaultValues(e)}}static schema(e={},t=!1){const r=m(e,Au,{});return new b({optional:t,name:r.blockName||S,value:[new _e({name:r.generalNames||S,value:ze.schema()})]})}fromSchema(e){W(e,[Au,fp]);const t=j(e,e,Ut.schema({names:{blockName:Au,generalNames:fp}}));P.assertSchema(t,this.className),this.names=Array.from(t.result.generalNames,r=>new ze({schema:r}))}toSchema(){return new b({value:Array.from(this.names,e=>e.toSchema())})}toJSON(){return{names:Array.from(this.names,e=>e.toJSON())}}}Ut.CLASS_NAME="GeneralNames";const GA="2.5.29.9",jA="2.5.29.14",WA="2.5.29.15",QA="2.5.29.16",Gv="2.5.29.17",jv="2.5.29.18",dm="2.5.29.19",YA="2.5.29.20",zA="2.5.29.27",XA="2.5.29.21",ZA="2.5.29.24",Wv="2.5.29.28",Qv="2.5.29.29",Yv="2.5.29.30",zv="2.5.29.31",gm="2.5.29.46",Xv="2.5.29.32",Mr="2.5.29.32.0",eE="1.3.6.1.4.1.311.21.10",Zv="2.5.29.33",mm="2.5.29.35",e1="2.5.29.36",tE="2.5.29.37",rE="2.5.29.54",pm="1.3.6.1.5.5.7.1.1",sE="1.3.6.1.5.5.7.1.11",aE="1.3.6.1.4.1.11129.2.4.2",nE="1.3.6.1.4.1.311.21.7",iE="1.3.6.1.4.1.311.21.1",oE="1.3.6.1.5.5.7.1.3",ym="1.2.840.113549.1.7.1",t1="1.2.840.113549.1.7.2",r1="1.2.840.113549.1.7.3",s1="1.2.840.113549.1.7.6",lE="1.2.840.113549.1.9.16.1.4",hp="1.2.840.113549.1.9.22.1",uE="1.2.840.113549.1.9.22.2",dp="1.2.840.113549.1.9.22.3",gp="1.2.840.113549.1.9.23.1",cE="1.3.6.1.5.5.7",fE=`${cE}.48`,Uh=`${fE}.1.1`,Ln="keyIdentifier",On="authorityCertIssuer",Pn="authorityCertSerialNumber",hE=[Ln,On,Pn];class dn extends G{constructor(e={}){super(),Ln in e&&(this.keyIdentifier=m(e,Ln,dn.defaultValues(Ln))),On in e&&(this.authorityCertIssuer=m(e,On,dn.defaultValues(On))),Pn in e&&(this.authorityCertSerialNumber=m(e,Pn,dn.defaultValues(Pn))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ln:return new z;case On:return[];case Pn:return new _;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new Ie({name:t.keyIdentifier||S,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new _e({name:t.authorityCertIssuer||S,value:ze.schema()})]}),new Ie({name:t.authorityCertSerialNumber||S,optional:!0,idBlock:{tagClass:3,tagNumber:2}})]})}fromSchema(e){W(e,hE);const t=j(e,e,dn.schema({names:{keyIdentifier:Ln,authorityCertIssuer:On,authorityCertSerialNumber:Pn}}));P.assertSchema(t,this.className),Ln in t.result&&(this.keyIdentifier=new z({valueHex:t.result.keyIdentifier.valueBlock.valueHex})),On in t.result&&(this.authorityCertIssuer=Array.from(t.result.authorityCertIssuer,r=>new ze({schema:r}))),Pn in t.result&&(this.authorityCertSerialNumber=new _({valueHex:t.result.authorityCertSerialNumber.valueBlock.valueHex}))}toSchema(){const e=[];return this.keyIdentifier&&e.push(new Ie({idBlock:{tagClass:3,tagNumber:0},valueHex:this.keyIdentifier.valueBlock.valueHexView})),this.authorityCertIssuer&&e.push(new N({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.authorityCertIssuer,t=>t.toSchema())})),this.authorityCertSerialNumber&&e.push(new Ie({idBlock:{tagClass:3,tagNumber:2},valueHex:this.authorityCertSerialNumber.valueBlock.valueHexView})),new b({value:e})}toJSON(){const e={};return this.keyIdentifier&&(e.keyIdentifier=this.keyIdentifier.toJSON()),this.authorityCertIssuer&&(e.authorityCertIssuer=Array.from(this.authorityCertIssuer,t=>t.toJSON())),this.authorityCertSerialNumber&&(e.authorityCertSerialNumber=this.authorityCertSerialNumber.toJSON()),e}}dn.CLASS_NAME="AuthorityKeyIdentifier";const _n="pathLenConstraint",$n="cA";class Wi extends G{constructor(e={}){super(),this.cA=m(e,$n,!1),_n in e&&(this.pathLenConstraint=m(e,_n,0)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case $n:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _s({optional:!0,name:t.cA||S}),new _({optional:!0,name:t.pathLenConstraint||S})]})}fromSchema(e){W(e,[$n,_n]);const t=j(e,e,Wi.schema({names:{cA:$n,pathLenConstraint:_n}}));P.assertSchema(t,this.className),$n in t.result&&(this.cA=t.result.cA.valueBlock.value),_n in t.result&&(t.result.pathLenConstraint.valueBlock.isHexOnly?this.pathLenConstraint=t.result.pathLenConstraint:this.pathLenConstraint=t.result.pathLenConstraint.valueBlock.valueDec)}toSchema(){const e=[];return this.cA!==Wi.defaultValues($n)&&e.push(new _s({value:this.cA})),_n in this&&(this.pathLenConstraint instanceof _?e.push(this.pathLenConstraint):e.push(new _({value:this.pathLenConstraint}))),new b({value:e})}toJSON(){const e={};return this.cA!==Wi.defaultValues($n)&&(e.cA=this.cA),_n in this&&(this.pathLenConstraint instanceof _?e.pathLenConstraint=this.pathLenConstraint.toJSON():e.pathLenConstraint=this.pathLenConstraint),e}}Wi.CLASS_NAME="BasicConstraints";const Cd="certificateIndex",Ad="keyIndex";class Ff extends G{constructor(e={}){super(),this.certificateIndex=m(e,Cd,Ff.defaultValues(Cd)),this.keyIndex=m(e,Ad,Ff.defaultValues(Ad)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Cd:case Ad:return 0;default:return super.defaultValues(e)}}static schema(){return new _}fromSchema(e){if(e.constructor.blockName()!==_.blockName())throw new Error("Object's schema was not verified against input data for CAVersion");let t=e.valueBlock.valueHex.slice(0);const r=new Uint8Array(t);switch(!0){case t.byteLength<4:{const f=new ArrayBuffer(4);new Uint8Array(f).set(r,4-t.byteLength),t=f.slice(0)}break;case t.byteLength>4:{const f=new ArrayBuffer(4);new Uint8Array(f).set(r.slice(0,4)),t=f.slice(0)}break}const a=t.slice(0,2),n=new Uint8Array(a);let i=n[0];n[0]=n[1],n[1]=i;const o=new Uint16Array(a);this.keyIndex=o[0];const l=t.slice(2),u=new Uint8Array(l);i=u[0],u[0]=u[1],u[1]=i;const c=new Uint16Array(l);this.certificateIndex=c[0]}toSchema(){const e=new ArrayBuffer(2),t=new Uint16Array(e);t[0]=this.certificateIndex;const r=new Uint8Array(e);let a=r[0];r[0]=r[1],r[1]=a;const n=new ArrayBuffer(2),i=new Uint16Array(n);i[0]=this.keyIndex;const o=new Uint8Array(n);return a=o[0],o[0]=o[1],o[1]=a,new _({valueHex:jl(n,e)})}toJSON(){return{certificateIndex:this.certificateIndex,keyIndex:this.keyIndex}}}Ff.CLASS_NAME="CAVersion";const Mu="policyQualifierId",Hu="qualifier",dE=[Mu,Hu];class Qi extends G{constructor(e={}){super(),this.policyQualifierId=m(e,Mu,Qi.defaultValues(Mu)),this.qualifier=m(e,Hu,Qi.defaultValues(Hu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Mu:return S;case Hu:return new xe;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.policyQualifierId||S}),new xe({name:t.qualifier||S})]})}fromSchema(e){W(e,dE);const t=j(e,e,Qi.schema({names:{policyQualifierId:Mu,qualifier:Hu}}));P.assertSchema(t,this.className),this.policyQualifierId=t.result.policyQualifierId.valueBlock.toString(),this.qualifier=t.result.qualifier}toSchema(){return new b({value:[new he({value:this.policyQualifierId}),this.qualifier]})}toJSON(){return{policyQualifierId:this.policyQualifierId,qualifier:this.qualifier.toJSON()}}}Qi.CLASS_NAME="PolicyQualifierInfo";const Fu="policyIdentifier",Un="policyQualifiers",gE=[Fu,Un];class Yi extends G{constructor(e={}){super(),this.policyIdentifier=m(e,Fu,Yi.defaultValues(Fu)),Un in e&&(this.policyQualifiers=m(e,Un,Yi.defaultValues(Un))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Fu:return S;case Un:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.policyIdentifier||S}),new b({optional:!0,value:[new _e({name:t.policyQualifiers||S,value:Qi.schema()})]})]})}fromSchema(e){W(e,gE);const t=j(e,e,Yi.schema({names:{policyIdentifier:Fu,policyQualifiers:Un}}));P.assertSchema(t,this.className),this.policyIdentifier=t.result.policyIdentifier.valueBlock.toString(),Un in t.result&&(this.policyQualifiers=Array.from(t.result.policyQualifiers,r=>new Qi({schema:r})))}toSchema(){const e=[];return e.push(new he({value:this.policyIdentifier})),this.policyQualifiers&&e.push(new b({value:Array.from(this.policyQualifiers,t=>t.toSchema())})),new b({value:e})}toJSON(){const e={policyIdentifier:this.policyIdentifier};return this.policyQualifiers&&(e.policyQualifiers=Array.from(this.policyQualifiers,t=>t.toJSON())),e}}Yi.CLASS_NAME="PolicyInformation";const qu="certificatePolicies",mE=[qu];class ou extends G{constructor(e={}){super(),this.certificatePolicies=m(e,qu,ou.defaultValues(qu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case qu:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _e({name:t.certificatePolicies||S,value:Yi.schema()})]})}fromSchema(e){W(e,mE);const t=j(e,e,ou.schema({names:{certificatePolicies:qu}}));P.assertSchema(t,this.className),this.certificatePolicies=Array.from(t.result.certificatePolicies,r=>new Yi({schema:r}))}toSchema(){return new b({value:Array.from(this.certificatePolicies,e=>e.toSchema())})}toJSON(){return{certificatePolicies:Array.from(this.certificatePolicies,e=>e.toJSON())}}}ou.CLASS_NAME="CertificatePolicies";const Ju="templateID",Os="templateMajorVersion",Ps="templateMinorVersion",pE=[Ju,Os,Ps];class Jl extends G{constructor(e={}){super(),this.templateID=m(e,Ju,Jl.defaultValues(Ju)),Os in e&&(this.templateMajorVersion=m(e,Os,Jl.defaultValues(Os))),Ps in e&&(this.templateMinorVersion=m(e,Ps,Jl.defaultValues(Ps))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ju:return S;case Os:case Ps:return 0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.templateID||S}),new _({name:t.templateMajorVersion||S,optional:!0}),new _({name:t.templateMinorVersion||S,optional:!0})]})}fromSchema(e){W(e,pE);const t=j(e,e,Jl.schema({names:{templateID:Ju,templateMajorVersion:Os,templateMinorVersion:Ps}}));P.assertSchema(t,this.className),this.templateID=t.result.templateID.valueBlock.toString(),Os in t.result&&(this.templateMajorVersion=t.result.templateMajorVersion.valueBlock.valueDec),Ps in t.result&&(this.templateMinorVersion=t.result.templateMinorVersion.valueBlock.valueDec)}toSchema(){const e=[];return e.push(new he({value:this.templateID})),Os in this&&e.push(new _({value:this.templateMajorVersion})),Ps in this&&e.push(new _({value:this.templateMinorVersion})),new b({value:e})}toJSON(){const e={templateID:this.templateID};return Os in this&&(e.templateMajorVersion=this.templateMajorVersion),Ps in this&&(e.templateMinorVersion=this.templateMinorVersion),e}}const Kn="distributionPoint",a1="distributionPointNames",Mn="reasons",Hn="cRLIssuer",n1="cRLIssuerNames",yE=[Kn,a1,Mn,Hn,n1];class gn extends G{constructor(e={}){super(),Kn in e&&(this.distributionPoint=m(e,Kn,gn.defaultValues(Kn))),Mn in e&&(this.reasons=m(e,Mn,gn.defaultValues(Mn))),Hn in e&&(this.cRLIssuer=m(e,Hn,gn.defaultValues(Hn))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Kn:return[];case Mn:return new He;case Hn:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new wt({value:[new N({name:t.distributionPoint||S,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new _e({name:t.distributionPointNames||S,value:ze.schema()})]}),new N({name:t.distributionPoint||S,optional:!0,idBlock:{tagClass:3,tagNumber:1},value:rt.schema().valueBlock.value})]})]}),new Ie({name:t.reasons||S,optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new N({name:t.cRLIssuer||S,optional:!0,idBlock:{tagClass:3,tagNumber:2},value:[new _e({name:t.cRLIssuerNames||S,value:ze.schema()})]})]})}fromSchema(e){W(e,yE);const t=j(e,e,gn.schema({names:{distributionPoint:Kn,distributionPointNames:a1,reasons:Mn,cRLIssuer:Hn,cRLIssuerNames:n1}}));P.assertSchema(t,this.className),Kn in t.result&&(t.result.distributionPoint.idBlock.tagNumber===0&&(this.distributionPoint=Array.from(t.result.distributionPointNames,r=>new ze({schema:r}))),t.result.distributionPoint.idBlock.tagNumber===1&&(this.distributionPoint=new rt({schema:new b({value:t.result.distributionPoint.valueBlock.value})}))),Mn in t.result&&(this.reasons=new He({valueHex:t.result.reasons.valueBlock.valueHex})),Hn in t.result&&(this.cRLIssuer=Array.from(t.result.cRLIssuerNames,r=>new ze({schema:r})))}toSchema(){const e=[];if(this.distributionPoint){let t;this.distributionPoint instanceof Array?t=new N({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,r=>r.toSchema())}):t=new N({idBlock:{tagClass:3,tagNumber:1},value:[this.distributionPoint.toSchema()]}),e.push(new N({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}return this.reasons&&e.push(new Ie({idBlock:{tagClass:3,tagNumber:1},valueHex:this.reasons.valueBlock.valueHexView})),this.cRLIssuer&&e.push(new N({idBlock:{tagClass:3,tagNumber:2},value:Array.from(this.cRLIssuer,t=>t.toSchema())})),new b({value:e})}toJSON(){const e={};return this.distributionPoint&&(this.distributionPoint instanceof Array?e.distributionPoint=Array.from(this.distributionPoint,t=>t.toJSON()):e.distributionPoint=this.distributionPoint.toJSON()),this.reasons&&(e.reasons=this.reasons.toJSON()),this.cRLIssuer&&(e.cRLIssuer=Array.from(this.cRLIssuer,t=>t.toJSON())),e}}gn.CLASS_NAME="DistributionPoint";const Gu="distributionPoints",vE=[Gu];class lu extends G{constructor(e={}){super(),this.distributionPoints=m(e,Gu,lu.defaultValues(Gu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Gu:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _e({name:t.distributionPoints||S,value:gn.schema()})]})}fromSchema(e){W(e,vE);const t=j(e,e,lu.schema({names:{distributionPoints:Gu}}));P.assertSchema(t,this.className),this.distributionPoints=Array.from(t.result.distributionPoints,r=>new gn({schema:r}))}toSchema(){return new b({value:Array.from(this.distributionPoints,e=>e.toSchema())})}toJSON(){return{distributionPoints:Array.from(this.distributionPoints,e=>e.toJSON())}}}lu.CLASS_NAME="CRLDistributionPoints";const ju="keyPurposes",wE=[ju];class qf extends G{constructor(e={}){super(),this.keyPurposes=m(e,ju,qf.defaultValues(ju)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ju:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _e({name:t.keyPurposes||S,value:new he})]})}fromSchema(e){W(e,wE);const t=j(e,e,qf.schema({names:{keyPurposes:ju}}));P.assertSchema(t,this.className),this.keyPurposes=Array.from(t.result.keyPurposes,r=>r.valueBlock.toString())}toSchema(){return new b({value:Array.from(this.keyPurposes,e=>new he({value:e}))})}toJSON(){return{keyPurposes:Array.from(this.keyPurposes)}}}qf.CLASS_NAME="ExtKeyUsage";const Eu="accessDescriptions";class uu extends G{constructor(e={}){super(),this.accessDescriptions=m(e,Eu,uu.defaultValues(Eu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Eu:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _e({name:t.accessDescriptions||S,value:ji.schema()})]})}fromSchema(e){W(e,[Eu]);const t=j(e,e,uu.schema({names:{accessDescriptions:Eu}}));P.assertSchema(t,this.className),this.accessDescriptions=Array.from(t.result.accessDescriptions,r=>new ji({schema:r}))}toSchema(){return new b({value:Array.from(this.accessDescriptions,e=>e.toSchema())})}toJSON(){return{accessDescriptions:Array.from(this.accessDescriptions,e=>e.toJSON())}}}uu.CLASS_NAME="InfoAccess";const Fn="distributionPoint",i1="distributionPointNames",Sa="onlyContainsUserCerts",Ca="onlyContainsCACerts",Aa="onlySomeReasons",Ea="indirectCRL",ba="onlyContainsAttributeCerts",SE=[Fn,i1,Sa,Ca,Aa,Ea,ba];class Wt extends G{constructor(e={}){super(),Fn in e&&(this.distributionPoint=m(e,Fn,Wt.defaultValues(Fn))),this.onlyContainsUserCerts=m(e,Sa,Wt.defaultValues(Sa)),this.onlyContainsCACerts=m(e,Ca,Wt.defaultValues(Ca)),Aa in e&&(this.onlySomeReasons=m(e,Aa,Wt.defaultValues(Aa))),this.indirectCRL=m(e,Ea,Wt.defaultValues(Ea)),this.onlyContainsAttributeCerts=m(e,ba,Wt.defaultValues(ba)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Fn:return[];case Sa:return!1;case Ca:return!1;case Aa:return 0;case Ea:return!1;case ba:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new wt({value:[new N({name:t.distributionPoint||S,idBlock:{tagClass:3,tagNumber:0},value:[new _e({name:t.distributionPointNames||S,value:ze.schema()})]}),new N({name:t.distributionPoint||S,idBlock:{tagClass:3,tagNumber:1},value:rt.schema().valueBlock.value})]})]}),new Ie({name:t.onlyContainsUserCerts||S,optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new Ie({name:t.onlyContainsCACerts||S,optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new Ie({name:t.onlySomeReasons||S,optional:!0,idBlock:{tagClass:3,tagNumber:3}}),new Ie({name:t.indirectCRL||S,optional:!0,idBlock:{tagClass:3,tagNumber:4}}),new Ie({name:t.onlyContainsAttributeCerts||S,optional:!0,idBlock:{tagClass:3,tagNumber:5}})]})}fromSchema(e){W(e,SE);const t=j(e,e,Wt.schema({names:{distributionPoint:Fn,distributionPointNames:i1,onlyContainsUserCerts:Sa,onlyContainsCACerts:Ca,onlySomeReasons:Aa,indirectCRL:Ea,onlyContainsAttributeCerts:ba}}));if(P.assertSchema(t,this.className),Fn in t.result)switch(!0){case t.result.distributionPoint.idBlock.tagNumber===0:this.distributionPoint=Array.from(t.result.distributionPointNames,r=>new ze({schema:r}));break;case t.result.distributionPoint.idBlock.tagNumber===1:this.distributionPoint=new rt({schema:new b({value:t.result.distributionPoint.valueBlock.value})});break;default:throw new Error("Unknown tagNumber for distributionPoint: {$asn1.result.distributionPoint.idBlock.tagNumber}")}if(Sa in t.result){const r=new Uint8Array(t.result.onlyContainsUserCerts.valueBlock.valueHex);this.onlyContainsUserCerts=r[0]!==0}if(Ca in t.result){const r=new Uint8Array(t.result.onlyContainsCACerts.valueBlock.valueHex);this.onlyContainsCACerts=r[0]!==0}if(Aa in t.result){const r=new Uint8Array(t.result.onlySomeReasons.valueBlock.valueHex);this.onlySomeReasons=r[0]}if(Ea in t.result){const r=new Uint8Array(t.result.indirectCRL.valueBlock.valueHex);this.indirectCRL=r[0]!==0}if(ba in t.result){const r=new Uint8Array(t.result.onlyContainsAttributeCerts.valueBlock.valueHex);this.onlyContainsAttributeCerts=r[0]!==0}}toSchema(){const e=[];if(this.distributionPoint){let t;this.distributionPoint instanceof Array?t=new N({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,r=>r.toSchema())}):(t=this.distributionPoint.toSchema(),t.idBlock.tagClass=3,t.idBlock.tagNumber=1),e.push(new N({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if(this.onlyContainsUserCerts!==Wt.defaultValues(Sa)&&e.push(new Ie({idBlock:{tagClass:3,tagNumber:1},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsCACerts!==Wt.defaultValues(Ca)&&e.push(new Ie({idBlock:{tagClass:3,tagNumber:2},valueHex:new Uint8Array([255]).buffer})),this.onlySomeReasons!==void 0){const t=new ArrayBuffer(1),r=new Uint8Array(t);r[0]=this.onlySomeReasons,e.push(new Ie({idBlock:{tagClass:3,tagNumber:3},valueHex:t}))}return this.indirectCRL!==Wt.defaultValues(Ea)&&e.push(new Ie({idBlock:{tagClass:3,tagNumber:4},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsAttributeCerts!==Wt.defaultValues(ba)&&e.push(new Ie({idBlock:{tagClass:3,tagNumber:5},valueHex:new Uint8Array([255]).buffer})),new b({value:e})}toJSON(){const e={};return this.distributionPoint&&(this.distributionPoint instanceof Array?e.distributionPoint=Array.from(this.distributionPoint,t=>t.toJSON()):e.distributionPoint=this.distributionPoint.toJSON()),this.onlyContainsUserCerts!==Wt.defaultValues(Sa)&&(e.onlyContainsUserCerts=this.onlyContainsUserCerts),this.onlyContainsCACerts!==Wt.defaultValues(Ca)&&(e.onlyContainsCACerts=this.onlyContainsCACerts),Aa in this&&(e.onlySomeReasons=this.onlySomeReasons),this.indirectCRL!==Wt.defaultValues(Ea)&&(e.indirectCRL=this.indirectCRL),this.onlyContainsAttributeCerts!==Wt.defaultValues(ba)&&(e.onlyContainsAttributeCerts=this.onlyContainsAttributeCerts),e}}Wt.CLASS_NAME="IssuingDistributionPoint";const Wu="base",ko="minimum",ka="maximum",CE=[Wu,ko,ka];class xs extends G{constructor(e={}){super(),this.base=m(e,Wu,xs.defaultValues(Wu)),this.minimum=m(e,ko,xs.defaultValues(ko)),ka in e&&(this.maximum=m(e,ka,xs.defaultValues(ka))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Wu:return new ze;case ko:return 0;case ka:return 0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[ze.schema(t.base||{}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new _({name:t.minimum||S})]}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new _({name:t.maximum||S})]})]})}fromSchema(e){W(e,CE);const t=j(e,e,xs.schema({names:{base:{names:{blockName:Wu}},minimum:ko,maximum:ka}}));P.assertSchema(t,this.className),this.base=new ze({schema:t.result.base}),ko in t.result&&(t.result.minimum.valueBlock.isHexOnly?this.minimum=t.result.minimum:this.minimum=t.result.minimum.valueBlock.valueDec),ka in t.result&&(t.result.maximum.valueBlock.isHexOnly?this.maximum=t.result.maximum:this.maximum=t.result.maximum.valueBlock.valueDec)}toSchema(){const e=[];if(e.push(this.base.toSchema()),this.minimum!==0){let t=0;this.minimum instanceof _?t=this.minimum:t=new _({value:this.minimum}),e.push(new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if(ka in this){let t=0;this.maximum instanceof _?t=this.maximum:t=new _({value:this.maximum}),e.push(new N({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[t]}))}return new b({value:e})}toJSON(){const e={base:this.base.toJSON()};return this.minimum!==0&&(typeof this.minimum=="number"?e.minimum=this.minimum:e.minimum=this.minimum.toJSON()),this.maximum!==void 0&&(typeof this.maximum=="number"?e.maximum=this.maximum:e.maximum=this.maximum.toJSON()),e}}xs.CLASS_NAME="GeneralSubtree";const qn="permittedSubtrees",Jn="excludedSubtrees",AE=[qn,Jn];class Ql extends G{constructor(e={}){super(),qn in e&&(this.permittedSubtrees=m(e,qn,Ql.defaultValues(qn))),Jn in e&&(this.excludedSubtrees=m(e,Jn,Ql.defaultValues(Jn))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case qn:case Jn:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new _e({name:t.permittedSubtrees||S,value:xs.schema()})]}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new _e({name:t.excludedSubtrees||S,value:xs.schema()})]})]})}fromSchema(e){W(e,AE);const t=j(e,e,Ql.schema({names:{permittedSubtrees:qn,excludedSubtrees:Jn}}));P.assertSchema(t,this.className),qn in t.result&&(this.permittedSubtrees=Array.from(t.result.permittedSubtrees,r=>new xs({schema:r}))),Jn in t.result&&(this.excludedSubtrees=Array.from(t.result.excludedSubtrees,r=>new xs({schema:r})))}toSchema(){const e=[];return this.permittedSubtrees&&e.push(new N({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.permittedSubtrees,t=>t.toSchema())})),this.excludedSubtrees&&e.push(new N({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.excludedSubtrees,t=>t.toSchema())})),new b({value:e})}toJSON(){const e={};return this.permittedSubtrees&&(e.permittedSubtrees=Array.from(this.permittedSubtrees,t=>t.toJSON())),this.excludedSubtrees&&(e.excludedSubtrees=Array.from(this.excludedSubtrees,t=>t.toJSON())),e}}Ql.CLASS_NAME="NameConstraints";const Us="requireExplicitPolicy",Ks="inhibitPolicyMapping",EE=[Us,Ks];class Yl extends G{constructor(e={}){super(),Us in e&&(this.requireExplicitPolicy=m(e,Us,Yl.defaultValues(Us))),Ks in e&&(this.inhibitPolicyMapping=m(e,Ks,Yl.defaultValues(Ks))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Us:return 0;case Ks:return 0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new Ie({name:t.requireExplicitPolicy||S,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Ie({name:t.inhibitPolicyMapping||S,optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){W(e,EE);const t=j(e,e,Yl.schema({names:{requireExplicitPolicy:Us,inhibitPolicyMapping:Ks}}));if(P.assertSchema(t,this.className),Us in t.result){const r=t.result.requireExplicitPolicy;r.idBlock.tagClass=1,r.idBlock.tagNumber=2;const a=r.toBER(!1),n=_t(a);P.assert(n,"Integer"),this.requireExplicitPolicy=n.result.valueBlock.valueDec}if(Ks in t.result){const r=t.result.inhibitPolicyMapping;r.idBlock.tagClass=1,r.idBlock.tagNumber=2;const a=r.toBER(!1),n=_t(a);P.assert(n,"Integer"),this.inhibitPolicyMapping=n.result.valueBlock.valueDec}}toSchema(){const e=[];if(Us in this){const t=new _({value:this.requireExplicitPolicy});t.idBlock.tagClass=3,t.idBlock.tagNumber=0,e.push(t)}if(Ks in this){const t=new _({value:this.inhibitPolicyMapping});t.idBlock.tagClass=3,t.idBlock.tagNumber=1,e.push(t)}return new b({value:e})}toJSON(){const e={};return Us in this&&(e.requireExplicitPolicy=this.requireExplicitPolicy),Ks in this&&(e.inhibitPolicyMapping=this.inhibitPolicyMapping),e}}Yl.CLASS_NAME="PolicyConstraints";const Qu="issuerDomainPolicy",Yu="subjectDomainPolicy",bE=[Qu,Yu];class zi extends G{constructor(e={}){super(),this.issuerDomainPolicy=m(e,Qu,zi.defaultValues(Qu)),this.subjectDomainPolicy=m(e,Yu,zi.defaultValues(Yu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Qu:return S;case Yu:return S;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.issuerDomainPolicy||S}),new he({name:t.subjectDomainPolicy||S})]})}fromSchema(e){W(e,bE);const t=j(e,e,zi.schema({names:{issuerDomainPolicy:Qu,subjectDomainPolicy:Yu}}));P.assertSchema(t,this.className),this.issuerDomainPolicy=t.result.issuerDomainPolicy.valueBlock.toString(),this.subjectDomainPolicy=t.result.subjectDomainPolicy.valueBlock.toString()}toSchema(){return new b({value:[new he({value:this.issuerDomainPolicy}),new he({value:this.subjectDomainPolicy})]})}toJSON(){return{issuerDomainPolicy:this.issuerDomainPolicy,subjectDomainPolicy:this.subjectDomainPolicy}}}zi.CLASS_NAME="PolicyMapping";const zu="mappings",kE=[zu];class Jf extends G{constructor(e={}){super(),this.mappings=m(e,zu,Jf.defaultValues(zu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case zu:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _e({name:t.mappings||S,value:zi.schema()})]})}fromSchema(e){W(e,kE);const t=j(e,e,Jf.schema({names:{mappings:zu}}));P.assertSchema(t,this.className),this.mappings=Array.from(t.result.mappings,r=>new zi({schema:r}))}toSchema(){return new b({value:Array.from(this.mappings,e=>e.toSchema())})}toJSON(){return{mappings:Array.from(this.mappings,e=>e.toJSON())}}}Jf.CLASS_NAME="PolicyMappings";const Ia="notBefore",Ba="notAfter",IE=[Ia,Ba];class zl extends G{constructor(e={}){super(),Ia in e&&(this.notBefore=m(e,Ia,zl.defaultValues(Ia))),Ba in e&&(this.notAfter=m(e,Ba,zl.defaultValues(Ba))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ia:return new Date;case Ba:return new Date;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new Ie({name:t.notBefore||S,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Ie({name:t.notAfter||S,optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){W(e,IE);const t=j(e,e,zl.schema({names:{notBefore:Ia,notAfter:Ba}}));if(P.assertSchema(t,this.className),Ia in t.result){const r=new vt;r.fromBuffer(t.result.notBefore.valueBlock.valueHex),this.notBefore=r.toDate()}if(Ba in t.result){const r=new vt({valueHex:t.result.notAfter.valueBlock.valueHex});r.fromBuffer(t.result.notAfter.valueBlock.valueHex),this.notAfter=r.toDate()}}toSchema(){const e=[];return Ia in this&&e.push(new Ie({idBlock:{tagClass:3,tagNumber:0},valueHex:new vt({valueDate:this.notBefore}).valueBlock.valueHexView})),Ba in this&&e.push(new Ie({idBlock:{tagClass:3,tagNumber:1},valueHex:new vt({valueDate:this.notAfter}).valueBlock.valueHexView})),new b({value:e})}toJSON(){const e={};return this.notBefore&&(e.notBefore=this.notBefore),this.notAfter&&(e.notAfter=this.notAfter),e}}zl.CLASS_NAME="PrivateKeyUsagePeriod";const Io="id",Ms="type",Bo="values",BE=[Io,Ms],xE=[Bo];class Xi extends G{constructor(e={}){super(),this.id=m(e,Io,Xi.defaultValues(Io)),Ms in e&&(this.type=m(e,Ms,Xi.defaultValues(Ms))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Io:return S;case Ms:return new It;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Io:return t===S;case Ms:return t instanceof It;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.id||S}),new xe({name:t.type||S,optional:!0})]})}fromSchema(e){W(e,BE);const t=j(e,e,Xi.schema({names:{id:Io,type:Ms}}));P.assertSchema(t,this.className),this.id=t.result.id.valueBlock.toString(),Ms in t.result&&(this.type=t.result.type)}toSchema(){const e=[new he({value:this.id})];return Ms in this&&e.push(this.type),new b({value:e})}toJSON(){const e={id:this.id};return this.type&&(e.type=this.type.toJSON()),e}}Xi.CLASS_NAME="QCStatement";class Gf extends G{constructor(e={}){super(),this.values=m(e,Bo,Gf.defaultValues(Bo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Bo:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Bo:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _e({name:t.values||S,value:Xi.schema(t.value||{})})]})}fromSchema(e){W(e,xE);const t=j(e,e,Gf.schema({names:{values:Bo}}));P.assertSchema(t,this.className),this.values=Array.from(t.result.values,r=>new Xi({schema:r}))}toSchema(){return new b({value:Array.from(this.values,e=>e.toSchema())})}toJSON(){return{values:Array.from(this.values,e=>e.toJSON())}}}Gf.CLASS_NAME="QCStatements";var Gn;class Cn{static register(e,t,r){this.namedCurves[e.toLowerCase()]=this.namedCurves[t]={name:e,id:t,size:r}}static find(e){return this.namedCurves[e.toLowerCase()]||null}}Gn=Cn;Cn.namedCurves={};Gn.register("P-256","1.2.840.10045.3.1.7",32),Gn.register("P-384","1.3.132.0.34",48),Gn.register("P-521","1.3.132.0.35",66),Gn.register("brainpoolP256r1","1.3.36.3.3.2.8.1.1.7",32),Gn.register("brainpoolP384r1","1.3.36.3.3.2.8.1.1.11",48),Gn.register("brainpoolP512r1","1.3.36.3.3.2.8.1.1.13",64);const fh="x",hh="y",dh="namedCurve";class pr extends G{constructor(e={}){super(),this.x=m(e,fh,pr.defaultValues(fh)),this.y=m(e,hh,pr.defaultValues(hh)),this.namedCurve=m(e,dh,pr.defaultValues(dh)),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case fh:case hh:return $t;case dh:return S;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case fh:case hh:return t instanceof ArrayBuffer&&su(t,pr.defaultValues(e));case dh:return typeof t=="string"&&t===pr.defaultValues(e);default:return super.defaultValues(e)}}static schema(){return new x0}fromSchema(e){const t=Ee.toUint8Array(e);if(t[0]!==4)throw new Error("Object's schema was not verified against input data for ECPublicKey");const r=Cn.find(this.namedCurve);if(!r)throw new Error(`Incorrect curve OID: ${this.namedCurve}`);const a=r.size;if(t.byteLength!==a*2+1)throw new Error("Object's schema was not verified against input data for ECPublicKey");this.namedCurve=r.name,this.x=t.slice(1,a+1).buffer,this.y=t.slice(1+a,a*2+1).buffer}toSchema(){return new x0({data:jl(new Uint8Array([4]).buffer,this.x,this.y)})}toJSON(){const e=Cn.find(this.namedCurve);return{crv:e?e.name:this.namedCurve,x:gg(I0(this.x),!0,!0,!1),y:gg(I0(this.y),!0,!0,!1)}}fromJSON(e){Ge.assert("json",e,"crv","x","y");let t=0;const r=Cn.find(e.crv);r&&(this.namedCurve=r.id,t=r.size);const a=au(Pf(e.x,!0));if(a.byteLength<t){this.x=new ArrayBuffer(t);const i=new Uint8Array(this.x),o=new Uint8Array(a);i.set(o,1)}else this.x=a.slice(0,t);const n=au(Pf(e.y,!0));if(n.byteLength<t){this.y=new ArrayBuffer(t);const i=new Uint8Array(this.y),o=new Uint8Array(n);i.set(o,1)}else this.y=n.slice(0,t)}}pr.CLASS_NAME="ECPublicKey";const Xu="modulus",Zu="publicExponent",NE=[Xu,Zu];class Zi extends G{constructor(e={}){super(),this.modulus=m(e,Xu,Zi.defaultValues(Xu)),this.publicExponent=m(e,Zu,Zi.defaultValues(Zu)),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Xu:return new _;case Zu:return new _;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _({name:t.modulus||S}),new _({name:t.publicExponent||S})]})}fromSchema(e){W(e,NE);const t=j(e,e,Zi.schema({names:{modulus:Xu,publicExponent:Zu}}));P.assertSchema(t,this.className),this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent}toSchema(){return new b({value:[this.modulus.convertToDER(),this.publicExponent]})}toJSON(){return{n:ke.ToBase64Url(this.modulus.valueBlock.valueHexView),e:ke.ToBase64Url(this.publicExponent.valueBlock.valueHexView)}}fromJSON(e){Ge.assert("json",e,"n","e");const t=au(Pf(e.n,!0));this.modulus=new _({valueHex:t.slice(0,Math.pow(2,bA(t.byteLength)))}),this.publicExponent=new _({valueHex:au(Pf(e.e,!0)).slice(0,3)})}}Zi.CLASS_NAME="RSAPublicKey";const ec="algorithm",tc="subjectPublicKey",TE=[ec,tc];class wr extends G{constructor(e={}){super(),this.algorithm=m(e,ec,wr.defaultValues(ec)),this.subjectPublicKey=m(e,tc,wr.defaultValues(tc));const t=m(e,"parsedKey",null);t&&(this.parsedKey=t),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}get parsedKey(){if(this._parsedKey===void 0){switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":if("algorithmParams"in this.algorithm&&this.algorithm.algorithmParams.constructor.blockName()===he.blockName())try{this._parsedKey=new pr({namedCurve:this.algorithm.algorithmParams.valueBlock.toString(),schema:this.subjectPublicKey.valueBlock.valueHexView})}catch{}break;case"1.2.840.113549.1.1.1":{const e=_t(this.subjectPublicKey.valueBlock.valueHexView);if(e.offset!==-1)try{this._parsedKey=new Zi({schema:e.result})}catch{}}break}this._parsedKey||(this._parsedKey=null)}return this._parsedKey||void 0}set parsedKey(e){this._parsedKey=e}static defaultValues(e){switch(e){case ec:return new $;case tc:return new He;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[$.schema(t.algorithm||{}),new He({name:t.subjectPublicKey||S})]})}fromSchema(e){W(e,TE);const t=j(e,e,wr.schema({names:{algorithm:{names:{blockName:ec}},subjectPublicKey:tc}}));P.assertSchema(t,this.className),this.algorithm=new $({schema:t.result.algorithm}),this.subjectPublicKey=t.result.subjectPublicKey}toSchema(){return new b({value:[this.algorithm.toSchema(),this.subjectPublicKey]})}toJSON(){if(!this.parsedKey)return{algorithm:this.algorithm.toJSON(),subjectPublicKey:this.subjectPublicKey.toJSON()};const e={};switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA";break}const t=this.parsedKey.toJSON();return Object.assign(e,t),e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new pr({json:e}),this.algorithm=new $({algorithmId:"1.2.840.10045.2.1",algorithmParams:new he({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new Zi({json:e}),this.algorithm=new $({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new It});break;default:throw new Error(`Invalid value for "kty" parameter: ${e.kty}`)}this.subjectPublicKey=new He({valueHex:this.parsedKey.toSchema().toBER(!1)})}}async importKey(e,t=Le(!0)){try{if(!e)throw new Error("Need to provide publicKey input parameter");const r=await t.exportKey("spki",e),a=_t(r);try{this.fromSchema(a.result)}catch{throw new Error("Error during initializing object from schema")}}catch(r){const a=r instanceof Error?r.message:`${r}`;throw new Error(`Error during exporting public key: ${a}`)}}}wr.CLASS_NAME="PublicKeyInfo";const xo="version",No="privateKey",ts="namedCurve",xa="publicKey",RE=[xo,No,ts,xa];class Hr extends G{constructor(e={}){super(),this.version=m(e,xo,Hr.defaultValues(xo)),this.privateKey=m(e,No,Hr.defaultValues(No)),ts in e&&(this.namedCurve=m(e,ts,Hr.defaultValues(ts))),xa in e&&(this.publicKey=m(e,xa,Hr.defaultValues(xa))),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case xo:return 1;case No:return new z;case ts:return S;case xa:return new pr;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case xo:return t===Hr.defaultValues(e);case No:return t.isEqual(Hr.defaultValues(e));case ts:return t===S;case xa:return pr.compareWithDefault(ts,t.namedCurve)&&pr.compareWithDefault("x",t.x)&&pr.compareWithDefault("y",t.y);default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _({name:t.version||S}),new z({name:t.privateKey||S}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new he({name:t.namedCurve||S})]}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new He({name:t.publicKey||S})]})]})}fromSchema(e){W(e,RE);const t=j(e,e,Hr.schema({names:{version:xo,privateKey:No,namedCurve:ts,publicKey:xa}}));if(P.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.privateKey=t.result.privateKey,ts in t.result&&(this.namedCurve=t.result.namedCurve.valueBlock.toString()),xa in t.result){const r={schema:t.result.publicKey.valueBlock.valueHex};ts in this&&(r.namedCurve=this.namedCurve),this.publicKey=new pr(r)}}toSchema(){const e=[new _({value:this.version}),this.privateKey];return this.namedCurve&&e.push(new N({idBlock:{tagClass:3,tagNumber:0},value:[new he({value:this.namedCurve})]})),this.publicKey&&e.push(new N({idBlock:{tagClass:3,tagNumber:1},value:[new He({valueHex:this.publicKey.toSchema().toBER(!1)})]})),new b({value:e})}toJSON(){if(!this.namedCurve||Hr.compareWithDefault(ts,this.namedCurve))throw new Error('Not enough information for making JSON: absent "namedCurve" value');const e=Cn.find(this.namedCurve),t={crv:e?e.name:this.namedCurve,d:ke.ToBase64Url(this.privateKey.valueBlock.valueHexView)};if(this.publicKey){const r=this.publicKey.toJSON();t.x=r.x,t.y=r.y}return t}fromJSON(e){Ge.assert("json",e,"crv","d");let t=0;const r=Cn.find(e.crv);r&&(this.namedCurve=r.id,t=r.size);const a=ke.FromBase64Url(e.d);if(a.byteLength<t){const n=new ArrayBuffer(t),i=new Uint8Array(n),o=new Uint8Array(a);i.set(o,1),this.privateKey=new z({valueHex:n})}else this.privateKey=new z({valueHex:a.slice(0,t)});e.x&&e.y&&(this.publicKey=new pr({json:e}))}}Hr.CLASS_NAME="ECPrivateKey";const rc="prime",sc="exponent",ac="coefficient",VE=[rc,sc,ac];class Xs extends G{constructor(e={}){super(),this.prime=m(e,rc,Xs.defaultValues(rc)),this.exponent=m(e,sc,Xs.defaultValues(sc)),this.coefficient=m(e,ac,Xs.defaultValues(ac)),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case rc:return new _;case sc:return new _;case ac:return new _;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _({name:t.prime||S}),new _({name:t.exponent||S}),new _({name:t.coefficient||S})]})}fromSchema(e){W(e,VE);const t=j(e,e,Xs.schema({names:{prime:rc,exponent:sc,coefficient:ac}}));P.assertSchema(t,this.className),this.prime=t.result.prime.convertFromDER(),this.exponent=t.result.exponent.convertFromDER(),this.coefficient=t.result.coefficient.convertFromDER()}toSchema(){return new b({value:[this.prime.convertToDER(),this.exponent.convertToDER(),this.coefficient.convertToDER()]})}toJSON(){return{r:ke.ToBase64Url(this.prime.valueBlock.valueHexView),d:ke.ToBase64Url(this.exponent.valueBlock.valueHexView),t:ke.ToBase64Url(this.coefficient.valueBlock.valueHexView)}}fromJSON(e){Ge.assert("json",e,"r","d","r"),this.prime=new _({valueHex:ke.FromBase64Url(e.r)}),this.exponent=new _({valueHex:ke.FromBase64Url(e.d)}),this.coefficient=new _({valueHex:ke.FromBase64Url(e.t)})}}Xs.CLASS_NAME="OtherPrimeInfo";const nc="version",ic="modulus",oc="publicExponent",lc="privateExponent",uc="prime1",cc="prime2",fc="exponent1",hc="exponent2",dc="coefficient",jn="otherPrimeInfos",_E=[nc,ic,oc,lc,uc,cc,fc,hc,dc,jn];class fr extends G{constructor(e={}){super(),this.version=m(e,nc,fr.defaultValues(nc)),this.modulus=m(e,ic,fr.defaultValues(ic)),this.publicExponent=m(e,oc,fr.defaultValues(oc)),this.privateExponent=m(e,lc,fr.defaultValues(lc)),this.prime1=m(e,uc,fr.defaultValues(uc)),this.prime2=m(e,cc,fr.defaultValues(cc)),this.exponent1=m(e,fc,fr.defaultValues(fc)),this.exponent2=m(e,hc,fr.defaultValues(hc)),this.coefficient=m(e,dc,fr.defaultValues(dc)),jn in e&&(this.otherPrimeInfos=m(e,jn,fr.defaultValues(jn))),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case nc:return 0;case ic:return new _;case oc:return new _;case lc:return new _;case uc:return new _;case cc:return new _;case fc:return new _;case hc:return new _;case dc:return new _;case jn:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _({name:t.version||S}),new _({name:t.modulus||S}),new _({name:t.publicExponent||S}),new _({name:t.privateExponent||S}),new _({name:t.prime1||S}),new _({name:t.prime2||S}),new _({name:t.exponent1||S}),new _({name:t.exponent2||S}),new _({name:t.coefficient||S}),new b({optional:!0,value:[new _e({name:t.otherPrimeInfosName||S,value:Xs.schema(t.otherPrimeInfo||{})})]})]})}fromSchema(e){W(e,_E);const t=j(e,e,fr.schema({names:{version:nc,modulus:ic,publicExponent:oc,privateExponent:lc,prime1:uc,prime2:cc,exponent1:fc,exponent2:hc,coefficient:dc,otherPrimeInfo:{names:{blockName:jn}}}}));P.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent,this.privateExponent=t.result.privateExponent.convertFromDER(256),this.prime1=t.result.prime1.convertFromDER(128),this.prime2=t.result.prime2.convertFromDER(128),this.exponent1=t.result.exponent1.convertFromDER(128),this.exponent2=t.result.exponent2.convertFromDER(128),this.coefficient=t.result.coefficient.convertFromDER(128),jn in t.result&&(this.otherPrimeInfos=Array.from(t.result.otherPrimeInfos,r=>new Xs({schema:r})))}toSchema(){const e=[];return e.push(new _({value:this.version})),e.push(this.modulus.convertToDER()),e.push(this.publicExponent),e.push(this.privateExponent.convertToDER()),e.push(this.prime1.convertToDER()),e.push(this.prime2.convertToDER()),e.push(this.exponent1.convertToDER()),e.push(this.exponent2.convertToDER()),e.push(this.coefficient.convertToDER()),this.otherPrimeInfos&&e.push(new b({value:Array.from(this.otherPrimeInfos,t=>t.toSchema())})),new b({value:e})}toJSON(){const e={n:ke.ToBase64Url(this.modulus.valueBlock.valueHexView),e:ke.ToBase64Url(this.publicExponent.valueBlock.valueHexView),d:ke.ToBase64Url(this.privateExponent.valueBlock.valueHexView),p:ke.ToBase64Url(this.prime1.valueBlock.valueHexView),q:ke.ToBase64Url(this.prime2.valueBlock.valueHexView),dp:ke.ToBase64Url(this.exponent1.valueBlock.valueHexView),dq:ke.ToBase64Url(this.exponent2.valueBlock.valueHexView),qi:ke.ToBase64Url(this.coefficient.valueBlock.valueHexView)};return this.otherPrimeInfos&&(e.oth=Array.from(this.otherPrimeInfos,t=>t.toJSON())),e}fromJSON(e){Ge.assert("json",e,"n","e","d","p","q","dp","dq","qi"),this.modulus=new _({valueHex:ke.FromBase64Url(e.n)}),this.publicExponent=new _({valueHex:ke.FromBase64Url(e.e)}),this.privateExponent=new _({valueHex:ke.FromBase64Url(e.d)}),this.prime1=new _({valueHex:ke.FromBase64Url(e.p)}),this.prime2=new _({valueHex:ke.FromBase64Url(e.q)}),this.exponent1=new _({valueHex:ke.FromBase64Url(e.dp)}),this.exponent2=new _({valueHex:ke.FromBase64Url(e.dq)}),this.coefficient=new _({valueHex:ke.FromBase64Url(e.qi)}),e.oth&&(this.otherPrimeInfos=Array.from(e.oth,t=>new Xs({json:t})))}}fr.CLASS_NAME="RSAPrivateKey";const gc="version",mc="privateKeyAlgorithm",pc="privateKey",Wn="attributes",gh="parsedKey",$E=[gc,mc,pc,Wn];class Jr extends G{constructor(e={}){super(),this.version=m(e,gc,Jr.defaultValues(gc)),this.privateKeyAlgorithm=m(e,mc,Jr.defaultValues(mc)),this.privateKey=m(e,pc,Jr.defaultValues(pc)),Wn in e&&(this.attributes=m(e,Wn,Jr.defaultValues(Wn))),gh in e&&(this.parsedKey=m(e,gh,Jr.defaultValues(gh))),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case gc:return 0;case mc:return new $;case pc:return new z;case Wn:return[];case gh:return{};default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _({name:t.version||S}),$.schema(t.privateKeyAlgorithm||{}),new z({name:t.privateKey||S}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new _e({name:t.attributes||S,value:mt.schema()})]})]})}fromSchema(e){W(e,$E);const t=j(e,e,Jr.schema({names:{version:gc,privateKeyAlgorithm:{names:{blockName:mc}},privateKey:pc,attributes:Wn}}));switch(P.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.privateKeyAlgorithm=new $({schema:t.result.privateKeyAlgorithm}),this.privateKey=t.result.privateKey,Wn in t.result&&(this.attributes=Array.from(t.result.attributes,r=>new mt({schema:r}))),this.privateKeyAlgorithm.algorithmId){case"1.2.840.113549.1.1.1":{const r=_t(this.privateKey.valueBlock.valueHexView);r.offset!==-1&&(this.parsedKey=new fr({schema:r.result}))}break;case"1.2.840.10045.2.1":if("algorithmParams"in this.privateKeyAlgorithm&&this.privateKeyAlgorithm.algorithmParams instanceof he){const r=_t(this.privateKey.valueBlock.valueHexView);r.offset!==-1&&(this.parsedKey=new Hr({namedCurve:this.privateKeyAlgorithm.algorithmParams.valueBlock.toString(),schema:r.result}))}break}}toSchema(){const e=[new _({value:this.version}),this.privateKeyAlgorithm.toSchema(),this.privateKey];return this.attributes&&e.push(new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes,t=>t.toSchema())})),new b({value:e})}toJSON(){if(!this.parsedKey){const r={version:this.version,privateKeyAlgorithm:this.privateKeyAlgorithm.toJSON(),privateKey:this.privateKey.toJSON()};return this.attributes&&(r.attributes=Array.from(this.attributes,a=>a.toJSON())),r}const e={};switch(this.privateKeyAlgorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA";break}const t=this.parsedKey.toJSON();return Object.assign(e,t),e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new Hr({json:e}),this.privateKeyAlgorithm=new $({algorithmId:"1.2.840.10045.2.1",algorithmParams:new he({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new fr({json:e}),this.privateKeyAlgorithm=new $({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new It});break;default:throw new Error(`Invalid value for "kty" parameter: ${e.kty}`)}this.privateKey=new z({valueHex:this.parsedKey.toSchema().toBER(!1)})}}}Jr.CLASS_NAME="PrivateKeyInfo";const To="contentType",Ro="contentEncryptionAlgorithm",Qn="encryptedContent",DE=[To,Ro,Qn],mp=1024;class Nt extends G{constructor(e={}){if(super(),this.contentType=m(e,To,Nt.defaultValues(To)),this.contentEncryptionAlgorithm=m(e,Ro,Nt.defaultValues(Ro)),Qn in e&&e.encryptedContent&&(this.encryptedContent=e.encryptedContent,this.encryptedContent.idBlock.tagClass===1&&this.encryptedContent.idBlock.tagNumber===4&&this.encryptedContent.idBlock.isConstructed===!1&&!e.disableSplit)){const t=new z({idBlock:{isConstructed:!0},isConstructed:!0});let r=0;const a=this.encryptedContent.valueBlock.valueHexView.slice().buffer;let n=a.byteLength;for(;n>0;){const i=new Uint8Array(a,r,r+mp>a.byteLength?a.byteLength-r:mp),o=new ArrayBuffer(i.length),l=new Uint8Array(o);for(let u=0;u<l.length;u++)l[u]=i[u];t.valueBlock.value.push(new z({valueHex:o})),n-=i.length,r+=i.length}this.encryptedContent=t}e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case To:return S;case Ro:return new $;case Qn:return new z;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case To:return t===S;case Ro:return t.algorithmId===S&&!("algorithmParams"in t);case Qn:return t.isEqual(Nt.defaultValues(Qn));default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.contentType||S}),$.schema(t.contentEncryptionAlgorithm||{}),new wt({value:[new N({name:t.encryptedContent||S,idBlock:{tagClass:3,tagNumber:0},value:[new _e({value:new z})]}),new Ie({name:t.encryptedContent||S,idBlock:{tagClass:3,tagNumber:0}})]})]})}fromSchema(e){W(e,DE);const t=j(e,e,Nt.schema({names:{contentType:To,contentEncryptionAlgorithm:{names:{blockName:Ro}},encryptedContent:Qn}}));P.assertSchema(t,this.className),this.contentType=t.result.contentType.valueBlock.toString(),this.contentEncryptionAlgorithm=new $({schema:t.result.contentEncryptionAlgorithm}),Qn in t.result&&(this.encryptedContent=t.result.encryptedContent,this.encryptedContent.idBlock.tagClass=1,this.encryptedContent.idBlock.tagNumber=4)}toSchema(){const e={isIndefiniteForm:!1},t=[];if(t.push(new he({value:this.contentType})),t.push(this.contentEncryptionAlgorithm.toSchema()),this.encryptedContent){e.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed;const r=this.encryptedContent;r.idBlock.tagClass=3,r.idBlock.tagNumber=0,r.lenBlock.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed,t.push(r)}return new b({lenBlock:e,value:t})}toJSON(){const e={contentType:this.contentType,contentEncryptionAlgorithm:this.contentEncryptionAlgorithm.toJSON()};return this.encryptedContent&&(e.encryptedContent=this.encryptedContent.toJSON()),e}getEncryptedContent(){if(!this.encryptedContent)throw new Error("Parameter 'encryptedContent' is undefined");return z.prototype.getValue.call(this.encryptedContent)}}Nt.CLASS_NAME="EncryptedContentInfo";const Na="hashAlgorithm",Ta="maskGenAlgorithm",Ra="saltLength",Va="trailerField",LE=[Na,Ta,Ra,Va];class Qt extends G{constructor(e={}){super(),this.hashAlgorithm=m(e,Na,Qt.defaultValues(Na)),this.maskGenAlgorithm=m(e,Ta,Qt.defaultValues(Ta)),this.saltLength=m(e,Ra,Qt.defaultValues(Ra)),this.trailerField=m(e,Va,Qt.defaultValues(Va)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Na:return new $({algorithmId:"1.3.14.3.2.26",algorithmParams:new It});case Ta:return new $({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new $({algorithmId:"1.3.14.3.2.26",algorithmParams:new It}).toSchema()});case Ra:return 20;case Va:return 1;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new N({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[$.schema(t.hashAlgorithm||{})]}),new N({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[$.schema(t.maskGenAlgorithm||{})]}),new N({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[new _({name:t.saltLength||S})]}),new N({idBlock:{tagClass:3,tagNumber:3},optional:!0,value:[new _({name:t.trailerField||S})]})]})}fromSchema(e){W(e,LE);const t=j(e,e,Qt.schema({names:{hashAlgorithm:{names:{blockName:Na}},maskGenAlgorithm:{names:{blockName:Ta}},saltLength:Ra,trailerField:Va}}));P.assertSchema(t,this.className),Na in t.result&&(this.hashAlgorithm=new $({schema:t.result.hashAlgorithm})),Ta in t.result&&(this.maskGenAlgorithm=new $({schema:t.result.maskGenAlgorithm})),Ra in t.result&&(this.saltLength=t.result.saltLength.valueBlock.valueDec),Va in t.result&&(this.trailerField=t.result.trailerField.valueBlock.valueDec)}toSchema(){const e=[];return this.hashAlgorithm.isEqual(Qt.defaultValues(Na))||e.push(new N({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(Qt.defaultValues(Ta))||e.push(new N({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.saltLength!==Qt.defaultValues(Ra)&&e.push(new N({idBlock:{tagClass:3,tagNumber:2},value:[new _({value:this.saltLength})]})),this.trailerField!==Qt.defaultValues(Va)&&e.push(new N({idBlock:{tagClass:3,tagNumber:3},value:[new _({value:this.trailerField})]})),new b({value:e})}toJSON(){const e={};return this.hashAlgorithm.isEqual(Qt.defaultValues(Na))||(e.hashAlgorithm=this.hashAlgorithm.toJSON()),this.maskGenAlgorithm.isEqual(Qt.defaultValues(Ta))||(e.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.saltLength!==Qt.defaultValues(Ra)&&(e.saltLength=this.saltLength),this.trailerField!==Qt.defaultValues(Va)&&(e.trailerField=this.trailerField),e}}Qt.CLASS_NAME="RSASSAPSSParams";const Vo="salt",yc="iterationCount",rs="keyLength",Hs="prf",OE=[Vo,yc,rs,Hs];class lr extends G{constructor(e={}){super(),this.salt=m(e,Vo,lr.defaultValues(Vo)),this.iterationCount=m(e,yc,lr.defaultValues(yc)),rs in e&&(this.keyLength=m(e,rs,lr.defaultValues(rs))),Hs in e&&(this.prf=m(e,Hs,lr.defaultValues(Hs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Vo:return{};case yc:return-1;case rs:return 0;case Hs:return new $({algorithmId:"1.3.14.3.2.26",algorithmParams:new It});default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new wt({value:[new z({name:t.saltPrimitive||S}),$.schema(t.saltConstructed||{})]}),new _({name:t.iterationCount||S}),new _({name:t.keyLength||S,optional:!0}),$.schema(t.prf||{names:{optional:!0}})]})}fromSchema(e){W(e,OE);const t=j(e,e,lr.schema({names:{saltPrimitive:Vo,saltConstructed:{names:{blockName:Vo}},iterationCount:yc,keyLength:rs,prf:{names:{blockName:Hs,optional:!0}}}}));P.assertSchema(t,this.className),this.salt=t.result.salt,this.iterationCount=t.result.iterationCount.valueBlock.valueDec,rs in t.result&&(this.keyLength=t.result.keyLength.valueBlock.valueDec),Hs in t.result&&(this.prf=new $({schema:t.result.prf}))}toSchema(){const e=[];return e.push(this.salt),e.push(new _({value:this.iterationCount})),rs in this&&lr.defaultValues(rs)!==this.keyLength&&e.push(new _({value:this.keyLength})),this.prf&&lr.defaultValues(Hs).isEqual(this.prf)===!1&&e.push(this.prf.toSchema()),new b({value:e})}toJSON(){const e={salt:this.salt.toJSON(),iterationCount:this.iterationCount};return rs in this&&lr.defaultValues(rs)!==this.keyLength&&(e.keyLength=this.keyLength),this.prf&&lr.defaultValues(Hs).isEqual(this.prf)===!1&&(e.prf=this.prf.toJSON()),e}}lr.CLASS_NAME="PBKDF2Params";const vc="keyDerivationFunc",wc="encryptionScheme",PE=[vc,wc];class eo extends G{constructor(e={}){super(),this.keyDerivationFunc=m(e,vc,eo.defaultValues(vc)),this.encryptionScheme=m(e,wc,eo.defaultValues(wc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case vc:return new $;case wc:return new $;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[$.schema(t.keyDerivationFunc||{}),$.schema(t.encryptionScheme||{})]})}fromSchema(e){W(e,PE);const t=j(e,e,eo.schema({names:{keyDerivationFunc:{names:{blockName:vc}},encryptionScheme:{names:{blockName:wc}}}}));P.assertSchema(t,this.className),this.keyDerivationFunc=new $({schema:t.result.keyDerivationFunc}),this.encryptionScheme=new $({schema:t.result.encryptionScheme})}toSchema(){return new b({value:[this.keyDerivationFunc.toSchema(),this.encryptionScheme.toSchema()]})}toJSON(){return{keyDerivationFunc:this.keyDerivationFunc.toJSON(),encryptionScheme:this.encryptionScheme.toJSON()}}}eo.CLASS_NAME="PBES2Params";class UE{constructor(e){this.crypto=e.crypto,this.subtle="webkitSubtle"in e.crypto?e.crypto.webkitSubtle:e.crypto.subtle,this.name=m(e,"name",S)}async encrypt(...e){return this.subtle.encrypt(...e)}async decrypt(...e){return this.subtle.decrypt(...e)}sign(...e){return this.subtle.sign(...e)}async verify(...e){return this.subtle.verify(...e)}async digest(...e){return this.subtle.digest(...e)}async generateKey(...e){return this.subtle.generateKey(...e)}async deriveKey(...e){return this.subtle.deriveKey(...e)}async deriveBits(...e){return this.subtle.deriveBits(...e)}async wrapKey(...e){return this.subtle.wrapKey(...e)}async unwrapKey(...e){return this.subtle.unwrapKey(...e)}exportKey(...e){return this.subtle.exportKey(...e)}importKey(...e){return this.subtle.importKey(...e)}getRandomValues(e){return this.crypto.getRandomValues(e)}}async function pp(s,e,t,r,a,n){let i,o;const l=[];switch(e.toUpperCase()){case"SHA-1":i=20,o=64;break;case"SHA-256":i=32,o=64;break;case"SHA-384":i=48,o=128;break;case"SHA-512":i=64,o=128;break;default:throw new Error("Unsupported hashing algorithm")}const u=new Uint8Array(r),c=new ArrayBuffer(r.byteLength*2+2),f=new Uint8Array(c);for(let Ve=0;Ve<u.length;Ve++)f[Ve*2]=0,f[Ve*2+1]=u[Ve];f[f.length-2]=0,f[f.length-1]=0,r=c.slice(0);const g=new ArrayBuffer(o),v=new Uint8Array(g);for(let Ve=0;Ve<g.byteLength;Ve++)v[Ve]=3;const p=a.byteLength,h=o*Math.ceil(p/o),d=new ArrayBuffer(h),y=new Uint8Array(d),E=new Uint8Array(a);for(let Ve=0;Ve<h;Ve++)y[Ve]=E[Ve%p];const k=r.byteLength,R=o*Math.ceil(k/o),V=new ArrayBuffer(R),L=new Uint8Array(V),ne=new Uint8Array(r);for(let Ve=0;Ve<R;Ve++)L[Ve]=ne[Ve%k];const se=d.byteLength+V.byteLength;let Se=new ArrayBuffer(se),Te=new Uint8Array(Se);Te.set(y),Te.set(L,y.length);const ye=Math.ceil((t>>3)/i);let Ce=Promise.resolve(Se);for(let Ve=0;Ve<=ye;Ve++){Ce=Ce.then(Pe=>{const pe=new ArrayBuffer(g.byteLength+Pe.byteLength),$e=new Uint8Array(pe);return $e.set(v),$e.set(Te,v.length),pe});for(let Pe=0;Pe<n;Pe++)Ce=Ce.then(pe=>s.digest({name:e},new Uint8Array(pe)));Ce=Ce.then(Pe=>{const pe=new ArrayBuffer(o),$e=new Uint8Array(pe);for(let le=0;le<pe.byteLength;le++)$e[le]=Pe[le%Pe.byteLength];const ie=Math.ceil(p/o)+Math.ceil(k/o),ot=[];let Me=0,te=o;for(let le=0;le<ie;le++){const ae=Array.from(new Uint8Array(Se.slice(Me,Me+te)));Me+=o,Me+o>Se.byteLength&&(te=Se.byteLength-Me);let me=511;for(let Ae=pe.byteLength-1;Ae>=0;Ae--)me>>=8,me+=$e[Ae]+ae[Ae],ae[Ae]=me&255;ot.push(...ae)}return Se=new ArrayBuffer(ot.length),Te=new Uint8Array(Se),Te.set(ot),l.push(...new Uint8Array(Pe)),Se})}return Ce=Ce.then(()=>{const Ve=new ArrayBuffer(t>>3);return new Uint8Array(Ve).set(new Uint8Array(l).slice(0,t>>3)),Ve}),Ce}function o1(s){const e=typeof s=="string"?{name:s}:s;return"hash"in e?{...e,hash:o1(e.hash)}:e}class N0 extends UE{async importKey(e,t,r,a,n){var i,o,l,u,c,f;let g={};const v=o1(r);switch(e.toLowerCase()){case"raw":return this.subtle.importKey("raw",t,r,a,n);case"spki":{const p=_t(Ee.toArrayBuffer(t));P.assert(p,"keyData");const h=new wr;try{h.fromSchema(p.result)}catch{throw new tt("Incorrect keyData")}switch(v.name.toUpperCase()){case"RSA-PSS":{if(!v.hash)throw new Ge("hash","algorithm.hash","Incorrect hash algorithm: Hash algorithm is missed");switch(v.hash.name.toUpperCase()){case"SHA-1":g.alg="PS1";break;case"SHA-256":g.alg="PS256";break;case"SHA-384":g.alg="PS384";break;case"SHA-512":g.alg="PS512";break;default:throw new Error(`Incorrect hash algorithm: ${v.hash.name.toUpperCase()}`)}}case"RSASSA-PKCS1-V1_5":{if(n=["verify"],g.kty="RSA",g.ext=a,g.key_ops=n,h.algorithm.algorithmId!=="1.2.840.113549.1.1.1")throw new Error(`Incorrect public key algorithm: ${h.algorithm.algorithmId}`);if(!g.alg){if(!v.hash)throw new Ge("hash","algorithm.hash","Incorrect hash algorithm: Hash algorithm is missed");switch(v.hash.name.toUpperCase()){case"SHA-1":g.alg="RS1";break;case"SHA-256":g.alg="RS256";break;case"SHA-384":g.alg="RS384";break;case"SHA-512":g.alg="RS512";break;default:throw new Error(`Incorrect hash algorithm: ${v.hash.name.toUpperCase()}`)}}const d=h.toJSON();Object.assign(g,d)}break;case"ECDSA":n=["verify"];case"ECDH":{if(g={kty:"EC",ext:a,key_ops:n},h.algorithm.algorithmId!=="1.2.840.10045.2.1")throw new Error(`Incorrect public key algorithm: ${h.algorithm.algorithmId}`);const d=h.toJSON();Object.assign(g,d)}break;case"RSA-OAEP":{if(g.kty="RSA",g.ext=a,g.key_ops=n,this.name.toLowerCase()==="safari")g.alg="RSA-OAEP";else{if(!v.hash)throw new Ge("hash","algorithm.hash","Incorrect hash algorithm: Hash algorithm is missed");switch(v.hash.name.toUpperCase()){case"SHA-1":g.alg="RSA-OAEP";break;case"SHA-256":g.alg="RSA-OAEP-256";break;case"SHA-384":g.alg="RSA-OAEP-384";break;case"SHA-512":g.alg="RSA-OAEP-512";break;default:throw new Error(`Incorrect hash algorithm: ${v.hash.name.toUpperCase()}`)}}const d=h.toJSON();Object.assign(g,d)}break;case"RSAES-PKCS1-V1_5":{g.kty="RSA",g.ext=a,g.key_ops=n,g.alg="PS1";const d=h.toJSON();Object.assign(g,d)}break;default:throw new Error(`Incorrect algorithm name: ${v.name.toUpperCase()}`)}}break;case"pkcs8":{const p=new Jr,h=_t(Ee.toArrayBuffer(t));P.assert(h,"keyData");try{p.fromSchema(h.result)}catch{throw new Error("Incorrect keyData")}if(!p.parsedKey)throw new Error("Incorrect keyData");switch(v.name.toUpperCase()){case"RSA-PSS":switch((i=v.hash)===null||i===void 0?void 0:i.name.toUpperCase()){case"SHA-1":g.alg="PS1";break;case"SHA-256":g.alg="PS256";break;case"SHA-384":g.alg="PS384";break;case"SHA-512":g.alg="PS512";break;default:throw new Error(`Incorrect hash algorithm: ${(o=v.hash)===null||o===void 0?void 0:o.name.toUpperCase()}`)}case"RSASSA-PKCS1-V1_5":{if(n=["sign"],g.kty="RSA",g.ext=a,g.key_ops=n,p.privateKeyAlgorithm.algorithmId!=="1.2.840.113549.1.1.1")throw new Error(`Incorrect private key algorithm: ${p.privateKeyAlgorithm.algorithmId}`);if(!("alg"in g))switch((l=v.hash)===null||l===void 0?void 0:l.name.toUpperCase()){case"SHA-1":g.alg="RS1";break;case"SHA-256":g.alg="RS256";break;case"SHA-384":g.alg="RS384";break;case"SHA-512":g.alg="RS512";break;default:throw new Error(`Incorrect hash algorithm: ${(u=v.hash)===null||u===void 0?void 0:u.name.toUpperCase()}`)}const d=p.toJSON();Object.assign(g,d)}break;case"ECDSA":n=["sign"];case"ECDH":{if(g={kty:"EC",ext:a,key_ops:n},p.privateKeyAlgorithm.algorithmId!=="1.2.840.10045.2.1")throw new Error(`Incorrect algorithm: ${p.privateKeyAlgorithm.algorithmId}`);const d=p.toJSON();Object.assign(g,d)}break;case"RSA-OAEP":{if(g.kty="RSA",g.ext=a,g.key_ops=n,this.name.toLowerCase()==="safari")g.alg="RSA-OAEP";else switch((c=v.hash)===null||c===void 0?void 0:c.name.toUpperCase()){case"SHA-1":g.alg="RSA-OAEP";break;case"SHA-256":g.alg="RSA-OAEP-256";break;case"SHA-384":g.alg="RSA-OAEP-384";break;case"SHA-512":g.alg="RSA-OAEP-512";break;default:throw new Error(`Incorrect hash algorithm: ${(f=v.hash)===null||f===void 0?void 0:f.name.toUpperCase()}`)}const d=p.toJSON();Object.assign(g,d)}break;case"RSAES-PKCS1-V1_5":{n=["decrypt"],g.kty="RSA",g.ext=a,g.key_ops=n,g.alg="PS1";const d=p.toJSON();Object.assign(g,d)}break;default:throw new Error(`Incorrect algorithm name: ${v.name.toUpperCase()}`)}}break;case"jwk":g=t;break;default:throw new Error(`Incorrect format: ${e}`)}if(this.name.toLowerCase()==="safari")try{return this.subtle.importKey("jwk",au(JSON.stringify(g)),r,a,n)}catch{return this.subtle.importKey("jwk",g,r,a,n)}return this.subtle.importKey("jwk",g,r,a,n)}async exportKey(e,t){let r=await this.subtle.exportKey("jwk",t);switch(this.name.toLowerCase()==="safari"&&r instanceof ArrayBuffer&&(r=JSON.parse(I0(r))),e.toLowerCase()){case"raw":return this.subtle.exportKey("raw",t);case"spki":{const a=new wr;try{a.fromJSON(r)}catch{throw new Error("Incorrect key data")}return a.toSchema().toBER(!1)}case"pkcs8":{const a=new Jr;try{a.fromJSON(r)}catch{throw new Error("Incorrect key data")}return a.toSchema().toBER(!1)}case"jwk":return r;default:throw new Error(`Incorrect format: ${e}`)}}async convert(e,t,r,a,n,i){if(e.toLowerCase()===t.toLowerCase())return r;const o=await this.importKey(e,r,a,n,i);return this.exportKey(t,o)}getAlgorithmByOID(e,t=!1,r){switch(e){case"1.2.840.113549.1.1.1":return{name:"RSAES-PKCS1-v1_5"};case"1.2.840.113549.1.1.5":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case"1.2.840.113549.1.1.11":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"1.2.840.113549.1.1.12":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case"1.2.840.113549.1.1.13":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case"1.2.840.113549.1.1.10":return{name:"RSA-PSS"};case"1.2.840.113549.1.1.7":return{name:"RSA-OAEP"};case"1.2.840.10045.2.1":case"1.2.840.10045.4.1":return{name:"ECDSA",hash:{name:"SHA-1"}};case"1.2.840.10045.4.3.2":return{name:"ECDSA",hash:{name:"SHA-256"}};case"1.2.840.10045.4.3.3":return{name:"ECDSA",hash:{name:"SHA-384"}};case"1.2.840.10045.4.3.4":return{name:"ECDSA",hash:{name:"SHA-512"}};case"1.3.133.16.840.63.0.2":return{name:"ECDH",kdf:"SHA-1"};case"1.3.132.1.11.1":return{name:"ECDH",kdf:"SHA-256"};case"1.3.132.1.11.2":return{name:"ECDH",kdf:"SHA-384"};case"1.3.132.1.11.3":return{name:"ECDH",kdf:"SHA-512"};case"2.16.840.1.101.3.4.1.2":return{name:"AES-CBC",length:128};case"2.16.840.1.101.3.4.1.22":return{name:"AES-CBC",length:192};case"2.16.840.1.101.3.4.1.42":return{name:"AES-CBC",length:256};case"2.16.840.1.101.3.4.1.6":return{name:"AES-GCM",length:128};case"2.16.840.1.101.3.4.1.26":return{name:"AES-GCM",length:192};case"2.16.840.1.101.3.4.1.46":return{name:"AES-GCM",length:256};case"2.16.840.1.101.3.4.1.4":return{name:"AES-CFB",length:128};case"2.16.840.1.101.3.4.1.24":return{name:"AES-CFB",length:192};case"2.16.840.1.101.3.4.1.44":return{name:"AES-CFB",length:256};case"2.16.840.1.101.3.4.1.5":return{name:"AES-KW",length:128};case"2.16.840.1.101.3.4.1.25":return{name:"AES-KW",length:192};case"2.16.840.1.101.3.4.1.45":return{name:"AES-KW",length:256};case"1.2.840.113549.2.7":return{name:"HMAC",hash:{name:"SHA-1"}};case"1.2.840.113549.2.9":return{name:"HMAC",hash:{name:"SHA-256"}};case"1.2.840.113549.2.10":return{name:"HMAC",hash:{name:"SHA-384"}};case"1.2.840.113549.2.11":return{name:"HMAC",hash:{name:"SHA-512"}};case"1.2.840.113549.1.9.16.3.5":return{name:"DH"};case"1.3.14.3.2.26":return{name:"SHA-1"};case"2.16.840.1.101.3.4.2.1":return{name:"SHA-256"};case"2.16.840.1.101.3.4.2.2":return{name:"SHA-384"};case"2.16.840.1.101.3.4.2.3":return{name:"SHA-512"};case"1.2.840.113549.1.5.12":return{name:"PBKDF2"};case"1.2.840.10045.3.1.7":return{name:"P-256"};case"1.3.132.0.34":return{name:"P-384"};case"1.3.132.0.35":return{name:"P-521"}}if(t)throw new Error(`Unsupported algorithm identifier ${r?`for ${r} `:S}: ${e}`);return{}}getOIDByAlgorithm(e,t=!1,r){let a=S;switch(e.name.toUpperCase()){case"RSAES-PKCS1-V1_5":a="1.2.840.113549.1.1.1";break;case"RSASSA-PKCS1-V1_5":switch(e.hash.name.toUpperCase()){case"SHA-1":a="1.2.840.113549.1.1.5";break;case"SHA-256":a="1.2.840.113549.1.1.11";break;case"SHA-384":a="1.2.840.113549.1.1.12";break;case"SHA-512":a="1.2.840.113549.1.1.13";break}break;case"RSA-PSS":a="1.2.840.113549.1.1.10";break;case"RSA-OAEP":a="1.2.840.113549.1.1.7";break;case"ECDSA":switch(e.hash.name.toUpperCase()){case"SHA-1":a="1.2.840.10045.4.1";break;case"SHA-256":a="1.2.840.10045.4.3.2";break;case"SHA-384":a="1.2.840.10045.4.3.3";break;case"SHA-512":a="1.2.840.10045.4.3.4";break}break;case"ECDH":switch(e.kdf.toUpperCase()){case"SHA-1":a="1.3.133.16.840.63.0.2";break;case"SHA-256":a="1.3.132.1.11.1";break;case"SHA-384":a="1.3.132.1.11.2";break;case"SHA-512":a="1.3.132.1.11.3";break}break;case"AES-CTR":break;case"AES-CBC":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.2";break;case 192:a="2.16.840.1.101.3.4.1.22";break;case 256:a="2.16.840.1.101.3.4.1.42";break}break;case"AES-CMAC":break;case"AES-GCM":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.6";break;case 192:a="2.16.840.1.101.3.4.1.26";break;case 256:a="2.16.840.1.101.3.4.1.46";break}break;case"AES-CFB":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.4";break;case 192:a="2.16.840.1.101.3.4.1.24";break;case 256:a="2.16.840.1.101.3.4.1.44";break}break;case"AES-KW":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.5";break;case 192:a="2.16.840.1.101.3.4.1.25";break;case 256:a="2.16.840.1.101.3.4.1.45";break}break;case"HMAC":switch(e.hash.name.toUpperCase()){case"SHA-1":a="1.2.840.113549.2.7";break;case"SHA-256":a="1.2.840.113549.2.9";break;case"SHA-384":a="1.2.840.113549.2.10";break;case"SHA-512":a="1.2.840.113549.2.11";break}break;case"DH":a="1.2.840.113549.1.9.16.3.5";break;case"SHA-1":a="1.3.14.3.2.26";break;case"SHA-256":a="2.16.840.1.101.3.4.2.1";break;case"SHA-384":a="2.16.840.1.101.3.4.2.2";break;case"SHA-512":a="2.16.840.1.101.3.4.2.3";break;case"CONCAT":break;case"HKDF":break;case"PBKDF2":a="1.2.840.113549.1.5.12";break;case"P-256":a="1.2.840.10045.3.1.7";break;case"P-384":a="1.3.132.0.34";break;case"P-521":a="1.3.132.0.35";break}if(!a&&t)throw new Error(`Unsupported algorithm ${r?`for ${r} `:S}: ${e.name}`);return a}getAlgorithmParameters(e,t){let r={algorithm:{},usages:[]};switch(e.toUpperCase()){case"RSAES-PKCS1-V1_5":case"RSASSA-PKCS1-V1_5":switch(t.toLowerCase()){case"generatekey":r={algorithm:{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["sign","verify"]};break;case"verify":case"sign":case"importkey":r={algorithm:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSASSA-PKCS1-v1_5"},usages:[]}}break;case"RSA-PSS":switch(t.toLowerCase()){case"sign":case"verify":r={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"},saltLength:20},usages:["sign","verify"]};break;case"generatekey":r={algorithm:{name:"RSA-PSS",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-1"}},usages:["sign","verify"]};break;case"importkey":r={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSA-PSS"},usages:[]}}break;case"RSA-OAEP":switch(t.toLowerCase()){case"encrypt":case"decrypt":r={algorithm:{name:"RSA-OAEP"},usages:["encrypt","decrypt"]};break;case"generatekey":r={algorithm:{name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"importkey":r={algorithm:{name:"RSA-OAEP",hash:{name:"SHA-256"}},usages:["encrypt"]};break;case"exportkey":default:return{algorithm:{name:"RSA-OAEP"},usages:[]}}break;case"ECDSA":switch(t.toLowerCase()){case"generatekey":r={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["sign","verify"]};break;case"importkey":r={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["verify"]};break;case"verify":case"sign":r={algorithm:{name:"ECDSA",hash:{name:"SHA-256"}},usages:["sign"]};break;default:return{algorithm:{name:"ECDSA"},usages:[]}}break;case"ECDH":switch(t.toLowerCase()){case"exportkey":case"importkey":case"generatekey":r={algorithm:{name:"ECDH",namedCurve:"P-256"},usages:["deriveKey","deriveBits"]};break;case"derivekey":case"derivebits":r={algorithm:{name:"ECDH",namedCurve:"P-256",public:[]},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"ECDH"},usages:[]}}break;case"AES-CTR":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-CTR",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-CTR",counter:new Uint8Array(16),length:10},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CTR"},usages:[]}}break;case"AES-CBC":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-CBC",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-CBC",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CBC"},usages:[]}}break;case"AES-GCM":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-GCM",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-GCM",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-GCM"},usages:[]}}break;case"AES-KW":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":case"wrapkey":case"unwrapkey":r={algorithm:{name:"AES-KW",length:256},usages:["wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-KW"},usages:[]}}break;case"HMAC":switch(t.toLowerCase()){case"sign":case"verify":r={algorithm:{name:"HMAC"},usages:["sign","verify"]};break;case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"HMAC",length:32,hash:{name:"SHA-256"}},usages:["sign","verify"]};break;default:return{algorithm:{name:"HMAC"},usages:[]}}break;case"HKDF":switch(t.toLowerCase()){case"derivekey":r={algorithm:{name:"HKDF",hash:"SHA-256",salt:new Uint8Array([]),info:new Uint8Array([])},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"HKDF"},usages:[]}}break;case"PBKDF2":switch(t.toLowerCase()){case"derivekey":r={algorithm:{name:"PBKDF2",hash:{name:"SHA-256"},salt:new Uint8Array([]),iterations:1e4},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"PBKDF2"},usages:[]}}break}return r}getHashAlgorithm(e){let t=S;switch(e.algorithmId){case"1.2.840.10045.4.1":case"1.2.840.113549.1.1.5":t="SHA-1";break;case"1.2.840.10045.4.3.2":case"1.2.840.113549.1.1.11":t="SHA-256";break;case"1.2.840.10045.4.3.3":case"1.2.840.113549.1.1.12":t="SHA-384";break;case"1.2.840.10045.4.3.4":case"1.2.840.113549.1.1.13":t="SHA-512";break;case"1.2.840.113549.1.1.10":try{const r=new Qt({schema:e.algorithmParams});if(r.hashAlgorithm){const a=this.getAlgorithmByOID(r.hashAlgorithm.algorithmId);if("name"in a)t=a.name;else return S}else t="SHA-1"}catch{}break}return t}async encryptEncryptedContentInfo(e){Ge.assert(e,"password","contentEncryptionAlgorithm","hmacHashAlgorithm","iterationCount","contentToEncrypt","contentToEncrypt","contentType");const t=this.getOIDByAlgorithm(e.contentEncryptionAlgorithm,!0,"contentEncryptionAlgorithm"),r=this.getOIDByAlgorithm({name:"PBKDF2"},!0,"PBKDF2"),a=this.getOIDByAlgorithm({name:"HMAC",hash:{name:e.hmacHashAlgorithm}},!0,"hmacHashAlgorithm"),n=new ArrayBuffer(16),i=new Uint8Array(n);this.getRandomValues(i);const o=new ArrayBuffer(64),l=new Uint8Array(o);this.getRandomValues(l);const u=new Uint8Array(e.contentToEncrypt),c=new lr({salt:new z({valueHex:o}),iterationCount:e.iterationCount,prf:new $({algorithmId:a,algorithmParams:new It})}),f=new Uint8Array(e.password),g=await this.importKey("raw",f,"PBKDF2",!1,["deriveKey"]),v=await this.deriveKey({name:"PBKDF2",hash:{name:e.hmacHashAlgorithm},salt:l,iterations:e.iterationCount},g,e.contentEncryptionAlgorithm,!1,["encrypt"]),p=await this.encrypt({name:e.contentEncryptionAlgorithm.name,iv:i},v,u),h=new eo({keyDerivationFunc:new $({algorithmId:r,algorithmParams:c.toSchema()}),encryptionScheme:new $({algorithmId:t,algorithmParams:new z({valueHex:n})})});return new Nt({contentType:e.contentType,contentEncryptionAlgorithm:new $({algorithmId:"1.2.840.113549.1.5.13",algorithmParams:h.toSchema()}),encryptedContent:new z({valueHex:p})})}async decryptEncryptedContentInfo(e){if(Ge.assert(e,"password","encryptedContentInfo"),e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId!=="1.2.840.113549.1.5.13")throw new Error(`Unknown "contentEncryptionAlgorithm": ${e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId}`);let t;try{t=new eo({schema:e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams})}catch{throw new Error('Incorrectly encoded "pbes2Parameters"')}let r;try{r=new lr({schema:t.keyDerivationFunc.algorithmParams})}catch{throw new Error('Incorrectly encoded "pbkdf2Params"')}const a=this.getAlgorithmByOID(t.encryptionScheme.algorithmId,!0),n=t.encryptionScheme.algorithmParams.valueBlock.valueHex,i=new Uint8Array(n),o=r.salt.valueBlock.valueHex,l=new Uint8Array(o),u=r.iterationCount;let c="SHA-1";r.prf&&(c=this.getAlgorithmByOID(r.prf.algorithmId,!0).hash.name);const f=await this.importKey("raw",e.password,"PBKDF2",!1,["deriveKey"]),g=await this.deriveKey({name:"PBKDF2",hash:{name:c},salt:l,iterations:u},f,a,!1,["decrypt"]),v=e.encryptedContentInfo.getEncryptedContent();return this.decrypt({name:a.name,iv:i},g,v)}async stampDataWithPassword(e){if(!(e instanceof Object))throw new Error('Parameters must have type "Object"');Ge.assert(e,"password","hashAlgorithm","iterationCount","salt","contentToStamp");let t;switch(e.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:throw new Error(`Incorrect "parameters.hashAlgorithm" parameter: ${e.hashAlgorithm}`)}const r={name:"HMAC",length:t,hash:{name:e.hashAlgorithm}},a=await pp(this,e.hashAlgorithm,t,e.password,e.salt,e.iterationCount),n=await this.importKey("raw",new Uint8Array(a),r,!1,["sign"]);return this.sign(r,n,new Uint8Array(e.contentToStamp))}async verifyDataStampedWithPassword(e){Ge.assert(e,"password","hashAlgorithm","salt","iterationCount","contentToVerify","signatureToVerify");let t=0;switch(e.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:throw new Error(`Incorrect "parameters.hashAlgorithm" parameter: ${e.hashAlgorithm}`)}const r={name:"HMAC",length:t,hash:{name:e.hashAlgorithm}},a=await pp(this,e.hashAlgorithm,t,e.password,e.salt,e.iterationCount),n=await this.importKey("raw",new Uint8Array(a),r,!1,["verify"]);return this.verify(r,n,new Uint8Array(e.signatureToVerify),new Uint8Array(e.contentToVerify))}async getSignatureParameters(e,t="SHA-1"){this.getOIDByAlgorithm({name:t},!0,"hashAlgorithm");const r=new $,a=this.getAlgorithmParameters(e.algorithm.name,"sign");if(!Object.keys(a.algorithm).length)throw new Error("Parameter 'algorithm' is empty");const n=a.algorithm;switch(n.hash.name=t,e.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":r.algorithmId=this.getOIDByAlgorithm(n,!0);break;case"RSA-PSS":{switch(t.toUpperCase()){case"SHA-256":n.saltLength=32;break;case"SHA-384":n.saltLength=48;break;case"SHA-512":n.saltLength=64;break}const i={};if(t.toUpperCase()!=="SHA-1"){const l=this.getOIDByAlgorithm({name:t},!0,"hashAlgorithm");i.hashAlgorithm=new $({algorithmId:l,algorithmParams:new It}),i.maskGenAlgorithm=new $({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:i.hashAlgorithm.toSchema()})}n.saltLength!==20&&(i.saltLength=n.saltLength);const o=new Qt(i);r.algorithmId="1.2.840.113549.1.1.10",r.algorithmParams=o.toSchema()}break;default:throw new Error(`Unsupported signature algorithm: ${e.algorithm.name}`)}return{signatureAlgorithm:r,parameters:a}}async signWithPrivateKey(e,t,r){const a=await this.sign(r.algorithm,t,e);return r.algorithm.name==="ECDSA"?ME(a):a}fillPublicKeyParameters(e,t){const r={},a=this.getHashAlgorithm(t);if(a===S)throw new Error(`Unsupported signature algorithm: ${t.algorithmId}`);let n;t.algorithmId==="1.2.840.113549.1.1.10"?n=t.algorithmId:n=e.algorithm.algorithmId;const i=this.getAlgorithmByOID(n,!0);if(r.algorithm=this.getAlgorithmParameters(i.name,"importKey"),"hash"in r.algorithm.algorithm&&(r.algorithm.algorithm.hash.name=a),i.name==="ECDSA"){const o=e.algorithm;if(!o.algorithmParams)throw new Error("Algorithm parameters for ECDSA public key are missed");const l=o.algorithmParams;if("idBlock"in o.algorithmParams&&!(l.idBlock.tagClass===1&&l.idBlock.tagNumber===6))throw new Error("Incorrect type for ECDSA public key parameters");const u=this.getAlgorithmByOID(l.valueBlock.toString(),!0);r.algorithm.algorithm.namedCurve=u.name}return r}async getPublicKey(e,t,r){r||(r=this.fillPublicKeyParameters(e,t));const a=e.toSchema().toBER(!1);return this.importKey("spki",a,r.algorithm.algorithm,!0,r.algorithm.usages)}async verifyWithPublicKey(e,t,r,a,n){let i;if(n){const u={};let c;a.algorithmId==="1.2.840.113549.1.1.10"?c=a.algorithmId:c=r.algorithm.algorithmId;const f=this.getAlgorithmByOID(c,!0);if(u.algorithm=this.getAlgorithmParameters(f.name,"importKey"),"hash"in u.algorithm.algorithm&&(u.algorithm.algorithm.hash.name=n),f.name==="ECDSA"){let g=!1;if("algorithmParams"in r.algorithm&&"idBlock"in r.algorithm.algorithmParams&&r.algorithm.algorithmParams.idBlock.tagClass===1&&r.algorithm.algorithmParams.idBlock.tagNumber===6&&(g=!0),g===!1)throw new Error("Incorrect type for ECDSA public key parameters");const v=this.getAlgorithmByOID(r.algorithm.algorithmParams.valueBlock.toString(),!0);u.algorithm.algorithm.namedCurve=v.name}i=await this.getPublicKey(r,null,u)}else{if(n=this.getHashAlgorithm(a),!n)throw new Error(`Unsupported signature algorithm: ${a.algorithmId}`);i=await this.getPublicKey(r,a)}const o=this.getAlgorithmParameters(i.algorithm.name,"verify");"hash"in o.algorithm&&(o.algorithm.hash.name=n);let l=t.valueBlock.valueHexView;if(i.algorithm.name==="ECDSA"){const u=Cn.find(i.algorithm.namedCurve);if(!u)throw new Error("Unsupported named curve in use");const c=_t(l);P.assert(c,"Signature value"),l=HE(c.result,u.size)}if(i.algorithm.name==="RSA-PSS"){const u=new Qt({schema:a.algorithmParams});"saltLength"in u?o.algorithm.saltLength=u.saltLength:o.algorithm.saltLength=20;let c="SHA-1";"hashAlgorithm"in u&&(c=this.getAlgorithmByOID(u.hashAlgorithm.algorithmId,!0).name),o.algorithm.hash.name=c}return this.verify(o.algorithm,i,l,e)}}let l1={name:"none",crypto:null};function yp(s){return!!(s&&typeof s=="object"&&"crypto"in s)}function vp(s,...e){let t=null;if(e.length<2)e.length?t=e[0]:t=typeof self<"u"&&self.crypto?new N0({name:"browser",crypto:self.crypto}):null;else{const r=e[0],a=e[1];yp(a)?t=a:yp(r)?t=r:"subtle"in r&&"getRandomValues"in r&&(t=new N0({crypto:r}))}if(typeof process<"u"&&"pid"in process&&typeof global<"u"&&typeof window>"u"){if(typeof global[process.pid]>"u")global[process.pid]={};else if(typeof global[process.pid]!="object")throw new Error(`Name global.${process.pid} already exists and it is not an object`);if(typeof global[process.pid].pkijs>"u")global[process.pid].pkijs={};else if(typeof global[process.pid].pkijs!="object")throw new Error(`Name global.${process.pid}.pkijs already exists and it is not an object`);global[process.pid].pkijs.engine={name:s,crypto:t}}else l1={name:s,crypto:t}}function KE(){if(typeof process<"u"&&"pid"in process&&typeof global<"u"&&typeof window>"u"){let s;try{s=global[process.pid].pkijs.engine}catch{throw new Error("Please call 'setEngine' before call to 'getEngine'")}return s}return l1}function Le(s=!1){const e=KE();if(!e.crypto&&s)throw new Error("Unable to create WebCrypto object");return e.crypto}function ME(s){if(s.byteLength%2!==0)return $t;const e=s.byteLength/2,t=new ArrayBuffer(e);new Uint8Array(t).set(new Uint8Array(s,0,e));const a=new _({valueHex:t}),n=new ArrayBuffer(e);new Uint8Array(n).set(new Uint8Array(s,e,e));const o=new _({valueHex:n});return new b({value:[a.convertToDER(),o.convertToDER()]}).toBER(!1)}function HE(s,e){if(!(s instanceof b&&s.valueBlock.value.length===2&&s.valueBlock.value[0]instanceof _&&s.valueBlock.value[1]instanceof _))return $t;const t=s.valueBlock.value[0].convertFromDER().valueBlock.valueHexView,r=s.valueBlock.value[1].convertFromDER().valueBlock.valueHexView,a=new Uint8Array(e*2);return a.set(t,e-t.byteLength),a.set(r,2*e-r.byteLength),a.buffer}async function FE(s,e,t,r,a){switch(s.toUpperCase()){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;default:throw new tt(`Unknown hash function: ${s}`)}if(tt.assert(e,"zBuffer","ArrayBuffer"),e.byteLength===0)throw new tt("'zBuffer' has zero length, error");if(tt.assert(r,"SharedInfo","ArrayBuffer"),t>255)throw new tt("Please set 'Counter' argument to value less or equal to 255");const n=new ArrayBuffer(4),i=new Uint8Array(n);i[0]=0,i[1]=0,i[2]=0,i[3]=t;let o=$t;o=jl(o,e),o=jl(o,n),o=jl(o,r);const l=await a.digest({name:s},o);return{counter:t,result:l}}async function wp(s,e,t,r,a=Le(!0)){let n=0,i=1;switch(s.toUpperCase()){case"SHA-1":n=160;break;case"SHA-256":n=256;break;case"SHA-384":n=384;break;case"SHA-512":n=512;break;default:throw new tt(`Unknown hash function: ${s}`)}if(tt.assert(e,"Zbuffer","ArrayBuffer"),e.byteLength===0)throw new tt("'Zbuffer' has zero length, error");tt.assert(r,"SharedInfo","ArrayBuffer");const o=t/n;Math.floor(o)>0&&(i=Math.floor(o),o-i>0&&i++);const l=[];for(let g=1;g<=i;g++)l.push(await FE(s,e,g,r,a));let u=$t,c=1,f=!0;for(;f;){f=!1;for(const g of l)if(g.counter===c){u=jl(u,g.result),f=!0;break}c++}if(t>>=3,u.byteLength>t){const g=new ArrayBuffer(t),v=new Uint8Array(g),p=new Uint8Array(u);for(let h=0;h<t;h++)v[h]=p[h];return g}return u}const Ed="version",bd="logID",kd="extensions",Id="timestamp",Bd="hashAlgorithm",xd="signatureAlgorithm",Nd="signature",Sp="none",Cp="md5",Ap="sha1",Ep="sha224",bp="sha256",kp="sha384",Ip="sha512",Bp="anonymous",xp="rsa",Np="dsa",Tp="ecdsa";class Ss extends G{constructor(e={}){super(),this.version=m(e,Ed,Ss.defaultValues(Ed)),this.logID=m(e,bd,Ss.defaultValues(bd)),this.timestamp=m(e,Id,Ss.defaultValues(Id)),this.extensions=m(e,kd,Ss.defaultValues(kd)),this.hashAlgorithm=m(e,Bd,Ss.defaultValues(Bd)),this.signatureAlgorithm=m(e,xd,Ss.defaultValues(xd)),this.signature=m(e,Nd,Ss.defaultValues(Nd)),"stream"in e&&e.stream&&this.fromStream(e.stream),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ed:return 0;case bd:case kd:return $t;case Id:return new Date(0);case Bd:case xd:return S;case Nd:return new xe;default:return super.defaultValues(e)}}fromSchema(e){if(!(e instanceof x0))throw new Error("Object's schema was not verified against input data for SignedCertificateTimestamp");const t=new Sn({stream:new At({buffer:e.data})});this.fromStream(t)}fromStream(e){const t=e.getUint16();if(this.version=e.getBlock(1)[0],this.version===0){this.logID=new Uint8Array(e.getBlock(32)).buffer.slice(0),this.timestamp=new Date(so(new Uint8Array(e.getBlock(8)),8));const r=e.getUint16();switch(this.extensions=new Uint8Array(e.getBlock(r)).buffer.slice(0),e.getBlock(1)[0]){case 0:this.hashAlgorithm=Sp;break;case 1:this.hashAlgorithm=Cp;break;case 2:this.hashAlgorithm=Ap;break;case 3:this.hashAlgorithm=Ep;break;case 4:this.hashAlgorithm=bp;break;case 5:this.hashAlgorithm=kp;break;case 6:this.hashAlgorithm=Ip;break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}switch(e.getBlock(1)[0]){case 0:this.signatureAlgorithm=Bp;break;case 1:this.signatureAlgorithm=xp;break;case 2:this.signatureAlgorithm=Np;break;case 3:this.signatureAlgorithm=Tp;break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}const a=e.getUint16(),n=new Uint8Array(e.getBlock(a)).buffer.slice(0),i=_t(n);if(P.assert(i,"SignedCertificateTimestamp"),this.signature=i.result,t!==47+r+a)throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}}toSchema(){const e=this.toStream();return new x0({data:e.stream.buffer})}toStream(){const e=new Sn;e.appendUint16(47+this.extensions.byteLength+this.signature.valueBeforeDecodeView.byteLength),e.appendChar(this.version),e.appendView(new Uint8Array(this.logID));const t=new ArrayBuffer(8),r=new Uint8Array(t),a=ua(this.timestamp.valueOf(),8);r.set(new Uint8Array(a),8-a.byteLength),e.appendView(r),e.appendUint16(this.extensions.byteLength),this.extensions.byteLength&&e.appendView(new Uint8Array(this.extensions));let n;switch(this.hashAlgorithm.toLowerCase()){case Sp:n=0;break;case Cp:n=1;break;case Ap:n=2;break;case Ep:n=3;break;case bp:n=4;break;case kp:n=5;break;case Ip:n=6;break;default:throw new Error(`Incorrect data for hashAlgorithm: ${this.hashAlgorithm}`)}e.appendChar(n);let i;switch(this.signatureAlgorithm.toLowerCase()){case Bp:i=0;break;case xp:i=1;break;case Np:i=2;break;case Tp:i=3;break;default:throw new Error(`Incorrect data for signatureAlgorithm: ${this.signatureAlgorithm}`)}e.appendChar(i);const o=this.signature.toBER(!1);return e.appendUint16(o.byteLength),e.appendView(new Uint8Array(o)),e}toJSON(){return{version:this.version,logID:ip(this.logID),timestamp:this.timestamp,extensions:ip(this.extensions),hashAlgorithm:this.hashAlgorithm,signatureAlgorithm:this.signatureAlgorithm,signature:this.signature.toJSON()}}async verify(e,t,r=0,a=Le(!0)){const n=gg(I0(this.logID));let i=null;const o=new Sn;for(const v of e)if(v.log_id===n){i=v.key;break}if(!i)throw new Error(`Public key not found for CT with logId: ${n}`);const l=au(Pf(i)),u=wr.fromBER(l);o.appendChar(0),o.appendChar(0);const c=new ArrayBuffer(8),f=new Uint8Array(c),g=ua(this.timestamp.valueOf(),8);return f.set(new Uint8Array(g),8-g.byteLength),o.appendView(f),o.appendUint16(r),r===0&&o.appendUint24(t.byteLength),o.appendView(new Uint8Array(t)),o.appendUint16(this.extensions.byteLength),this.extensions.byteLength!==0&&o.appendView(new Uint8Array(this.extensions)),a.verifyWithPublicKey(o.buffer.slice(0,o.length),new z({valueHex:this.signature.toBER(!1)}),u,{algorithmId:S},"SHA-256")}}Ss.CLASS_NAME="SignedCertificateTimestamp";const mh="timestamps";class ld extends G{constructor(e={}){super(),this.timestamps=m(e,mh,ld.defaultValues(mh)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case mh:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case mh:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){var t;const r=m(e,"names",{});return(t=r.optional)!==null&&t!==void 0||(r.optional=!1),new z({name:r.blockName||"SignedCertificateTimestampList",optional:r.optional})}fromSchema(e){if(!(e instanceof z))throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");const t=new Sn({stream:new At({buffer:e.valueBlock.valueHex})});if(t.getUint16()!==t.length)throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");for(;t.length;)this.timestamps.push(new Ss({stream:t}))}toSchema(){const e=new Sn;let t=0;const r=[];for(const a of this.timestamps){const n=a.toStream();r.push(n),t+=n.stream.buffer.byteLength}e.appendUint16(t);for(const a of r)e.appendView(a.stream.view);return new z({valueHex:e.stream.buffer.slice(0)})}toJSON(){return{timestamps:Array.from(this.timestamps,e=>e.toJSON())}}}ld.CLASS_NAME="SignedCertificateTimestampList";const Sc="attributes",qE=[Sc];class jf extends G{constructor(e={}){super(),this.attributes=m(e,Sc,jf.defaultValues(Sc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Sc:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _e({name:t.attributes||S,value:mt.schema()})]})}fromSchema(e){W(e,qE);const t=j(e,e,jf.schema({names:{attributes:Sc}}));P.assertSchema(t,this.className),this.attributes=Array.from(t.result.attributes,r=>new mt({schema:r}))}toSchema(){return new b({value:Array.from(this.attributes,e=>e.toSchema())})}toJSON(){return{attributes:Array.from(this.attributes,e=>e.toJSON())}}}jf.CLASS_NAME="SubjectDirectoryAttributes";class St{static getItems(){return this.types||(this.types={},St.register(Gv,"SubjectAltName",iu),St.register(jv,"IssuerAltName",iu),St.register(mm,"AuthorityKeyIdentifier",dn),St.register(dm,"BasicConstraints",Wi),St.register(iE,"MicrosoftCaVersion",Ff),St.register(Xv,"CertificatePolicies",ou),St.register(eE,"CertificatePoliciesMicrosoft",ou),St.register(nE,"MicrosoftCertTemplateV2",Jl),St.register(zv,"CRLDistributionPoints",lu),St.register(gm,"FreshestCRL",lu),St.register(tE,"ExtKeyUsage",qf),St.register(Qv,"CertificateIssuer",Ut),St.register(pm,"AuthorityInfoAccess",uu),St.register(sE,"SubjectInfoAccess",uu),St.register(Wv,"IssuingDistributionPoint",Wt),St.register(Yv,"NameConstraints",Ql),St.register(e1,"PolicyConstraints",Yl),St.register(Zv,"PolicyMappings",Jf),St.register(QA,"PrivateKeyUsagePeriod",zl),St.register(oE,"QCStatements",Gf),St.register(aE,"SignedCertificateTimestampList",ld),St.register(GA,"SubjectDirectoryAttributes",jf)),this.types}static fromBER(e,t){const r=_t(t);if(r.offset===-1)return null;const a=this.find(e);if(a)try{return new a.type({schema:r.result})}catch{const i=new a.type;return i.parsingError=`Incorrectly formatted value of extension ${a.name} (${e})`,i}return r.result}static find(e){return this.getItems()[e]||null}static register(e,t,r){this.getItems()[e]={name:t,type:r}}}const Cc="extnID",_a="critical",Ac="extnValue",ph="parsedValue",JE=[Cc,_a,Ac];class Tt extends G{constructor(e={}){super(),this.extnID=m(e,Cc,Tt.defaultValues(Cc)),this.critical=m(e,_a,Tt.defaultValues(_a)),Ac in e?this.extnValue=new z({valueHex:e.extnValue}):this.extnValue=Tt.defaultValues(Ac),ph in e&&(this.parsedValue=m(e,ph,Tt.defaultValues(ph))),e.schema&&this.fromSchema(e.schema)}get parsedValue(){if(this._parsedValue===void 0){const e=St.fromBER(this.extnID,this.extnValue.valueBlock.valueHexView);this._parsedValue=e}return this._parsedValue||void 0}set parsedValue(e){this._parsedValue=e}static defaultValues(e){switch(e){case Cc:return S;case _a:return!1;case Ac:return new z;case ph:return{};default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.extnID||S}),new _s({name:t.critical||S,optional:!0}),new z({name:t.extnValue||S})]})}fromSchema(e){W(e,JE);const t=j(e,e,Tt.schema({names:{extnID:Cc,critical:_a,extnValue:Ac}}));P.assertSchema(t,this.className),this.extnID=t.result.extnID.valueBlock.toString(),_a in t.result&&(this.critical=t.result.critical.valueBlock.value),this.extnValue=t.result.extnValue}toSchema(){const e=[];return e.push(new he({value:this.extnID})),this.critical!==Tt.defaultValues(_a)&&e.push(new _s({value:this.critical})),e.push(this.extnValue),new b({value:e})}toJSON(){const e={extnID:this.extnID,extnValue:this.extnValue.toJSON()};return this.critical!==Tt.defaultValues(_a)&&(e.critical=this.critical),this.parsedValue&&this.parsedValue.toJSON&&(e.parsedValue=this.parsedValue.toJSON()),e}}Tt.CLASS_NAME="Extension";const Ec="extensions",GE=[Ec];class Dt extends G{constructor(e={}){super(),this.extensions=m(e,Ec,Dt.defaultValues(Ec)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ec:return[];default:return super.defaultValues(e)}}static schema(e={},t=!1){const r=m(e,"names",{});return new b({optional:t,name:r.blockName||S,value:[new _e({name:r.extensions||S,value:Tt.schema(r.extension||{})})]})}fromSchema(e){W(e,GE);const t=j(e,e,Dt.schema({names:{extensions:Ec}}));P.assertSchema(t,this.className),this.extensions=Array.from(t.result.extensions,r=>new Tt({schema:r}))}toSchema(){return new b({value:Array.from(this.extensions,e=>e.toSchema())})}toJSON(){return{extensions:this.extensions.map(e=>e.toJSON())}}}Dt.CLASS_NAME="Extensions";const bc="issuer",kc="serialNumber",Yn="issuerUID",jE=[bc,kc,Yn];class vr extends G{constructor(e={}){super(),this.issuer=m(e,bc,vr.defaultValues(bc)),this.serialNumber=m(e,kc,vr.defaultValues(kc)),Yn in e&&(this.issuerUID=m(e,Yn,vr.defaultValues(Yn))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case bc:return new Ut;case kc:return new _;case Yn:return new He;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[Ut.schema(t.issuer||{}),new _({name:t.serialNumber||S}),new He({optional:!0,name:t.issuerUID||S})]})}fromSchema(e){W(e,jE);const t=j(e,e,vr.schema({names:{issuer:{names:{blockName:bc}},serialNumber:kc,issuerUID:Yn}}));P.assertSchema(t,this.className),this.issuer=new Ut({schema:t.result.issuer}),this.serialNumber=t.result.serialNumber,Yn in t.result&&(this.issuerUID=t.result.issuerUID)}toSchema(){const e=new b({value:[this.issuer.toSchema(),this.serialNumber]});return this.issuerUID&&e.valueBlock.value.push(this.issuerUID),e}toJSON(){const e={issuer:this.issuer.toJSON(),serialNumber:this.serialNumber.toJSON()};return this.issuerUID&&(e.issuerUID=this.issuerUID.toJSON()),e}}vr.CLASS_NAME="IssuerSerial";const Ic="version",zn="baseCertificateID",Xn="subjectName",Bc="issuer",xc="signature",Nc="serialNumber",Tc="attrCertValidityPeriod",Rc="attributes",Zn="issuerUniqueID",ei="extensions",WE=[Ic,zn,Xn,Bc,xc,Nc,Tc,Rc,Zn,ei];class or extends G{constructor(e={}){super(),this.version=m(e,Ic,or.defaultValues(Ic)),zn in e&&(this.baseCertificateID=m(e,zn,or.defaultValues(zn))),Xn in e&&(this.subjectName=m(e,Xn,or.defaultValues(Xn))),this.issuer=m(e,Bc,or.defaultValues(Bc)),this.signature=m(e,xc,or.defaultValues(xc)),this.serialNumber=m(e,Nc,or.defaultValues(Nc)),this.attrCertValidityPeriod=m(e,Tc,or.defaultValues(Tc)),this.attributes=m(e,Rc,or.defaultValues(Rc)),Zn in e&&(this.issuerUniqueID=m(e,Zn,or.defaultValues(Zn))),ei in e&&(this.extensions=m(e,ei,or.defaultValues(ei))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ic:return 0;case zn:return new vr;case Xn:return new Ut;case Bc:return new Ut;case xc:return new $;case Nc:return new _;case Tc:return new hs;case Rc:return[];case Zn:return new He;case ei:return new Dt;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _({name:t.version||S}),new wt({value:[new N({name:t.baseCertificateID||S,idBlock:{tagClass:3,tagNumber:0},value:vr.schema().valueBlock.value}),new N({name:t.subjectName||S,idBlock:{tagClass:3,tagNumber:1},value:Ut.schema().valueBlock.value})]}),Ut.schema({names:{blockName:t.issuer||S}}),$.schema(t.signature||{}),new _({name:t.serialNumber||S}),hs.schema(t.attrCertValidityPeriod||{}),new b({name:t.attributes||S,value:[new _e({value:mt.schema()})]}),new He({optional:!0,name:t.issuerUniqueID||S}),Dt.schema(t.extensions||{},!0)]})}fromSchema(e){W(e,WE);const t=j(e,e,or.schema({names:{version:Ic,baseCertificateID:zn,subjectName:Xn,issuer:Bc,signature:{names:{blockName:xc}},serialNumber:Nc,attrCertValidityPeriod:{names:{blockName:Tc}},attributes:Rc,issuerUniqueID:Zn,extensions:{names:{blockName:ei}}}}));P.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,zn in t.result&&(this.baseCertificateID=new vr({schema:new b({value:t.result.baseCertificateID.valueBlock.value})})),Xn in t.result&&(this.subjectName=new Ut({schema:new b({value:t.result.subjectName.valueBlock.value})})),this.issuer=t.result.issuer,this.signature=new $({schema:t.result.signature}),this.serialNumber=t.result.serialNumber,this.attrCertValidityPeriod=new hs({schema:t.result.attrCertValidityPeriod}),this.attributes=Array.from(t.result.attributes.valueBlock.value,r=>new mt({schema:r})),Zn in t.result&&(this.issuerUniqueID=t.result.issuerUniqueID),ei in t.result&&(this.extensions=new Dt({schema:t.result.extensions}))}toSchema(){const e=new b({value:[new _({value:this.version})]});return this.baseCertificateID&&e.valueBlock.value.push(new N({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),this.subjectName&&e.valueBlock.value.push(new N({idBlock:{tagClass:3,tagNumber:1},value:this.subjectName.toSchema().valueBlock.value})),e.valueBlock.value.push(this.issuer.toSchema()),e.valueBlock.value.push(this.signature.toSchema()),e.valueBlock.value.push(this.serialNumber),e.valueBlock.value.push(this.attrCertValidityPeriod.toSchema()),e.valueBlock.value.push(new b({value:Array.from(this.attributes,t=>t.toSchema())})),this.issuerUniqueID&&e.valueBlock.value.push(this.issuerUniqueID),this.extensions&&e.valueBlock.value.push(this.extensions.toSchema()),e}toJSON(){const e={version:this.version};return this.baseCertificateID&&(e.baseCertificateID=this.baseCertificateID.toJSON()),this.subjectName&&(e.subjectName=this.subjectName.toJSON()),e.issuer=this.issuer.toJSON(),e.signature=this.signature.toJSON(),e.serialNumber=this.serialNumber.toJSON(),e.attrCertValidityPeriod=this.attrCertValidityPeriod.toJSON(),e.attributes=Array.from(this.attributes,t=>t.toJSON()),this.issuerUniqueID&&(e.issuerUniqueID=this.issuerUniqueID.toJSON()),this.extensions&&(e.extensions=this.extensions.toJSON()),e}}or.CLASS_NAME="AttributeCertificateInfoV1";const Vc="acinfo",_c="signatureAlgorithm",$c="signatureValue",QE=[Vc,$c,_c];class Zs extends G{constructor(e={}){super(),this.acinfo=m(e,Vc,Zs.defaultValues(Vc)),this.signatureAlgorithm=m(e,_c,Zs.defaultValues(_c)),this.signatureValue=m(e,$c,Zs.defaultValues($c)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Vc:return new or;case _c:return new $;case $c:return new He;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[or.schema(t.acinfo||{}),$.schema(t.signatureAlgorithm||{}),new He({name:t.signatureValue||S})]})}fromSchema(e){W(e,QE);const t=j(e,e,Zs.schema({names:{acinfo:{names:{blockName:Vc}},signatureAlgorithm:{names:{blockName:_c}},signatureValue:$c}}));P.assertSchema(t,this.className),this.acinfo=new or({schema:t.result.acinfo}),this.signatureAlgorithm=new $({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}toSchema(){return new b({value:[this.acinfo.toSchema(),this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){return{acinfo:this.acinfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()}}}Zs.CLASS_NAME="AttributeCertificateV1";const Dc="digestedObjectType",ti="otherObjectTypeID",Lc="digestAlgorithm",Oc="objectDigest",YE=[Dc,ti,Lc,Oc];class Or extends G{constructor(e={}){super(),this.digestedObjectType=m(e,Dc,Or.defaultValues(Dc)),ti in e&&(this.otherObjectTypeID=m(e,ti,Or.defaultValues(ti))),this.digestAlgorithm=m(e,Lc,Or.defaultValues(Lc)),this.objectDigest=m(e,Oc,Or.defaultValues(Oc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Dc:return new ao;case ti:return new he;case Lc:return new $;case Oc:return new He;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new ao({name:t.digestedObjectType||S}),new he({optional:!0,name:t.otherObjectTypeID||S}),$.schema(t.digestAlgorithm||{}),new He({name:t.objectDigest||S})]})}fromSchema(e){W(e,YE);const t=j(e,e,Or.schema({names:{digestedObjectType:Dc,otherObjectTypeID:ti,digestAlgorithm:{names:{blockName:Lc}},objectDigest:Oc}}));P.assertSchema(t,this.className),this.digestedObjectType=t.result.digestedObjectType,ti in t.result&&(this.otherObjectTypeID=t.result.otherObjectTypeID),this.digestAlgorithm=new $({schema:t.result.digestAlgorithm}),this.objectDigest=t.result.objectDigest}toSchema(){const e=new b({value:[this.digestedObjectType]});return this.otherObjectTypeID&&e.valueBlock.value.push(this.otherObjectTypeID),e.valueBlock.value.push(this.digestAlgorithm.toSchema()),e.valueBlock.value.push(this.objectDigest),e}toJSON(){const e={digestedObjectType:this.digestedObjectType.toJSON(),digestAlgorithm:this.digestAlgorithm.toJSON(),objectDigest:this.objectDigest.toJSON()};return this.otherObjectTypeID&&(e.otherObjectTypeID=this.otherObjectTypeID.toJSON()),e}}Or.CLASS_NAME="ObjectDigestInfo";const ri="issuerName",si="baseCertificateID",ai="objectDigestInfo",zE=[ri,si,ai];class mn extends G{constructor(e={}){super(),ri in e&&(this.issuerName=m(e,ri,mn.defaultValues(ri))),si in e&&(this.baseCertificateID=m(e,si,mn.defaultValues(si))),ai in e&&(this.objectDigestInfo=m(e,ai,mn.defaultValues(ai))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ri:return new Ut;case si:return new vr;case ai:return new Or;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[Ut.schema({names:{blockName:t.issuerName}},!0),new N({optional:!0,name:t.baseCertificateID||S,idBlock:{tagClass:3,tagNumber:0},value:vr.schema().valueBlock.value}),new N({optional:!0,name:t.objectDigestInfo||S,idBlock:{tagClass:3,tagNumber:1},value:Or.schema().valueBlock.value})]})}fromSchema(e){W(e,zE);const t=j(e,e,mn.schema({names:{issuerName:ri,baseCertificateID:si,objectDigestInfo:ai}}));P.assertSchema(t,this.className),ri in t.result&&(this.issuerName=new Ut({schema:t.result.issuerName})),si in t.result&&(this.baseCertificateID=new vr({schema:new b({value:t.result.baseCertificateID.valueBlock.value})})),ai in t.result&&(this.objectDigestInfo=new Or({schema:new b({value:t.result.objectDigestInfo.valueBlock.value})}))}toSchema(){const e=new b;return this.issuerName&&e.valueBlock.value.push(this.issuerName.toSchema()),this.baseCertificateID&&e.valueBlock.value.push(new N({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),this.objectDigestInfo&&e.valueBlock.value.push(new N({idBlock:{tagClass:3,tagNumber:1},value:this.objectDigestInfo.toSchema().valueBlock.value})),e}toJSON(){const e={};return this.issuerName&&(e.issuerName=this.issuerName.toJSON()),this.baseCertificateID&&(e.baseCertificateID=this.baseCertificateID.toJSON()),this.objectDigestInfo&&(e.objectDigestInfo=this.objectDigestInfo.toJSON()),e}}mn.CLASS_NAME="V2Form";const ni="baseCertificateID",ii="entityName",oi="objectDigestInfo",XE=[ni,ii,oi];class ea extends G{constructor(e={}){super(),ni in e&&(this.baseCertificateID=m(e,ni,ea.defaultValues(ni))),ii in e&&(this.entityName=m(e,ii,ea.defaultValues(ii))),oi in e&&(this.objectDigestInfo=m(e,oi,ea.defaultValues(oi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ni:return new vr;case ii:return new Ut;case oi:return new Or;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new N({optional:!0,name:t.baseCertificateID||S,idBlock:{tagClass:3,tagNumber:0},value:vr.schema().valueBlock.value}),new N({optional:!0,name:t.entityName||S,idBlock:{tagClass:3,tagNumber:1},value:Ut.schema().valueBlock.value}),new N({optional:!0,name:t.objectDigestInfo||S,idBlock:{tagClass:3,tagNumber:2},value:Or.schema().valueBlock.value})]})}fromSchema(e){W(e,XE);const t=j(e,e,ea.schema({names:{baseCertificateID:ni,entityName:ii,objectDigestInfo:oi}}));P.assertSchema(t,this.className),ni in t.result&&(this.baseCertificateID=new vr({schema:new b({value:t.result.baseCertificateID.valueBlock.value})})),ii in t.result&&(this.entityName=new Ut({schema:new b({value:t.result.entityName.valueBlock.value})})),oi in t.result&&(this.objectDigestInfo=new Or({schema:new b({value:t.result.objectDigestInfo.valueBlock.value})}))}toSchema(){const e=new b;return this.baseCertificateID&&e.valueBlock.value.push(new N({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),this.entityName&&e.valueBlock.value.push(new N({idBlock:{tagClass:3,tagNumber:1},value:this.entityName.toSchema().valueBlock.value})),this.objectDigestInfo&&e.valueBlock.value.push(new N({idBlock:{tagClass:3,tagNumber:2},value:this.objectDigestInfo.toSchema().valueBlock.value})),e}toJSON(){const e={};return this.baseCertificateID&&(e.baseCertificateID=this.baseCertificateID.toJSON()),this.entityName&&(e.entityName=this.entityName.toJSON()),this.objectDigestInfo&&(e.objectDigestInfo=this.objectDigestInfo.toJSON()),e}}ea.CLASS_NAME="Holder";const Pc="version",Uc="holder",Kc="issuer",Mc="signature",Hc="serialNumber",Fc="attrCertValidityPeriod",qc="attributes",li="issuerUniqueID",ui="extensions",ZE=[Pc,Uc,Kc,Mc,Hc,Fc,qc,li,ui];class hr extends G{constructor(e={}){super(),this.version=m(e,Pc,hr.defaultValues(Pc)),this.holder=m(e,Uc,hr.defaultValues(Uc)),this.issuer=m(e,Kc,hr.defaultValues(Kc)),this.signature=m(e,Mc,hr.defaultValues(Mc)),this.serialNumber=m(e,Hc,hr.defaultValues(Hc)),this.attrCertValidityPeriod=m(e,Fc,hr.defaultValues(Fc)),this.attributes=m(e,qc,hr.defaultValues(qc)),li in e&&(this.issuerUniqueID=m(e,li,hr.defaultValues(li))),ui in e&&(this.extensions=m(e,ui,hr.defaultValues(ui))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Pc:return 1;case Uc:return new ea;case Kc:return{};case Mc:return new $;case Hc:return new _;case Fc:return new hs;case qc:return[];case li:return new He;case ui:return new Dt;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _({name:t.version||S}),ea.schema(t.holder||{}),new wt({value:[Ut.schema({names:{blockName:t.issuer||S}}),new N({name:t.issuer||S,idBlock:{tagClass:3,tagNumber:0},value:mn.schema().valueBlock.value})]}),$.schema(t.signature||{}),new _({name:t.serialNumber||S}),hs.schema(t.attrCertValidityPeriod||{}),new b({name:t.attributes||S,value:[new _e({value:mt.schema()})]}),new He({optional:!0,name:t.issuerUniqueID||S}),Dt.schema(t.extensions||{},!0)]})}fromSchema(e){W(e,ZE);const t=j(e,e,hr.schema({names:{version:Pc,holder:{names:{blockName:Uc}},issuer:Kc,signature:{names:{blockName:Mc}},serialNumber:Hc,attrCertValidityPeriod:{names:{blockName:Fc}},attributes:qc,issuerUniqueID:li,extensions:{names:{blockName:ui}}}}));switch(P.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.holder=new ea({schema:t.result.holder}),t.result.issuer.idBlock.tagClass){case 3:this.issuer=new mn({schema:new b({value:t.result.issuer.valueBlock.value})});break;case 1:default:throw new Error("Incorrect value for 'issuer' in AttributeCertificateInfoV2")}this.signature=new $({schema:t.result.signature}),this.serialNumber=t.result.serialNumber,this.attrCertValidityPeriod=new hs({schema:t.result.attrCertValidityPeriod}),this.attributes=Array.from(t.result.attributes.valueBlock.value,r=>new mt({schema:r})),li in t.result&&(this.issuerUniqueID=t.result.issuerUniqueID),ui in t.result&&(this.extensions=new Dt({schema:t.result.extensions}))}toSchema(){const e=new b({value:[new _({value:this.version}),this.holder.toSchema(),new N({idBlock:{tagClass:3,tagNumber:0},value:this.issuer.toSchema().valueBlock.value}),this.signature.toSchema(),this.serialNumber,this.attrCertValidityPeriod.toSchema(),new b({value:Array.from(this.attributes,t=>t.toSchema())})]});return this.issuerUniqueID&&e.valueBlock.value.push(this.issuerUniqueID),this.extensions&&e.valueBlock.value.push(this.extensions.toSchema()),e}toJSON(){const e={version:this.version,holder:this.holder.toJSON(),issuer:this.issuer.toJSON(),signature:this.signature.toJSON(),serialNumber:this.serialNumber.toJSON(),attrCertValidityPeriod:this.attrCertValidityPeriod.toJSON(),attributes:Array.from(this.attributes,t=>t.toJSON())};return this.issuerUniqueID&&(e.issuerUniqueID=this.issuerUniqueID.toJSON()),this.extensions&&(e.extensions=this.extensions.toJSON()),e}}hr.CLASS_NAME="AttributeCertificateInfoV2";const Jc="acinfo",Gc="signatureAlgorithm",jc="signatureValue",eb=[Jc,Gc,jc];class Pr extends G{constructor(e={}){super(),this.acinfo=m(e,Jc,Pr.defaultValues(Jc)),this.signatureAlgorithm=m(e,Gc,Pr.defaultValues(Gc)),this.signatureValue=m(e,jc,Pr.defaultValues(jc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Jc:return new hr;case Gc:return new $;case jc:return new He;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[hr.schema(t.acinfo||{}),$.schema(t.signatureAlgorithm||{}),new He({name:t.signatureValue||S})]})}fromSchema(e){W(e,eb);const t=j(e,e,Pr.schema({names:{acinfo:{names:{blockName:Jc}},signatureAlgorithm:{names:{blockName:Gc}},signatureValue:jc}}));P.assertSchema(t,this.className),this.acinfo=new hr({schema:t.result.acinfo}),this.signatureAlgorithm=new $({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}toSchema(){return new b({value:[this.acinfo.toSchema(),this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){return{acinfo:this.acinfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()}}}Pr.CLASS_NAME="AttributeCertificateV2";const ci="contentType",_o="content",tb=[ci,_o];class ft extends G{constructor(e={}){super(),this.contentType=m(e,ci,ft.defaultValues(ci)),this.content=m(e,_o,ft.defaultValues(_o)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ci:return S;case _o:return new xe;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ci:return typeof t=="string"&&t===this.defaultValues(ci);case _o:return t instanceof xe;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return"optional"in t||(t.optional=!1),new b({name:t.blockName||"ContentInfo",optional:t.optional,value:[new he({name:t.contentType||ci}),new N({idBlock:{tagClass:3,tagNumber:0},value:[new xe({name:t.content||_o})]})]})}fromSchema(e){W(e,tb);const t=j(e,e,ft.schema());P.assertSchema(t,this.className),this.contentType=t.result.contentType.valueBlock.toString(),this.content=t.result.content}toSchema(){return new b({value:[new he({value:this.contentType}),new N({idBlock:{tagClass:3,tagNumber:0},value:[this.content]})]})}toJSON(){const e={contentType:this.contentType};return this.content instanceof xe||(e.content=this.content.toJSON()),e}}ft.CLASS_NAME="ContentInfo";ft.DATA=ym;ft.SIGNED_DATA=t1;ft.ENVELOPED_DATA=r1;ft.ENCRYPTED_DATA=s1;const Td="type",Rd="value",vg="utcTimeName",wg="generalTimeName",rb=[vg,wg];var Rp;(function(s){s[s.UTCTime=0]="UTCTime",s[s.GeneralizedTime=1]="GeneralizedTime",s[s.empty=2]="empty"})(Rp||(Rp={}));class Vt extends G{constructor(e={}){super(),this.type=m(e,Td,Vt.defaultValues(Td)),this.value=m(e,Rd,Vt.defaultValues(Rd)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Td:return 0;case Rd:return new Date(0,0,0);default:return super.defaultValues(e)}}static schema(e={},t=!1){const r=m(e,"names",{});return new wt({optional:t,value:[new nu({name:r.utcTimeName||S}),new vt({name:r.generalTimeName||S})]})}fromSchema(e){W(e,rb);const t=j(e,e,Vt.schema({names:{utcTimeName:vg,generalTimeName:wg}}));P.assertSchema(t,this.className),vg in t.result&&(this.type=0,this.value=t.result.utcTimeName.toDate()),wg in t.result&&(this.type=1,this.value=t.result.generalTimeName.toDate())}toSchema(){return this.type===0?new nu({valueDate:this.value}):this.type===1?new vt({valueDate:this.value}):{}}toJSON(){return{type:this.type,value:this.value}}}Vt.CLASS_NAME="Time";const Vd="tbs",$a="version",Kh="serialNumber",Mh="signature",Hh="issuer",Fh="notBefore",qh="notAfter",Jh="subject",Gh="subjectPublicKeyInfo",Wc="issuerUniqueID",Qc="subjectUniqueID",Yc="extensions",zc="signatureAlgorithm",Xc="signatureValue",Kr="tbsCertificate",T0=`${Kr}.${$a}`,vm=`${Kr}.${Kh}`,wm=`${Kr}.${Mh}`,Sm=`${Kr}.${Hh}`,R0=`${Kr}.${Fh}`,V0=`${Kr}.${qh}`,Cm=`${Kr}.${Jh}`,Am=`${Kr}.${Gh}`,_0=`${Kr}.${Wc}`,$0=`${Kr}.${Qc}`,$f=`${Kr}.${Yc}`,sb=[Kr,T0,vm,wm,Sm,R0,V0,Cm,Am,_0,$0,$f,zc,Xc];function ab(s={}){const e=m(s,"names",{});return new b({name:e.blockName||Kr,value:[new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new _({name:e.tbsCertificateVersion||T0})]}),new _({name:e.tbsCertificateSerialNumber||vm}),$.schema(e.signature||{names:{blockName:wm}}),rt.schema(e.issuer||{names:{blockName:Sm}}),new b({name:e.tbsCertificateValidity||"tbsCertificate.validity",value:[Vt.schema(e.notBefore||{names:{utcTimeName:R0,generalTimeName:R0}}),Vt.schema(e.notAfter||{names:{utcTimeName:V0,generalTimeName:V0}})]}),rt.schema(e.subject||{names:{blockName:Cm}}),wr.schema(e.subjectPublicKeyInfo||{names:{blockName:Am}}),new Ie({name:e.tbsCertificateIssuerUniqueID||_0,optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new Ie({name:e.tbsCertificateSubjectUniqueID||$0,optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[Dt.schema(e.extensions||{names:{blockName:$f}})]})]})}class Xe extends G{constructor(e={}){super(),this.tbsView=new Uint8Array(m(e,Vd,Xe.defaultValues(Vd))),this.version=m(e,$a,Xe.defaultValues($a)),this.serialNumber=m(e,Kh,Xe.defaultValues(Kh)),this.signature=m(e,Mh,Xe.defaultValues(Mh)),this.issuer=m(e,Hh,Xe.defaultValues(Hh)),this.notBefore=m(e,Fh,Xe.defaultValues(Fh)),this.notAfter=m(e,qh,Xe.defaultValues(qh)),this.subject=m(e,Jh,Xe.defaultValues(Jh)),this.subjectPublicKeyInfo=m(e,Gh,Xe.defaultValues(Gh)),Wc in e&&(this.issuerUniqueID=m(e,Wc,Xe.defaultValues(Wc))),Qc in e&&(this.subjectUniqueID=m(e,Qc,Xe.defaultValues(Qc))),Yc in e&&(this.extensions=m(e,Yc,Xe.defaultValues(Yc))),this.signatureAlgorithm=m(e,zc,Xe.defaultValues(zc)),this.signatureValue=m(e,Xc,Xe.defaultValues(Xc)),e.schema&&this.fromSchema(e.schema)}get tbs(){return Ee.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}static defaultValues(e){switch(e){case Vd:return $t;case $a:return 0;case Kh:return new _;case Mh:return new $;case Hh:return new rt;case Fh:return new Vt;case qh:return new Vt;case Jh:return new rt;case Gh:return new wr;case Wc:return $t;case Qc:return $t;case Yc:return[];case zc:return new $;case Xc:return new He;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[ab(t.tbsCertificate),$.schema(t.signatureAlgorithm||{names:{blockName:zc}}),new He({name:t.signatureValue||Xc})]})}fromSchema(e){W(e,sb);const t=j(e,e,Xe.schema({names:{tbsCertificate:{names:{extensions:{names:{extensions:$f}}}}}}));P.assertSchema(t,this.className),this.tbsView=t.result.tbsCertificate.valueBeforeDecodeView,T0 in t.result&&(this.version=t.result[T0].valueBlock.valueDec),this.serialNumber=t.result[vm],this.signature=new $({schema:t.result[wm]}),this.issuer=new rt({schema:t.result[Sm]}),this.notBefore=new Vt({schema:t.result[R0]}),this.notAfter=new Vt({schema:t.result[V0]}),this.subject=new rt({schema:t.result[Cm]}),this.subjectPublicKeyInfo=new wr({schema:t.result[Am]}),_0 in t.result&&(this.issuerUniqueID=t.result[_0].valueBlock.valueHex),$0 in t.result&&(this.subjectUniqueID=t.result[$0].valueBlock.valueHex),$f in t.result&&(this.extensions=Array.from(t.result[$f],r=>new Tt({schema:r}))),this.signatureAlgorithm=new $({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[];return $a in this&&this.version!==Xe.defaultValues($a)&&e.push(new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new _({value:this.version})]})),e.push(this.serialNumber),e.push(this.signature.toSchema()),e.push(this.issuer.toSchema()),e.push(new b({value:[this.notBefore.toSchema(),this.notAfter.toSchema()]})),e.push(this.subject.toSchema()),e.push(this.subjectPublicKeyInfo.toSchema()),this.issuerUniqueID&&e.push(new Ie({optional:!0,idBlock:{tagClass:3,tagNumber:1},valueHex:this.issuerUniqueID})),this.subjectUniqueID&&e.push(new Ie({optional:!0,idBlock:{tagClass:3,tagNumber:2},valueHex:this.subjectUniqueID})),this.extensions&&e.push(new N({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[new b({value:Array.from(this.extensions,t=>t.toSchema())})]})),new b({value:e})}toSchema(e=!1){let t;if(e===!1){if(!this.tbsView.byteLength)return Xe.schema().value[0];const r=_t(this.tbsView);P.assert(r,"TBS Certificate"),t=r.result}else t=this.encodeTBS();return new b({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:ke.ToHex(this.tbsView),version:this.version,serialNumber:this.serialNumber.toJSON(),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),notBefore:this.notBefore.toJSON(),notAfter:this.notAfter.toJSON(),subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return $a in this&&this.version!==Xe.defaultValues($a)&&(e.version=this.version),this.issuerUniqueID&&(e.issuerUniqueID=ke.ToHex(this.issuerUniqueID)),this.subjectUniqueID&&(e.subjectUniqueID=ke.ToHex(this.subjectUniqueID)),this.extensions&&(e.extensions=Array.from(this.extensions,t=>t.toJSON())),e}async getPublicKey(e,t=Le(!0)){return t.getPublicKey(this.subjectPublicKeyInfo,this.signatureAlgorithm,e)}async getKeyHash(e="SHA-1",t=Le(!0)){return t.digest({name:e},this.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView)}async sign(e,t="SHA-1",r=Le(!0)){if(!e)throw new Error("Need to provide a private key for signing");const a=await r.getSignatureParameters(e,t),n=a.parameters;this.signature=a.signatureAlgorithm,this.signatureAlgorithm=a.signatureAlgorithm,this.tbsView=new Uint8Array(this.encodeTBS().toBER());const i=await r.signWithPrivateKey(this.tbsView,e,n);this.signatureValue=new He({valueHex:i})}async verify(e,t=Le(!0)){let r;if(e?r=e.subjectPublicKeyInfo:this.issuer.isEqual(this.subject)&&(r=this.subjectPublicKeyInfo),!(r instanceof wr))throw new Error("Please provide issuer certificate as a parameter");return t.verifyWithPublicKey(this.tbsView,this.signatureValue,r,this.signatureAlgorithm)}}Xe.CLASS_NAME="Certificate";function u1(s,e=null){if(e&&s.issuer.isEqual(e.issuer)&&s.serialNumber.isEqual(e.serialNumber))return null;let t=!1;if(s.extensions){for(const r of s.extensions)if(r.extnID===dm&&r.parsedValue instanceof Wi&&r.parsedValue.cA){t=!0;break}}return t?s:null}const $o="certId",Do="certValue",go="parsedValue",nb=[$o,Do];class Fi extends G{constructor(e={}){super(),this.certId=m(e,$o,Fi.defaultValues($o)),this.certValue=m(e,Do,Fi.defaultValues(Do)),go in e&&(this.parsedValue=m(e,go,Fi.defaultValues(go))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case $o:return S;case Do:return new xe;case go:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case $o:return t===S;case Do:return t instanceof xe;case go:return t instanceof Object&&Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.id||"id"}),new N({idBlock:{tagClass:3,tagNumber:0},value:[new xe({name:t.value||"value"})]})]})}fromSchema(e){W(e,nb);const t=j(e,e,Fi.schema({names:{id:$o,value:Do}}));P.assertSchema(t,this.className),this.certId=t.result.certId.valueBlock.toString(),this.certValue=t.result.certValue;const r=this.certValue.valueBlock.valueHexView;switch(this.certId){case hp:try{this.parsedValue=Xe.fromBER(r)}catch{Pr.fromBER(r)}break;case dp:this.parsedValue=Pr.fromBER(r);break;case uE:default:throw new Error(`Incorrect CERT_ID value in CertBag: ${this.certId}`)}}toSchema(){return go in this&&("acinfo"in this.parsedValue?this.certId=dp:this.certId=hp,this.certValue=new z({valueHex:this.parsedValue.toSchema().toBER(!1)})),new b({value:[new he({value:this.certId}),new N({idBlock:{tagClass:3,tagNumber:0},value:["toSchema"in this.certValue?this.certValue.toSchema():this.certValue]})]})}toJSON(){return{certId:this.certId,certValue:this.certValue.toJSON()}}}Fi.CLASS_NAME="CertBag";const Zc="userCertificate",Lo="revocationDate",fi="crlEntryExtensions",ib=[Zc,Lo,fi];class qi extends G{constructor(e={}){super(),this.userCertificate=m(e,Zc,qi.defaultValues(Zc)),this.revocationDate=m(e,Lo,qi.defaultValues(Lo)),fi in e&&(this.crlEntryExtensions=m(e,fi,qi.defaultValues(fi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Zc:return new _;case Lo:return new Vt;case fi:return new Dt;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _({name:t.userCertificate||Zc}),Vt.schema({names:{utcTimeName:t.revocationDate||Lo,generalTimeName:t.revocationDate||Lo}}),Dt.schema({names:{blockName:t.crlEntryExtensions||fi}},!0)]})}fromSchema(e){W(e,ib);const t=j(e,e,qi.schema());P.assertSchema(t,this.className),this.userCertificate=t.result.userCertificate,this.revocationDate=new Vt({schema:t.result.revocationDate}),fi in t.result&&(this.crlEntryExtensions=new Dt({schema:t.result.crlEntryExtensions}))}toSchema(){const e=[this.userCertificate,this.revocationDate.toSchema()];return this.crlEntryExtensions&&e.push(this.crlEntryExtensions.toSchema()),new b({value:e})}toJSON(){const e={userCertificate:this.userCertificate.toJSON(),revocationDate:this.revocationDate.toJSON()};return this.crlEntryExtensions&&(e.crlEntryExtensions=this.crlEntryExtensions.toJSON()),e}}qi.CLASS_NAME="RevokedCertificate";const _d="tbs",bu="version",$d="signature",Dd="issuer",Ld="thisUpdate",yh="nextUpdate",vh="revokedCertificates",wh="crlExtensions",ef="signatureAlgorithm",tf="signatureValue",ha="tbsCertList",D0=`${ha}.version`,Em=`${ha}.signature`,bm=`${ha}.issuer`,L0=`${ha}.thisUpdate`,Wf=`${ha}.nextUpdate`,O0=`${ha}.revokedCertificates`,P0=`${ha}.extensions`,ob=[ha,D0,Em,bm,L0,Wf,O0,P0,ef,tf];function lb(s={}){const e=m(s,"names",{});return new b({name:e.blockName||ha,value:[new _({optional:!0,name:e.tbsCertListVersion||D0,value:2}),$.schema(e.signature||{names:{blockName:Em}}),rt.schema(e.issuer||{names:{blockName:bm}}),Vt.schema(e.tbsCertListThisUpdate||{names:{utcTimeName:L0,generalTimeName:L0}}),Vt.schema(e.tbsCertListNextUpdate||{names:{utcTimeName:Wf,generalTimeName:Wf}},!0),new b({optional:!0,value:[new _e({name:e.tbsCertListRevokedCertificates||O0,value:new b({value:[new _,Vt.schema(),Dt.schema({},!0)]})})]}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[Dt.schema(e.crlExtensions||{names:{blockName:P0}})]})]})}const ub=[mm,jv,YA,zA,Wv,gm,pm,XA,ZA,Qv];class Ot extends G{constructor(e={}){super(),this.tbsView=new Uint8Array(m(e,_d,Ot.defaultValues(_d))),this.version=m(e,bu,Ot.defaultValues(bu)),this.signature=m(e,$d,Ot.defaultValues($d)),this.issuer=m(e,Dd,Ot.defaultValues(Dd)),this.thisUpdate=m(e,Ld,Ot.defaultValues(Ld)),yh in e&&(this.nextUpdate=m(e,yh,Ot.defaultValues(yh))),vh in e&&(this.revokedCertificates=m(e,vh,Ot.defaultValues(vh))),wh in e&&(this.crlExtensions=m(e,wh,Ot.defaultValues(wh))),this.signatureAlgorithm=m(e,ef,Ot.defaultValues(ef)),this.signatureValue=m(e,tf,Ot.defaultValues(tf)),e.schema&&this.fromSchema(e.schema)}get tbs(){return Ee.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}static defaultValues(e){switch(e){case _d:return $t;case bu:return 0;case $d:return new $;case Dd:return new rt;case Ld:return new Vt;case yh:return new Vt;case vh:return[];case wh:return new Dt;case ef:return new $;case tf:return new He;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||"CertificateList",value:[lb(e),$.schema(t.signatureAlgorithm||{names:{blockName:ef}}),new He({name:t.signatureValue||tf})]})}fromSchema(e){W(e,ob);const t=j(e,e,Ot.schema());P.assertSchema(t,this.className),this.tbsView=t.result.tbsCertList.valueBeforeDecodeView,D0 in t.result&&(this.version=t.result[D0].valueBlock.valueDec),this.signature=new $({schema:t.result[Em]}),this.issuer=new rt({schema:t.result[bm]}),this.thisUpdate=new Vt({schema:t.result[L0]}),Wf in t.result&&(this.nextUpdate=new Vt({schema:t.result[Wf]})),O0 in t.result&&(this.revokedCertificates=Array.from(t.result[O0],r=>new qi({schema:r}))),P0 in t.result&&(this.crlExtensions=new Dt({schema:t.result[P0]})),this.signatureAlgorithm=new $({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[];return this.version!==Ot.defaultValues(bu)&&e.push(new _({value:this.version})),e.push(this.signature.toSchema()),e.push(this.issuer.toSchema()),e.push(this.thisUpdate.toSchema()),this.nextUpdate&&e.push(this.nextUpdate.toSchema()),this.revokedCertificates&&e.push(new b({value:Array.from(this.revokedCertificates,t=>t.toSchema())})),this.crlExtensions&&e.push(new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.crlExtensions.toSchema()]})),new b({value:e})}toSchema(e=!1){let t;if(e)t=this.encodeTBS();else{if(!this.tbsView.byteLength)return Ot.schema();const r=_t(this.tbsView);P.assert(r,"TBS Certificate Revocation List"),t=r.result}return new b({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:ke.ToHex(this.tbsView),version:this.version,signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),thisUpdate:this.thisUpdate.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return this.version!==Ot.defaultValues(bu)&&(e.version=this.version),this.nextUpdate&&(e.nextUpdate=this.nextUpdate.toJSON()),this.revokedCertificates&&(e.revokedCertificates=Array.from(this.revokedCertificates,t=>t.toJSON())),this.crlExtensions&&(e.crlExtensions=this.crlExtensions.toJSON()),e}isCertificateRevoked(e){if(!this.issuer.isEqual(e.issuer)||!this.revokedCertificates)return!1;for(const t of this.revokedCertificates)if(t.userCertificate.isEqual(e.serialNumber))return!0;return!1}async sign(e,t="SHA-1",r=Le(!0)){if(!e)throw new Error("Need to provide a private key for signing");const a=await r.getSignatureParameters(e,t),{parameters:n}=a;this.signature=a.signatureAlgorithm,this.signatureAlgorithm=a.signatureAlgorithm,this.tbsView=new Uint8Array(this.encodeTBS().toBER());const i=await r.signWithPrivateKey(this.tbsView,e,n);this.signatureValue=new He({valueHex:i})}async verify(e={},t=Le(!0)){let r;if(e.issuerCertificate&&(r=e.issuerCertificate.subjectPublicKeyInfo,!this.issuer.isEqual(e.issuerCertificate.subject)))return!1;if(e.publicKeyInfo&&(r=e.publicKeyInfo),!r)throw new Error("Issuer's certificate must be provided as an input parameter");if(this.crlExtensions){for(const a of this.crlExtensions.extensions)if(a.critical&&!ub.includes(a.extnID))return!1}return t.verifyWithPublicKey(this.tbsView,this.signatureValue,r,this.signatureAlgorithm)}}Ot.CLASS_NAME="CertificateRevocationList";const Oo="crlId",Po="crlValue",ku="parsedValue",cb=[Oo,Po];class Ji extends G{constructor(e={}){super(),this.crlId=m(e,Oo,Ji.defaultValues(Oo)),this.crlValue=m(e,Po,Ji.defaultValues(Po)),ku in e&&(this.parsedValue=m(e,ku,Ji.defaultValues(ku))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Oo:return S;case Po:return new xe;case ku:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Oo:return t===S;case Po:return t instanceof xe;case ku:return t instanceof Object&&Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.id||"id"}),new N({idBlock:{tagClass:3,tagNumber:0},value:[new xe({name:t.value||"value"})]})]})}fromSchema(e){W(e,cb);const t=j(e,e,Ji.schema({names:{id:Oo,value:Po}}));switch(P.assertSchema(t,this.className),this.crlId=t.result.crlId.valueBlock.toString(),this.crlValue=t.result.crlValue,this.crlId){case gp:this.parsedValue=Ot.fromBER(this.certValue.valueBlock.valueHex);break;default:throw new Error(`Incorrect CRL_ID value in CRLBag: ${this.crlId}`)}}toSchema(){return this.parsedValue&&(this.crlId=gp,this.crlValue=new z({valueHex:this.parsedValue.toSchema().toBER(!1)})),new b({value:[new he({value:this.crlId}),new N({idBlock:{tagClass:3,tagNumber:0},value:[this.crlValue.toSchema()]})]})}toJSON(){return{crlId:this.crlId,crlValue:this.crlValue.toJSON()}}}Ji.CLASS_NAME="CRLBag";const Uo="version",Ko="encryptedContentInfo",Da="unprotectedAttrs",fb=[Uo,Ko,Da];class Ns extends G{constructor(e={}){super(),this.version=m(e,Uo,Ns.defaultValues(Uo)),this.encryptedContentInfo=m(e,Ko,Ns.defaultValues(Ko)),Da in e&&(this.unprotectedAttrs=m(e,Da,Ns.defaultValues(Da))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Uo:return 0;case Ko:return new Nt;case Da:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Uo:return t===0;case Ko:return Nt.compareWithDefault("contentType",t.contentType)&&Nt.compareWithDefault("contentEncryptionAlgorithm",t.contentEncryptionAlgorithm)&&Nt.compareWithDefault("encryptedContent",t.encryptedContent);case Da:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _({name:t.version||S}),Nt.schema(t.encryptedContentInfo||{}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new _e({name:t.unprotectedAttrs||S,value:mt.schema()})]})]})}fromSchema(e){W(e,fb);const t=j(e,e,Ns.schema({names:{version:Uo,encryptedContentInfo:{names:{blockName:Ko}},unprotectedAttrs:Da}}));P.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.encryptedContentInfo=new Nt({schema:t.result.encryptedContentInfo}),Da in t.result&&(this.unprotectedAttrs=Array.from(t.result.unprotectedAttrs,r=>new mt({schema:r})))}toSchema(){const e=[];return e.push(new _({value:this.version})),e.push(this.encryptedContentInfo.toSchema()),this.unprotectedAttrs&&e.push(new N({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.unprotectedAttrs,t=>t.toSchema())})),new b({value:e})}toJSON(){const e={version:this.version,encryptedContentInfo:this.encryptedContentInfo.toJSON()};return this.unprotectedAttrs&&(e.unprotectedAttrs=Array.from(this.unprotectedAttrs,t=>t.toJSON())),e}async encrypt(e,t=Le(!0)){tt.assert(e,"parameters","object");const r={...e,contentType:"1.2.840.113549.1.7.1"};this.encryptedContentInfo=await t.encryptEncryptedContentInfo(r)}async decrypt(e,t=Le(!0)){tt.assert(e,"parameters","object");const r={...e,encryptedContentInfo:this.encryptedContentInfo};return t.decryptEncryptedContentInfo(r)}}Ns.CLASS_NAME="EncryptedData";const hi="encryptionAlgorithm",La="encryptedData",Iu="parsedValue",hb=[hi,La];class an extends G{constructor(e={}){super(),this.encryptionAlgorithm=m(e,hi,an.defaultValues(hi)),this.encryptedData=m(e,La,an.defaultValues(La)),Iu in e&&(this.parsedValue=m(e,Iu,an.defaultValues(Iu))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case hi:return new $;case La:return new z;case Iu:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case hi:return $.compareWithDefault("algorithmId",t.algorithmId)&&!("algorithmParams"in t);case La:return t.isEqual(an.defaultValues(e));case Iu:return t instanceof Object&&Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[$.schema(t.encryptionAlgorithm||{names:{blockName:hi}}),new wt({value:[new z({name:t.encryptedData||La}),new z({idBlock:{isConstructed:!0},name:t.encryptedData||La})]})]})}fromSchema(e){W(e,hb);const t=j(e,e,an.schema({names:{encryptionAlgorithm:{names:{blockName:hi}},encryptedData:La}}));P.assertSchema(t,this.className),this.encryptionAlgorithm=new $({schema:t.result.encryptionAlgorithm}),this.encryptedData=t.result.encryptedData}toSchema(){return new b({value:[this.encryptionAlgorithm.toSchema(),this.encryptedData]})}toJSON(){return{encryptionAlgorithm:this.encryptionAlgorithm.toJSON(),encryptedData:this.encryptedData.toJSON()}}async parseInternalValues(e,t=Le(!0)){const a=await new Ns({encryptedContentInfo:new Nt({contentEncryptionAlgorithm:this.encryptionAlgorithm,encryptedContent:this.encryptedData})}).decrypt(e,t);this.parsedValue=Jr.fromBER(a)}async makeInternalValues(e,t=Le(!0)){if(!this.parsedValue)throw new Error('Please initialize "parsedValue" first');const r=new Ns,a={...e,contentToEncrypt:this.parsedValue.toSchema().toBER(!1)};if(await r.encrypt(a,t),!r.encryptedContentInfo.encryptedContent)throw new Error("The filed `encryptedContent` in EncryptedContentInfo is empty");this.encryptionAlgorithm=r.encryptedContentInfo.contentEncryptionAlgorithm,this.encryptedData=r.encryptedContentInfo.encryptedContent}}an.CLASS_NAME="PKCS8ShroudedKeyBag";const Mo="secretTypeId",Ho="secretValue",db=[Mo,Ho];class Xl extends G{constructor(e={}){super(),this.secretTypeId=m(e,Mo,Xl.defaultValues(Mo)),this.secretValue=m(e,Ho,Xl.defaultValues(Ho)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Mo:return S;case Ho:return new xe;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Mo:return t===S;case Ho:return t instanceof xe;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.id||"id"}),new N({idBlock:{tagClass:3,tagNumber:0},value:[new xe({name:t.value||"value"})]})]})}fromSchema(e){W(e,db);const t=j(e,e,Xl.schema({names:{id:Mo,value:Ho}}));P.assertSchema(t,this.className),this.secretTypeId=t.result.secretTypeId.valueBlock.toString(),this.secretValue=t.result.secretValue}toSchema(){return new b({value:[new he({value:this.secretTypeId}),new N({idBlock:{tagClass:3,tagNumber:0},value:[this.secretValue.toSchema()]})]})}toJSON(){return{secretTypeId:this.secretTypeId,secretValue:this.secretValue.toJSON()}}}Xl.CLASS_NAME="SecretBag";class rn{static getItems(){return this.items||(this.items={},rn.register("1.2.840.113549.1.12.10.1.1",Jr),rn.register("1.2.840.113549.1.12.10.1.2",an),rn.register("1.2.840.113549.1.12.10.1.3",Fi),rn.register("1.2.840.113549.1.12.10.1.4",Ji),rn.register("1.2.840.113549.1.12.10.1.5",Xl),rn.register("1.2.840.113549.1.12.10.1.6",ta)),this.items}static register(e,t){this.getItems()[e]=t}static find(e){return this.getItems()[e]||null}}const di="bagId",gi="bagValue",Fs="bagAttributes",gb=[di,gi,Fs];class pn extends G{constructor(e={}){super(),this.bagId=m(e,di,pn.defaultValues(di)),this.bagValue=m(e,gi,pn.defaultValues(gi)),Fs in e&&(this.bagAttributes=m(e,Fs,pn.defaultValues(Fs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case di:return S;case gi:return new xe;case Fs:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case di:return t===S;case gi:return t instanceof xe;case Fs:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.bagId||di}),new N({idBlock:{tagClass:3,tagNumber:0},value:[new xe({name:t.bagValue||gi})]}),new Bt({optional:!0,value:[new _e({name:t.bagAttributes||Fs,value:mt.schema()})]})]})}fromSchema(e){W(e,gb);const t=j(e,e,pn.schema({names:{bagId:di,bagValue:gi,bagAttributes:Fs}}));P.assertSchema(t,this.className),this.bagId=t.result.bagId.valueBlock.toString();const r=rn.find(this.bagId);if(!r)throw new Error(`Invalid BAG_ID for SafeBag: ${this.bagId}`);this.bagValue=new r({schema:t.result.bagValue}),Fs in t.result&&(this.bagAttributes=Array.from(t.result.bagAttributes,a=>new mt({schema:a})))}toSchema(){const e=[new he({value:this.bagId}),new N({idBlock:{tagClass:3,tagNumber:0},value:[this.bagValue.toSchema()]})];return this.bagAttributes&&e.push(new Bt({value:Array.from(this.bagAttributes,t=>t.toSchema())})),new b({value:e})}toJSON(){const e={bagId:this.bagId,bagValue:this.bagValue.toJSON()};return this.bagAttributes&&(e.bagAttributes=Array.from(this.bagAttributes,t=>t.toJSON())),e}}pn.CLASS_NAME="SafeBag";const mo="safeBags";class ta extends G{constructor(e={}){super(),this.safeBags=m(e,mo,ta.defaultValues(mo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case mo:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case mo:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _e({name:t.safeBags||S,value:pn.schema()})]})}fromSchema(e){W(e,[mo]);const t=j(e,e,ta.schema({names:{safeBags:mo}}));P.assertSchema(t,this.className),this.safeBags=Array.from(t.result.safeBags,r=>new pn({schema:r}))}toSchema(){return new b({value:Array.from(this.safeBags,e=>e.toSchema())})}toJSON(){return{safeBags:Array.from(this.safeBags,e=>e.toJSON())}}}ta.CLASS_NAME="SafeContents";const rf="otherCertFormat",sf="otherCert",mb=[rf,sf];class An extends G{constructor(e={}){super(),this.otherCertFormat=m(e,rf,An.defaultValues(rf)),this.otherCert=m(e,sf,An.defaultValues(sf)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case rf:return S;case sf:return new xe;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.otherCertFormat||rf}),new xe({name:t.otherCert||sf})]})}fromSchema(e){W(e,mb);const t=j(e,e,An.schema());P.assertSchema(t,this.className),this.otherCertFormat=t.result.otherCertFormat.valueBlock.toString(),this.otherCert=t.result.otherCert}toSchema(){return new b({value:[new he({value:this.otherCertFormat}),this.otherCert]})}toJSON(){const e={otherCertFormat:this.otherCertFormat};return this.otherCert instanceof xe||(e.otherCert=this.otherCert.toJSON()),e}}const af="certificates",pb=[af];class Ts extends G{constructor(e={}){super(),this.certificates=m(e,af,Ts.defaultValues(af)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case af:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new Bt({name:t.blockName||S,value:[new _e({name:t.certificates||af,value:new wt({value:[Xe.schema(),new N({idBlock:{tagClass:3,tagNumber:0},value:[new xe]}),new N({idBlock:{tagClass:3,tagNumber:1},value:[new b]}),new N({idBlock:{tagClass:3,tagNumber:2},value:Pr.schema().valueBlock.value}),new N({idBlock:{tagClass:3,tagNumber:3},value:An.schema().valueBlock.value})]})})]})}fromSchema(e){W(e,pb);const t=j(e,e,Ts.schema());P.assertSchema(t,this.className),this.certificates=Array.from(t.result.certificates||[],r=>{const a=r.idBlock.tagNumber;if(r.idBlock.tagClass===1)return new Xe({schema:r});const n=new b({value:r.valueBlock.value});switch(a){case 1:return n.valueBlock.value[0].valueBlock.value[0].valueBlock.valueDec===1?new Pr({schema:n}):new Zs({schema:n});case 2:return new Pr({schema:n});case 3:return new An({schema:n})}return r})}toSchema(){return new Bt({value:Array.from(this.certificates,e=>{switch(!0){case e instanceof Xe:return e.toSchema();case e instanceof Zs:return new N({idBlock:{tagClass:3,tagNumber:1},value:e.toSchema().valueBlock.value});case e instanceof Pr:return new N({idBlock:{tagClass:3,tagNumber:2},value:e.toSchema().valueBlock.value});case e instanceof An:return new N({idBlock:{tagClass:3,tagNumber:3},value:e.toSchema().valueBlock.value})}return e.toSchema()})})}toJSON(){return{certificates:Array.from(this.certificates,e=>e.toJSON())}}}Ts.CLASS_NAME="CertificateSet";const nf="otherRevInfoFormat",of="otherRevInfo",yb=[nf,of];class ia extends G{constructor(e={}){super(),this.otherRevInfoFormat=m(e,nf,ia.defaultValues(nf)),this.otherRevInfo=m(e,of,ia.defaultValues(of)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case nf:return S;case of:return new xe;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.otherRevInfoFormat||nf}),new xe({name:t.otherRevInfo||of})]})}fromSchema(e){W(e,yb);const t=j(e,e,ia.schema());P.assertSchema(t,this.className),this.otherRevInfoFormat=t.result.otherRevInfoFormat.valueBlock.toString(),this.otherRevInfo=t.result.otherRevInfo}toSchema(){return new b({value:[new he({value:this.otherRevInfoFormat}),this.otherRevInfo]})}toJSON(){const e={otherRevInfoFormat:this.otherRevInfoFormat};return this.otherRevInfo instanceof xe||(e.otherRevInfo=this.otherRevInfo.toJSON()),e}}ia.CLASS_NAME="OtherRevocationInfoFormat";const lf="crls",Od="otherRevocationInfos",vb=[lf];class oa extends G{constructor(e={}){super(),this.crls=m(e,lf,oa.defaultValues(lf)),this.otherRevocationInfos=m(e,Od,oa.defaultValues(Od)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case lf:return[];case Od:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new Bt({name:t.blockName||S,value:[new _e({name:t.crls||S,value:new wt({value:[Ot.schema(),new N({idBlock:{tagClass:3,tagNumber:1},value:[new he,new xe]})]})})]})}fromSchema(e){W(e,vb);const t=j(e,e,oa.schema({names:{crls:lf}}));if(P.assertSchema(t,this.className),t.result.crls)for(const r of t.result.crls)r.idBlock.tagClass===1?this.crls.push(new Ot({schema:r})):this.otherRevocationInfos.push(new ia({schema:r}))}toSchema(){const e=[];return e.push(...Array.from(this.crls,t=>t.toSchema())),e.push(...Array.from(this.otherRevocationInfos,t=>{const r=t.toSchema();return r.idBlock.tagClass=3,r.idBlock.tagNumber=1,r})),new Bt({value:e})}toJSON(){return{crls:Array.from(this.crls,e=>e.toJSON()),otherRevocationInfos:Array.from(this.otherRevocationInfos,e=>e.toJSON())}}}oa.CLASS_NAME="RevocationInfoChoices";const uf="certs",mi="crls",wb=[uf,mi];class to extends G{constructor(e={}){super(),this.crls=m(e,mi,to.defaultValues(mi)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case uf:return new Ts;case mi:return new oa;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case uf:return t.certificates.length===0;case mi:return t.crls.length===0&&t.otherRevocationInfos.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new N({name:t.certs||S,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Ts.schema().valueBlock.value}),new N({name:t.crls||S,optional:!0,idBlock:{tagClass:3,tagNumber:1},value:oa.schema().valueBlock.value})]})}fromSchema(e){W(e,wb);const t=j(e,e,to.schema({names:{certs:uf,crls:mi}}));P.assertSchema(t,this.className),uf in t.result&&(this.certs=new Ts({schema:new Bt({value:t.result.certs.valueBlock.value})})),mi in t.result&&(this.crls=new oa({schema:new Bt({value:t.result.crls.valueBlock.value})}))}toSchema(){const e=[];return this.certs&&e.push(new N({idBlock:{tagClass:3,tagNumber:0},value:this.certs.toSchema().valueBlock.value})),this.crls&&e.push(new N({idBlock:{tagClass:3,tagNumber:1},value:this.crls.toSchema().valueBlock.value})),new b({value:e})}toJSON(){const e={};return this.certs&&(e.certs=this.certs.toJSON()),this.crls&&(e.crls=this.crls.toJSON()),e}}to.CLASS_NAME="OriginatorInfo";const cf="issuer",ff="serialNumber",Sb=[cf,ff];class Lt extends G{constructor(e={}){super(),this.issuer=m(e,cf,Lt.defaultValues(cf)),this.serialNumber=m(e,ff,Lt.defaultValues(ff)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case cf:return new rt;case ff:return new _;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[rt.schema(t.issuer||{}),new _({name:t.serialNumber||S})]})}fromSchema(e){W(e,Sb);const t=j(e,e,Lt.schema({names:{issuer:{names:{blockName:cf}},serialNumber:ff}}));P.assertSchema(t,this.className),this.issuer=new rt({schema:t.result.issuer}),this.serialNumber=t.result.serialNumber}toSchema(){return new b({value:[this.issuer.toSchema(),this.serialNumber]})}toJSON(){return{issuer:this.issuer.toJSON(),serialNumber:this.serialNumber.toJSON()}}}Lt.CLASS_NAME="IssuerAndSerialNumber";const Sh="variant",Bu="value",Cb=["blockName"];class Zl extends G{constructor(e={}){super(),this.variant=m(e,Sh,Zl.defaultValues(Sh)),Bu in e&&(this.value=m(e,Bu,Zl.defaultValues(Bu))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Sh:return-1;case Bu:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Sh:return t===-1;case Bu:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new wt({value:[Lt.schema({names:{blockName:t.blockName||S}}),new Ie({name:t.blockName||S,idBlock:{tagClass:3,tagNumber:0}})]})}fromSchema(e){W(e,Cb);const t=j(e,e,Zl.schema({names:{blockName:"blockName"}}));P.assertSchema(t,this.className),t.result.blockName.idBlock.tagClass===1?(this.variant=1,this.value=new Lt({schema:t.result.blockName})):(this.variant=2,this.value=new z({valueHex:t.result.blockName.valueBlock.valueHex}))}toSchema(){switch(this.variant){case 1:if(!(this.value instanceof Lt))throw new Error("Incorrect type of RecipientIdentifier.value. It should be IssuerAndSerialNumber.");return this.value.toSchema();case 2:if(!(this.value instanceof z))throw new Error("Incorrect type of RecipientIdentifier.value. It should be ASN.1 OctetString.");return new Ie({idBlock:{tagClass:3,tagNumber:0},valueHex:this.value.valueBlock.valueHexView});default:return new xe}}toJSON(){const e={variant:this.variant};return(this.variant===1||this.variant===2)&&this.value&&(e.value=this.value.toJSON()),e}}Zl.CLASS_NAME="RecipientIdentifier";const pi="version",Fo="rid",qo="keyEncryptionAlgorithm",Jo="encryptedKey",Ch="recipientCertificate",Ab=[pi,Fo,qo,Jo];class Tr extends G{constructor(e={}){super(),this.version=m(e,pi,Tr.defaultValues(pi)),this.rid=m(e,Fo,Tr.defaultValues(Fo)),this.keyEncryptionAlgorithm=m(e,qo,Tr.defaultValues(qo)),this.encryptedKey=m(e,Jo,Tr.defaultValues(Jo)),this.recipientCertificate=m(e,Ch,Tr.defaultValues(Ch)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case pi:return-1;case Fo:return{};case qo:return new $;case Jo:return new z;case Ch:return new Xe;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case pi:return t===Tr.defaultValues(pi);case Fo:return Object.keys(t).length===0;case qo:case Jo:return t.isEqual(Tr.defaultValues(e));case Ch:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _({name:t.version||S}),Zl.schema(t.rid||{}),$.schema(t.keyEncryptionAlgorithm||{}),new z({name:t.encryptedKey||S})]})}fromSchema(e){W(e,Ab);const t=j(e,e,Tr.schema({names:{version:pi,rid:{names:{blockName:Fo}},keyEncryptionAlgorithm:{names:{blockName:qo}},encryptedKey:Jo}}));P.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,t.result.rid.idBlock.tagClass===3?this.rid=new z({valueHex:t.result.rid.valueBlock.valueHex}):this.rid=new Lt({schema:t.result.rid}),this.keyEncryptionAlgorithm=new $({schema:t.result.keyEncryptionAlgorithm}),this.encryptedKey=t.result.encryptedKey}toSchema(){const e=[];return this.rid instanceof Lt?(this.version=0,e.push(new _({value:this.version})),e.push(this.rid.toSchema())):(this.version=2,e.push(new _({value:this.version})),e.push(new Ie({idBlock:{tagClass:3,tagNumber:0},valueHex:this.rid.valueBlock.valueHexView}))),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.encryptedKey),new b({value:e})}toJSON(){return{version:this.version,rid:this.rid.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}Tr.CLASS_NAME="KeyTransRecipientInfo";const Go="algorithm",jo="publicKey",Eb=[Go,jo];class ra extends G{constructor(e={}){super(),this.algorithm=m(e,Go,ra.defaultValues(Go)),this.publicKey=m(e,jo,ra.defaultValues(jo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Go:return new $;case jo:return new He;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Go:case jo:return t.isEqual(ra.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[$.schema(t.algorithm||{}),new He({name:t.publicKey||S})]})}fromSchema(e){W(e,Eb);const t=j(e,e,ra.schema({names:{algorithm:{names:{blockName:Go}},publicKey:jo}}));P.assertSchema(t,this.className),this.algorithm=new $({schema:t.result.algorithm}),this.publicKey=t.result.publicKey}toSchema(){return new b({value:[this.algorithm.toSchema(),this.publicKey]})}toJSON(){return{algorithm:this.algorithm.toJSON(),publicKey:this.publicKey.toJSON()}}}ra.CLASS_NAME="OriginatorPublicKey";const Ah="variant",xu="value",bb=["blockName"];class la extends G{constructor(e={}){super(),this.variant=m(e,Ah,la.defaultValues(Ah)),xu in e&&(this.value=m(e,xu,la.defaultValues(xu))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ah:return-1;case xu:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ah:return t===-1;case xu:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new wt({value:[Lt.schema({names:{blockName:t.blockName||S}}),new Ie({idBlock:{tagClass:3,tagNumber:0},name:t.blockName||S}),new N({idBlock:{tagClass:3,tagNumber:1},name:t.blockName||S,value:ra.schema().valueBlock.value})]})}fromSchema(e){W(e,bb);const t=j(e,e,la.schema({names:{blockName:"blockName"}}));P.assertSchema(t,this.className),t.result.blockName.idBlock.tagClass===1?(this.variant=1,this.value=new Lt({schema:t.result.blockName})):t.result.blockName.idBlock.tagNumber===0?(t.result.blockName.idBlock.tagClass=1,t.result.blockName.idBlock.tagNumber=4,this.variant=2,this.value=t.result.blockName):(this.variant=3,this.value=new ra({schema:new b({value:t.result.blockName.valueBlock.value})}))}toSchema(){switch(this.variant){case 1:return this.value.toSchema();case 2:return this.value.idBlock.tagClass=3,this.value.idBlock.tagNumber=0,this.value;case 3:{const e=this.value.toSchema();return e.idBlock.tagClass=3,e.idBlock.tagNumber=1,e}default:return new xe}}toJSON(){const e={variant:this.variant};return(this.variant===1||this.variant===2||this.variant===3)&&(e.value=this.value.toJSON()),e}}la.CLASS_NAME="OriginatorIdentifierOrKey";const Wo="keyAttrId",vs="keyAttr",kb=[Wo,vs];class ds extends G{constructor(e={}){super(),this.keyAttrId=m(e,Wo,ds.defaultValues(Wo)),vs in e&&(this.keyAttr=m(e,vs,ds.defaultValues(vs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Wo:return S;case vs:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Wo:return typeof t=="string"&&t===S;case vs:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({optional:t.optional||!0,name:t.blockName||S,value:[new he({name:t.keyAttrId||S}),new xe({optional:!0,name:t.keyAttr||S})]})}fromSchema(e){W(e,kb);const t=j(e,e,ds.schema({names:{keyAttrId:Wo,keyAttr:vs}}));P.assertSchema(t,this.className),this.keyAttrId=t.result.keyAttrId.valueBlock.toString(),vs in t.result&&(this.keyAttr=t.result.keyAttr)}toSchema(){const e=[];return e.push(new he({value:this.keyAttrId})),vs in this&&e.push(this.keyAttr),new b({value:e})}toJSON(){const e={keyAttrId:this.keyAttrId};return vs in this&&(e.keyAttr=this.keyAttr.toJSON()),e}}ds.CLASS_NAME="OtherKeyAttribute";const yi="subjectKeyIdentifier",Oa="date",Pa="other",Ib=[yi,Oa,Pa];class Is extends G{constructor(e={}){super(),this.subjectKeyIdentifier=m(e,yi,Is.defaultValues(yi)),Oa in e&&(this.date=m(e,Oa,Is.defaultValues(Oa))),Pa in e&&(this.other=m(e,Pa,Is.defaultValues(Pa))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case yi:return new z;case Oa:return new vt;case Pa:return new ds;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case yi:return t.isEqual(Is.defaultValues(yi));case Oa:return t.year===0&&t.month===0&&t.day===0&&t.hour===0&&t.minute===0&&t.second===0&&t.millisecond===0;case Pa:return t.keyAttrId===S&&!("keyAttr"in t);default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new z({name:t.subjectKeyIdentifier||S}),new vt({optional:!0,name:t.date||S}),ds.schema(t.other||{})]})}fromSchema(e){W(e,Ib);const t=j(e,e,Is.schema({names:{subjectKeyIdentifier:yi,date:Oa,other:{names:{blockName:Pa}}}}));P.assertSchema(t,this.className),this.subjectKeyIdentifier=t.result.subjectKeyIdentifier,Oa in t.result&&(this.date=t.result.date),Pa in t.result&&(this.other=new ds({schema:t.result.other}))}toSchema(){const e=[];return e.push(this.subjectKeyIdentifier),this.date&&e.push(this.date),this.other&&e.push(this.other.toSchema()),new b({value:e})}toJSON(){const e={subjectKeyIdentifier:this.subjectKeyIdentifier.toJSON()};return this.date&&(e.date=this.date.toJSON()),this.other&&(e.other=this.other.toJSON()),e}}Is.CLASS_NAME="RecipientKeyIdentifier";const Eh="variant",bh="value",Bb=["blockName"];class Rs extends G{constructor(e={}){super(),this.variant=m(e,Eh,Rs.defaultValues(Eh)),this.value=m(e,bh,Rs.defaultValues(bh)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Eh:return-1;case bh:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Eh:return t===-1;case bh:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new wt({value:[Lt.schema(t.issuerAndSerialNumber||{names:{blockName:t.blockName||S}}),new N({name:t.blockName||S,idBlock:{tagClass:3,tagNumber:0},value:Is.schema(t.rKeyId||{names:{blockName:t.blockName||S}}).valueBlock.value})]})}fromSchema(e){W(e,Bb);const t=j(e,e,Rs.schema({names:{blockName:"blockName"}}));P.assertSchema(t,this.className),t.result.blockName.idBlock.tagClass===1?(this.variant=1,this.value=new Lt({schema:t.result.blockName})):(this.variant=2,this.value=new Is({schema:new b({value:t.result.blockName.valueBlock.value})}))}toSchema(){switch(this.variant){case 1:return this.value.toSchema();case 2:return new N({idBlock:{tagClass:3,tagNumber:0},value:this.value.toSchema().valueBlock.value});default:return new xe}}toJSON(){const e={variant:this.variant};return(this.variant===1||this.variant===2)&&(e.value=this.value.toJSON()),e}}Rs.CLASS_NAME="KeyAgreeRecipientIdentifier";const Qo="rid",vi="encryptedKey",xb=[Qo,vi];class sa extends G{constructor(e={}){super(),this.rid=m(e,Qo,sa.defaultValues(Qo)),this.encryptedKey=m(e,vi,sa.defaultValues(vi)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Qo:return new Rs;case vi:return new z;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Qo:return t.variant===-1&&!("value"in t);case vi:return t.isEqual(sa.defaultValues(vi));default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[Rs.schema(t.rid||{}),new z({name:t.encryptedKey||S})]})}fromSchema(e){W(e,xb);const t=j(e,e,sa.schema({names:{rid:{names:{blockName:Qo}},encryptedKey:vi}}));P.assertSchema(t,this.className),this.rid=new Rs({schema:t.result.rid}),this.encryptedKey=t.result.encryptedKey}toSchema(){return new b({value:[this.rid.toSchema(),this.encryptedKey]})}toJSON(){return{rid:this.rid.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}sa.CLASS_NAME="RecipientEncryptedKey";const kh="encryptedKeys",c1="RecipientEncryptedKeys",Nb=[c1];class En extends G{constructor(e={}){super(),this.encryptedKeys=m(e,kh,En.defaultValues(kh)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case kh:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case kh:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _e({name:t.RecipientEncryptedKeys||S,value:sa.schema()})]})}fromSchema(e){W(e,Nb);const t=j(e,e,En.schema({names:{RecipientEncryptedKeys:c1}}));P.assertSchema(t,this.className),this.encryptedKeys=Array.from(t.result.RecipientEncryptedKeys,r=>new sa({schema:r}))}toSchema(){return new b({value:Array.from(this.encryptedKeys,e=>e.toSchema())})}toJSON(){return{encryptedKeys:Array.from(this.encryptedKeys,e=>e.toJSON())}}}En.CLASS_NAME="RecipientEncryptedKeys";const Yo="version",zo="originator",qs="ukm",Xo="keyEncryptionAlgorithm",Zo="recipientEncryptedKeys",Ih="recipientCertificate",Bh="recipientPublicKey",Tb=[Yo,zo,qs,Xo,Zo];class Ar extends G{constructor(e={}){super(),this.version=m(e,Yo,Ar.defaultValues(Yo)),this.originator=m(e,zo,Ar.defaultValues(zo)),qs in e&&(this.ukm=m(e,qs,Ar.defaultValues(qs))),this.keyEncryptionAlgorithm=m(e,Xo,Ar.defaultValues(Xo)),this.recipientEncryptedKeys=m(e,Zo,Ar.defaultValues(Zo)),this.recipientCertificate=m(e,Ih,Ar.defaultValues(Ih)),this.recipientPublicKey=m(e,Bh,Ar.defaultValues(Bh)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Yo:return 0;case zo:return new la;case qs:return new z;case Xo:return new $;case Zo:return new En;case Ih:return new Xe;case Bh:return null;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Yo:return t===0;case zo:return t.variant===-1&&!("value"in t);case qs:return t.isEqual(Ar.defaultValues(qs));case Xo:return t.algorithmId===S&&!("algorithmParams"in t);case Zo:return t.encryptedKeys.length===0;case Ih:return!1;case Bh:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _({name:t.version||S}),new N({idBlock:{tagClass:3,tagNumber:0},value:[la.schema(t.originator||{})]}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new z({name:t.ukm||S})]}),$.schema(t.keyEncryptionAlgorithm||{}),En.schema(t.recipientEncryptedKeys||{})]})}fromSchema(e){W(e,Tb);const t=j(e,e,Ar.schema({names:{version:Yo,originator:{names:{blockName:zo}},ukm:qs,keyEncryptionAlgorithm:{names:{blockName:Xo}},recipientEncryptedKeys:{names:{blockName:Zo}}}}));P.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.originator=new la({schema:t.result.originator}),qs in t.result&&(this.ukm=t.result.ukm),this.keyEncryptionAlgorithm=new $({schema:t.result.keyEncryptionAlgorithm}),this.recipientEncryptedKeys=new En({schema:t.result.recipientEncryptedKeys})}toSchema(){const e=[];return e.push(new _({value:this.version})),e.push(new N({idBlock:{tagClass:3,tagNumber:0},value:[this.originator.toSchema()]})),this.ukm&&e.push(new N({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[this.ukm]})),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.recipientEncryptedKeys.toSchema()),new b({value:e})}toJSON(){const e={version:this.version,originator:this.originator.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),recipientEncryptedKeys:this.recipientEncryptedKeys.toJSON()};return this.ukm&&(e.ukm=this.ukm.toJSON()),e}}Ar.CLASS_NAME="KeyAgreeRecipientInfo";const wi="keyIdentifier",Ua="date",Ka="other",Rb=[wi,Ua,Ka];class ls extends G{constructor(e={}){super(),this.keyIdentifier=m(e,wi,ls.defaultValues(wi)),Ua in e&&(this.date=m(e,Ua,ls.defaultValues(Ua))),Ka in e&&(this.other=m(e,Ka,ls.defaultValues(Ka))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case wi:return new z;case Ua:return new vt;case Ka:return new ds;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case wi:return t.isEqual(ls.defaultValues(wi));case Ua:return t.year===0&&t.month===0&&t.day===0&&t.hour===0&&t.minute===0&&t.second===0&&t.millisecond===0;case Ka:return t.compareWithDefault("keyAttrId",t.keyAttrId)&&!("keyAttr"in t);default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new z({name:t.keyIdentifier||S}),new vt({optional:!0,name:t.date||S}),ds.schema(t.other||{})]})}fromSchema(e){W(e,Rb);const t=j(e,e,ls.schema({names:{keyIdentifier:wi,date:Ua,other:{names:{blockName:Ka}}}}));P.assertSchema(t,this.className),this.keyIdentifier=t.result.keyIdentifier,Ua in t.result&&(this.date=t.result.date),Ka in t.result&&(this.other=new ds({schema:t.result.other}))}toSchema(){const e=[];return e.push(this.keyIdentifier),this.date&&e.push(this.date),this.other&&e.push(this.other.toSchema()),new b({value:e})}toJSON(){const e={keyIdentifier:this.keyIdentifier.toJSON()};return this.date&&(e.date=this.date),this.other&&(e.other=this.other.toJSON()),e}}ls.CLASS_NAME="KEKIdentifier";const el="version",tl="kekid",rl="keyEncryptionAlgorithm",Si="encryptedKey",xh="preDefinedKEK",Vb=[el,tl,rl,Si];class Rr extends G{constructor(e={}){super(),this.version=m(e,el,Rr.defaultValues(el)),this.kekid=m(e,tl,Rr.defaultValues(tl)),this.keyEncryptionAlgorithm=m(e,rl,Rr.defaultValues(rl)),this.encryptedKey=m(e,Si,Rr.defaultValues(Si)),this.preDefinedKEK=m(e,xh,Rr.defaultValues(xh)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case el:return 0;case tl:return new ls;case rl:return new $;case Si:return new z;case xh:return $t;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case"KEKRecipientInfo":return t===Rr.defaultValues(el);case tl:return t.compareWithDefault("keyIdentifier",t.keyIdentifier)&&!("date"in t)&&!("other"in t);case rl:return t.algorithmId===S&&!("algorithmParams"in t);case Si:return t.isEqual(Rr.defaultValues(Si));case xh:return t.byteLength===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _({name:t.version||S}),ls.schema(t.kekid||{}),$.schema(t.keyEncryptionAlgorithm||{}),new z({name:t.encryptedKey||S})]})}fromSchema(e){W(e,Vb);const t=j(e,e,Rr.schema({names:{version:el,kekid:{names:{blockName:tl}},keyEncryptionAlgorithm:{names:{blockName:rl}},encryptedKey:Si}}));P.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.kekid=new ls({schema:t.result.kekid}),this.keyEncryptionAlgorithm=new $({schema:t.result.keyEncryptionAlgorithm}),this.encryptedKey=t.result.encryptedKey}toSchema(){return new b({value:[new _({value:this.version}),this.kekid.toSchema(),this.keyEncryptionAlgorithm.toSchema(),this.encryptedKey]})}toJSON(){return{version:this.version,kekid:this.kekid.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}Rr.CLASS_NAME="KEKRecipientInfo";const sl="version",Ma="keyDerivationAlgorithm",al="keyEncryptionAlgorithm",Ci="encryptedKey",Nh="password",_b=[sl,Ma,al,Ci];class qr extends G{constructor(e={}){super(),this.version=m(e,sl,qr.defaultValues(sl)),Ma in e&&(this.keyDerivationAlgorithm=m(e,Ma,qr.defaultValues(Ma))),this.keyEncryptionAlgorithm=m(e,al,qr.defaultValues(al)),this.encryptedKey=m(e,Ci,qr.defaultValues(Ci)),this.password=m(e,Nh,qr.defaultValues(Nh)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case sl:return-1;case Ma:return new $;case al:return new $;case Ci:return new z;case Nh:return $t;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case sl:return t===-1;case Ma:case al:return t.algorithmId===S&&!("algorithmParams"in t);case Ci:return t.isEqual(qr.defaultValues(Ci));case Nh:return t.byteLength===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _({name:t.version||S}),new N({name:t.keyDerivationAlgorithm||S,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:$.schema().valueBlock.value}),$.schema(t.keyEncryptionAlgorithm||{}),new z({name:t.encryptedKey||S})]})}fromSchema(e){W(e,_b);const t=j(e,e,qr.schema({names:{version:sl,keyDerivationAlgorithm:Ma,keyEncryptionAlgorithm:{names:{blockName:al}},encryptedKey:Ci}}));P.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,Ma in t.result&&(this.keyDerivationAlgorithm=new $({schema:new b({value:t.result.keyDerivationAlgorithm.valueBlock.value})})),this.keyEncryptionAlgorithm=new $({schema:t.result.keyEncryptionAlgorithm}),this.encryptedKey=t.result.encryptedKey}toSchema(){const e=[];return e.push(new _({value:this.version})),this.keyDerivationAlgorithm&&e.push(new N({idBlock:{tagClass:3,tagNumber:0},value:this.keyDerivationAlgorithm.toSchema().valueBlock.value})),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.encryptedKey),new b({value:e})}toJSON(){const e={version:this.version,keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()};return this.keyDerivationAlgorithm&&(e.keyDerivationAlgorithm=this.keyDerivationAlgorithm.toJSON()),e}}qr.CLASS_NAME="PasswordRecipientInfo";const nl="oriType",Ai="oriValue",$b=[nl,Ai];class yn extends G{constructor(e={}){super(),this.oriType=m(e,nl,yn.defaultValues(nl)),this.oriValue=m(e,Ai,yn.defaultValues(Ai)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case nl:return S;case Ai:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case nl:return t===S;case Ai:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.oriType||S}),new xe({name:t.oriValue||S})]})}fromSchema(e){W(e,$b);const t=j(e,e,yn.schema({names:{oriType:nl,oriValue:Ai}}));P.assertSchema(t,this.className),this.oriType=t.result.oriType.valueBlock.toString(),this.oriValue=t.result.oriValue}toSchema(){return new b({value:[new he({value:this.oriType}),this.oriValue]})}toJSON(){const e={oriType:this.oriType};return yn.compareWithDefault(Ai,this.oriValue)||(e.oriValue=this.oriValue.toJSON()),e}}yn.CLASS_NAME="OtherRecipientInfo";const Th="variant",Nu="value",Db=["blockName"];class Gr extends G{constructor(e={}){super(),this.variant=m(e,Th,Gr.defaultValues(Th)),Nu in e&&(this.value=m(e,Nu,Gr.defaultValues(Nu))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Th:return-1;case Nu:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Th:return t===Gr.defaultValues(e);case Nu:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new wt({value:[Tr.schema({names:{blockName:t.blockName||S}}),new N({name:t.blockName||S,idBlock:{tagClass:3,tagNumber:1},value:Ar.schema().valueBlock.value}),new N({name:t.blockName||S,idBlock:{tagClass:3,tagNumber:2},value:Rr.schema().valueBlock.value}),new N({name:t.blockName||S,idBlock:{tagClass:3,tagNumber:3},value:qr.schema().valueBlock.value}),new N({name:t.blockName||S,idBlock:{tagClass:3,tagNumber:4},value:yn.schema().valueBlock.value})]})}fromSchema(e){W(e,Db);const t=j(e,e,Gr.schema({names:{blockName:"blockName"}}));if(P.assertSchema(t,this.className),t.result.blockName.idBlock.tagClass===1)this.variant=1,this.value=new Tr({schema:t.result.blockName});else{const r=new b({value:t.result.blockName.valueBlock.value});switch(t.result.blockName.idBlock.tagNumber){case 1:this.variant=2,this.value=new Ar({schema:r});break;case 2:this.variant=3,this.value=new Rr({schema:r});break;case 3:this.variant=4,this.value=new qr({schema:r});break;case 4:this.variant=5,this.value=new yn({schema:r});break;default:throw new Error("Incorrect structure of RecipientInfo block")}}}toSchema(){Ge.assertEmpty(this.value,"value","RecipientInfo");const e=this.value.toSchema();switch(this.variant){case 1:return e;case 2:case 3:case 4:return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.variant-1,e;default:return new xe}}toJSON(){const e={variant:this.variant};return this.value&&this.variant>=1&&this.variant<=4&&(e.value=this.value.toJSON()),e}}Gr.CLASS_NAME="RecipientInfo";const Ha="hashAlgorithm",Fa="maskGenAlgorithm",qa="pSourceAlgorithm",Lb=[Ha,Fa,qa];class dr extends G{constructor(e={}){super(),this.hashAlgorithm=m(e,Ha,dr.defaultValues(Ha)),this.maskGenAlgorithm=m(e,Fa,dr.defaultValues(Fa)),this.pSourceAlgorithm=m(e,qa,dr.defaultValues(qa)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ha:return new $({algorithmId:"1.3.14.3.2.26",algorithmParams:new It});case Fa:return new $({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new $({algorithmId:"1.3.14.3.2.26",algorithmParams:new It}).toSchema()});case qa:return new $({algorithmId:"1.2.840.113549.1.1.9",algorithmParams:new z({valueHex:new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer})});default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new N({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[$.schema(t.hashAlgorithm||{})]}),new N({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[$.schema(t.maskGenAlgorithm||{})]}),new N({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[$.schema(t.pSourceAlgorithm||{})]})]})}fromSchema(e){W(e,Lb);const t=j(e,e,dr.schema({names:{hashAlgorithm:{names:{blockName:Ha}},maskGenAlgorithm:{names:{blockName:Fa}},pSourceAlgorithm:{names:{blockName:qa}}}}));P.assertSchema(t,this.className),Ha in t.result&&(this.hashAlgorithm=new $({schema:t.result.hashAlgorithm})),Fa in t.result&&(this.maskGenAlgorithm=new $({schema:t.result.maskGenAlgorithm})),qa in t.result&&(this.pSourceAlgorithm=new $({schema:t.result.pSourceAlgorithm}))}toSchema(){const e=[];return this.hashAlgorithm.isEqual(dr.defaultValues(Ha))||e.push(new N({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(dr.defaultValues(Fa))||e.push(new N({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.pSourceAlgorithm.isEqual(dr.defaultValues(qa))||e.push(new N({idBlock:{tagClass:3,tagNumber:2},value:[this.pSourceAlgorithm.toSchema()]})),new b({value:e})}toJSON(){const e={};return this.hashAlgorithm.isEqual(dr.defaultValues(Ha))||(e.hashAlgorithm=this.hashAlgorithm.toJSON()),this.maskGenAlgorithm.isEqual(dr.defaultValues(Fa))||(e.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.pSourceAlgorithm.isEqual(dr.defaultValues(qa))||(e.pSourceAlgorithm=this.pSourceAlgorithm.toJSON()),e}}dr.CLASS_NAME="RSAESOAEPParams";const il="keyInfo",Ja="entityUInfo",ol="suppPubInfo",Ob=[il,Ja,ol];class Ys extends G{constructor(e={}){super(),this.keyInfo=m(e,il,Ys.defaultValues(il)),Ja in e&&(this.entityUInfo=m(e,Ja,Ys.defaultValues(Ja))),this.suppPubInfo=m(e,ol,Ys.defaultValues(ol)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case il:return new $;case Ja:return new z;case ol:return new z;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case il:case Ja:case ol:return t.isEqual(Ys.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[$.schema(t.keyInfo||{}),new N({name:t.entityUInfo||S,idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[new z]}),new N({name:t.suppPubInfo||S,idBlock:{tagClass:3,tagNumber:2},value:[new z]})]})}fromSchema(e){W(e,Ob);const t=j(e,e,Ys.schema({names:{keyInfo:{names:{blockName:il}},entityUInfo:Ja,suppPubInfo:ol}}));P.assertSchema(t,this.className),this.keyInfo=new $({schema:t.result.keyInfo}),Ja in t.result&&(this.entityUInfo=t.result.entityUInfo.valueBlock.value[0]),this.suppPubInfo=t.result.suppPubInfo.valueBlock.value[0]}toSchema(){const e=[];return e.push(this.keyInfo.toSchema()),this.entityUInfo&&e.push(new N({idBlock:{tagClass:3,tagNumber:0},value:[this.entityUInfo]})),e.push(new N({idBlock:{tagClass:3,tagNumber:2},value:[this.suppPubInfo]})),new b({value:e})}toJSON(){const e={keyInfo:this.keyInfo.toJSON(),suppPubInfo:this.suppPubInfo.toJSON()};return this.entityUInfo&&(e.entityUInfo=this.entityUInfo.toJSON()),e}}Ys.CLASS_NAME="ECCCMSSharedInfo";const ll="version",Ga="originatorInfo",ul="recipientInfos",cl="encryptedContentInfo",ja="unprotectedAttrs",Pb=[ll,Ga,ul,cl,ja],Vp={kdfAlgorithm:"SHA-512",kekEncryptionLength:256},Ub={"P-256":256,"P-384":384,"P-521":528};class is extends G{constructor(e={}){super(),this.version=m(e,ll,is.defaultValues(ll)),Ga in e&&(this.originatorInfo=m(e,Ga,is.defaultValues(Ga))),this.recipientInfos=m(e,ul,is.defaultValues(ul)),this.encryptedContentInfo=m(e,cl,is.defaultValues(cl)),ja in e&&(this.unprotectedAttrs=m(e,ja,is.defaultValues(ja))),this.policy={disableSplit:!!e.disableSplit},e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ll:return 0;case Ga:return new to;case ul:return[];case cl:return new Nt;case ja:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ll:return t===is.defaultValues(e);case Ga:return t.certs.certificates.length===0&&t.crls.crls.length===0;case ul:case ja:return t.length===0;case cl:return Nt.compareWithDefault("contentType",t.contentType)&&Nt.compareWithDefault("contentEncryptionAlgorithm",t.contentEncryptionAlgorithm)&&Nt.compareWithDefault("encryptedContent",t.encryptedContent);default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _({name:t.version||S}),new N({name:t.originatorInfo||S,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:to.schema().valueBlock.value}),new Bt({value:[new _e({name:t.recipientInfos||S,value:Gr.schema()})]}),Nt.schema(t.encryptedContentInfo||{}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new _e({name:t.unprotectedAttrs||S,value:mt.schema()})]})]})}fromSchema(e){W(e,Pb);const t=j(e,e,is.schema({names:{version:ll,originatorInfo:Ga,recipientInfos:ul,encryptedContentInfo:{names:{blockName:cl}},unprotectedAttrs:ja}}));P.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,Ga in t.result&&(this.originatorInfo=new to({schema:new b({value:t.result.originatorInfo.valueBlock.value})})),this.recipientInfos=Array.from(t.result.recipientInfos,r=>new Gr({schema:r})),this.encryptedContentInfo=new Nt({schema:t.result.encryptedContentInfo}),ja in t.result&&(this.unprotectedAttrs=Array.from(t.result.unprotectedAttrs,r=>new mt({schema:r})))}toSchema(){const e=[];return e.push(new _({value:this.version})),this.originatorInfo&&e.push(new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:this.originatorInfo.toSchema().valueBlock.value})),e.push(new Bt({value:Array.from(this.recipientInfos,t=>t.toSchema())})),e.push(this.encryptedContentInfo.toSchema()),this.unprotectedAttrs&&e.push(new N({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.unprotectedAttrs,t=>t.toSchema())})),new b({value:e})}toJSON(){const e={version:this.version,recipientInfos:Array.from(this.recipientInfos,t=>t.toJSON()),encryptedContentInfo:this.encryptedContentInfo.toJSON()};return this.originatorInfo&&(e.originatorInfo=this.originatorInfo.toJSON()),this.unprotectedAttrs&&(e.unprotectedAttrs=Array.from(this.unprotectedAttrs,t=>t.toJSON())),e}addRecipientByCertificate(e,t,r,a=Le(!0)){const n=Object.assign({useOAEP:!0,oaepHashAlgorithm:"SHA-512"},Vp,t||{});if(e.subjectPublicKeyInfo.algorithm.algorithmId.indexOf("1.2.840.113549")!==-1)r=1;else if(e.subjectPublicKeyInfo.algorithm.algorithmId.indexOf("1.2.840.10045")!==-1)r=2;else throw new Error(`Unknown type of certificate's public key: ${e.subjectPublicKeyInfo.algorithm.algorithmId}`);switch(r){case 1:{let i,o;if(n.useOAEP===!0){i=a.getOIDByAlgorithm({name:"RSA-OAEP"},!0,"keyEncryptionAlgorithm");const u=a.getOIDByAlgorithm({name:n.oaepHashAlgorithm},!0,"RSAES-OAEP-params"),c=new $({algorithmId:u,algorithmParams:new It});o=new dr({hashAlgorithm:c,maskGenAlgorithm:new $({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:c.toSchema()})}).toSchema()}else{if(i=a.getOIDByAlgorithm({name:"RSAES-PKCS1-v1_5"}),i===S)throw new Error("Can not find OID for RSAES-PKCS1-v1_5");o=new It}const l=new Tr({version:0,rid:new Lt({issuer:e.issuer,serialNumber:e.serialNumber}),keyEncryptionAlgorithm:new $({algorithmId:i,algorithmParams:o}),recipientCertificate:e});this.recipientInfos.push(new Gr({variant:1,value:l}))}break;case 2:{const i=new Rs({variant:1,value:new Lt({issuer:e.issuer,serialNumber:e.serialNumber})});this._addKeyAgreeRecipientInfo(i,n,{recipientCertificate:e},a)}break;default:throw new Error(`Unknown "variant" value: ${r}`)}return!0}addRecipientByPreDefinedData(e,t={},r,a=Le(!0)){if(tt.assert(e,"preDefinedData","ArrayBuffer"),!e.byteLength)throw new Error("Pre-defined data could have zero length");if(!t.keyIdentifier){const n=new ArrayBuffer(16),i=new Uint8Array(n);a.getRandomValues(i),t.keyIdentifier=n}switch(t.hmacHashAlgorithm||(t.hmacHashAlgorithm="SHA-512"),t.iterationCount===void 0&&(t.iterationCount=2048),t.keyEncryptionAlgorithm||(t.keyEncryptionAlgorithm={name:"AES-KW",length:256}),t.keyEncryptionAlgorithmParams||(t.keyEncryptionAlgorithmParams=new It),r){case 1:{const n=a.getOIDByAlgorithm(t.keyEncryptionAlgorithm,!0,"keyEncryptionAlgorithm"),i=new Rr({version:4,kekid:new ls({keyIdentifier:new z({valueHex:t.keyIdentifier})}),keyEncryptionAlgorithm:new $({algorithmId:n,algorithmParams:t.keyEncryptionAlgorithmParams}),preDefinedKEK:e});this.recipientInfos.push(new Gr({variant:3,value:i}))}break;case 2:{const n=a.getOIDByAlgorithm({name:"PBKDF2"},!0,"keyDerivationAlgorithm"),i=new ArrayBuffer(64),o=new Uint8Array(i);a.getRandomValues(o);const l=a.getOIDByAlgorithm({name:"HMAC",hash:{name:t.hmacHashAlgorithm}},!0,"hmacHashAlgorithm"),u=new lr({salt:new z({valueHex:i}),iterationCount:t.iterationCount,prf:new $({algorithmId:l,algorithmParams:new It})}),c=a.getOIDByAlgorithm(t.keyEncryptionAlgorithm,!0,"keyEncryptionAlgorithm"),f=new qr({version:0,keyDerivationAlgorithm:new $({algorithmId:n,algorithmParams:u.toSchema()}),keyEncryptionAlgorithm:new $({algorithmId:c,algorithmParams:t.keyEncryptionAlgorithmParams}),password:e});this.recipientInfos.push(new Gr({variant:4,value:f}))}break;default:throw new Error(`Unknown value for "variant": ${r}`)}}addRecipientByKeyIdentifier(e,t,r,a=Le(!0)){const n=Object.assign({},Vp,r||{}),i=new Rs({variant:2,value:new Is({subjectKeyIdentifier:new z({valueHex:t})})});this._addKeyAgreeRecipientInfo(i,n,{recipientPublicKey:e},a)}_addKeyAgreeRecipientInfo(e,t,r,a=Le(!0)){const n=new sa({rid:e}),i=a.getOIDByAlgorithm({name:"AES-KW",length:t.kekEncryptionLength},!0,"keyEncryptionAlgorithm"),o=new $({algorithmId:i}),l=a.getOIDByAlgorithm({name:"ECDH",kdf:t.kdfAlgorithm},!0,"KeyAgreeRecipientInfo"),u=new ArrayBuffer(64),c=new Uint8Array(u);a.getRandomValues(c);const f={version:3,ukm:new z({valueHex:u}),keyEncryptionAlgorithm:new $({algorithmId:l,algorithmParams:o.toSchema()}),recipientEncryptedKeys:new En({encryptedKeys:[n]})},g=new Ar(Object.assign(f,r));this.recipientInfos.push(new Gr({variant:2,value:g}))}async encrypt(e,t,r=Le(!0)){const a=new ArrayBuffer(16),n=new Uint8Array(a);r.getRandomValues(n);const i=new Uint8Array(t),o=r.getOIDByAlgorithm(e,!0,"contentEncryptionAlgorithm"),l=await r.generateKey(e,!0,["encrypt"]),u=await r.encrypt({name:e.name,iv:n},l,i),c=await r.exportKey("raw",l);this.version=2,this.encryptedContentInfo=new Nt({disableSplit:this.policy.disableSplit,contentType:"1.2.840.113549.1.7.1",contentEncryptionAlgorithm:new $({algorithmId:o,algorithmParams:new z({valueHex:a})}),encryptedContent:new z({valueHex:u})});const f=async d=>{const y=this.recipientInfos[d].value;let E,k;if(y.recipientPublicKey)E=y.recipientPublicKey.algorithm.namedCurve,k=y.recipientPublicKey;else if(y.recipientCertificate){const te=y.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;if(te.constructor.blockName()!==he.blockName())throw new Error(`Incorrect "recipientCertificate" for index ${d}`);switch(te.valueBlock.toString()){case"1.2.840.10045.3.1.7":E="P-256";break;case"1.3.132.0.34":E="P-384";break;case"1.3.132.0.35":E="P-521";break;default:throw new Error(`Incorrect curve OID for index ${d}`)}k=await y.recipientCertificate.getPublicKey({algorithm:{algorithm:{name:"ECDH",namedCurve:E},usages:[]}},r)}else throw new Error("Unsupported RecipientInfo");const R=Ub[E],V=await r.generateKey({name:"ECDH",namedCurve:E},!0,["deriveBits"]),L=await r.exportKey("spki",V.publicKey),ne=await r.deriveBits({name:"ECDH",public:k},V.privateKey,R),se=new $({schema:y.keyEncryptionAlgorithm.algorithmParams}),Se=r.getAlgorithmByOID(se.algorithmId,!0,"aesKWAlgorithm");let Te=Se.length;const ye=new ArrayBuffer(4),Ce=new Uint8Array(ye);for(let te=3;te>=0;te--)Ce[te]=Te,Te>>=8;const Pe=new Ys({keyInfo:new $({algorithmId:se.algorithmId}),entityUInfo:y.ukm,suppPubInfo:new z({valueHex:ye})}).toSchema().toBER(!1),pe=r.getAlgorithmByOID(y.keyEncryptionAlgorithm.algorithmId,!0,"ecdhAlgorithm"),$e=await wp(pe.kdf,ne,Se.length,Pe,r),ie=await r.importKey("raw",$e,{name:"AES-KW"},!0,["wrapKey"]),ot=await r.wrapKey("raw",l,ie,{name:"AES-KW"}),Me=new la;return Me.variant=3,Me.value=ra.fromBER(L),y.originator=Me,y.recipientEncryptedKeys.encryptedKeys[0].encryptedKey=new z({valueHex:ot}),{ecdhPrivateKey:V.privateKey}},g=async d=>{const y=this.recipientInfos[d].value,E=r.getAlgorithmByOID(y.keyEncryptionAlgorithm.algorithmId,!0,"keyEncryptionAlgorithm");if(E.name==="RSA-OAEP"){const k=y.keyEncryptionAlgorithm.algorithmParams,R=new dr({schema:k});if(E.hash=r.getAlgorithmByOID(R.hashAlgorithm.algorithmId),!("name"in E.hash))throw new Error(`Incorrect OID for hash algorithm: ${R.hashAlgorithm.algorithmId}`)}try{const k=await y.recipientCertificate.getPublicKey({algorithm:{algorithm:E,usages:["encrypt","wrapKey"]}},r),R=await r.encrypt(k.algorithm,k,c);y.encryptedKey=new z({valueHex:R})}catch{}},v=async d=>{const y=this.recipientInfos[d].value,E=r.getAlgorithmByOID(y.keyEncryptionAlgorithm.algorithmId,!0,"kekAlgorithm"),k=await r.importKey("raw",new Uint8Array(y.preDefinedKEK),E,!0,["wrapKey"]),R=await r.wrapKey("raw",l,k,E);y.encryptedKey=new z({valueHex:R})},p=async d=>{const y=this.recipientInfos[d].value;let E;if(!y.keyDerivationAlgorithm)throw new Error('Please append encoded "keyDerivationAlgorithm"');if(!y.keyDerivationAlgorithm.algorithmParams)throw new Error('Incorrectly encoded "keyDerivationAlgorithm"');try{E=new lr({schema:y.keyDerivationAlgorithm.algorithmParams})}catch{throw new Error('Incorrectly encoded "keyDerivationAlgorithm"')}const k=new Uint8Array(y.password),R=await r.importKey("raw",k,"PBKDF2",!1,["deriveKey"]),V=r.getAlgorithmByOID(y.keyEncryptionAlgorithm.algorithmId,!0,"kekAlgorithm");let L="SHA-1";E.prf&&(L=r.getAlgorithmByOID(E.prf.algorithmId,!0,"prfAlgorithm").hash.name);const ne=new Uint8Array(E.salt.valueBlock.valueHex),se=E.iterationCount,Se=await r.deriveKey({name:"PBKDF2",hash:{name:L},salt:ne,iterations:se},R,V,!0,["wrapKey"]),Te=await r.wrapKey("raw",l,Se,V);y.encryptedKey=new z({valueHex:Te})},h=[];for(let d=0;d<this.recipientInfos.length;d++)switch(this.recipientInfos[d].variant){case 1:h.push(await g(d));break;case 2:h.push(await f(d));break;case 3:h.push(await v(d));break;case 4:h.push(await p(d));break;default:throw new Error(`Unknown recipient type in array with index ${d}`)}return h}async decrypt(e,t,r=Le(!0)){const a=t||{};if(e+1>this.recipientInfos.length)throw new Error(`Maximum value for "index" is: ${this.recipientInfos.length-1}`);const n=async h=>{const d=this.recipientInfos[h].value;let y,E,k;const R=d.originator;if(a.recipientCertificate){const pe=a.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;if(pe.constructor.blockName()!==he.blockName())throw new Error(`Incorrect "recipientCertificate" for index ${h}`);y=pe.valueBlock.toString()}else if(R.value.algorithm.algorithmParams){const pe=R.value.algorithm.algorithmParams;if(pe.constructor.blockName()!==he.blockName())throw new Error(`Incorrect originator for index ${h}`);y=pe.valueBlock.toString()}else throw new Error('Parameter "recipientCertificate" is mandatory for "KeyAgreeRecipientInfo" if algorithm params are missing from originator');if(!a.recipientPrivateKey)throw new Error('Parameter "recipientPrivateKey" is mandatory for "KeyAgreeRecipientInfo"');switch(y){case"1.2.840.10045.3.1.7":E="P-256",k=256;break;case"1.3.132.0.34":E="P-384",k=384;break;case"1.3.132.0.35":E="P-521",k=528;break;default:throw new Error(`Incorrect curve OID for index ${h}`)}let V,L=r;Ee.isBufferSource(a.recipientPrivateKey)?V=await r.importKey("pkcs8",a.recipientPrivateKey,{name:"ECDH",namedCurve:E},!0,["deriveBits"]):(V=a.recipientPrivateKey,"crypto"in a&&a.crypto&&(L=a.crypto.subtle)),"algorithmParams"in R.value.algorithm||(R.value.algorithm.algorithmParams=new he({value:y}));const ne=R.value.toSchema().toBER(!1),se=await r.importKey("spki",ne,{name:"ECDH",namedCurve:E},!0,[]),Se=await L.deriveBits({name:"ECDH",public:se},V,k);async function Te(pe){pe=pe||!1;const $e=new $({schema:d.keyEncryptionAlgorithm.algorithmParams}),ie=r.getAlgorithmByOID($e.algorithmId,!0,"kwAlgorithm");let ot=ie.length;const Me=new ArrayBuffer(4),te=new Uint8Array(Me);for(let qe=3;qe>=0;qe--)te[qe]=ot,ot>>=8;const le={algorithmId:$e.algorithmId};pe&&(le.algorithmParams=new It);const me=new Ys({keyInfo:new $(le),entityUInfo:d.ukm,suppPubInfo:new z({valueHex:Me})}).toSchema().toBER(!1),Ae=r.getAlgorithmByOID(d.keyEncryptionAlgorithm.algorithmId,!0,"ecdhAlgorithm");if(!Ae.name)throw new Error(`Incorrect OID for key encryption algorithm: ${d.keyEncryptionAlgorithm.algorithmId}`);return wp(Ae.kdf,Se,ie.length,me,r)}const ye=await Te(),Ce=async pe=>r.importKey("raw",pe,{name:"AES-KW"},!0,["unwrapKey"]),Ve=await Ce(ye),Pe=async pe=>{const $e=this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,ie=r.getAlgorithmByOID($e,!0,"contentEncryptionAlgorithm");return r.unwrapKey("raw",d.recipientEncryptedKeys.encryptedKeys[0].encryptedKey.valueBlock.valueHexView,pe,{name:"AES-KW"},ie,!0,["decrypt"])};try{return await Pe(Ve)}catch{const pe=await Te(!0),$e=await Ce(pe);return Pe($e)}},i=async h=>{const d=this.recipientInfos[h].value;if(!a.recipientPrivateKey)throw new Error('Parameter "recipientPrivateKey" is mandatory for "KeyTransRecipientInfo"');const y=r.getAlgorithmByOID(d.keyEncryptionAlgorithm.algorithmId,!0,"keyEncryptionAlgorithm");if(y.name==="RSA-OAEP"){const ne=d.keyEncryptionAlgorithm.algorithmParams,se=new dr({schema:ne});if(y.hash=r.getAlgorithmByOID(se.hashAlgorithm.algorithmId),!("name"in y.hash))throw new Error(`Incorrect OID for hash algorithm: ${se.hashAlgorithm.algorithmId}`)}let E,k=r;Ee.isBufferSource(a.recipientPrivateKey)?E=await r.importKey("pkcs8",a.recipientPrivateKey,y,!0,["decrypt"]):(E=a.recipientPrivateKey,"crypto"in a&&a.crypto&&(k=a.crypto.subtle));const R=await k.decrypt(E.algorithm,E,d.encryptedKey.valueBlock.valueHexView),V=this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,L=r.getAlgorithmByOID(V,!0,"contentEncryptionAlgorithm");if(!("name"in L))throw new Error(`Incorrect "contentEncryptionAlgorithm": ${V}`);return r.importKey("raw",R,L,!0,["decrypt"])},o=async h=>{const d=this.recipientInfos[h].value;if(!a.preDefinedData)throw new Error('Parameter "preDefinedData" is mandatory for "KEKRecipientInfo"');const y=r.getAlgorithmByOID(d.keyEncryptionAlgorithm.algorithmId,!0,"kekAlgorithm"),E=await r.importKey("raw",a.preDefinedData,y,!0,["unwrapKey"]),k=this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,R=r.getAlgorithmByOID(k,!0,"contentEncryptionAlgorithm");if(!R.name)throw new Error(`Incorrect "contentEncryptionAlgorithm": ${k}`);return r.unwrapKey("raw",d.encryptedKey.valueBlock.valueHexView,E,y,R,!0,["decrypt"])},l=async h=>{const d=this.recipientInfos[h].value;let y;if(!a.preDefinedData)throw new Error('Parameter "preDefinedData" is mandatory for "KEKRecipientInfo"');if(!d.keyDerivationAlgorithm)throw new Error('Please append encoded "keyDerivationAlgorithm"');if(!d.keyDerivationAlgorithm.algorithmParams)throw new Error('Incorrectly encoded "keyDerivationAlgorithm"');try{y=new lr({schema:d.keyDerivationAlgorithm.algorithmParams})}catch{throw new Error('Incorrectly encoded "keyDerivationAlgorithm"')}const E=await r.importKey("raw",a.preDefinedData,"PBKDF2",!1,["deriveKey"]),k=r.getAlgorithmByOID(d.keyEncryptionAlgorithm.algorithmId,!0,"keyEncryptionAlgorithm"),R=y.prf?r.getAlgorithmByOID(y.prf.algorithmId,!0,"prfAlgorithm").hash.name:"SHA-1",V=new Uint8Array(y.salt.valueBlock.valueHex),L=y.iterationCount,ne=await r.deriveKey({name:"PBKDF2",hash:{name:R},salt:V,iterations:L},E,k,!0,["unwrapKey"]),se=this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,Se=r.getAlgorithmByOID(se,!0,"contentEncryptionAlgorithm");return r.unwrapKey("raw",d.encryptedKey.valueBlock.valueHexView,ne,k,Se,!0,["decrypt"])};let u;switch(this.recipientInfos[e].variant){case 1:u=await i(e);break;case 2:u=await n(e);break;case 3:u=await o(e);break;case 4:u=await l(e);break;default:throw new Error(`Unknown recipient type in array with index ${e}`)}const c=this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,f=r.getAlgorithmByOID(c,!0,"contentEncryptionAlgorithm"),g=this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams.valueBlock.valueHex,v=new Uint8Array(g);if(!this.encryptedContentInfo.encryptedContent)throw new Error("Required property `encryptedContent` is empty");const p=this.encryptedContentInfo.getEncryptedContent();return r.decrypt({name:f.name,iv:v},u,p)}}is.CLASS_NAME="EnvelopedData";const po="safeContents",Tu="parsedValue",_p="contentInfos";class ro extends G{constructor(e={}){super(),this.safeContents=m(e,po,ro.defaultValues(po)),Tu in e&&(this.parsedValue=m(e,Tu,ro.defaultValues(Tu))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case po:return[];case Tu:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case po:return t.length===0;case Tu:return t instanceof Object&&Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _e({name:t.contentInfos||S,value:ft.schema()})]})}fromSchema(e){W(e,[_p]);const t=j(e,e,ro.schema({names:{contentInfos:_p}}));P.assertSchema(t,this.className),this.safeContents=Array.from(t.result.contentInfos,r=>new ft({schema:r}))}toSchema(){return new b({value:Array.from(this.safeContents,e=>e.toSchema())})}toJSON(){return{safeContents:Array.from(this.safeContents,e=>e.toJSON())}}async parseInternalValues(e,t=Le(!0)){if(Ge.assert(e,po),tt.assert(e.safeContents,po,"Array"),e.safeContents.length!==this.safeContents.length)throw new tt('Length of "parameters.safeContents" must be equal to "this.safeContents.length"');this.parsedValue={safeContents:[]};for(const[r,a]of this.safeContents.entries()){const n=e.safeContents[r],i=`parameters.safeContents[${r}]`;switch(a.contentType){case ym:{tt.assert(a.content,"this.safeContents[j].content",z);const o=a.content.getValue();this.parsedValue.safeContents.push({privacyMode:0,value:ta.fromBER(o)})}break;case r1:{const o=new is({schema:a.content});Ge.assert(i,n,"recipientCertificate","recipientKey");const l=n,u=l.recipientCertificate,c=l.recipientKey,f=await o.decrypt(0,{recipientCertificate:u,recipientPrivateKey:c},t);this.parsedValue.safeContents.push({privacyMode:2,value:ta.fromBER(f)})}break;case s1:{const o=new Ns({schema:a.content});Ge.assert(i,n,"password");const l=n.password,u=await o.decrypt({password:l},t);this.parsedValue.safeContents.push({privacyMode:1,value:ta.fromBER(u)})}break;default:throw new Error(`Unknown "contentType" for AuthenticatedSafe: " ${a.contentType}`)}}}async makeInternalValues(e,t=Le(!0)){if(!this.parsedValue)throw new Error('Please run "parseValues" first or add "parsedValue" manually');if(tt.assert(this.parsedValue,"this.parsedValue","object"),tt.assert(this.parsedValue.safeContents,"this.parsedValue.safeContents","Array"),tt.assert(e,"parameters","object"),Ge.assert(e,"safeContents"),tt.assert(e.safeContents,"parameters.safeContents","Array"),e.safeContents.length!==this.parsedValue.safeContents.length)throw new tt('Length of "parameters.safeContents" must be equal to "this.parsedValue.safeContents"');this.safeContents=[];for(const[r,a]of this.parsedValue.safeContents.entries())switch(Ge.assert("content",a,"privacyMode","value"),tt.assert(a.value,"content.value",ta),a.privacyMode){case 0:{const n=a.value.toSchema().toBER(!1);this.safeContents.push(new ft({contentType:"1.2.840.113549.1.7.1",content:new z({valueHex:n})}))}break;case 1:{const n=new Ns,i=e.safeContents[r];i.contentToEncrypt=a.value.toSchema().toBER(!1),await n.encrypt(i,t),this.safeContents.push(new ft({contentType:"1.2.840.113549.1.7.6",content:n.toSchema()}))}break;case 2:{const n=new is,i=a.value.toSchema().toBER(!1),o=e.safeContents[r];switch(Ge.assert(`parameters.safeContents[${r}]`,o,"encryptingCertificate","encryptionAlgorithm"),!0){case o.encryptionAlgorithm.name.toLowerCase()==="aes-cbc":case o.encryptionAlgorithm.name.toLowerCase()==="aes-gcm":break;default:throw new Error(`Incorrect parameter "encryptionAlgorithm" in "parameters.safeContents[i]": ${o.encryptionAlgorithm}`)}switch(!0){case o.encryptionAlgorithm.length===128:case o.encryptionAlgorithm.length===192:case o.encryptionAlgorithm.length===256:break;default:throw new Error(`Incorrect parameter "encryptionAlgorithm.length" in "parameters.safeContents[i]": ${o.encryptionAlgorithm.length}`)}const l=o.encryptionAlgorithm;n.addRecipientByCertificate(o.encryptingCertificate,{},void 0,t),await n.encrypt(l,i,t),this.safeContents.push(new ft({contentType:"1.2.840.113549.1.7.3",content:n.toSchema()}))}break;default:throw new Error(`Incorrect value for "content.privacyMode": ${a.privacyMode}`)}return this}}ro.CLASS_NAME="AuthenticatedSafe";const Ei="hashAlgorithm",fl="issuerNameHash",hl="issuerKeyHash",bi="serialNumber",Kb=[Ei,fl,hl,bi];class Rt extends G{constructor(e={}){super(),this.hashAlgorithm=m(e,Ei,Rt.defaultValues(Ei)),this.issuerNameHash=m(e,fl,Rt.defaultValues(fl)),this.issuerKeyHash=m(e,hl,Rt.defaultValues(hl)),this.serialNumber=m(e,bi,Rt.defaultValues(bi)),e.schema&&this.fromSchema(e.schema)}static async create(e,t,r=Le(!0)){const a=new Rt;return await a.createForCertificate(e,t,r),a}static defaultValues(e){switch(e){case Ei:return new $;case fl:case hl:return new z;case bi:return new _;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ei:return t.algorithmId===S&&!("algorithmParams"in t);case fl:case hl:case bi:return t.isEqual(Rt.defaultValues(bi));default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[$.schema(t.hashAlgorithmObject||{names:{blockName:t.hashAlgorithm||S}}),new z({name:t.issuerNameHash||S}),new z({name:t.issuerKeyHash||S}),new _({name:t.serialNumber||S})]})}fromSchema(e){W(e,Kb);const t=j(e,e,Rt.schema({names:{hashAlgorithm:Ei,issuerNameHash:fl,issuerKeyHash:hl,serialNumber:bi}}));P.assertSchema(t,this.className),this.hashAlgorithm=new $({schema:t.result.hashAlgorithm}),this.issuerNameHash=t.result.issuerNameHash,this.issuerKeyHash=t.result.issuerKeyHash,this.serialNumber=t.result.serialNumber}toSchema(){return new b({value:[this.hashAlgorithm.toSchema(),this.issuerNameHash,this.issuerKeyHash,this.serialNumber]})}toJSON(){return{hashAlgorithm:this.hashAlgorithm.toJSON(),issuerNameHash:this.issuerNameHash.toJSON(),issuerKeyHash:this.issuerKeyHash.toJSON(),serialNumber:this.serialNumber.toJSON()}}isEqual(e){return!(this.hashAlgorithm.algorithmId!==e.hashAlgorithm.algorithmId||!Ee.isEqual(this.issuerNameHash.valueBlock.valueHexView,e.issuerNameHash.valueBlock.valueHexView)||!Ee.isEqual(this.issuerKeyHash.valueBlock.valueHexView,e.issuerKeyHash.valueBlock.valueHexView)||!this.serialNumber.isEqual(e.serialNumber))}async createForCertificate(e,t,r=Le(!0)){Ge.assert(t,Ei,"issuerCertificate");const a=r.getOIDByAlgorithm({name:t.hashAlgorithm},!0,"hashAlgorithm");this.hashAlgorithm=new $({algorithmId:a,algorithmParams:new It});const n=t.issuerCertificate;this.serialNumber=e.serialNumber;const i=await r.digest({name:t.hashAlgorithm},n.subject.toSchema().toBER(!1));this.issuerNameHash=new z({valueHex:i});const o=n.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView,l=await r.digest({name:t.hashAlgorithm},o);this.issuerKeyHash=new z({valueHex:l})}}Rt.CLASS_NAME="CertID";const dl="certID",gl="certStatus",ml="thisUpdate",Wa="nextUpdate",ki="singleExtensions",Mb=[dl,gl,ml,Wa,ki];class os extends G{constructor(e={}){super(),this.certID=m(e,dl,os.defaultValues(dl)),this.certStatus=m(e,gl,os.defaultValues(gl)),this.thisUpdate=m(e,ml,os.defaultValues(ml)),Wa in e&&(this.nextUpdate=m(e,Wa,os.defaultValues(Wa))),ki in e&&(this.singleExtensions=m(e,ki,os.defaultValues(ki))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case dl:return new Rt;case gl:return{};case ml:case Wa:return new Date(0,0,0);case ki:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case dl:return Rt.compareWithDefault("hashAlgorithm",t.hashAlgorithm)&&Rt.compareWithDefault("issuerNameHash",t.issuerNameHash)&&Rt.compareWithDefault("issuerKeyHash",t.issuerKeyHash)&&Rt.compareWithDefault("serialNumber",t.serialNumber);case gl:return Object.keys(t).length===0;case ml:case Wa:return t===os.defaultValues(e);default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[Rt.schema(t.certID||{}),new wt({value:[new Ie({name:t.certStatus||S,idBlock:{tagClass:3,tagNumber:0}}),new N({name:t.certStatus||S,idBlock:{tagClass:3,tagNumber:1},value:[new vt,new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ao]})]}),new Ie({name:t.certStatus||S,idBlock:{tagClass:3,tagNumber:2},lenBlock:{length:1}})]}),new vt({name:t.thisUpdate||S}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new vt({name:t.nextUpdate||S})]}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[Dt.schema(t.singleExtensions||{})]})]})}fromSchema(e){W(e,Mb);const t=j(e,e,os.schema({names:{certID:{names:{blockName:dl}},certStatus:gl,thisUpdate:ml,nextUpdate:Wa,singleExtensions:{names:{blockName:ki}}}}));P.assertSchema(t,this.className),this.certID=new Rt({schema:t.result.certID}),this.certStatus=t.result.certStatus,this.thisUpdate=t.result.thisUpdate.toDate(),Wa in t.result&&(this.nextUpdate=t.result.nextUpdate.toDate()),ki in t.result&&(this.singleExtensions=Array.from(t.result.singleExtensions.valueBlock.value,r=>new Tt({schema:r})))}toSchema(){const e=[];return e.push(this.certID.toSchema()),e.push(this.certStatus),e.push(new vt({valueDate:this.thisUpdate})),this.nextUpdate&&e.push(new N({idBlock:{tagClass:3,tagNumber:0},value:[new vt({valueDate:this.nextUpdate})]})),this.singleExtensions&&e.push(new b({value:Array.from(this.singleExtensions,t=>t.toSchema())})),new b({value:e})}toJSON(){const e={certID:this.certID.toJSON(),certStatus:this.certStatus.toJSON(),thisUpdate:this.thisUpdate};return this.nextUpdate&&(e.nextUpdate=this.nextUpdate),this.singleExtensions&&(e.singleExtensions=Array.from(this.singleExtensions,t=>t.toJSON())),e}}os.CLASS_NAME="SingleResponse";const Rh="tbs",Ii="version",hf="responderID",df="producedAt",gf="responses",pl="responseExtensions",lo="ResponseData",jh=`${lo}.${Ii}`,yl=`${lo}.${hf}`,Sg=`${lo}.${df}`,Cg=`${lo}.${gf}`,Wh=`${lo}.${pl}`,Hb=[lo,jh,yl,Sg,Cg,Wh];class Ft extends G{constructor(e={}){super(),this.tbsView=new Uint8Array(m(e,Rh,Ft.defaultValues(Rh))),Ii in e&&(this.version=m(e,Ii,Ft.defaultValues(Ii))),this.responderID=m(e,hf,Ft.defaultValues(hf)),this.producedAt=m(e,df,Ft.defaultValues(df)),this.responses=m(e,gf,Ft.defaultValues(gf)),pl in e&&(this.responseExtensions=m(e,pl,Ft.defaultValues(pl))),e.schema&&this.fromSchema(e.schema)}get tbs(){return Ee.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}static defaultValues(e){switch(e){case Ii:return 0;case Rh:return $t;case hf:return{};case df:return new Date(0,0,0);case gf:case pl:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Rh:return t.byteLength===0;case hf:return Object.keys(t).length===0;case df:return t===Ft.defaultValues(e);case gf:case pl:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||lo,value:[new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new _({name:t.version||jh})]}),new wt({value:[new N({name:t.responderID||yl,idBlock:{tagClass:3,tagNumber:1},value:[rt.schema(t.ResponseDataByName||{names:{blockName:"ResponseData.byName"}})]}),new N({name:t.responderID||yl,idBlock:{tagClass:3,tagNumber:2},value:[new z({name:t.ResponseDataByKey||"ResponseData.byKey"})]})]}),new vt({name:t.producedAt||Sg}),new b({value:[new _e({name:Cg,value:os.schema(t.response||{})})]}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[Dt.schema(t.extensions||{names:{blockName:Wh}})]})]})}fromSchema(e){W(e,Hb);const t=j(e,e,Ft.schema());P.assertSchema(t,this.className),this.tbsView=t.result.ResponseData.valueBeforeDecodeView,jh in t.result&&(this.version=t.result[jh].valueBlock.valueDec),t.result[yl].idBlock.tagNumber===1?this.responderID=new rt({schema:t.result[yl].valueBlock.value[0]}):this.responderID=t.result[yl].valueBlock.value[0],this.producedAt=t.result[Sg].toDate(),this.responses=Array.from(t.result[Cg],r=>new os({schema:r})),Wh in t.result&&(this.responseExtensions=Array.from(t.result[Wh].valueBlock.value,r=>new Tt({schema:r})))}toSchema(e=!1){let t;if(e===!1){if(!this.tbsView.byteLength)return Ft.schema();const r=_t(this.tbsView);P.assert(r,"TBS Response Data"),t=r.result}else{const r=[];Ii in this&&r.push(new N({idBlock:{tagClass:3,tagNumber:0},value:[new _({value:this.version})]})),this.responderID instanceof rt?r.push(new N({idBlock:{tagClass:3,tagNumber:1},value:[this.responderID.toSchema()]})):r.push(new N({idBlock:{tagClass:3,tagNumber:2},value:[this.responderID]})),r.push(new vt({valueDate:this.producedAt})),r.push(new b({value:Array.from(this.responses,a=>a.toSchema())})),this.responseExtensions&&r.push(new N({idBlock:{tagClass:3,tagNumber:1},value:[new b({value:Array.from(this.responseExtensions,a=>a.toSchema())})]})),t=new b({value:r})}return t}toJSON(){const e={};return Ii in this&&(e.version=this.version),this.responderID&&(e.responderID=this.responderID),this.producedAt&&(e.producedAt=this.producedAt),this.responses&&(e.responses=Array.from(this.responses,t=>t.toJSON())),this.responseExtensions&&(e.responseExtensions=Array.from(this.responseExtensions,t=>t.toJSON())),e}}Ft.CLASS_NAME="ResponseData";const Pd="trustedCerts",Ud="certs",Kd="crls",Md="ocsps",Hd="checkDate",Fd="findOrigin",qd="findIssuer";var Ui;(function(s){s[s.unknown=-1]="unknown",s[s.success=0]="success",s[s.noRevocation=11]="noRevocation",s[s.noPath=60]="noPath",s[s.noValidPath=97]="noValidPath"})(Ui||(Ui={}));class nn extends Error{constructor(e,t){super(t),this.name=nn.NAME,this.code=e,this.message=t}}nn.NAME="ChainValidationError";function Fb(s,e){for(let t=0;t<e.length;t++)if(Ee.isEqual(s.tbsView,e[t].tbsView))return!0;return!1}class ud{constructor(e={}){this.trustedCerts=m(e,Pd,this.defaultValues(Pd)),this.certs=m(e,Ud,this.defaultValues(Ud)),this.crls=m(e,Kd,this.defaultValues(Kd)),this.ocsps=m(e,Md,this.defaultValues(Md)),this.checkDate=m(e,Hd,this.defaultValues(Hd)),this.findOrigin=m(e,Fd,this.defaultValues(Fd)),this.findIssuer=m(e,qd,this.defaultValues(qd))}static defaultFindOrigin(e,t){e.tbsView.byteLength===0&&(e.tbsView=new Uint8Array(e.encodeTBS().toBER()));for(const r of t.certs)if(r.tbsView.byteLength===0&&(r.tbsView=new Uint8Array(r.encodeTBS().toBER())),Ee.isEqual(e.tbsView,r.tbsView))return"Intermediate Certificates";for(const r of t.trustedCerts)if(r.tbsView.byteLength===0&&(r.tbsView=new Uint8Array(r.encodeTBS().toBER())),Ee.isEqual(e.tbsView,r.tbsView))return"Trusted Certificates";return"Unknown"}async defaultFindIssuer(e,t,r=Le(!0)){const a=[];let n=null,i=null,o=null;if(e.subject.isEqual(e.issuer))try{if(await e.verify(void 0,r))return[e]}catch{}if(e.extensions){for(const u of e.extensions)if(u.extnID===mm&&u.parsedValue instanceof dn){u.parsedValue.keyIdentifier?n=u.parsedValue.keyIdentifier:(u.parsedValue.authorityCertIssuer&&(i=u.parsedValue.authorityCertIssuer),u.parsedValue.authorityCertSerialNumber&&(o=u.parsedValue.authorityCertSerialNumber));break}}function l(u){if(n!==null&&u.extensions){let f=!1;for(const g of u.extensions)if(g.extnID===jA&&g.parsedValue){f=!0,Ee.isEqual(g.parsedValue.valueBlock.valueHex,n.valueBlock.valueHexView)&&a.push(u);break}if(f)return}let c=!1;o!==null&&(c=u.serialNumber.isEqual(o)),i!==null?u.subject.isEqual(i)&&c&&a.push(u):e.issuer.isEqual(u.subject)&&a.push(u)}for(const u of t.trustedCerts)l(u);for(const u of t.certs)l(u);for(let u=a.length-1;u>=0;u--)try{await e.verify(a[u],r)===!1&&a.splice(u,1)}catch{a.splice(u,1)}return a}defaultValues(e){switch(e){case Pd:return[];case Ud:return[];case Kd:return[];case Md:return[];case Hd:return new Date;case Fd:return ud.defaultFindOrigin;case qd:return this.defaultFindIssuer;default:throw new Error(`Invalid member name for CertificateChainValidationEngine class: ${e}`)}}async sort(e=!1,t=Le(!0)){const r=[],a=async(p,h)=>{const d=[];function y(k){let R=!0;for(let V=0;V<k.length;V++){for(let L=0;L<k.length;L++)if(L!==V&&k[V]===k[L]){R=!1;break}if(!R)break}return R}if(Fb(p,this.trustedCerts))return[[p]];const E=await this.findIssuer(p,this,h);if(E.length===0)throw new Error("No valid certificate paths found");for(let k=0;k<E.length;k++){if(Ee.isEqual(E[k].tbsView,p.tbsView)){d.push([E[k]]);continue}const R=await a(E[k],h);for(let V=0;V<R.length;V++){const L=R[V].slice();L.splice(0,0,E[k]),y(L)?d.push(L):d.push(R[V])}}return d},n=async p=>{const h=[],d=[],y=[];if(h.push(...r.filter(E=>p.issuer.isEqual(E.subject))),h.length===0)return{status:1,statusMessage:"No certificate's issuers"};if(d.push(...this.crls.filter(E=>E.issuer.isEqual(p.issuer))),d.length===0)return{status:2,statusMessage:"No CRLs for specific certificate issuer"};for(let E=0;E<d.length;E++){const k=d[E];if(!(k.nextUpdate&&k.nextUpdate.value<this.checkDate))for(let R=0;R<h.length;R++)try{if(await d[E].verify({issuerCertificate:h[R]},t)){y.push({crl:d[E],certificate:h[R]});break}}catch{}}return y.length?{status:0,statusMessage:S,result:y}:{status:3,statusMessage:"No valid CRLs found"}},i=async(p,h)=>{const d=t.getAlgorithmByOID(p.signatureAlgorithm.algorithmId);if(!d.name||!d.hash)return 1;for(let y=0;y<this.ocsps.length;y++){const k=await this.ocsps[y].getCertificateStatus(p,h,t);if(k.isForCertificate)return k.status===0?0:1}return 2};async function o(p,h=!1){let d=!1,y=!1,E=!1,k=!1;if(p.extensions){for(let R=0;R<p.extensions.length;R++){const V=p.extensions[R];if(V.critical&&!V.parsedValue)return{result:!1,resultCode:6,resultMessage:`Unable to parse critical certificate extension: ${V.extnID}`};if(V.extnID===WA){E=!0;const L=new Uint8Array(V.parsedValue.valueBlock.valueHex);(L[0]&4)===4&&(y=!0),(L[0]&2)===2&&(k=!0)}V.extnID===dm&&"cA"in V.parsedValue&&V.parsedValue.cA===!0&&(d=!0)}if(y===!0&&d===!1)return{result:!1,resultCode:3,resultMessage:'Unable to build certificate chain - using "keyCertSign" flag set without BasicConstraints'};if(E===!0&&d===!0&&y===!1)return{result:!1,resultCode:4,resultMessage:'Unable to build certificate chain - "keyCertSign" flag was not set'};if(d===!0&&E===!0&&h&&k===!1)return{result:!1,resultCode:5,resultMessage:'Unable to build certificate chain - intermediate certificate must have "cRLSign" key usage flag'}}return d===!1?{result:!1,resultCode:7,resultMessage:"Unable to build certificate chain - more than one possible end-user certificate"}:{result:!0,resultCode:0,resultMessage:S}}const l=async(p,h)=>{for(let d=0;d<p.length;d++)if(p[d].notBefore.value>h||p[d].notAfter.value<h)return{result:!1,resultCode:8,resultMessage:"The certificate is either not yet valid or expired"};if(p.length<2)return{result:!1,resultCode:9,resultMessage:"Too short certificate path"};for(let d=p.length-2;d>=0;d--)if(p[d].issuer.isEqual(p[d].subject)===!1&&p[d].issuer.isEqual(p[d+1].subject)===!1)return{result:!1,resultCode:10,resultMessage:"Incorrect name chaining"};if(this.crls.length!==0||this.ocsps.length!==0)for(let d=0;d<p.length-1;d++){let y=2,E={status:0,statusMessage:S};if(this.ocsps.length!==0)switch(y=await i(p[d],p[d+1]),y){case 0:continue;case 1:return{result:!1,resultCode:12,resultMessage:"One of certificates was revoked via OCSP response"}}if(this.crls.length!==0){if(E=await n(p[d]),E.status===0&&E.result)for(let k=0;k<E.result.length;k++){if(E.result[k].crl.isCertificateRevoked(p[d]))return{result:!1,resultCode:12,resultMessage:"One of certificates had been revoked"};if((await o(E.result[k].certificate,!0)).result===!1)return{result:!1,resultCode:13,resultMessage:"CRL issuer certificate is not a CA certificate or does not have crlSign flag"}}else if(e===!1)throw new nn(Ui.noRevocation,`No revocation values found for one of certificates: ${E.statusMessage}`)}else if(y===2)return{result:!1,resultCode:11,resultMessage:"No revocation values found for one of certificates"};if(y===2&&E.status===2&&e){const k=p[d+1];let R=!1;if(k.extensions)for(const V of k.extensions)switch(V.extnID){case zv:case gm:case pm:R=!0;break}if(R)throw new nn(Ui.noRevocation,`No revocation values found for one of certificates: ${E.statusMessage}`)}}for(const[d,y]of p.entries()){if(!d)continue;if(!(await o(y)).result)return{result:!1,resultCode:14,resultMessage:"One of intermediate certificates is not a CA certificate"}}return{result:!0}};r.push(...this.trustedCerts),r.push(...this.certs);for(let p=0;p<r.length;p++)for(let h=0;h<r.length;h++)if(p!==h&&Ee.isEqual(r[p].tbsView,r[h].tbsView)){r.splice(h,1),p=0;break}const u=r[r.length-1];let c;const f=[u];if(c=await a(u,t),c.length===0)throw new nn(Ui.noPath,"Unable to find certificate path");for(let p=c.length-1;p>=0;p--){let h=!1;for(let d=0;d<c[p].length;d++){const y=c[p][d];for(let E=0;E<this.trustedCerts.length;E++)if(Ee.isEqual(y.tbsView,this.trustedCerts[E].tbsView)){h=!0;break}if(h)break}h||c.splice(p,1)}if(c.length===0)throw new nn(Ui.noValidPath,"No valid certificate paths found");let g=c[0].length,v=0;for(let p=0;p<c.length;p++)c[p].length<g&&(g=c[p].length,v=p);for(let p=0;p<c[v].length;p++)f.push(c[v][p]);if(c=await l(f,this.checkDate),c.result===!1)throw c;return f}async verify(e={},t=Le(!0)){function r(l,u){const c=tn(l),f=tn(u),g=c.split("."),v=f.split("."),p=g.length,h=v.length;if(p===0||h===0||p<h)return!1;for(let d=0;d<p;d++)if(g[d].length===0)return!1;for(let d=0;d<h;d++)if(v[d].length===0){if(d===0){if(h===1)return!1;continue}return!1}for(let d=0;d<h;d++)if(v[h-1-d].length!==0&&g[p-1-d].localeCompare(v[h-1-d])!==0)return!1;return!0}function a(l,u){const c=tn(l),f=tn(u),g=c.split("@"),v=f.split("@");if(g.length===0||v.length===0||g.length<v.length)return!1;if(v.length===1){if(r(g[1],v[0])){const h=g[1].split("."),d=v[0].split(".");return d[0].length===0?!0:h.length===d.length}return!1}return c.localeCompare(f)===0}function n(l,u){let c=tn(l);const f=tn(u),g=c.split("/");if(f.split("/").length>1)return!1;if(g.length>1){for(let h=0;h<g.length;h++)if(g[h].length>0&&g[h].charAt(g[h].length-1)!==":"){c=g[h].split(":")[0];break}}if(r(c,f)){const h=c.split("."),d=f.split(".");return d[0].length===0?!0:h.length===d.length}return!1}function i(l,u){const c=l.valueBlock.valueHexView,f=u.valueBlock.valueHexView;if(c.length===4&&f.length===8){for(let g=0;g<4;g++)if((c[g]^f[g])&f[g+4])return!1;return!0}if(c.length===16&&f.length===32){for(let g=0;g<16;g++)if((c[g]^f[g])&f[g+16])return!1;return!0}return!1}function o(l,u){if(l.typesAndValues.length===0||u.typesAndValues.length===0)return!0;if(l.typesAndValues.length<u.typesAndValues.length)return!1;let c=!0,f=0;for(let g=0;g<u.typesAndValues.length;g++){let v=!1;for(let p=f;p<l.typesAndValues.length;p++)if(v=l.typesAndValues[p].isEqual(u.typesAndValues[g]),l.typesAndValues[p].type===u.typesAndValues[g].type&&(c=c&&v),v===!0)if(f===0||f===p){f=p+1;break}else return!1;if(v===!1)return!1}return f===0?!1:c}try{if(this.certs.length===0)throw new Error("Empty certificate array");const l=e.passedWhenNotRevValues||!1,u=e.initialPolicySet||[Mr],c=e.initialExplicitPolicy||!1,f=e.initialPolicyMappingInhibit||!1,g=e.initialInhibitPolicy||!1,v=e.initialPermittedSubtreesSet||[],p=e.initialExcludedSubtreesSet||[],h=e.initialRequiredNameForms||[];let d=c,y=f,E=g;const k=[!1,!1,!1];let R=0,V=0,L=0,ne=v,se=p;const Se=h;let Te=1;this.certs=await this.sort(l,t);const ye=[];ye.push(Mr);const Ce=[],Ve=new Array(this.certs.length-1);for(let te=0;te<this.certs.length-1;te++)Ve[te]=!0;Ce.push(Ve);const Pe=new Array(this.certs.length-1),pe=new Array(this.certs.length-1);let $e=d?this.certs.length-1:-1;for(let te=this.certs.length-2;te>=0;te--,Te++){const le=this.certs[te];if(le.extensions){for(let ae=0;ae<le.extensions.length;ae++){const me=le.extensions[ae];if(me.extnID===Xv){pe[te]=me.parsedValue;for(let Ae=0;Ae<ye.length;Ae++)if(ye[Ae]===Mr){delete Ce[Ae][te];break}for(let Ae=0;Ae<me.parsedValue.certificatePolicies.length;Ae++){let qe=-1;const nt=me.parsedValue.certificatePolicies[Ae].policyIdentifier;for(let Ue=0;Ue<ye.length;Ue++)if(nt===ye[Ue]){qe=Ue;break}if(qe===-1){ye.push(nt);const Ue=new Array(this.certs.length-1);Ue[te]=!0,Ce.push(Ue)}else Ce[qe][te]=!0}}if(me.extnID===Zv){if(y)return{result:!1,resultCode:98,resultMessage:"Policy mapping prohibited"};Pe[te]=me.parsedValue}me.extnID===e1&&d===!1&&(me.parsedValue.requireExplicitPolicy===0?(d=!0,$e=te):k[0]===!1?(k[0]=!0,R=me.parsedValue.requireExplicitPolicy):R=R>me.parsedValue.requireExplicitPolicy?me.parsedValue.requireExplicitPolicy:R,me.parsedValue.inhibitPolicyMapping===0?y=!0:k[1]===!1?(k[1]=!0,V=me.parsedValue.inhibitPolicyMapping+1):V=V>me.parsedValue.inhibitPolicyMapping+1?me.parsedValue.inhibitPolicyMapping+1:V),me.extnID===rE&&E===!1&&(me.parsedValue.valueBlock.valueDec===0?E=!0:k[2]===!1?(k[2]=!0,L=me.parsedValue.valueBlock.valueDec):L=L>me.parsedValue.valueBlock.valueDec?me.parsedValue.valueBlock.valueDec:L)}if(E===!0){let ae=-1;for(let me=0;me<ye.length;me++)if(ye[me]===Mr){ae=me;break}ae!==-1&&delete Ce[0][te]}d===!1&&k[0]===!0&&(R--,R===0&&(d=!0,$e=te,k[0]=!1)),y===!1&&k[1]===!0&&(V--,V===0&&(y=!0,k[1]=!1)),E===!1&&k[2]===!0&&(L--,L===0&&(E=!0,k[2]=!1))}}for(let te=0;te<this.certs.length-1;te++)if(te<this.certs.length-2&&typeof Pe[te+1]<"u")for(let le=0;le<Pe[te+1].mappings.length;le++){if(Pe[te+1].mappings[le].issuerDomainPolicy===Mr||Pe[te+1].mappings[le].subjectDomainPolicy===Mr)return{result:!1,resultCode:99,resultMessage:'The "anyPolicy" should not be a part of policy mapping scheme'};let ae=-1,me=-1;for(let Ae=0;Ae<ye.length;Ae++)ye[Ae]===Pe[te+1].mappings[le].issuerDomainPolicy&&(ae=Ae),ye[Ae]===Pe[te+1].mappings[le].subjectDomainPolicy&&(me=Ae);typeof Ce[ae][te]<"u"&&delete Ce[ae][te];for(let Ae=0;Ae<pe[te].certificatePolicies.length;Ae++)if(Pe[te+1].mappings[le].subjectDomainPolicy===pe[te].certificatePolicies[Ae].policyIdentifier&&ae!==-1&&me!==-1)for(let qe=0;qe<=te;qe++)typeof Ce[me][qe]<"u"&&(Ce[ae][qe]=!0,delete Ce[me][qe])}for(let te=0;te<ye.length;te++)if(ye[te]===Mr)for(let le=0;le<$e;le++)delete Ce[te][le];const ie=[];for(let te=0;te<Ce.length;te++){let le=!0;for(let ae=0;ae<this.certs.length-1;ae++){let me=!1;if(ae<$e&&ye[te]===Mr&&ye.length>1){le=!1;break}if(typeof Ce[te][ae]>"u"){if(ae>=$e){for(let Ae=0;Ae<ye.length;Ae++)if(ye[Ae]===Mr){Ce[Ae][ae]===!0&&(me=!0);break}}if(!me){le=!1;break}}}le===!0&&ie.push(ye[te])}let ot=[];if(u.length===1&&u[0]===Mr&&d===!1)ot=u;else if(ie.length===1&&ie[0]===Mr)ot=u;else for(let te=0;te<ie.length;te++)for(let le=0;le<u.length;le++)if(u[le]===ie[te]||u[le]===Mr){ot.push(ie[te]);break}const Me={result:ot.length>0,resultCode:0,resultMessage:ot.length>0?S:'Zero "userConstrPolicies" array, no intersections with "authConstrPolicies"',authConstrPolicies:ie,userConstrPolicies:ot,explicitPolicyIndicator:d,policyMappings:Pe,certificatePath:this.certs};if(ot.length===0||Me.result===!1)return Me;Te=1;for(let te=this.certs.length-2;te>=0;te--,Te++){const le=this.certs[te];let ae=[],me=[],Ae=[];if(le.extensions)for(let Ne=0;Ne<le.extensions.length;Ne++){const fe=le.extensions[Ne];fe.extnID===Yv&&("permittedSubtrees"in fe.parsedValue&&(me=me.concat(fe.parsedValue.permittedSubtrees)),"excludedSubtrees"in fe.parsedValue&&(Ae=Ae.concat(fe.parsedValue.excludedSubtrees))),fe.extnID===Gv&&(ae=ae.concat(fe.parsedValue.altNames))}let qe=Se.length<=0;for(let Ne=0;Ne<Se.length;Ne++)switch(Se[Ne].base.type){case 4:{if(Se[Ne].base.value.typesAndValues.length!==le.subject.typesAndValues.length)continue;qe=!0;for(let fe=0;fe<le.subject.typesAndValues.length;fe++)if(le.subject.typesAndValues[fe].type!==Se[Ne].base.value.typesAndValues[fe].type){qe=!1;break}if(qe===!0)break}break;default:}if(qe===!1)throw Me.result=!1,Me.resultCode=21,Me.resultMessage="No necessary name form found",Me;const nt=[[],[],[],[],[]];for(let Ne=0;Ne<ne.length;Ne++)switch(ne[Ne].base.type){case 1:nt[0].push(ne[Ne]);break;case 2:nt[1].push(ne[Ne]);break;case 4:nt[2].push(ne[Ne]);break;case 6:nt[3].push(ne[Ne]);break;case 7:nt[4].push(ne[Ne]);break;default:}for(let Ne=0;Ne<5;Ne++){let fe=!1,ht=!1;const lt=nt[Ne];for(let ut=0;ut<lt.length;ut++){switch(Ne){case 0:if(ae.length>0)for(let Oe=0;Oe<ae.length;Oe++)ae[Oe].type===1&&(ht=!0,fe=fe||a(ae[Oe].value,lt[ut].base.value));else for(let Oe=0;Oe<le.subject.typesAndValues.length;Oe++)(le.subject.typesAndValues[Oe].type==="1.2.840.113549.1.9.1"||le.subject.typesAndValues[Oe].type==="0.9.2342.19200300.100.1.3")&&(ht=!0,fe=fe||a(le.subject.typesAndValues[Oe].value.valueBlock.value,lt[ut].base.value));break;case 1:if(ae.length>0)for(let Oe=0;Oe<ae.length;Oe++)ae[Oe].type===2&&(ht=!0,fe=fe||r(ae[Oe].value,lt[ut].base.value));break;case 2:ht=!0,fe=o(le.subject,lt[ut].base.value);break;case 3:if(ae.length>0)for(let Oe=0;Oe<ae.length;Oe++)ae[Oe].type===6&&(ht=!0,fe=fe||n(ae[Oe].value,lt[ut].base.value));break;case 4:if(ae.length>0)for(let Oe=0;Oe<ae.length;Oe++)ae[Oe].type===7&&(ht=!0,fe=fe||i(ae[Oe].value,lt[ut].base.value));break;default:}if(fe)break}if(fe===!1&&lt.length>0&&ht)throw Me.result=!1,Me.resultCode=41,Me.resultMessage='Failed to meet "permitted sub-trees" name constraint',Me}let Ue=!1;for(let Ne=0;Ne<se.length;Ne++){switch(se[Ne].base.type){case 1:if(ae.length>=0)for(let fe=0;fe<ae.length;fe++)ae[fe].type===1&&(Ue=Ue||a(ae[fe].value,se[Ne].base.value));else for(let fe=0;fe<le.subject.typesAndValues.length;fe++)(le.subject.typesAndValues[fe].type==="1.2.840.113549.1.9.1"||le.subject.typesAndValues[fe].type==="0.9.2342.19200300.100.1.3")&&(Ue=Ue||a(le.subject.typesAndValues[fe].value.valueBlock.value,se[Ne].base.value));break;case 2:if(ae.length>0)for(let fe=0;fe<ae.length;fe++)ae[fe].type===2&&(Ue=Ue||r(ae[fe].value,se[Ne].base.value));break;case 4:Ue=Ue||o(le.subject,se[Ne].base.value);break;case 6:if(ae.length>0)for(let fe=0;fe<ae.length;fe++)ae[fe].type===6&&(Ue=Ue||n(ae[fe].value,se[Ne].base.value));break;case 7:if(ae.length>0)for(let fe=0;fe<ae.length;fe++)ae[fe].type===7&&(Ue=Ue||i(ae[fe].value,se[Ne].base.value));break;default:}if(Ue)break}if(Ue===!0)throw Me.result=!1,Me.resultCode=42,Me.resultMessage='Failed to meet "excluded sub-trees" name constraint',Me;ne=ne.concat(me),se=se.concat(Ae)}return Me}catch(l){return l instanceof Error?l instanceof nn?{result:!1,resultCode:l.code,resultMessage:l.message,error:l}:{result:!1,resultCode:Ui.unknown,resultMessage:l.message,error:l}:l&&typeof l=="object"&&"resultMessage"in l?l:{result:!1,resultCode:-1,resultMessage:`${l}`}}}}const Qh="tbsResponseData",mf="signatureAlgorithm",pf="signature",vl="certs",sh="BasicOCSPResponse",Ag=`${sh}.${Qh}`,Eg=`${sh}.${mf}`,bg=`${sh}.${pf}`,Yh=`${sh}.${vl}`,qb=[Ag,Eg,bg,Yh];class jr extends G{constructor(e={}){super(),this.tbsResponseData=m(e,Qh,jr.defaultValues(Qh)),this.signatureAlgorithm=m(e,mf,jr.defaultValues(mf)),this.signature=m(e,pf,jr.defaultValues(pf)),vl in e&&(this.certs=m(e,vl,jr.defaultValues(vl))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Qh:return new Ft;case mf:return new $;case pf:return new He;case vl:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case"type":{let r=Ft.compareWithDefault("tbs",t.tbs)&&Ft.compareWithDefault("responderID",t.responderID)&&Ft.compareWithDefault("producedAt",t.producedAt)&&Ft.compareWithDefault("responses",t.responses);return"responseExtensions"in t&&(r=r&&Ft.compareWithDefault("responseExtensions",t.responseExtensions)),r}case mf:return t.algorithmId===S&&!("algorithmParams"in t);case pf:return t.isEqual(jr.defaultValues(e));case vl:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||sh,value:[Ft.schema(t.tbsResponseData||{names:{blockName:Ag}}),$.schema(t.signatureAlgorithm||{names:{blockName:Eg}}),new He({name:t.signature||bg}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new b({value:[new _e({name:Yh,value:Xe.schema(t.certs||{})})]})]})]})}fromSchema(e){W(e,qb);const t=j(e,e,jr.schema());P.assertSchema(t,this.className),this.tbsResponseData=new Ft({schema:t.result[Ag]}),this.signatureAlgorithm=new $({schema:t.result[Eg]}),this.signature=t.result[bg],Yh in t.result&&(this.certs=Array.from(t.result[Yh],r=>new Xe({schema:r})))}toSchema(){const e=[];return e.push(this.tbsResponseData.toSchema()),e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),this.certs&&e.push(new N({idBlock:{tagClass:3,tagNumber:0},value:[new b({value:Array.from(this.certs,t=>t.toSchema())})]})),new b({value:e})}toJSON(){const e={tbsResponseData:this.tbsResponseData.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};return this.certs&&(e.certs=Array.from(this.certs,t=>t.toJSON())),e}async getCertificateStatus(e,t,r=Le(!0)){const a={isForCertificate:!1,status:2},n={},i=[];for(const o of this.tbsResponseData.responses){const l=r.getAlgorithmByOID(o.certID.hashAlgorithm.algorithmId,!0,"CertID.hashAlgorithm");if(!n[l.name]){n[l.name]=1;const u=new Rt;i.push(u),await u.createForCertificate(e,{hashAlgorithm:l.name,issuerCertificate:t},r)}}for(const o of this.tbsResponseData.responses)for(const l of i)if(o.certID.isEqual(l)){a.isForCertificate=!0;try{switch(o.certStatus.idBlock.isConstructed){case!0:o.certStatus.idBlock.tagNumber===1&&(a.status=1);break;case!1:switch(o.certStatus.idBlock.tagNumber){case 0:a.status=0;break;case 2:a.status=2;break;default:}break;default:}}catch{}return a}return a}async sign(e,t="SHA-1",r=Le(!0)){if(!e)throw new Error("Need to provide a private key for signing");const a=await r.getSignatureParameters(e,t),n=a.parameters.algorithm;if(!("name"in n))throw new Error("Empty algorithm");this.signatureAlgorithm=a.signatureAlgorithm,this.tbsResponseData.tbsView=new Uint8Array(this.tbsResponseData.toSchema(!0).toBER());const i=await r.signWithPrivateKey(this.tbsResponseData.tbsView,e,{algorithm:n});this.signature=new He({valueHex:i})}async verify(e={},t=Le(!0)){let r=null,a=-1;const n=e.trustedCerts||[];if(!this.certs)throw new Error("No certificates attached to the BasicOCSPResponse");switch(!0){case this.tbsResponseData.responderID instanceof rt:for(const[u,c]of this.certs.entries())if(c.subject.isEqual(this.tbsResponseData.responderID)){a=u;break}break;case this.tbsResponseData.responderID instanceof z:for(const[u,c]of this.certs.entries()){const f=await t.digest({name:"sha-1"},c.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView);if(su(f,this.tbsResponseData.responderID.valueBlock.valueHex)){a=u;break}}break;default:throw new Error("Wrong value for responderID")}if(a===-1)throw new Error("Correct certificate was not found in OCSP response");r=this.certs[a];const i=[r];for(const u of this.certs){const c=await u1(u,r);c&&i.push(c)}if(!(await new ud({certs:i,trustedCerts:n}).verify({},t)).result)throw new Error("Validation of signer's certificate failed");return t.verifyWithPublicKey(this.tbsResponseData.tbsView,this.signature,this.certs[a].subjectPublicKeyInfo,this.signatureAlgorithm)}}jr.CLASS_NAME="BasicOCSPResponse";const Jd="tbs",Gd="version",jd="subject",Wd="subjectPublicKeyInfo",yo="attributes",yf="signatureAlgorithm",vf="signatureValue",gu="CertificationRequestInfo",km=`${gu}.version`,Im=`${gu}.subject`,Bm=`${gu}.subjectPublicKeyInfo`,U0=`${gu}.attributes`,Jb=[gu,km,Im,Bm,U0,yf,vf];function Gb(s={}){const e=m(s,"names",{});return new b({name:e.CertificationRequestInfo||gu,value:[new _({name:e.CertificationRequestInfoVersion||km}),rt.schema(e.subject||{names:{blockName:Im}}),wr.schema({names:{blockName:Bm}}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new _e({optional:!0,name:e.CertificationRequestInfoAttributes||U0,value:mt.schema(e.attributes||{})})]})]})}class ns extends G{constructor(e={}){super(),this.tbsView=new Uint8Array(m(e,Jd,ns.defaultValues(Jd))),this.version=m(e,Gd,ns.defaultValues(Gd)),this.subject=m(e,jd,ns.defaultValues(jd)),this.subjectPublicKeyInfo=m(e,Wd,ns.defaultValues(Wd)),yo in e&&(this.attributes=m(e,yo,ns.defaultValues(yo))),this.signatureAlgorithm=m(e,yf,ns.defaultValues(yf)),this.signatureValue=m(e,vf,ns.defaultValues(vf)),e.schema&&this.fromSchema(e.schema)}get tbs(){return Ee.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}static defaultValues(e){switch(e){case Jd:return $t;case Gd:return 0;case jd:return new rt;case Wd:return new wr;case yo:return[];case yf:return new $;case vf:return new He;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({value:[Gb(t.certificationRequestInfo||{}),new b({name:t.signatureAlgorithm||yf,value:[new he,new xe({optional:!0})]}),new He({name:t.signatureValue||vf})]})}fromSchema(e){W(e,Jb);const t=j(e,e,ns.schema());P.assertSchema(t,this.className),this.tbsView=t.result.CertificationRequestInfo.valueBeforeDecodeView,this.version=t.result[km].valueBlock.valueDec,this.subject=new rt({schema:t.result[Im]}),this.subjectPublicKeyInfo=new wr({schema:t.result[Bm]}),U0 in t.result&&(this.attributes=Array.from(t.result[U0],r=>new mt({schema:r}))),this.signatureAlgorithm=new $({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[new _({value:this.version}),this.subject.toSchema(),this.subjectPublicKeyInfo.toSchema()];return yo in this&&e.push(new N({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes||[],t=>t.toSchema())})),new b({value:e})}toSchema(e=!1){let t;if(e===!1){if(this.tbsView.byteLength===0)return ns.schema();const r=_t(this.tbsView);P.assert(r,"PKCS#10 Certificate Request"),t=r.result}else t=this.encodeTBS();return new b({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:ke.ToHex(this.tbsView),version:this.version,subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return yo in this&&(e.attributes=Array.from(this.attributes||[],t=>t.toJSON())),e}async sign(e,t="SHA-1",r=Le(!0)){if(!e)throw new Error("Need to provide a private key for signing");const a=await r.getSignatureParameters(e,t),n=a.parameters;this.signatureAlgorithm=a.signatureAlgorithm,this.tbsView=new Uint8Array(this.encodeTBS().toBER());const i=await r.signWithPrivateKey(this.tbsView,e,n);this.signatureValue=new He({valueHex:i})}async verify(e=Le(!0)){return e.verifyWithPublicKey(this.tbsView,this.signatureValue,this.subjectPublicKeyInfo,this.signatureAlgorithm)}async getPublicKey(e,t=Le(!0)){return t.getPublicKey(this.subjectPublicKeyInfo,this.signatureAlgorithm,e)}}ns.CLASS_NAME="CertificationRequest";const Bi="digestAlgorithm",xi="digest",jb=[Bi,xi];class Qr extends G{constructor(e={}){super(),this.digestAlgorithm=m(e,Bi,Qr.defaultValues(Bi)),this.digest=m(e,xi,Qr.defaultValues(xi)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Bi:return new $;case xi:return new z;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Bi:return $.compareWithDefault("algorithmId",t.algorithmId)&&!("algorithmParams"in t);case xi:return t.isEqual(Qr.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[$.schema(t.digestAlgorithm||{names:{blockName:Bi}}),new z({name:t.digest||xi})]})}fromSchema(e){W(e,jb);const t=j(e,e,Qr.schema({names:{digestAlgorithm:{names:{blockName:Bi}},digest:xi}}));P.assertSchema(t,this.className),this.digestAlgorithm=new $({schema:t.result.digestAlgorithm}),this.digest=t.result.digest}toSchema(){return new b({value:[this.digestAlgorithm.toSchema(),this.digest]})}toJSON(){return{digestAlgorithm:this.digestAlgorithm.toJSON(),digest:this.digest.toJSON()}}}Qr.CLASS_NAME="DigestInfo";const wl="eContentType",ss="eContent",Wb=[wl,ss];class br extends G{constructor(e={}){if(super(),this.eContentType=m(e,wl,br.defaultValues(wl)),ss in e&&(this.eContent=m(e,ss,br.defaultValues(ss)),this.eContent.idBlock.tagClass===1&&this.eContent.idBlock.tagNumber===4&&this.eContent.idBlock.isConstructed===!1)){const t=new z({idBlock:{isConstructed:!0},isConstructed:!0});let r=0;const a=this.eContent.valueBlock.valueHexView.slice().buffer;let n=a.byteLength;for(;n>0;){const i=new Uint8Array(a,r,r+65536>a.byteLength?a.byteLength-r:65536),o=new ArrayBuffer(i.length),l=new Uint8Array(o);for(let u=0;u<l.length;u++)l[u]=i[u];t.valueBlock.value.push(new z({valueHex:o})),n-=i.length,r+=i.length}this.eContent=t}e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case wl:return S;case ss:return new z;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case wl:return t===S;case ss:return t.idBlock.tagClass===1&&t.idBlock.tagNumber===4?t.isEqual(br.defaultValues(ss)):!1;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.eContentType||S}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new xe({name:t.eContent||S})]})]})}fromSchema(e){W(e,Wb);const t=j(e,e,br.schema({names:{eContentType:wl,eContent:ss}}));P.assertSchema(t,this.className),this.eContentType=t.result.eContentType.valueBlock.toString(),ss in t.result&&(this.eContent=t.result.eContent)}toSchema(){const e=[];return e.push(new he({value:this.eContentType})),this.eContent&&br.compareWithDefault(ss,this.eContent)===!1&&e.push(new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.eContent]})),new b({value:e})}toJSON(){const e={eContentType:this.eContentType};return this.eContent&&br.compareWithDefault(ss,this.eContent)===!1&&(e.eContent=this.eContent.toJSON()),e}}br.CLASS_NAME="EncapsulatedContentInfo";const Ni="mac",Ti="macSalt",Js="iterations",Qb=[Ni,Ti,Js];class mr extends G{constructor(e={}){super(),this.mac=m(e,Ni,mr.defaultValues(Ni)),this.macSalt=m(e,Ti,mr.defaultValues(Ti)),Js in e&&(this.iterations=m(e,Js,mr.defaultValues(Js))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ni:return new Qr;case Ti:return new z;case Js:return 1;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ni:return Qr.compareWithDefault("digestAlgorithm",t.digestAlgorithm)&&Qr.compareWithDefault("digest",t.digest);case Ti:return t.isEqual(mr.defaultValues(e));case Js:return t===mr.defaultValues(e);default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,optional:t.optional||!0,value:[Qr.schema(t.mac||{names:{blockName:Ni}}),new z({name:t.macSalt||Ti}),new _({optional:!0,name:t.iterations||Js})]})}fromSchema(e){W(e,Qb);const t=j(e,e,mr.schema({names:{mac:{names:{blockName:Ni}},macSalt:Ti,iterations:Js}}));P.assertSchema(t,this.className),this.mac=new Qr({schema:t.result.mac}),this.macSalt=t.result.macSalt,Js in t.result&&(this.iterations=t.result.iterations.valueBlock.valueDec)}toSchema(){const e=[this.mac.toSchema(),this.macSalt];return this.iterations!==void 0&&e.push(new _({value:this.iterations})),new b({value:e})}toJSON(){const e={mac:this.mac.toJSON(),macSalt:this.macSalt.toJSON()};return this.iterations!==void 0&&(e.iterations=this.iterations),e}}mr.CLASS_NAME="MacData";const Ki="hashAlgorithm",Mi="hashedMessage",Yb=[Ki,Mi];class sr extends G{constructor(e={}){super(),this.hashAlgorithm=m(e,Ki,sr.defaultValues(Ki)),this.hashedMessage=m(e,Mi,sr.defaultValues(Mi)),e.schema&&this.fromSchema(e.schema)}static async create(e,t,r=Le(!0)){const a=r.getOIDByAlgorithm({name:e},!0,"hashAlgorithm"),n=await r.digest(e,t);return new sr({hashAlgorithm:new $({algorithmId:a,algorithmParams:new It}),hashedMessage:new z({valueHex:n})})}static defaultValues(e){switch(e){case Ki:return new $;case Mi:return new z;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ki:return t.algorithmId===S&&!("algorithmParams"in t);case Mi:return t.isEqual(sr.defaultValues(e))===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[$.schema(t.hashAlgorithm||{}),new z({name:t.hashedMessage||S})]})}fromSchema(e){W(e,Yb);const t=j(e,e,sr.schema({names:{hashAlgorithm:{names:{blockName:Ki}},hashedMessage:Mi}}));P.assertSchema(t,this.className),this.hashAlgorithm=new $({schema:t.result.hashAlgorithm}),this.hashedMessage=t.result.hashedMessage}toSchema(){return new b({value:[this.hashAlgorithm.toSchema(),this.hashedMessage]})}toJSON(){return{hashAlgorithm:this.hashAlgorithm.toJSON(),hashedMessage:this.hashedMessage.toJSON()}}}sr.CLASS_NAME="MessageImprint";const Sl="reqCert",Qa="singleRequestExtensions",zb=[Sl,Qa];class aa extends G{constructor(e={}){super(),this.reqCert=m(e,Sl,aa.defaultValues(Sl)),Qa in e&&(this.singleRequestExtensions=m(e,Qa,aa.defaultValues(Qa))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Sl:return new Rt;case Qa:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Sl:return t.isEqual(aa.defaultValues(e));case Qa:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[Rt.schema(t.reqCert||{}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[Tt.schema(t.extensions||{names:{blockName:t.singleRequestExtensions||S}})]})]})}fromSchema(e){W(e,zb);const t=j(e,e,aa.schema({names:{reqCert:{names:{blockName:Sl}},extensions:{names:{blockName:Qa}}}}));P.assertSchema(t,this.className),this.reqCert=new Rt({schema:t.result.reqCert}),Qa in t.result&&(this.singleRequestExtensions=Array.from(t.result.singleRequestExtensions.valueBlock.value,r=>new Tt({schema:r})))}toSchema(){const e=[];return e.push(this.reqCert.toSchema()),this.singleRequestExtensions&&e.push(new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new b({value:Array.from(this.singleRequestExtensions,t=>t.toSchema())})]})),new b({value:e})}toJSON(){const e={reqCert:this.reqCert.toJSON()};return this.singleRequestExtensions&&(e.singleRequestExtensions=Array.from(this.singleRequestExtensions,t=>t.toJSON())),e}}aa.CLASS_NAME="Request";const Vh="tbs",Cl="version",Al="requestorName",_h="requestList",El="requestExtensions",mu="TBSRequest",zh=`${mu}.${Cl}`,Xh=`${mu}.${Al}`,kg=`${mu}.requests`,Zh=`${mu}.${El}`,Xb=[mu,zh,Xh,kg,Zh];class zt extends G{constructor(e={}){super(),this.tbsView=new Uint8Array(m(e,Vh,zt.defaultValues(Vh))),Cl in e&&(this.version=m(e,Cl,zt.defaultValues(Cl))),Al in e&&(this.requestorName=m(e,Al,zt.defaultValues(Al))),this.requestList=m(e,_h,zt.defaultValues(_h)),El in e&&(this.requestExtensions=m(e,El,zt.defaultValues(El))),e.schema&&this.fromSchema(e.schema)}get tbs(){return Ee.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}static defaultValues(e){switch(e){case Vh:return $t;case Cl:return 0;case Al:return new ze;case _h:case El:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Vh:return t.byteLength===0;case Cl:return t===zt.defaultValues(e);case Al:return t.type===ze.defaultValues("type")&&Object.keys(t.value).length===0;case _h:case El:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||mu,value:[new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new _({name:t.TBSRequestVersion||zh})]}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[ze.schema(t.requestorName||{names:{blockName:Xh}})]}),new b({name:t.requestList||"TBSRequest.requestList",value:[new _e({name:t.requests||kg,value:aa.schema(t.requestNames||{})})]}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:2},value:[Dt.schema(t.extensions||{names:{blockName:t.requestExtensions||Zh}})]})]})}fromSchema(e){W(e,Xb);const t=j(e,e,zt.schema());P.assertSchema(t,this.className),this.tbsView=t.result.TBSRequest.valueBeforeDecodeView,zh in t.result&&(this.version=t.result[zh].valueBlock.valueDec),Xh in t.result&&(this.requestorName=new ze({schema:t.result[Xh]})),this.requestList=Array.from(t.result[kg],r=>new aa({schema:r})),Zh in t.result&&(this.requestExtensions=Array.from(t.result[Zh].valueBlock.value,r=>new Tt({schema:r})))}toSchema(e=!1){let t;if(e===!1){if(this.tbsView.byteLength===0)return zt.schema();const r=_t(this.tbsView);if(P.assert(r,"TBS Request"),!(r.result instanceof b))throw new Error("ASN.1 result should be SEQUENCE");t=r.result}else{const r=[];this.version!==void 0&&r.push(new N({idBlock:{tagClass:3,tagNumber:0},value:[new _({value:this.version})]})),this.requestorName&&r.push(new N({idBlock:{tagClass:3,tagNumber:1},value:[this.requestorName.toSchema()]})),r.push(new b({value:Array.from(this.requestList,a=>a.toSchema())})),this.requestExtensions&&r.push(new N({idBlock:{tagClass:3,tagNumber:2},value:[new b({value:Array.from(this.requestExtensions,a=>a.toSchema())})]})),t=new b({value:r})}return t}toJSON(){const e={};return this.version!=null&&(e.version=this.version),this.requestorName&&(e.requestorName=this.requestorName.toJSON()),e.requestList=Array.from(this.requestList,t=>t.toJSON()),this.requestExtensions&&(e.requestExtensions=Array.from(this.requestExtensions,t=>t.toJSON())),e}}zt.CLASS_NAME="TBSRequest";const vo="signatureAlgorithm",wo="signature",pa="certs";class Dr extends G{constructor(e={}){super(),this.signatureAlgorithm=m(e,vo,Dr.defaultValues(vo)),this.signature=m(e,wo,Dr.defaultValues(wo)),pa in e&&(this.certs=m(e,pa,Dr.defaultValues(pa))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case vo:return new $;case wo:return new He;case pa:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case vo:return t.algorithmId===S&&!("algorithmParams"in t);case wo:return t.isEqual(Dr.defaultValues(e));case pa:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[$.schema(t.signatureAlgorithm||{}),new He({name:t.signature||S}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new b({value:[new _e({name:t.certs||S,value:Xe.schema({})})]})]})]})}fromSchema(e){W(e,[vo,wo,pa]);const t=j(e,e,Dr.schema({names:{signatureAlgorithm:{names:{blockName:vo}},signature:wo,certs:pa}}));P.assertSchema(t,this.className),this.signatureAlgorithm=new $({schema:t.result.signatureAlgorithm}),this.signature=t.result.signature,pa in t.result&&(this.certs=Array.from(t.result.certs,r=>new Xe({schema:r})))}toSchema(){const e=[];return e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),this.certs&&e.push(new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new b({value:Array.from(this.certs,t=>t.toSchema())})]})),new b({value:e})}toJSON(){const e={signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};return this.certs&&(e.certs=Array.from(this.certs,t=>t.toJSON())),e}}Dr.CLASS_NAME="Signature";const bl="tbsRequest",Ya="optionalSignature",Zb=[bl,Ya];class Df extends G{constructor(e={}){super(),this.tbsRequest=m(e,bl,Df.defaultValues(bl)),Ya in e&&(this.optionalSignature=m(e,Ya,Df.defaultValues(Ya))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case bl:return new zt;case Ya:return new Dr;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case bl:return zt.compareWithDefault("tbs",t.tbs)&&zt.compareWithDefault("version",t.version)&&zt.compareWithDefault("requestorName",t.requestorName)&&zt.compareWithDefault("requestList",t.requestList)&&zt.compareWithDefault("requestExtensions",t.requestExtensions);case Ya:return Dr.compareWithDefault("signatureAlgorithm",t.signatureAlgorithm)&&Dr.compareWithDefault("signature",t.signature)&&Dr.compareWithDefault("certs",t.certs);default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||"OCSPRequest",value:[zt.schema(t.tbsRequest||{names:{blockName:bl}}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[Dr.schema(t.optionalSignature||{names:{blockName:Ya}})]})]})}fromSchema(e){W(e,Zb);const t=j(e,e,Df.schema());P.assertSchema(t,this.className),this.tbsRequest=new zt({schema:t.result.tbsRequest}),Ya in t.result&&(this.optionalSignature=new Dr({schema:t.result.optionalSignature}))}toSchema(e=!1){const t=[];return t.push(this.tbsRequest.toSchema(e)),this.optionalSignature&&t.push(new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.optionalSignature.toSchema()]})),new b({value:t})}toJSON(){const e={tbsRequest:this.tbsRequest.toJSON()};return this.optionalSignature&&(e.optionalSignature=this.optionalSignature.toJSON()),e}async createForCertificate(e,t,r=Le(!0)){const a=new Rt;await a.createForCertificate(e,t,r),this.tbsRequest.requestList.push(new aa({reqCert:a}))}async sign(e,t="SHA-1",r=Le(!0)){if(Ge.assertEmpty(e,"privateKey","OCSPRequest.sign method"),!this.optionalSignature)throw new Error('Need to create "optionalSignature" field before signing');const a=await r.getSignatureParameters(e,t),n=a.parameters;this.optionalSignature.signatureAlgorithm=a.signatureAlgorithm;const i=this.tbsRequest.toSchema(!0).toBER(!1),o=await r.signWithPrivateKey(i,e,n);this.optionalSignature.signature=new He({valueHex:o})}verify(){}}Df.CLASS_NAME="OCSPRequest";const kl="responseType",Il="response",ek=[kl,Il];class us extends G{constructor(e={}){super(),this.responseType=m(e,kl,us.defaultValues(kl)),this.response=m(e,Il,us.defaultValues(Il)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case kl:return S;case Il:return new z;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case kl:return t===S;case Il:return t.isEqual(us.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new he({name:t.responseType||S}),new z({name:t.response||S})]})}fromSchema(e){W(e,ek);const t=j(e,e,us.schema({names:{responseType:kl,response:Il}}));P.assertSchema(t,this.className),this.responseType=t.result.responseType.valueBlock.toString(),this.response=t.result.response}toSchema(){return new b({value:[new he({value:this.responseType}),this.response]})}toJSON(){return{responseType:this.responseType,response:this.response.toJSON()}}}us.CLASS_NAME="ResponseBytes";const So="responseStatus",Ds="responseBytes";class Gl extends G{constructor(e={}){super(),this.responseStatus=m(e,So,Gl.defaultValues(So)),Ds in e&&(this.responseBytes=m(e,Ds,Gl.defaultValues(Ds))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case So:return new ao;case Ds:return new us;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case So:return t.isEqual(Gl.defaultValues(e));case Ds:return us.compareWithDefault("responseType",t.responseType)&&us.compareWithDefault("response",t.response);default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||"OCSPResponse",value:[new ao({name:t.responseStatus||So}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[us.schema(t.responseBytes||{names:{blockName:Ds}})]})]})}fromSchema(e){W(e,[So,Ds]);const t=j(e,e,Gl.schema());P.assertSchema(t,this.className),this.responseStatus=t.result.responseStatus,Ds in t.result&&(this.responseBytes=new us({schema:t.result.responseBytes}))}toSchema(){const e=[];return e.push(this.responseStatus),this.responseBytes&&e.push(new N({idBlock:{tagClass:3,tagNumber:0},value:[this.responseBytes.toSchema()]})),new b({value:e})}toJSON(){const e={responseStatus:this.responseStatus.toJSON()};return this.responseBytes&&(e.responseBytes=this.responseBytes.toJSON()),e}async getCertificateStatus(e,t,r=Le(!0)){let a;const n={isForCertificate:!1,status:2};if(!this.responseBytes||this.responseBytes.responseType!==Uh)return n;try{const i=_t(this.responseBytes.response.valueBlock.valueHexView);P.assert(i,"Basic OCSP response"),a=new jr({schema:i.result})}catch{return n}return a.getCertificateStatus(e,t,r)}async sign(e,t,r=Le(!0)){var a;if(this.responseBytes&&this.responseBytes.responseType===Uh)return jr.fromBER(this.responseBytes.response.valueBlock.valueHexView).sign(e,t,r);throw new Error(`Unknown ResponseBytes type: ${((a=this.responseBytes)===null||a===void 0?void 0:a.responseType)||"Unknown"}`)}async verify(e=null,t=Le(!0)){var r;if(!(Ds in this))throw new Error("Empty ResponseBytes field");if(this.responseBytes&&this.responseBytes.responseType===Uh){const a=jr.fromBER(this.responseBytes.response.valueBlock.valueHexView);return e!==null&&(a.certs||(a.certs=[]),a.certs.push(e)),a.verify({},t)}throw new Error(`Unknown ResponseBytes type: ${((r=this.responseBytes)===null||r===void 0?void 0:r.responseType)||"Unknown"}`)}}Gl.CLASS_NAME="OCSPResponse";const Dn="type",Gs="attributes",$h="encodedValue",tk=[Gs];class Ct extends G{constructor(e={}){super(),this.type=m(e,Dn,Ct.defaultValues(Dn)),this.attributes=m(e,Gs,Ct.defaultValues(Gs)),this.encodedValue=m(e,$h,Ct.defaultValues($h)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Dn:return-1;case Gs:return[];case $h:return $t;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Dn:return t===Ct.defaultValues(Dn);case Gs:return t.length===0;case $h:return t.byteLength===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new N({name:t.blockName||S,optional:!0,idBlock:{tagClass:3,tagNumber:t.tagNumber||0},value:[new _e({name:t.attributes||S,value:mt.schema()})]})}fromSchema(e){W(e,tk);const t=j(e,e,Ct.schema({names:{tagNumber:this.type,attributes:Gs}}));P.assertSchema(t,this.className),this.type=t.result.idBlock.tagNumber,this.encodedValue=Ee.toArrayBuffer(t.result.valueBeforeDecodeView);const r=new Uint8Array(this.encodedValue);if(r[0]=49,!(Gs in t.result)){if(this.type===0)throw new Error("Wrong structure of SignedUnsignedAttributes");return}this.attributes=Array.from(t.result.attributes,a=>new mt({schema:a}))}toSchema(){if(Ct.compareWithDefault(Dn,this.type)||Ct.compareWithDefault(Gs,this.attributes))throw new Error('Incorrectly initialized "SignedAndUnsignedAttributes" class');return new N({optional:!0,idBlock:{tagClass:3,tagNumber:this.type},value:Array.from(this.attributes,e=>e.toSchema())})}toJSON(){if(Ct.compareWithDefault(Dn,this.type)||Ct.compareWithDefault(Gs,this.attributes))throw new Error('Incorrectly initialized "SignedAndUnsignedAttributes" class');return{type:this.type,attributes:Array.from(this.attributes,e=>e.toJSON())}}}Ct.CLASS_NAME="SignedAndUnsignedAttributes";const Bl="version",Ri="sid",xl="digestAlgorithm",za="signedAttrs",Nl="signatureAlgorithm",wf="signature",Xa="unsignedAttrs",Tn="SignerInfo",Ig=`${Tn}.${Bl}`,Sf=`${Tn}.${Ri}`,Bg=`${Tn}.${xl}`,e0=`${Tn}.${za}`,xg=`${Tn}.${Nl}`,Ng=`${Tn}.${wf}`,t0=`${Tn}.${Xa}`,rk=[Ig,Sf,Bg,e0,xg,Ng,t0];class kt extends G{constructor(e={}){super(),this.version=m(e,Bl,kt.defaultValues(Bl)),this.sid=m(e,Ri,kt.defaultValues(Ri)),this.digestAlgorithm=m(e,xl,kt.defaultValues(xl)),za in e&&(this.signedAttrs=m(e,za,kt.defaultValues(za))),this.signatureAlgorithm=m(e,Nl,kt.defaultValues(Nl)),this.signature=m(e,wf,kt.defaultValues(wf)),Xa in e&&(this.unsignedAttrs=m(e,Xa,kt.defaultValues(Xa))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Bl:return 0;case Ri:return new xe;case xl:return new $;case za:return new Ct({type:0});case Nl:return new $;case wf:return new z;case Xa:return new Ct({type:1});default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Bl:return kt.defaultValues(Bl)===t;case Ri:return t instanceof xe;case xl:return t instanceof $?t.isEqual(kt.defaultValues(xl)):!1;case za:return Ct.compareWithDefault("type",t.type)&&Ct.compareWithDefault("attributes",t.attributes)&&Ct.compareWithDefault("encodedValue",t.encodedValue);case Nl:return t instanceof $?t.isEqual(kt.defaultValues(Nl)):!1;case wf:case Xa:return Ct.compareWithDefault("type",t.type)&&Ct.compareWithDefault("attributes",t.attributes)&&Ct.compareWithDefault("encodedValue",t.encodedValue);default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:Tn,value:[new _({name:t.version||Ig}),new wt({value:[Lt.schema(t.sidSchema||{names:{blockName:Sf}}),new wt({value:[new N({optional:!0,name:t.sid||Sf,idBlock:{tagClass:3,tagNumber:0},value:[new z]}),new Ie({optional:!0,name:t.sid||Sf,idBlock:{tagClass:3,tagNumber:0}})]})]}),$.schema(t.digestAlgorithm||{names:{blockName:Bg}}),Ct.schema(t.signedAttrs||{names:{blockName:e0,tagNumber:0}}),$.schema(t.signatureAlgorithm||{names:{blockName:xg}}),new z({name:t.signature||Ng}),Ct.schema(t.unsignedAttrs||{names:{blockName:t0,tagNumber:1}})]})}fromSchema(e){W(e,rk);const t=j(e,e,kt.schema());P.assertSchema(t,this.className),this.version=t.result[Ig].valueBlock.valueDec;const r=t.result[Sf];r.idBlock.tagClass===1?this.sid=new Lt({schema:r}):this.sid=r,this.digestAlgorithm=new $({schema:t.result[Bg]}),e0 in t.result&&(this.signedAttrs=new Ct({type:0,schema:t.result[e0]})),this.signatureAlgorithm=new $({schema:t.result[xg]}),this.signature=t.result[Ng],t0 in t.result&&(this.unsignedAttrs=new Ct({type:1,schema:t.result[t0]}))}toSchema(){if(kt.compareWithDefault(Ri,this.sid))throw new Error('Incorrectly initialized "SignerInfo" class');const e=[];return e.push(new _({value:this.version})),this.sid instanceof Lt?e.push(this.sid.toSchema()):e.push(this.sid),e.push(this.digestAlgorithm.toSchema()),this.signedAttrs&&kt.compareWithDefault(za,this.signedAttrs)===!1&&e.push(this.signedAttrs.toSchema()),e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),this.unsignedAttrs&&kt.compareWithDefault(Xa,this.unsignedAttrs)===!1&&e.push(this.unsignedAttrs.toSchema()),new b({value:e})}toJSON(){if(kt.compareWithDefault(Ri,this.sid))throw new Error('Incorrectly initialized "SignerInfo" class');const e={version:this.version,digestAlgorithm:this.digestAlgorithm.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};return this.sid instanceof xe||(e.sid=this.sid.toJSON()),this.signedAttrs&&kt.compareWithDefault(za,this.signedAttrs)===!1&&(e.signedAttrs=this.signedAttrs.toJSON()),this.unsignedAttrs&&kt.compareWithDefault(Xa,this.unsignedAttrs)===!1&&(e.unsignedAttrs=this.unsignedAttrs.toJSON()),e}}kt.CLASS_NAME="SignerInfo";const Cf="version",Af="policy",Ef="messageImprint",bf="serialNumber",kf="genTime",Vi="ordering",_i="nonce",Tl="accuracy",Rl="tsa",Vl="extensions",ps="TSTInfo",Tg=`${ps}.${Cf}`,Rg=`${ps}.${Af}`,Vg=`${ps}.${Ef}`,_g=`${ps}.${bf}`,$g=`${ps}.${kf}`,r0=`${ps}.${Tl}`,s0=`${ps}.${Vi}`,a0=`${ps}.${_i}`,n0=`${ps}.${Rl}`,i0=`${ps}.${Vl}`,sk=[Tg,Rg,Vg,_g,$g,r0,s0,a0,n0,i0];class ir extends G{constructor(e={}){super(),this.version=m(e,Cf,ir.defaultValues(Cf)),this.policy=m(e,Af,ir.defaultValues(Af)),this.messageImprint=m(e,Ef,ir.defaultValues(Ef)),this.serialNumber=m(e,bf,ir.defaultValues(bf)),this.genTime=m(e,kf,ir.defaultValues(kf)),Tl in e&&(this.accuracy=m(e,Tl,ir.defaultValues(Tl))),Vi in e&&(this.ordering=m(e,Vi,ir.defaultValues(Vi))),_i in e&&(this.nonce=m(e,_i,ir.defaultValues(_i))),Rl in e&&(this.tsa=m(e,Rl,ir.defaultValues(Rl))),Vl in e&&(this.extensions=m(e,Vl,ir.defaultValues(Vl))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Cf:return 0;case Af:return S;case Ef:return new sr;case bf:return new _;case kf:return new Date(0,0,0);case Tl:return new $r;case Vi:return!1;case _i:return new _;case Rl:return new ze;case Vl:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Cf:case Af:case kf:case Vi:return t===ir.defaultValues(Vi);case Ef:return sr.compareWithDefault(Ki,t.hashAlgorithm)&&sr.compareWithDefault(Mi,t.hashedMessage);case bf:case _i:return t.isEqual(ir.defaultValues(_i));case Tl:return $r.compareWithDefault(ya,t.seconds)&&$r.compareWithDefault(va,t.millis)&&$r.compareWithDefault(wa,t.micros);case Rl:return ze.compareWithDefault(Du,t.type)&&ze.compareWithDefault(Lu,t.value);case Vl:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||ps,value:[new _({name:t.version||Tg}),new he({name:t.policy||Rg}),sr.schema(t.messageImprint||{names:{blockName:Vg}}),new _({name:t.serialNumber||_g}),new vt({name:t.genTime||$g}),$r.schema(t.accuracy||{names:{blockName:r0}}),new _s({name:t.ordering||s0,optional:!0}),new _({name:t.nonce||a0,optional:!0}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[ze.schema(t.tsa||{names:{blockName:n0}})]}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new _e({name:t.extensions||i0,value:Tt.schema(t.extension||{})})]})]})}fromSchema(e){W(e,sk);const t=j(e,e,ir.schema());P.assertSchema(t,this.className),this.version=t.result[Tg].valueBlock.valueDec,this.policy=t.result[Rg].valueBlock.toString(),this.messageImprint=new sr({schema:t.result[Vg]}),this.serialNumber=t.result[_g],this.genTime=t.result[$g].toDate(),r0 in t.result&&(this.accuracy=new $r({schema:t.result[r0]})),s0 in t.result&&(this.ordering=t.result[s0].valueBlock.value),a0 in t.result&&(this.nonce=t.result[a0]),n0 in t.result&&(this.tsa=new ze({schema:t.result[n0]})),i0 in t.result&&(this.extensions=Array.from(t.result[i0],r=>new Tt({schema:r})))}toSchema(){const e=[];return e.push(new _({value:this.version})),e.push(new he({value:this.policy})),e.push(this.messageImprint.toSchema()),e.push(this.serialNumber),e.push(new vt({valueDate:this.genTime})),this.accuracy&&e.push(this.accuracy.toSchema()),this.ordering!==void 0&&e.push(new _s({value:this.ordering})),this.nonce&&e.push(this.nonce),this.tsa&&e.push(new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.tsa.toSchema()]})),this.extensions&&e.push(new N({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.extensions,t=>t.toSchema())})),new b({value:e})}toJSON(){const e={version:this.version,policy:this.policy,messageImprint:this.messageImprint.toJSON(),serialNumber:this.serialNumber.toJSON(),genTime:this.genTime};return this.accuracy&&(e.accuracy=this.accuracy.toJSON()),this.ordering!==void 0&&(e.ordering=this.ordering),this.nonce&&(e.nonce=this.nonce.toJSON()),this.tsa&&(e.tsa=this.tsa.toJSON()),this.extensions&&(e.extensions=Array.from(this.extensions,t=>t.toJSON())),e}async verify(e,t=Le(!0)){if(!e.data)throw new Error('"data" is a mandatory attribute for TST_INFO verification');const r=e.data;if(e.notBefore&&this.genTime<e.notBefore)throw new Error("Generation time for TSTInfo object is less than notBefore value");if(e.notAfter&&this.genTime>e.notAfter)throw new Error("Generation time for TSTInfo object is more than notAfter value");const a=t.getAlgorithmByOID(this.messageImprint.hashAlgorithm.algorithmId,!0,"MessageImprint.hashAlgorithm"),n=await t.digest(a.name,new Uint8Array(r));return Ee.isEqual(n,this.messageImprint.hashedMessage.valueBlock.valueHexView)}}ir.CLASS_NAME="TSTInfo";const _l="version",If="digestAlgorithms",Bf="encapContentInfo",$l="certificates",Dl="crls",xf="signerInfos",Ru="ocsps",uo="SignedData",Dg=`${uo}.${_l}`,o0=`${uo}.${If}`,Lg=`${uo}.${Bf}`,l0=`${uo}.${$l}`,u0=`${uo}.${Dl}`,c0=`${uo}.${xf}`,ak=[Dg,o0,Lg,l0,u0,c0];class nr extends Error{constructor({message:e,code:t=0,date:r=new Date,signatureVerified:a=null,signerCertificate:n=null,signerCertificateVerified:i=null,timestampSerial:o=null,certificatePath:l=[]}){super(e),this.name="SignedDataVerifyError",this.date=r,this.code=t,this.timestampSerial=o,this.signatureVerified=a,this.signerCertificate=n,this.signerCertificateVerified=i,this.certificatePath=l}}class er extends G{constructor(e={}){super(),this.version=m(e,_l,er.defaultValues(_l)),this.digestAlgorithms=m(e,If,er.defaultValues(If)),this.encapContentInfo=m(e,Bf,er.defaultValues(Bf)),$l in e&&(this.certificates=m(e,$l,er.defaultValues($l))),Dl in e&&(this.crls=m(e,Dl,er.defaultValues(Dl))),Ru in e&&(this.ocsps=m(e,Ru,er.defaultValues(Ru))),this.signerInfos=m(e,xf,er.defaultValues(xf)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case _l:return 0;case If:return[];case Bf:return new br;case $l:return[];case Dl:return[];case Ru:return[];case xf:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case _l:return t===er.defaultValues(_l);case Bf:return br.compareWithDefault("eContentType",t.eContentType)&&br.compareWithDefault("eContent",t.eContent);case If:case $l:case Dl:case Ru:case xf:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return t.optional===void 0&&(t.optional=!1),new b({name:t.blockName||uo,optional:t.optional,value:[new _({name:t.version||Dg}),new Bt({value:[new _e({name:t.digestAlgorithms||o0,value:$.schema()})]}),br.schema(t.encapContentInfo||{names:{blockName:Lg}}),new N({name:t.certificates||l0,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Ts.schema().valueBlock.value}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:oa.schema(t.crls||{names:{crls:u0}}).valueBlock.value}),new Bt({value:[new _e({name:t.signerInfos||c0,value:kt.schema()})]})]})}fromSchema(e){W(e,ak);const t=j(e,e,er.schema());if(P.assertSchema(t,this.className),this.version=t.result[Dg].valueBlock.valueDec,o0 in t.result&&(this.digestAlgorithms=Array.from(t.result[o0],r=>new $({schema:r}))),this.encapContentInfo=new br({schema:t.result[Lg]}),l0 in t.result){const r=new Ts({schema:new Bt({value:t.result[l0].valueBlock.value})});this.certificates=r.certificates.slice(0)}u0 in t.result&&(this.crls=Array.from(t.result[u0],r=>r.idBlock.tagClass===1?new Ot({schema:r}):(r.idBlock.tagClass=1,r.idBlock.tagNumber=16,new ia({schema:r})))),c0 in t.result&&(this.signerInfos=Array.from(t.result[c0],r=>new kt({schema:r})))}toSchema(e=!1){const t=[];if(this.certificates&&this.certificates.length&&this.certificates.some(r=>r instanceof An)||this.crls&&this.crls.length&&this.crls.some(r=>r instanceof ia)?this.version=5:this.certificates&&this.certificates.length&&this.certificates.some(r=>r instanceof Pr)?this.version=4:this.certificates&&this.certificates.length&&this.certificates.some(r=>r instanceof Zs)||this.signerInfos.some(r=>r.version===3)||this.encapContentInfo.eContentType!==er.ID_DATA?this.version=3:this.version=1,t.push(new _({value:this.version})),t.push(new Bt({value:Array.from(this.digestAlgorithms,r=>r.toSchema())})),t.push(this.encapContentInfo.toSchema()),this.certificates){const a=new Ts({certificates:this.certificates}).toSchema();t.push(new N({idBlock:{tagClass:3,tagNumber:0},value:a.valueBlock.value}))}return this.crls&&t.push(new N({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.crls,r=>{if(r instanceof ia){const a=r.toSchema();return a.idBlock.tagClass=3,a.idBlock.tagNumber=1,a}return r.toSchema(e)})})),t.push(new Bt({value:Array.from(this.signerInfos,r=>r.toSchema())})),new b({value:t})}toJSON(){const e={version:this.version,digestAlgorithms:Array.from(this.digestAlgorithms,t=>t.toJSON()),encapContentInfo:this.encapContentInfo.toJSON(),signerInfos:Array.from(this.signerInfos,t=>t.toJSON())};return this.certificates&&(e.certificates=Array.from(this.certificates,t=>t.toJSON())),this.crls&&(e.crls=Array.from(this.crls,t=>t.toJSON())),e}async verify({signer:e=-1,data:t=$t,trustedCerts:r=[],checkDate:a=new Date,checkChain:n=!1,passedWhenNotRevValues:i=!1,extendedMode:o=!1,findOrigin:l=null,findIssuer:u=null}={},c=Le(!0)){let f=null,g=null;try{let v=$t,p=S,h=[];const d=this.signerInfos[e];if(!d)throw new nr({date:a,code:1,message:"Unable to get signer by supplied index"});if(!this.certificates)throw new nr({date:a,code:2,message:"No certificates attached to this signed data"});if(d.sid instanceof Lt){for(const R of this.certificates)if(R instanceof Xe&&R.issuer.isEqual(d.sid.issuer)&&R.serialNumber.isEqual(d.sid.serialNumber)){f=R;break}}else{const R=d.sid,V=R.idBlock.isConstructed?R.valueBlock.value[0].valueBlock.valueHex:R.valueBlock.valueHex;for(const L of this.certificates){if(!(L instanceof Xe))continue;const ne=await c.digest({name:"sha-1"},L.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView);if(su(ne,V)){f=L;break}}}if(!f)throw new nr({date:a,code:3,message:"Unable to find signer certificate"});if(this.encapContentInfo.eContentType===lE){if(!this.encapContentInfo.eContent)throw new nr({date:a,code:15,message:"Error during verification: TSTInfo eContent is empty",signatureVerified:null,signerCertificate:f,timestampSerial:g,signerCertificateVerified:!0});let R;try{R=ir.fromBER(this.encapContentInfo.eContent.valueBlock.valueHexView)}catch{throw new nr({date:a,code:15,message:"Error during verification: TSTInfo wrong ASN.1 schema ",signatureVerified:null,signerCertificate:f,timestampSerial:g,signerCertificateVerified:!0})}if(a=R.genTime,g=R.serialNumber.valueBlock.valueHexView.slice(),t.byteLength===0)throw new nr({date:a,code:4,message:"Missed detached data input array"});if(!await R.verify({data:t},c))throw new nr({date:a,code:15,message:"Error during verification: TSTInfo verification is failed",signatureVerified:!1,signerCertificate:f,timestampSerial:g,signerCertificateVerified:!0})}if(n){const R=this.certificates.filter(se=>se instanceof Xe&&!!u1(se,f)),V={checkDate:a,certs:R,trustedCerts:r};u&&(V.findIssuer=u),l&&(V.findOrigin=l);const L=new ud(V);if(L.certs.push(f),this.crls)for(const se of this.crls)"thisUpdate"in se?L.crls.push(se):se.otherRevInfoFormat===Uh&&L.ocsps.push(new jr({schema:se.otherRevInfo}));this.ocsps&&L.ocsps.push(...this.ocsps);const ne=await L.verify({passedWhenNotRevValues:i},c).catch(se=>{throw new nr({date:a,code:5,message:`Validation of signer's certificate failed with error: ${se instanceof Object?se.resultMessage:se}`,signerCertificate:f,signerCertificateVerified:!1})});if(ne.certificatePath&&(h=ne.certificatePath),!ne.result)throw new nr({date:a,code:5,message:`Validation of signer's certificate failed: ${ne.resultMessage}`,signerCertificate:f,signerCertificateVerified:!1})}const y=c.getAlgorithmByOID(d.digestAlgorithm.algorithmId);if(!("name"in y))throw new nr({date:a,code:7,message:`Unsupported signature algorithm: ${d.digestAlgorithm.algorithmId}`,signerCertificate:f,signerCertificateVerified:!0});p=y.name;const E=this.encapContentInfo.eContent;if(E)E.idBlock.tagClass===1&&E.idBlock.tagNumber===4?t=E.getValue():t=E.valueBlock.valueBeforeDecodeView;else if(t.byteLength===0)throw new nr({date:a,code:8,message:"Missed detached data input array",signerCertificate:f,signerCertificateVerified:!0});if(d.signedAttrs){let R=!1,V=!1;for(const L of d.signedAttrs.attributes)if(L.type==="1.2.840.113549.1.9.3"&&(R=!0),L.type==="1.2.840.113549.1.9.4"&&(V=!0,v=L.values[0].valueBlock.valueHex),R&&V)break;if(R===!1)throw new nr({date:a,code:9,message:'Attribute "content-type" is a mandatory attribute for "signed attributes"',signerCertificate:f,signerCertificateVerified:!0});if(V===!1)throw new nr({date:a,code:10,message:'Attribute "message-digest" is a mandatory attribute for "signed attributes"',signatureVerified:null,signerCertificate:f,signerCertificateVerified:!0})}if(d.signedAttrs){const R=await c.digest(p,new Uint8Array(t));if(!su(R,v))throw new nr({date:a,code:15,message:"Error during verification: Message digest doesn't match",signatureVerified:null,signerCertificate:f,timestampSerial:g,signerCertificateVerified:!0});t=d.signedAttrs.encodedValue}const k=await c.verifyWithPublicKey(t,d.signature,f.subjectPublicKeyInfo,f.signatureAlgorithm,p);return o?{date:a,code:14,message:S,signatureVerified:k,signerCertificate:f,timestampSerial:g,signerCertificateVerified:!0,certificatePath:h}:k}catch(v){throw v instanceof nr?v:new nr({date:a,code:15,message:`Error during verification: ${v instanceof Error?v.message:v}`,signatureVerified:null,signerCertificate:f,timestampSerial:g,signerCertificateVerified:!0})}}async sign(e,t,r="SHA-1",a=$t,n=Le(!0)){if(!e)throw new Error("Need to provide a private key for signing");const i=n.getOIDByAlgorithm({name:r},!0,"hashAlgorithm");this.digestAlgorithms.filter(f=>f.algorithmId===i).length===0&&this.digestAlgorithms.push(new $({algorithmId:i,algorithmParams:new It}));const o=this.signerInfos[t];if(!o)throw new RangeError("SignerInfo index is out of range");o.digestAlgorithm=new $({algorithmId:i,algorithmParams:new It});const l=await n.getSignatureParameters(e,r),u=l.parameters;if(o.signatureAlgorithm=l.signatureAlgorithm,o.signedAttrs)if(o.signedAttrs.encodedValue.byteLength!==0)a=o.signedAttrs.encodedValue;else{a=o.signedAttrs.toSchema().toBER();const f=Ee.toUint8Array(a);f[0]=49}else{const f=this.encapContentInfo.eContent;if(f)f.idBlock.tagClass===1&&f.idBlock.tagNumber===4?a=f.getValue():a=f.valueBlock.valueBeforeDecodeView;else if(a.byteLength===0)throw new Error("Missed detached data input array")}const c=await n.signWithPrivateKey(a,e,u);o.signature=new z({valueHex:c})}}er.CLASS_NAME="SignedData";er.ID_DATA=ym;const $i="version",Di="authSafe",js="macData",Vu="parsedValue",nk=[$i,Di,js];class sn extends G{constructor(e={}){super(),this.version=m(e,$i,sn.defaultValues($i)),this.authSafe=m(e,Di,sn.defaultValues(Di)),js in e&&(this.macData=m(e,js,sn.defaultValues(js))),Vu in e&&(this.parsedValue=m(e,Vu,sn.defaultValues(Vu))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case $i:return 3;case Di:return new ft;case js:return new mr;case Vu:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case $i:return t===sn.defaultValues(e);case Di:return ft.compareWithDefault("contentType",t.contentType)&&ft.compareWithDefault("content",t.content);case js:return mr.compareWithDefault("mac",t.mac)&&mr.compareWithDefault("macSalt",t.macSalt)&&mr.compareWithDefault("iterations",t.iterations);case Vu:return t instanceof Object&&Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _({name:t.version||$i}),ft.schema(t.authSafe||{names:{blockName:Di}}),mr.schema(t.macData||{names:{blockName:js,optional:!0}})]})}fromSchema(e){W(e,nk);const t=j(e,e,sn.schema({names:{version:$i,authSafe:{names:{blockName:Di}},macData:{names:{blockName:js}}}}));P.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.authSafe=new ft({schema:t.result.authSafe}),js in t.result&&(this.macData=new mr({schema:t.result.macData}))}toSchema(){const e=[new _({value:this.version}),this.authSafe.toSchema()];return this.macData&&e.push(this.macData.toSchema()),new b({value:e})}toJSON(){const e={version:this.version,authSafe:this.authSafe.toJSON()};return this.macData&&(e.macData=this.macData.toJSON()),e}async makeInternalValues(e={},t=Le(!0)){if(tt.assert(e,"parameters","object"),!this.parsedValue)throw new Error('Please call "parseValues" function first in order to make "parsedValue" data');switch(Ge.assertEmpty(this.parsedValue.integrityMode,"integrityMode","parsedValue"),Ge.assertEmpty(this.parsedValue.authenticatedSafe,"authenticatedSafe","parsedValue"),this.parsedValue.integrityMode){case 0:{if(!("iterations"in e))throw new Ge("iterations");Ge.assertEmpty(e.pbkdf2HashAlgorithm,"pbkdf2HashAlgorithm"),Ge.assertEmpty(e.hmacHashAlgorithm,"hmacHashAlgorithm"),Ge.assertEmpty(e.password,"password");const r=new ArrayBuffer(64),a=new Uint8Array(r);t.getRandomValues(a);const n=this.parsedValue.authenticatedSafe.toSchema().toBER(!1);this.authSafe=new ft({contentType:ft.DATA,content:new z({valueHex:n})});const i=await t.stampDataWithPassword({password:e.password,hashAlgorithm:e.hmacHashAlgorithm,salt:r,iterationCount:e.iterations,contentToStamp:n});this.macData=new mr({mac:new Qr({digestAlgorithm:new $({algorithmId:t.getOIDByAlgorithm({name:e.hmacHashAlgorithm},!0,"hmacHashAlgorithm")}),digest:new z({valueHex:i})}),macSalt:new z({valueHex:r}),iterations:e.iterations})}break;case 1:{if(!("signingCertificate"in e))throw new Ge("signingCertificate");Ge.assertEmpty(e.privateKey,"privateKey"),Ge.assertEmpty(e.hashAlgorithm,"hashAlgorithm");const r=this.parsedValue.authenticatedSafe.toSchema().toBER(!1),a=new er({version:1,encapContentInfo:new br({eContentType:"1.2.840.113549.1.7.1",eContent:new z({valueHex:r})}),certificates:[e.signingCertificate]}),n=await t.digest({name:e.hashAlgorithm},new Uint8Array(r)),i=[];i.push(new mt({type:"1.2.840.113549.1.9.3",values:[new he({value:"1.2.840.113549.1.7.1"})]})),i.push(new mt({type:"1.2.840.113549.1.9.5",values:[new nu({valueDate:new Date})]})),i.push(new mt({type:"1.2.840.113549.1.9.4",values:[new z({valueHex:n})]})),a.signerInfos.push(new kt({version:1,sid:new Lt({issuer:e.signingCertificate.issuer,serialNumber:e.signingCertificate.serialNumber}),signedAttrs:new Ct({type:0,attributes:i})})),await a.sign(e.privateKey,0,e.hashAlgorithm,void 0,t),this.authSafe=new ft({contentType:"1.2.840.113549.1.7.2",content:a.toSchema(!0)})}break;default:throw new Error(`Parameter "integrityMode" has unknown value: ${this.parsedValue.integrityMode}`)}}async parseInternalValues(e,t=Le(!0)){switch(tt.assert(e,"parameters","object"),e.checkIntegrity===void 0&&(e.checkIntegrity=!0),this.parsedValue={},this.authSafe.contentType){case ft.DATA:{Ge.assertEmpty(e.password,"password"),this.parsedValue.integrityMode=0,tt.assert(this.authSafe.content,"authSafe.content",z);const r=this.authSafe.content.getValue();if(this.parsedValue.authenticatedSafe=ro.fromBER(r),e.checkIntegrity){if(!this.macData)throw new Error('Absent "macData" value, can not check PKCS#12 data integrity');const a=t.getAlgorithmByOID(this.macData.mac.digestAlgorithm.algorithmId,!0,"digestAlgorithm");if(!await t.verifyDataStampedWithPassword({password:e.password,hashAlgorithm:a.name,salt:Ee.toArrayBuffer(this.macData.macSalt.valueBlock.valueHexView),iterationCount:this.macData.iterations||1,contentToVerify:r,signatureToVerify:Ee.toArrayBuffer(this.macData.mac.digest.valueBlock.valueHexView)}))throw new Error("Integrity for the PKCS#12 data is broken!")}}break;case ft.SIGNED_DATA:{this.parsedValue.integrityMode=1;const r=new er({schema:this.authSafe.content}),a=r.encapContentInfo.eContent;Ge.assert(a,"eContent","cmsSigned.encapContentInfo"),tt.assert(a,"eContent",z);const n=a.getValue();if(this.parsedValue.authenticatedSafe=ro.fromBER(n),!await r.verify({signer:0,checkChain:!1},t))throw new Error("Integrity for the PKCS#12 data is broken!")}break;default:throw new Error(`Incorrect value for "this.authSafe.contentType": ${this.authSafe.contentType}`)}}}sn.CLASS_NAME="PFX";const Ll="status",Za="statusStrings",en="failInfo",ik=[Ll,Za,en];var $p;(function(s){s[s.granted=0]="granted",s[s.grantedWithMods=1]="grantedWithMods",s[s.rejection=2]="rejection",s[s.waiting=3]="waiting",s[s.revocationWarning=4]="revocationWarning",s[s.revocationNotification=5]="revocationNotification"})($p||($p={}));class Wr extends G{constructor(e={}){super(),this.status=m(e,Ll,Wr.defaultValues(Ll)),Za in e&&(this.statusStrings=m(e,Za,Wr.defaultValues(Za))),en in e&&(this.failInfo=m(e,en,Wr.defaultValues(en))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ll:return 2;case Za:return[];case en:return new He;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ll:return t===Wr.defaultValues(e);case Za:return t.length===0;case en:return t.isEqual(Wr.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||S,value:[new _({name:t.status||S}),new b({optional:!0,value:[new _e({name:t.statusStrings||S,value:new gs})]}),new He({name:t.failInfo||S,optional:!0})]})}fromSchema(e){W(e,ik);const t=j(e,e,Wr.schema({names:{status:Ll,statusStrings:Za,failInfo:en}}));P.assertSchema(t,this.className);const r=t.result.status;if(r.valueBlock.isHexOnly===!0||r.valueBlock.valueDec<0||r.valueBlock.valueDec>5)throw new Error('PKIStatusInfo "status" has invalid value');this.status=r.valueBlock.valueDec,Za in t.result&&(this.statusStrings=t.result.statusStrings),en in t.result&&(this.failInfo=t.result.failInfo)}toSchema(){const e=[];return e.push(new _({value:this.status})),this.statusStrings&&e.push(new b({optional:!0,value:this.statusStrings})),this.failInfo&&e.push(this.failInfo),new b({value:e})}toJSON(){const e={status:this.status};return this.statusStrings&&(e.statusStrings=Array.from(this.statusStrings,t=>t.toJSON())),this.failInfo&&(e.failInfo=this.failInfo.toJSON()),e}}Wr.CLASS_NAME="PKIStatusInfo";const Nf="version",Tf="messageImprint",Ol="reqPolicy",Pl="nonce",Ws="certReq",Ul="extensions",co="TimeStampReq",Og=`${co}.${Nf}`,Pg=`${co}.${Tf}`,f0=`${co}.${Ol}`,h0=`${co}.${Pl}`,d0=`${co}.${Ws}`,g0=`${co}.${Ul}`,ok=[Og,Pg,f0,h0,d0,g0];class Nr extends G{constructor(e={}){super(),this.version=m(e,Nf,Nr.defaultValues(Nf)),this.messageImprint=m(e,Tf,Nr.defaultValues(Tf)),Ol in e&&(this.reqPolicy=m(e,Ol,Nr.defaultValues(Ol))),Pl in e&&(this.nonce=m(e,Pl,Nr.defaultValues(Pl))),Ws in e&&(this.certReq=m(e,Ws,Nr.defaultValues(Ws))),Ul in e&&(this.extensions=m(e,Ul,Nr.defaultValues(Ul))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Nf:return 0;case Tf:return new sr;case Ol:return S;case Pl:return new _;case Ws:return!1;case Ul:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Nf:case Ol:case Ws:return t===Nr.defaultValues(e);case Tf:return sr.compareWithDefault("hashAlgorithm",t.hashAlgorithm)&&sr.compareWithDefault("hashedMessage",t.hashedMessage);case Pl:return t.isEqual(Nr.defaultValues(e));case Ul:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||co,value:[new _({name:t.version||Og}),sr.schema(t.messageImprint||{names:{blockName:Pg}}),new he({name:t.reqPolicy||f0,optional:!0}),new _({name:t.nonce||h0,optional:!0}),new _s({name:t.certReq||d0,optional:!0}),new N({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new _e({name:t.extensions||g0,value:Tt.schema()})]})]})}fromSchema(e){W(e,ok);const t=j(e,e,Nr.schema());P.assertSchema(t,this.className),this.version=t.result[Og].valueBlock.valueDec,this.messageImprint=new sr({schema:t.result[Pg]}),f0 in t.result&&(this.reqPolicy=t.result[f0].valueBlock.toString()),h0 in t.result&&(this.nonce=t.result[h0]),d0 in t.result&&(this.certReq=t.result[d0].valueBlock.value),g0 in t.result&&(this.extensions=Array.from(t.result[g0],r=>new Tt({schema:r})))}toSchema(){const e=[];return e.push(new _({value:this.version})),e.push(this.messageImprint.toSchema()),this.reqPolicy&&e.push(new he({value:this.reqPolicy})),this.nonce&&e.push(this.nonce),Ws in this&&Nr.compareWithDefault(Ws,this.certReq)===!1&&e.push(new _s({value:this.certReq})),this.extensions&&e.push(new N({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.extensions,t=>t.toSchema())})),new b({value:e})}toJSON(){const e={version:this.version,messageImprint:this.messageImprint.toJSON()};return this.reqPolicy!==void 0&&(e.reqPolicy=this.reqPolicy),this.nonce!==void 0&&(e.nonce=this.nonce.toJSON()),this.certReq!==void 0&&Nr.compareWithDefault(Ws,this.certReq)===!1&&(e.certReq=this.certReq),this.extensions&&(e.extensions=Array.from(this.extensions,t=>t.toJSON())),e}}Nr.CLASS_NAME="TimeStampReq";const Kl="status",Ml="timeStampToken",xm="TimeStampResp",Ug=`${xm}.${Kl}`,m0=`${xm}.${Ml}`,lk=[Ug,m0];class Lf extends G{constructor(e={}){super(),this.status=m(e,Kl,Lf.defaultValues(Kl)),Ml in e&&(this.timeStampToken=m(e,Ml,Lf.defaultValues(Ml))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Kl:return new Wr;case Ml:return new ft;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Kl:return Wr.compareWithDefault(Kl,t.status)&&!("statusStrings"in t)&&!("failInfo"in t);case Ml:return t.contentType===S&&t.content instanceof xe;default:return super.defaultValues(e)}}static schema(e={}){const t=m(e,"names",{});return new b({name:t.blockName||xm,value:[Wr.schema(t.status||{names:{blockName:Ug}}),ft.schema(t.timeStampToken||{names:{blockName:m0,optional:!0}})]})}fromSchema(e){W(e,lk);const t=j(e,e,Lf.schema());P.assertSchema(t,this.className),this.status=new Wr({schema:t.result[Ug]}),m0 in t.result&&(this.timeStampToken=new ft({schema:t.result[m0]}))}toSchema(){const e=[];return e.push(this.status.toSchema()),this.timeStampToken&&e.push(this.timeStampToken.toSchema()),new b({value:e})}toJSON(){const e={status:this.status.toJSON()};return this.timeStampToken&&(e.timeStampToken=this.timeStampToken.toJSON()),e}async sign(e,t,r=Le(!0)){return this.assertContentType(),new er({schema:this.timeStampToken.content}).sign(e,0,t,void 0,r)}async verify(e={signer:0,trustedCerts:[],data:$t},t=Le(!0)){return this.assertContentType(),new er({schema:this.timeStampToken.content}).verify(e,t)}assertContentType(){if(!this.timeStampToken)throw new Error("timeStampToken is absent in TSP response");if(this.timeStampToken.contentType!==t1)throw new Error(`Wrong format of timeStampToken: ${this.timeStampToken.contentType}`)}}Lf.CLASS_NAME="TimeStampResp";function uk(){if(typeof self<"u"){if("crypto"in self){let s="webcrypto";"webkitSubtle"in self.crypto&&(s="safari"),vp(s,new N0({name:s,crypto}))}}else if(typeof crypto<"u"&&"webcrypto"in crypto){const s="NodeJS ^15",e=crypto.webcrypto;vp(s,new N0({name:s,crypto:e}))}}uk();function Dp(s,e,t){const r=s.slice();return r[65]=e[t],r[67]=t,r}function Lp(s,e,t){const r=s.slice();return r[68]=e[t],r[67]=t,r}function Op(s,e,t){const r=s.slice();return r[70]=e[t],r[67]=t,r}function Pp(s,e,t){const r=s.slice();return r[72]=e[t],r[67]=t,r}function ck(s){let e;return{c(){e=Kt("No")},l(t){e=Mt(t,"No")},m(t,r){q(t,e,r)},d(t){t&&J(e)}}}function fk(s){let e;return{c(){e=Kt("Alias Name")},l(t){e=Mt(t,"Alias Name")},m(t,r){q(t,e,r)},d(t){t&&J(e)}}}function hk(s){let e,t,r,a,n,i,o,l,u,c,f,g,v,p,h,d;return e=new st({props:{class:"!p-4"}}),r=new st({props:{$$slots:{default:[ck]},$$scope:{ctx:s}}}),n=new st({props:{class:"w-64",$$slots:{default:[fk]},$$scope:{ctx:s}}}),o=new st({props:{class:"w-64"}}),u=new st({props:{class:"w-96"}}),f=new st({props:{class:"w-36"}}),v=new st({}),h=new st({}),{c(){K(e.$$.fragment),t=Z(),K(r.$$.fragment),a=Z(),K(n.$$.fragment),i=Z(),K(o.$$.fragment),l=Z(),K(u.$$.fragment),c=Z(),K(f.$$.fragment),g=Z(),K(v.$$.fragment),p=Z(),K(h.$$.fragment)},l(y){M(e.$$.fragment,y),t=ee(y),M(r.$$.fragment,y),a=ee(y),M(n.$$.fragment,y),i=ee(y),M(o.$$.fragment,y),l=ee(y),M(u.$$.fragment,y),c=ee(y),M(f.$$.fragment,y),g=ee(y),M(v.$$.fragment,y),p=ee(y),M(h.$$.fragment,y)},m(y,E){H(e,y,E),q(y,t,E),H(r,y,E),q(y,a,E),H(n,y,E),q(y,i,E),H(o,y,E),q(y,l,E),H(u,y,E),q(y,c,E),H(f,y,E),q(y,g,E),H(v,y,E),q(y,p,E),H(h,y,E),d=!0},p(y,E){const k={};E[2]&4096&&(k.$$scope={dirty:E,ctx:y}),r.$set(k);const R={};E[2]&4096&&(R.$$scope={dirty:E,ctx:y}),n.$set(R)},i(y){d||(D(e.$$.fragment,y),D(r.$$.fragment,y),D(n.$$.fragment,y),D(o.$$.fragment,y),D(u.$$.fragment,y),D(f.$$.fragment,y),D(v.$$.fragment,y),D(h.$$.fragment,y),d=!0)},o(y){O(e.$$.fragment,y),O(r.$$.fragment,y),O(n.$$.fragment,y),O(o.$$.fragment,y),O(u.$$.fragment,y),O(f.$$.fragment,y),O(v.$$.fragment,y),O(h.$$.fragment,y),d=!1},d(y){F(e,y),y&&J(t),F(r,y),y&&J(a),F(n,y),y&&J(i),F(o,y),y&&J(l),F(u,y),y&&J(c),F(f,y),y&&J(g),F(v,y),y&&J(p),F(h,y)}}}function Up(s){let e,t,r=s[14],a=[];for(let i=0;i<r.length;i+=1)a[i]=Kp(Pp(s,r,i));const n=i=>O(a[i],1,1,()=>{a[i]=null});return{c(){for(let i=0;i<a.length;i+=1)a[i].c();e=Vs()},l(i){for(let o=0;o<a.length;o+=1)a[o].l(i);e=Vs()},m(i,o){for(let l=0;l<a.length;l+=1)a[l].m(i,o);q(i,e,o),t=!0},p(i,o){if(o[0]&16384){r=i[14];let l;for(l=0;l<r.length;l+=1){const u=Pp(i,r,l);a[l]?(a[l].p(u,o),D(a[l],1)):(a[l]=Kp(u),a[l].c(),D(a[l],1),a[l].m(e.parentNode,e))}for(In(),l=r.length;l<a.length;l+=1)n(l);Bn()}},i(i){if(!t){for(let o=0;o<r.length;o+=1)D(a[o]);t=!0}},o(i){a=a.filter(Boolean);for(let o=0;o<a.length;o+=1)O(a[o]);t=!1},d(i){K0(a,i),i&&J(e)}}}function dk(s){let e=s[67]+1+"",t;return{c(){t=Kt(e)},l(r){t=Mt(r,e)},m(r,a){q(r,t,a)},p:xn,d(r){r&&J(t)}}}function gk(s){let e=s[72]+"",t;return{c(){t=Kt(e)},l(r){t=Mt(r,e)},m(r,a){q(r,t,a)},p(r,a){a[0]&16384&&e!==(e=r[72]+"")&&q0(t,e)},d(r){r&&J(t)}}}function mk(s){let e,t,r,a,n,i,o,l,u,c,f,g,v,p,h,d,y;return e=new we({props:{class:"!p-4"}}),r=new we({props:{class:"w-10",$$slots:{default:[dk]},$$scope:{ctx:s}}}),n=new we({props:{class:"w-64",$$slots:{default:[gk]},$$scope:{ctx:s}}}),o=new we({props:{class:"w-64"}}),u=new we({props:{class:"w-96"}}),f=new we({props:{class:"w-36"}}),v=new we({}),h=new st({}),{c(){K(e.$$.fragment),t=Z(),K(r.$$.fragment),a=Z(),K(n.$$.fragment),i=Z(),K(o.$$.fragment),l=Z(),K(u.$$.fragment),c=Z(),K(f.$$.fragment),g=Z(),K(v.$$.fragment),p=Z(),K(h.$$.fragment),d=Z()},l(E){M(e.$$.fragment,E),t=ee(E),M(r.$$.fragment,E),a=ee(E),M(n.$$.fragment,E),i=ee(E),M(o.$$.fragment,E),l=ee(E),M(u.$$.fragment,E),c=ee(E),M(f.$$.fragment,E),g=ee(E),M(v.$$.fragment,E),p=ee(E),M(h.$$.fragment,E),d=ee(E)},m(E,k){H(e,E,k),q(E,t,k),H(r,E,k),q(E,a,k),H(n,E,k),q(E,i,k),H(o,E,k),q(E,l,k),H(u,E,k),q(E,c,k),H(f,E,k),q(E,g,k),H(v,E,k),q(E,p,k),H(h,E,k),q(E,d,k),y=!0},p(E,k){const R={};k[2]&4096&&(R.$$scope={dirty:k,ctx:E}),r.$set(R);const V={};k[0]&16384|k[2]&4096&&(V.$$scope={dirty:k,ctx:E}),n.$set(V)},i(E){y||(D(e.$$.fragment,E),D(r.$$.fragment,E),D(n.$$.fragment,E),D(o.$$.fragment,E),D(u.$$.fragment,E),D(f.$$.fragment,E),D(v.$$.fragment,E),D(h.$$.fragment,E),y=!0)},o(E){O(e.$$.fragment,E),O(r.$$.fragment,E),O(n.$$.fragment,E),O(o.$$.fragment,E),O(u.$$.fragment,E),O(f.$$.fragment,E),O(v.$$.fragment,E),O(h.$$.fragment,E),y=!1},d(E){F(e,E),E&&J(t),F(r,E),E&&J(a),F(n,E),E&&J(i),F(o,E),E&&J(l),F(u,E),E&&J(c),F(f,E),E&&J(g),F(v,E),E&&J(p),F(h,E),E&&J(d)}}}function Kp(s){let e,t;return e=new Nn({props:{$$slots:{default:[mk]},$$scope:{ctx:s}}}),{c(){K(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,a){H(e,r,a),t=!0},p(r,a){const n={};a[0]&16384|a[2]&4096&&(n.$$scope={dirty:a,ctx:r}),e.$set(n)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){O(e.$$.fragment,r),t=!1},d(r){F(e,r)}}}function pk(s){let e,t,r;function a(i){s[30](i)}let n={style:"filled",id:"floating_filled",name:"floating_filled",type:"text",label:"Alias Name"};return s[5]!==void 0&&(n.value=s[5]),e=new Xf({props:n}),Qf.push(()=>Yf(e,"value",a,s[5])),{c(){K(e.$$.fragment)},l(i){M(e.$$.fragment,i)},m(i,o){H(e,i,o),r=!0},p(i,o){const l={};!t&&o[0]&32&&(t=!0,l.value=i[5],zf(()=>t=!1)),e.$set(l)},i(i){r||(D(e.$$.fragment,i),r=!0)},o(i){O(e.$$.fragment,i),r=!1},d(i){F(e,i)}}}function yk(s){let e,t,r;function a(i){s[31](i)}let n={style:"filled",id:"floating_filled2",name:"floating_filled2",type:"text",label:"PKCS#12 Password"};return s[6]!==void 0&&(n.value=s[6]),e=new Xf({props:n}),Qf.push(()=>Yf(e,"value",a,s[6])),{c(){K(e.$$.fragment)},l(i){M(e.$$.fragment,i)},m(i,o){H(e,i,o),r=!0},p(i,o){const l={};!t&&o[0]&64&&(t=!0,l.value=i[6],zf(()=>t=!1)),e.$set(l)},i(i){r||(D(e.$$.fragment,i),r=!0)},o(i){O(e.$$.fragment,i),r=!1},d(i){F(e,i)}}}function vk(s){let e,t,r;return{c(){e=M0("input"),this.h()},l(a){e=H0(a,"INPUT",{type:!0,id:!0,class:!0}),this.h()},h(){es(e,"type","file"),es(e,"id","RemoteCertUpload"),es(e,"class","block w-full disabled:cursor-not-allowed disabled:opacity-50 focus:border-blue-500 focus:ring-blue-500 dark:focus:border-blue-500 dark:focus:ring-blue-500 bg-gray-50 text-gray-900 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 border-gray-300 dark:border-gray-600 p-2.5 text-sm rounded-lg border !p-0 dark:text-gray-400")},m(a,n){q(a,e,n),t||(r=F0(e,"change",s[15]),t=!0)},p:xn,d(a){a&&J(e),t=!1,r()}}}function wk(s){let e;return{c(){e=Kt("Upload")},l(t){e=Mt(t,"Upload")},m(t,r){q(t,e,r)},d(t){t&&J(e)}}}function Sk(s){let e,t;return e=new J0({props:{color:"dark",$$slots:{default:[wk]},$$scope:{ctx:s}}}),e.$on("click",s[16]),{c(){K(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,a){H(e,r,a),t=!0},p(r,a){const n={};a[2]&4096&&(n.$$scope={dirty:a,ctx:r}),e.$set(n)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){O(e.$$.fragment,r),t=!1},d(r){F(e,r)}}}function Ck(s){let e,t,r,a,n,i,o,l,u,c,f,g,v,p,h,d;return e=new we({props:{class:"!p-4"}}),r=new we({props:{class:"w-10"}}),n=new we({props:{class:"w-64",$$slots:{default:[pk]},$$scope:{ctx:s}}}),o=new we({props:{class:"w-64",$$slots:{default:[yk]},$$scope:{ctx:s}}}),u=new we({props:{class:"w-96",$$slots:{default:[vk]},$$scope:{ctx:s}}}),f=new we({props:{class:"w-36",$$slots:{default:[Sk]},$$scope:{ctx:s}}}),v=new we({}),h=new we({}),{c(){K(e.$$.fragment),t=Z(),K(r.$$.fragment),a=Z(),K(n.$$.fragment),i=Z(),K(o.$$.fragment),l=Z(),K(u.$$.fragment),c=Z(),K(f.$$.fragment),g=Z(),K(v.$$.fragment),p=Z(),K(h.$$.fragment)},l(y){M(e.$$.fragment,y),t=ee(y),M(r.$$.fragment,y),a=ee(y),M(n.$$.fragment,y),i=ee(y),M(o.$$.fragment,y),l=ee(y),M(u.$$.fragment,y),c=ee(y),M(f.$$.fragment,y),g=ee(y),M(v.$$.fragment,y),p=ee(y),M(h.$$.fragment,y)},m(y,E){H(e,y,E),q(y,t,E),H(r,y,E),q(y,a,E),H(n,y,E),q(y,i,E),H(o,y,E),q(y,l,E),H(u,y,E),q(y,c,E),H(f,y,E),q(y,g,E),H(v,y,E),q(y,p,E),H(h,y,E),d=!0},p(y,E){const k={};E[0]&32|E[2]&4096&&(k.$$scope={dirty:E,ctx:y}),n.$set(k);const R={};E[0]&64|E[2]&4096&&(R.$$scope={dirty:E,ctx:y}),o.$set(R);const V={};E[2]&4096&&(V.$$scope={dirty:E,ctx:y}),u.$set(V);const L={};E[2]&4096&&(L.$$scope={dirty:E,ctx:y}),f.$set(L)},i(y){d||(D(e.$$.fragment,y),D(r.$$.fragment,y),D(n.$$.fragment,y),D(o.$$.fragment,y),D(u.$$.fragment,y),D(f.$$.fragment,y),D(v.$$.fragment,y),D(h.$$.fragment,y),d=!0)},o(y){O(e.$$.fragment,y),O(r.$$.fragment,y),O(n.$$.fragment,y),O(o.$$.fragment,y),O(u.$$.fragment,y),O(f.$$.fragment,y),O(v.$$.fragment,y),O(h.$$.fragment,y),d=!1},d(y){F(e,y),y&&J(t),F(r,y),y&&J(a),F(n,y),y&&J(i),F(o,y),y&&J(l),F(u,y),y&&J(c),F(f,y),y&&J(g),F(v,y),y&&J(p),F(h,y)}}}function Ak(s){let e,t,r,a=s[13]==1&&Up(s);return t=new Nn({props:{$$slots:{default:[Ck]},$$scope:{ctx:s}}}),{c(){a&&a.c(),e=Z(),K(t.$$.fragment)},l(n){a&&a.l(n),e=ee(n),M(t.$$.fragment,n)},m(n,i){a&&a.m(n,i),q(n,e,i),H(t,n,i),r=!0},p(n,i){n[13]==1?a?(a.p(n,i),i[0]&8192&&D(a,1)):(a=Up(n),a.c(),D(a,1),a.m(e.parentNode,e)):a&&(In(),O(a,1,1,()=>{a=null}),Bn());const o={};i[0]&96|i[2]&4096&&(o.$$scope={dirty:i,ctx:n}),t.$set(o)},i(n){r||(D(a),D(t.$$.fragment,n),r=!0)},o(n){O(a),O(t.$$.fragment,n),r=!1},d(n){a&&a.d(n),n&&J(e),F(t,n)}}}function Ek(s){let e,t,r,a;return e=new W0({props:{$$slots:{default:[hk]},$$scope:{ctx:s}}}),r=new j0({props:{$$slots:{default:[Ak]},$$scope:{ctx:s}}}),{c(){K(e.$$.fragment),t=Z(),K(r.$$.fragment)},l(n){M(e.$$.fragment,n),t=ee(n),M(r.$$.fragment,n)},m(n,i){H(e,n,i),q(n,t,i),H(r,n,i),a=!0},p(n,i){const o={};i[2]&4096&&(o.$$scope={dirty:i,ctx:n}),e.$set(o);const l={};i[0]&24672|i[2]&4096&&(l.$$scope={dirty:i,ctx:n}),r.$set(l)},i(n){a||(D(e.$$.fragment,n),D(r.$$.fragment,n),a=!0)},o(n){O(e.$$.fragment,n),O(r.$$.fragment,n),a=!1},d(n){F(e,n),n&&J(t),F(r,n)}}}function bk(s){let e,t;return e=new G0({props:{shadow:!0,striped:!0,tableNoWFull:!0,$$slots:{default:[Ek]},$$scope:{ctx:s}}}),{c(){K(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,a){H(e,r,a),t=!0},p(r,a){const n={};a[0]&24672|a[2]&4096&&(n.$$scope={dirty:a,ctx:r}),e.$set(n)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){O(e.$$.fragment,r),t=!1},d(r){F(e,r)}}}function kk(s){let e;return{c(){e=Kt("No")},l(t){e=Mt(t,"No")},m(t,r){q(t,e,r)},d(t){t&&J(e)}}}function Ik(s){let e;return{c(){e=Kt("Alias Name")},l(t){e=Mt(t,"Alias Name")},m(t,r){q(t,e,r)},d(t){t&&J(e)}}}function Bk(s){let e,t,r,a,n,i,o,l,u,c,f,g,v,p;return e=new st({props:{class:"!p-4"}}),r=new st({props:{$$slots:{default:[kk]},$$scope:{ctx:s}}}),n=new st({props:{$$slots:{default:[Ik]},$$scope:{ctx:s}}}),o=new st({}),u=new st({}),f=new st({}),v=new st({}),{c(){K(e.$$.fragment),t=Z(),K(r.$$.fragment),a=Z(),K(n.$$.fragment),i=Z(),K(o.$$.fragment),l=Z(),K(u.$$.fragment),c=Z(),K(f.$$.fragment),g=Z(),K(v.$$.fragment)},l(h){M(e.$$.fragment,h),t=ee(h),M(r.$$.fragment,h),a=ee(h),M(n.$$.fragment,h),i=ee(h),M(o.$$.fragment,h),l=ee(h),M(u.$$.fragment,h),c=ee(h),M(f.$$.fragment,h),g=ee(h),M(v.$$.fragment,h)},m(h,d){H(e,h,d),q(h,t,d),H(r,h,d),q(h,a,d),H(n,h,d),q(h,i,d),H(o,h,d),q(h,l,d),H(u,h,d),q(h,c,d),H(f,h,d),q(h,g,d),H(v,h,d),p=!0},p(h,d){const y={};d[2]&4096&&(y.$$scope={dirty:d,ctx:h}),r.$set(y);const E={};d[2]&4096&&(E.$$scope={dirty:d,ctx:h}),n.$set(E)},i(h){p||(D(e.$$.fragment,h),D(r.$$.fragment,h),D(n.$$.fragment,h),D(o.$$.fragment,h),D(u.$$.fragment,h),D(f.$$.fragment,h),D(v.$$.fragment,h),p=!0)},o(h){O(e.$$.fragment,h),O(r.$$.fragment,h),O(n.$$.fragment,h),O(o.$$.fragment,h),O(u.$$.fragment,h),O(f.$$.fragment,h),O(v.$$.fragment,h),p=!1},d(h){F(e,h),h&&J(t),F(r,h),h&&J(a),F(n,h),h&&J(i),F(o,h),h&&J(l),F(u,h),h&&J(c),F(f,h),h&&J(g),F(v,h)}}}function Mp(s){let e,t,r=s[12],a=[];for(let i=0;i<r.length;i+=1)a[i]=Hp(Op(s,r,i));const n=i=>O(a[i],1,1,()=>{a[i]=null});return{c(){for(let i=0;i<a.length;i+=1)a[i].c();e=Vs()},l(i){for(let o=0;o<a.length;o+=1)a[o].l(i);e=Vs()},m(i,o){for(let l=0;l<a.length;l+=1)a[l].m(i,o);q(i,e,o),t=!0},p(i,o){if(o[0]&4096){r=i[12];let l;for(l=0;l<r.length;l+=1){const u=Op(i,r,l);a[l]?(a[l].p(u,o),D(a[l],1)):(a[l]=Hp(u),a[l].c(),D(a[l],1),a[l].m(e.parentNode,e))}for(In(),l=r.length;l<a.length;l+=1)n(l);Bn()}},i(i){if(!t){for(let o=0;o<r.length;o+=1)D(a[o]);t=!0}},o(i){a=a.filter(Boolean);for(let o=0;o<a.length;o+=1)O(a[o]);t=!1},d(i){K0(a,i),i&&J(e)}}}function xk(s){let e=s[67]+1+"",t;return{c(){t=Kt(e)},l(r){t=Mt(r,e)},m(r,a){q(r,t,a)},p:xn,d(r){r&&J(t)}}}function Nk(s){let e=s[70]+"",t;return{c(){t=Kt(e)},l(r){t=Mt(r,e)},m(r,a){q(r,t,a)},p(r,a){a[0]&4096&&e!==(e=r[70]+"")&&q0(t,e)},d(r){r&&J(t)}}}function Tk(s){let e,t,r,a,n,i,o,l,u,c,f,g,v,p,h;return e=new we({props:{class:"!p-4"}}),r=new we({props:{class:"w-10",$$slots:{default:[xk]},$$scope:{ctx:s}}}),n=new we({props:{class:"w-64",$$slots:{default:[Nk]},$$scope:{ctx:s}}}),o=new we({props:{class:"w-96"}}),u=new we({props:{class:"w-36"}}),f=new we({}),v=new we({}),{c(){K(e.$$.fragment),t=Z(),K(r.$$.fragment),a=Z(),K(n.$$.fragment),i=Z(),K(o.$$.fragment),l=Z(),K(u.$$.fragment),c=Z(),K(f.$$.fragment),g=Z(),K(v.$$.fragment),p=Z()},l(d){M(e.$$.fragment,d),t=ee(d),M(r.$$.fragment,d),a=ee(d),M(n.$$.fragment,d),i=ee(d),M(o.$$.fragment,d),l=ee(d),M(u.$$.fragment,d),c=ee(d),M(f.$$.fragment,d),g=ee(d),M(v.$$.fragment,d),p=ee(d)},m(d,y){H(e,d,y),q(d,t,y),H(r,d,y),q(d,a,y),H(n,d,y),q(d,i,y),H(o,d,y),q(d,l,y),H(u,d,y),q(d,c,y),H(f,d,y),q(d,g,y),H(v,d,y),q(d,p,y),h=!0},p(d,y){const E={};y[2]&4096&&(E.$$scope={dirty:y,ctx:d}),r.$set(E);const k={};y[0]&4096|y[2]&4096&&(k.$$scope={dirty:y,ctx:d}),n.$set(k)},i(d){h||(D(e.$$.fragment,d),D(r.$$.fragment,d),D(n.$$.fragment,d),D(o.$$.fragment,d),D(u.$$.fragment,d),D(f.$$.fragment,d),D(v.$$.fragment,d),h=!0)},o(d){O(e.$$.fragment,d),O(r.$$.fragment,d),O(n.$$.fragment,d),O(o.$$.fragment,d),O(u.$$.fragment,d),O(f.$$.fragment,d),O(v.$$.fragment,d),h=!1},d(d){F(e,d),d&&J(t),F(r,d),d&&J(a),F(n,d),d&&J(i),F(o,d),d&&J(l),F(u,d),d&&J(c),F(f,d),d&&J(g),F(v,d),d&&J(p)}}}function Hp(s){let e,t;return e=new Nn({props:{$$slots:{default:[Tk]},$$scope:{ctx:s}}}),{c(){K(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,a){H(e,r,a),t=!0},p(r,a){const n={};a[0]&4096|a[2]&4096&&(n.$$scope={dirty:a,ctx:r}),e.$set(n)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){O(e.$$.fragment,r),t=!1},d(r){F(e,r)}}}function Rk(s){let e,t,r;function a(i){s[32](i)}let n={style:"filled",id:"floating_filled",name:"floating_filled",type:"text",label:"Alias Name"};return s[2]!==void 0&&(n.value=s[2]),e=new Xf({props:n}),Qf.push(()=>Yf(e,"value",a,s[2])),{c(){K(e.$$.fragment)},l(i){M(e.$$.fragment,i)},m(i,o){H(e,i,o),r=!0},p(i,o){const l={};!t&&o[0]&4&&(t=!0,l.value=i[2],zf(()=>t=!1)),e.$set(l)},i(i){r||(D(e.$$.fragment,i),r=!0)},o(i){O(e.$$.fragment,i),r=!1},d(i){F(e,i)}}}function Vk(s){let e,t,r;return{c(){e=M0("input"),this.h()},l(a){e=H0(a,"INPUT",{type:!0,id:!0,class:!0}),this.h()},h(){es(e,"type","file"),es(e,"id","RemoteCertUpload"),es(e,"class","block w-full disabled:cursor-not-allowed disabled:opacity-50 focus:border-blue-500 focus:ring-blue-500 dark:focus:border-blue-500 dark:focus:ring-blue-500 bg-gray-50 text-gray-900 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 border-gray-300 dark:border-gray-600 p-2.5 text-sm rounded-lg border !p-0 dark:text-gray-400")},m(a,n){q(a,e,n),t||(r=F0(e,"change",s[17]),t=!0)},p:xn,d(a){a&&J(e),t=!1,r()}}}function _k(s){let e;return{c(){e=Kt("Upload")},l(t){e=Mt(t,"Upload")},m(t,r){q(t,e,r)},d(t){t&&J(e)}}}function $k(s){let e,t;return e=new J0({props:{color:"dark",$$slots:{default:[_k]},$$scope:{ctx:s}}}),e.$on("click",s[18]),{c(){K(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,a){H(e,r,a),t=!0},p(r,a){const n={};a[2]&4096&&(n.$$scope={dirty:a,ctx:r}),e.$set(n)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){O(e.$$.fragment,r),t=!1},d(r){F(e,r)}}}function Dk(s){let e,t,r,a,n,i,o,l,u,c,f,g,v,p;return e=new we({props:{class:"!p-4"}}),r=new we({props:{class:"w-10"}}),n=new we({props:{class:"w-64",$$slots:{default:[Rk]},$$scope:{ctx:s}}}),o=new we({props:{class:"w-96",$$slots:{default:[Vk]},$$scope:{ctx:s}}}),u=new we({props:{class:"w-36",$$slots:{default:[$k]},$$scope:{ctx:s}}}),f=new we({}),v=new we({}),{c(){K(e.$$.fragment),t=Z(),K(r.$$.fragment),a=Z(),K(n.$$.fragment),i=Z(),K(o.$$.fragment),l=Z(),K(u.$$.fragment),c=Z(),K(f.$$.fragment),g=Z(),K(v.$$.fragment)},l(h){M(e.$$.fragment,h),t=ee(h),M(r.$$.fragment,h),a=ee(h),M(n.$$.fragment,h),i=ee(h),M(o.$$.fragment,h),l=ee(h),M(u.$$.fragment,h),c=ee(h),M(f.$$.fragment,h),g=ee(h),M(v.$$.fragment,h)},m(h,d){H(e,h,d),q(h,t,d),H(r,h,d),q(h,a,d),H(n,h,d),q(h,i,d),H(o,h,d),q(h,l,d),H(u,h,d),q(h,c,d),H(f,h,d),q(h,g,d),H(v,h,d),p=!0},p(h,d){const y={};d[0]&4|d[2]&4096&&(y.$$scope={dirty:d,ctx:h}),n.$set(y);const E={};d[2]&4096&&(E.$$scope={dirty:d,ctx:h}),o.$set(E);const k={};d[2]&4096&&(k.$$scope={dirty:d,ctx:h}),u.$set(k)},i(h){p||(D(e.$$.fragment,h),D(r.$$.fragment,h),D(n.$$.fragment,h),D(o.$$.fragment,h),D(u.$$.fragment,h),D(f.$$.fragment,h),D(v.$$.fragment,h),p=!0)},o(h){O(e.$$.fragment,h),O(r.$$.fragment,h),O(n.$$.fragment,h),O(o.$$.fragment,h),O(u.$$.fragment,h),O(f.$$.fragment,h),O(v.$$.fragment,h),p=!1},d(h){F(e,h),h&&J(t),F(r,h),h&&J(a),F(n,h),h&&J(i),F(o,h),h&&J(l),F(u,h),h&&J(c),F(f,h),h&&J(g),F(v,h)}}}function Lk(s){let e,t,r,a=s[11]==1&&Mp(s);return t=new Nn({props:{$$slots:{default:[Dk]},$$scope:{ctx:s}}}),{c(){a&&a.c(),e=Z(),K(t.$$.fragment)},l(n){a&&a.l(n),e=ee(n),M(t.$$.fragment,n)},m(n,i){a&&a.m(n,i),q(n,e,i),H(t,n,i),r=!0},p(n,i){n[11]==1?a?(a.p(n,i),i[0]&2048&&D(a,1)):(a=Mp(n),a.c(),D(a,1),a.m(e.parentNode,e)):a&&(In(),O(a,1,1,()=>{a=null}),Bn());const o={};i[0]&4|i[2]&4096&&(o.$$scope={dirty:i,ctx:n}),t.$set(o)},i(n){r||(D(a),D(t.$$.fragment,n),r=!0)},o(n){O(a),O(t.$$.fragment,n),r=!1},d(n){a&&a.d(n),n&&J(e),F(t,n)}}}function Ok(s){let e,t,r,a;return e=new W0({props:{$$slots:{default:[Bk]},$$scope:{ctx:s}}}),r=new j0({props:{$$slots:{default:[Lk]},$$scope:{ctx:s}}}),{c(){K(e.$$.fragment),t=Z(),K(r.$$.fragment)},l(n){M(e.$$.fragment,n),t=ee(n),M(r.$$.fragment,n)},m(n,i){H(e,n,i),q(n,t,i),H(r,n,i),a=!0},p(n,i){const o={};i[2]&4096&&(o.$$scope={dirty:i,ctx:n}),e.$set(o);const l={};i[0]&6148|i[2]&4096&&(l.$$scope={dirty:i,ctx:n}),r.$set(l)},i(n){a||(D(e.$$.fragment,n),D(r.$$.fragment,n),a=!0)},o(n){O(e.$$.fragment,n),O(r.$$.fragment,n),a=!1},d(n){F(e,n),n&&J(t),F(r,n)}}}function Pk(s){let e,t;return e=new G0({props:{shadow:!0,striped:!0,tableNoWFull:!0,$$slots:{default:[Ok]},$$scope:{ctx:s}}}),{c(){K(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,a){H(e,r,a),t=!0},p(r,a){const n={};a[0]&6148|a[2]&4096&&(n.$$scope={dirty:a,ctx:r}),e.$set(n)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){O(e.$$.fragment,r),t=!1},d(r){F(e,r)}}}function Uk(s){let e;return{c(){e=Kt("No")},l(t){e=Mt(t,"No")},m(t,r){q(t,e,r)},d(t){t&&J(e)}}}function Kk(s){let e;return{c(){e=Kt("Alias Name")},l(t){e=Mt(t,"Alias Name")},m(t,r){q(t,e,r)},d(t){t&&J(e)}}}function Mk(s){let e,t,r,a,n,i,o,l,u,c,f,g,v,p;return e=new st({props:{class:"!p-4"}}),r=new st({props:{$$slots:{default:[Uk]},$$scope:{ctx:s}}}),n=new st({props:{$$slots:{default:[Kk]},$$scope:{ctx:s}}}),o=new st({}),u=new st({}),f=new st({}),v=new st({}),{c(){K(e.$$.fragment),t=Z(),K(r.$$.fragment),a=Z(),K(n.$$.fragment),i=Z(),K(o.$$.fragment),l=Z(),K(u.$$.fragment),c=Z(),K(f.$$.fragment),g=Z(),K(v.$$.fragment)},l(h){M(e.$$.fragment,h),t=ee(h),M(r.$$.fragment,h),a=ee(h),M(n.$$.fragment,h),i=ee(h),M(o.$$.fragment,h),l=ee(h),M(u.$$.fragment,h),c=ee(h),M(f.$$.fragment,h),g=ee(h),M(v.$$.fragment,h)},m(h,d){H(e,h,d),q(h,t,d),H(r,h,d),q(h,a,d),H(n,h,d),q(h,i,d),H(o,h,d),q(h,l,d),H(u,h,d),q(h,c,d),H(f,h,d),q(h,g,d),H(v,h,d),p=!0},p(h,d){const y={};d[2]&4096&&(y.$$scope={dirty:d,ctx:h}),r.$set(y);const E={};d[2]&4096&&(E.$$scope={dirty:d,ctx:h}),n.$set(E)},i(h){p||(D(e.$$.fragment,h),D(r.$$.fragment,h),D(n.$$.fragment,h),D(o.$$.fragment,h),D(u.$$.fragment,h),D(f.$$.fragment,h),D(v.$$.fragment,h),p=!0)},o(h){O(e.$$.fragment,h),O(r.$$.fragment,h),O(n.$$.fragment,h),O(o.$$.fragment,h),O(u.$$.fragment,h),O(f.$$.fragment,h),O(v.$$.fragment,h),p=!1},d(h){F(e,h),h&&J(t),F(r,h),h&&J(a),F(n,h),h&&J(i),F(o,h),h&&J(l),F(u,h),h&&J(c),F(f,h),h&&J(g),F(v,h)}}}function Fp(s){let e,t,r=s[8],a=[];for(let i=0;i<r.length;i+=1)a[i]=qp(Lp(s,r,i));const n=i=>O(a[i],1,1,()=>{a[i]=null});return{c(){for(let i=0;i<a.length;i+=1)a[i].c();e=Vs()},l(i){for(let o=0;o<a.length;o+=1)a[o].l(i);e=Vs()},m(i,o){for(let l=0;l<a.length;l+=1)a[l].m(i,o);q(i,e,o),t=!0},p(i,o){if(o[0]&256){r=i[8];let l;for(l=0;l<r.length;l+=1){const u=Lp(i,r,l);a[l]?(a[l].p(u,o),D(a[l],1)):(a[l]=qp(u),a[l].c(),D(a[l],1),a[l].m(e.parentNode,e))}for(In(),l=r.length;l<a.length;l+=1)n(l);Bn()}},i(i){if(!t){for(let o=0;o<r.length;o+=1)D(a[o]);t=!0}},o(i){a=a.filter(Boolean);for(let o=0;o<a.length;o+=1)O(a[o]);t=!1},d(i){K0(a,i),i&&J(e)}}}function Hk(s){let e=s[67]+1+"",t;return{c(){t=Kt(e)},l(r){t=Mt(r,e)},m(r,a){q(r,t,a)},p:xn,d(r){r&&J(t)}}}function Fk(s){let e=s[68]+"",t;return{c(){t=Kt(e)},l(r){t=Mt(r,e)},m(r,a){q(r,t,a)},p(r,a){a[0]&256&&e!==(e=r[68]+"")&&q0(t,e)},d(r){r&&J(t)}}}function qk(s){let e,t,r,a,n,i,o,l,u,c,f,g,v,p,h;return e=new we({props:{class:"!p-4"}}),r=new we({props:{class:"w-10",$$slots:{default:[Hk]},$$scope:{ctx:s}}}),n=new we({props:{class:"w-64",$$slots:{default:[Fk]},$$scope:{ctx:s}}}),o=new we({}),u=new we({}),f=new we({}),v=new we({}),{c(){K(e.$$.fragment),t=Z(),K(r.$$.fragment),a=Z(),K(n.$$.fragment),i=Z(),K(o.$$.fragment),l=Z(),K(u.$$.fragment),c=Z(),K(f.$$.fragment),g=Z(),K(v.$$.fragment),p=Z()},l(d){M(e.$$.fragment,d),t=ee(d),M(r.$$.fragment,d),a=ee(d),M(n.$$.fragment,d),i=ee(d),M(o.$$.fragment,d),l=ee(d),M(u.$$.fragment,d),c=ee(d),M(f.$$.fragment,d),g=ee(d),M(v.$$.fragment,d),p=ee(d)},m(d,y){H(e,d,y),q(d,t,y),H(r,d,y),q(d,a,y),H(n,d,y),q(d,i,y),H(o,d,y),q(d,l,y),H(u,d,y),q(d,c,y),H(f,d,y),q(d,g,y),H(v,d,y),q(d,p,y),h=!0},p(d,y){const E={};y[2]&4096&&(E.$$scope={dirty:y,ctx:d}),r.$set(E);const k={};y[0]&256|y[2]&4096&&(k.$$scope={dirty:y,ctx:d}),n.$set(k)},i(d){h||(D(e.$$.fragment,d),D(r.$$.fragment,d),D(n.$$.fragment,d),D(o.$$.fragment,d),D(u.$$.fragment,d),D(f.$$.fragment,d),D(v.$$.fragment,d),h=!0)},o(d){O(e.$$.fragment,d),O(r.$$.fragment,d),O(n.$$.fragment,d),O(o.$$.fragment,d),O(u.$$.fragment,d),O(f.$$.fragment,d),O(v.$$.fragment,d),h=!1},d(d){F(e,d),d&&J(t),F(r,d),d&&J(a),F(n,d),d&&J(i),F(o,d),d&&J(l),F(u,d),d&&J(c),F(f,d),d&&J(g),F(v,d),d&&J(p)}}}function qp(s){let e,t;return e=new Nn({props:{$$slots:{default:[qk]},$$scope:{ctx:s}}}),{c(){K(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,a){H(e,r,a),t=!0},p(r,a){const n={};a[0]&256|a[2]&4096&&(n.$$scope={dirty:a,ctx:r}),e.$set(n)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){O(e.$$.fragment,r),t=!1},d(r){F(e,r)}}}function Jk(s){let e,t,r;function a(i){s[33](i)}let n={style:"filled",id:"floating_filled",name:"floating_filled",type:"text",label:"Alias Name"};return s[3]!==void 0&&(n.value=s[3]),e=new Xf({props:n}),Qf.push(()=>Yf(e,"value",a,s[3])),{c(){K(e.$$.fragment)},l(i){M(e.$$.fragment,i)},m(i,o){H(e,i,o),r=!0},p(i,o){const l={};!t&&o[0]&8&&(t=!0,l.value=i[3],zf(()=>t=!1)),e.$set(l)},i(i){r||(D(e.$$.fragment,i),r=!0)},o(i){O(e.$$.fragment,i),r=!1},d(i){F(e,i)}}}function Gk(s){let e,t,r;return{c(){e=M0("input"),this.h()},l(a){e=H0(a,"INPUT",{type:!0,id:!0,class:!0}),this.h()},h(){es(e,"type","file"),es(e,"id","RemoteCertUpload"),es(e,"class","block w-full disabled:cursor-not-allowed disabled:opacity-50 focus:border-blue-500 focus:ring-blue-500 dark:focus:border-blue-500 dark:focus:ring-blue-500 bg-gray-50 text-gray-900 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 border-gray-300 dark:border-gray-600 p-2.5 text-sm rounded-lg border !p-0 dark:text-gray-400")},m(a,n){q(a,e,n),t||(r=F0(e,"change",s[21]),t=!0)},p:xn,d(a){a&&J(e),t=!1,r()}}}function jk(s){let e;return{c(){e=Kt("Upload")},l(t){e=Mt(t,"Upload")},m(t,r){q(t,e,r)},d(t){t&&J(e)}}}function Wk(s){let e,t;return e=new J0({props:{color:"dark",$$slots:{default:[jk]},$$scope:{ctx:s}}}),e.$on("click",s[22]),{c(){K(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,a){H(e,r,a),t=!0},p(r,a){const n={};a[2]&4096&&(n.$$scope={dirty:a,ctx:r}),e.$set(n)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){O(e.$$.fragment,r),t=!1},d(r){F(e,r)}}}function Qk(s){let e,t,r,a,n,i,o,l,u,c,f,g,v,p;return e=new we({props:{class:"!p-4"}}),r=new we({props:{class:"w-10"}}),n=new we({props:{class:"w-64",$$slots:{default:[Jk]},$$scope:{ctx:s}}}),o=new we({props:{class:"w-96",$$slots:{default:[Gk]},$$scope:{ctx:s}}}),u=new we({props:{class:"w-36",$$slots:{default:[Wk]},$$scope:{ctx:s}}}),f=new we({}),v=new we({}),{c(){K(e.$$.fragment),t=Z(),K(r.$$.fragment),a=Z(),K(n.$$.fragment),i=Z(),K(o.$$.fragment),l=Z(),K(u.$$.fragment),c=Z(),K(f.$$.fragment),g=Z(),K(v.$$.fragment)},l(h){M(e.$$.fragment,h),t=ee(h),M(r.$$.fragment,h),a=ee(h),M(n.$$.fragment,h),i=ee(h),M(o.$$.fragment,h),l=ee(h),M(u.$$.fragment,h),c=ee(h),M(f.$$.fragment,h),g=ee(h),M(v.$$.fragment,h)},m(h,d){H(e,h,d),q(h,t,d),H(r,h,d),q(h,a,d),H(n,h,d),q(h,i,d),H(o,h,d),q(h,l,d),H(u,h,d),q(h,c,d),H(f,h,d),q(h,g,d),H(v,h,d),p=!0},p(h,d){const y={};d[0]&8|d[2]&4096&&(y.$$scope={dirty:d,ctx:h}),n.$set(y);const E={};d[2]&4096&&(E.$$scope={dirty:d,ctx:h}),o.$set(E);const k={};d[2]&4096&&(k.$$scope={dirty:d,ctx:h}),u.$set(k)},i(h){p||(D(e.$$.fragment,h),D(r.$$.fragment,h),D(n.$$.fragment,h),D(o.$$.fragment,h),D(u.$$.fragment,h),D(f.$$.fragment,h),D(v.$$.fragment,h),p=!0)},o(h){O(e.$$.fragment,h),O(r.$$.fragment,h),O(n.$$.fragment,h),O(o.$$.fragment,h),O(u.$$.fragment,h),O(f.$$.fragment,h),O(v.$$.fragment,h),p=!1},d(h){F(e,h),h&&J(t),F(r,h),h&&J(a),F(n,h),h&&J(i),F(o,h),h&&J(l),F(u,h),h&&J(c),F(f,h),h&&J(g),F(v,h)}}}function Yk(s){let e,t,r,a=s[7]==1&&Fp(s);return t=new Nn({props:{$$slots:{default:[Qk]},$$scope:{ctx:s}}}),{c(){a&&a.c(),e=Z(),K(t.$$.fragment)},l(n){a&&a.l(n),e=ee(n),M(t.$$.fragment,n)},m(n,i){a&&a.m(n,i),q(n,e,i),H(t,n,i),r=!0},p(n,i){n[7]==1?a?(a.p(n,i),i[0]&128&&D(a,1)):(a=Fp(n),a.c(),D(a,1),a.m(e.parentNode,e)):a&&(In(),O(a,1,1,()=>{a=null}),Bn());const o={};i[0]&8|i[2]&4096&&(o.$$scope={dirty:i,ctx:n}),t.$set(o)},i(n){r||(D(a),D(t.$$.fragment,n),r=!0)},o(n){O(a),O(t.$$.fragment,n),r=!1},d(n){a&&a.d(n),n&&J(e),F(t,n)}}}function zk(s){let e,t,r,a;return e=new W0({props:{$$slots:{default:[Mk]},$$scope:{ctx:s}}}),r=new j0({props:{$$slots:{default:[Yk]},$$scope:{ctx:s}}}),{c(){K(e.$$.fragment),t=Z(),K(r.$$.fragment)},l(n){M(e.$$.fragment,n),t=ee(n),M(r.$$.fragment,n)},m(n,i){H(e,n,i),q(n,t,i),H(r,n,i),a=!0},p(n,i){const o={};i[2]&4096&&(o.$$scope={dirty:i,ctx:n}),e.$set(o);const l={};i[0]&392|i[2]&4096&&(l.$$scope={dirty:i,ctx:n}),r.$set(l)},i(n){a||(D(e.$$.fragment,n),D(r.$$.fragment,n),a=!0)},o(n){O(e.$$.fragment,n),O(r.$$.fragment,n),a=!1},d(n){F(e,n),n&&J(t),F(r,n)}}}function Xk(s){let e,t;return e=new G0({props:{shadow:!0,striped:!0,tableNoWFull:!0,$$slots:{default:[zk]},$$scope:{ctx:s}}}),{c(){K(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,a){H(e,r,a),t=!0},p(r,a){const n={};a[0]&392|a[2]&4096&&(n.$$scope={dirty:a,ctx:r}),e.$set(n)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){O(e.$$.fragment,r),t=!1},d(r){F(e,r)}}}function Zk(s){let e,t;return e=new Dh({props:{title:"CRL",$$slots:{default:[dI]},$$scope:{ctx:s}}}),e.$on("click",s[27]),{c(){K(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,a){H(e,r,a),t=!0},p(r,a){const n={};a[0]&1552|a[2]&4096&&(n.$$scope={dirty:a,ctx:r}),e.$set(n)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){O(e.$$.fragment,r),t=!1},d(r){F(e,r)}}}function eI(s){let e;return{c(){e=Kt("No")},l(t){e=Mt(t,"No")},m(t,r){q(t,e,r)},d(t){t&&J(e)}}}function tI(s){let e;return{c(){e=Kt("Alias Name")},l(t){e=Mt(t,"Alias Name")},m(t,r){q(t,e,r)},d(t){t&&J(e)}}}function rI(s){let e,t,r,a,n,i,o,l,u,c,f,g,v,p;return e=new st({props:{class:"!p-4"}}),r=new st({props:{$$slots:{default:[eI]},$$scope:{ctx:s}}}),n=new st({props:{$$slots:{default:[tI]},$$scope:{ctx:s}}}),o=new st({}),u=new st({}),f=new st({}),v=new st({}),{c(){K(e.$$.fragment),t=Z(),K(r.$$.fragment),a=Z(),K(n.$$.fragment),i=Z(),K(o.$$.fragment),l=Z(),K(u.$$.fragment),c=Z(),K(f.$$.fragment),g=Z(),K(v.$$.fragment)},l(h){M(e.$$.fragment,h),t=ee(h),M(r.$$.fragment,h),a=ee(h),M(n.$$.fragment,h),i=ee(h),M(o.$$.fragment,h),l=ee(h),M(u.$$.fragment,h),c=ee(h),M(f.$$.fragment,h),g=ee(h),M(v.$$.fragment,h)},m(h,d){H(e,h,d),q(h,t,d),H(r,h,d),q(h,a,d),H(n,h,d),q(h,i,d),H(o,h,d),q(h,l,d),H(u,h,d),q(h,c,d),H(f,h,d),q(h,g,d),H(v,h,d),p=!0},p(h,d){const y={};d[2]&4096&&(y.$$scope={dirty:d,ctx:h}),r.$set(y);const E={};d[2]&4096&&(E.$$scope={dirty:d,ctx:h}),n.$set(E)},i(h){p||(D(e.$$.fragment,h),D(r.$$.fragment,h),D(n.$$.fragment,h),D(o.$$.fragment,h),D(u.$$.fragment,h),D(f.$$.fragment,h),D(v.$$.fragment,h),p=!0)},o(h){O(e.$$.fragment,h),O(r.$$.fragment,h),O(n.$$.fragment,h),O(o.$$.fragment,h),O(u.$$.fragment,h),O(f.$$.fragment,h),O(v.$$.fragment,h),p=!1},d(h){F(e,h),h&&J(t),F(r,h),h&&J(a),F(n,h),h&&J(i),F(o,h),h&&J(l),F(u,h),h&&J(c),F(f,h),h&&J(g),F(v,h)}}}function Jp(s){let e,t,r=s[10],a=[];for(let i=0;i<r.length;i+=1)a[i]=Gp(Dp(s,r,i));const n=i=>O(a[i],1,1,()=>{a[i]=null});return{c(){for(let i=0;i<a.length;i+=1)a[i].c();e=Vs()},l(i){for(let o=0;o<a.length;o+=1)a[o].l(i);e=Vs()},m(i,o){for(let l=0;l<a.length;l+=1)a[l].m(i,o);q(i,e,o),t=!0},p(i,o){if(o[0]&1024){r=i[10];let l;for(l=0;l<r.length;l+=1){const u=Dp(i,r,l);a[l]?(a[l].p(u,o),D(a[l],1)):(a[l]=Gp(u),a[l].c(),D(a[l],1),a[l].m(e.parentNode,e))}for(In(),l=r.length;l<a.length;l+=1)n(l);Bn()}},i(i){if(!t){for(let o=0;o<r.length;o+=1)D(a[o]);t=!0}},o(i){a=a.filter(Boolean);for(let o=0;o<a.length;o+=1)O(a[o]);t=!1},d(i){K0(a,i),i&&J(e)}}}function sI(s){let e=s[67]+1+"",t;return{c(){t=Kt(e)},l(r){t=Mt(r,e)},m(r,a){q(r,t,a)},p:xn,d(r){r&&J(t)}}}function aI(s){let e=s[65]+"",t;return{c(){t=Kt(e)},l(r){t=Mt(r,e)},m(r,a){q(r,t,a)},p(r,a){a[0]&1024&&e!==(e=r[65]+"")&&q0(t,e)},d(r){r&&J(t)}}}function nI(s){let e,t,r,a,n,i,o,l,u,c,f,g,v,p,h;return e=new we({props:{class:"!p-4"}}),r=new we({props:{class:"w-10",$$slots:{default:[sI]},$$scope:{ctx:s}}}),n=new we({props:{class:"w-64",$$slots:{default:[aI]},$$scope:{ctx:s}}}),o=new we({}),u=new we({}),f=new we({}),v=new we({}),{c(){K(e.$$.fragment),t=Z(),K(r.$$.fragment),a=Z(),K(n.$$.fragment),i=Z(),K(o.$$.fragment),l=Z(),K(u.$$.fragment),c=Z(),K(f.$$.fragment),g=Z(),K(v.$$.fragment),p=Z()},l(d){M(e.$$.fragment,d),t=ee(d),M(r.$$.fragment,d),a=ee(d),M(n.$$.fragment,d),i=ee(d),M(o.$$.fragment,d),l=ee(d),M(u.$$.fragment,d),c=ee(d),M(f.$$.fragment,d),g=ee(d),M(v.$$.fragment,d),p=ee(d)},m(d,y){H(e,d,y),q(d,t,y),H(r,d,y),q(d,a,y),H(n,d,y),q(d,i,y),H(o,d,y),q(d,l,y),H(u,d,y),q(d,c,y),H(f,d,y),q(d,g,y),H(v,d,y),q(d,p,y),h=!0},p(d,y){const E={};y[2]&4096&&(E.$$scope={dirty:y,ctx:d}),r.$set(E);const k={};y[0]&1024|y[2]&4096&&(k.$$scope={dirty:y,ctx:d}),n.$set(k)},i(d){h||(D(e.$$.fragment,d),D(r.$$.fragment,d),D(n.$$.fragment,d),D(o.$$.fragment,d),D(u.$$.fragment,d),D(f.$$.fragment,d),D(v.$$.fragment,d),h=!0)},o(d){O(e.$$.fragment,d),O(r.$$.fragment,d),O(n.$$.fragment,d),O(o.$$.fragment,d),O(u.$$.fragment,d),O(f.$$.fragment,d),O(v.$$.fragment,d),h=!1},d(d){F(e,d),d&&J(t),F(r,d),d&&J(a),F(n,d),d&&J(i),F(o,d),d&&J(l),F(u,d),d&&J(c),F(f,d),d&&J(g),F(v,d),d&&J(p)}}}function Gp(s){let e,t;return e=new Nn({props:{$$slots:{default:[nI]},$$scope:{ctx:s}}}),{c(){K(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,a){H(e,r,a),t=!0},p(r,a){const n={};a[0]&1024|a[2]&4096&&(n.$$scope={dirty:a,ctx:r}),e.$set(n)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){O(e.$$.fragment,r),t=!1},d(r){F(e,r)}}}function iI(s){let e,t,r;function a(i){s[34](i)}let n={style:"filled",id:"floating_filled",name:"floating_filled",type:"text",label:"Alias Name"};return s[4]!==void 0&&(n.value=s[4]),e=new Xf({props:n}),Qf.push(()=>Yf(e,"value",a,s[4])),{c(){K(e.$$.fragment)},l(i){M(e.$$.fragment,i)},m(i,o){H(e,i,o),r=!0},p(i,o){const l={};!t&&o[0]&16&&(t=!0,l.value=i[4],zf(()=>t=!1)),e.$set(l)},i(i){r||(D(e.$$.fragment,i),r=!0)},o(i){O(e.$$.fragment,i),r=!1},d(i){F(e,i)}}}function oI(s){let e,t,r;return{c(){e=M0("input"),this.h()},l(a){e=H0(a,"INPUT",{type:!0,id:!0,class:!0}),this.h()},h(){es(e,"type","file"),es(e,"id","crlUpload"),es(e,"class","block w-full disabled:cursor-not-allowed disabled:opacity-50 focus:border-blue-500 focus:ring-blue-500 dark:focus:border-blue-500 dark:focus:ring-blue-500 bg-gray-50 text-gray-900 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 border-gray-300 dark:border-gray-600 p-2.5 text-sm rounded-lg border !p-0 dark:text-gray-400")},m(a,n){q(a,e,n),t||(r=F0(e,"change",s[19]),t=!0)},p:xn,d(a){a&&J(e),t=!1,r()}}}function lI(s){let e;return{c(){e=Kt("Upload")},l(t){e=Mt(t,"Upload")},m(t,r){q(t,e,r)},d(t){t&&J(e)}}}function uI(s){let e,t;return e=new J0({props:{color:"dark",$$slots:{default:[lI]},$$scope:{ctx:s}}}),e.$on("click",s[20]),{c(){K(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,a){H(e,r,a),t=!0},p(r,a){const n={};a[2]&4096&&(n.$$scope={dirty:a,ctx:r}),e.$set(n)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){O(e.$$.fragment,r),t=!1},d(r){F(e,r)}}}function cI(s){let e,t,r,a,n,i,o,l,u,c,f,g,v,p;return e=new we({props:{class:"!p-4"}}),r=new we({props:{class:"w-10"}}),n=new we({props:{class:"w-64",$$slots:{default:[iI]},$$scope:{ctx:s}}}),o=new we({props:{class:"w-96",$$slots:{default:[oI]},$$scope:{ctx:s}}}),u=new we({props:{class:"w-36",$$slots:{default:[uI]},$$scope:{ctx:s}}}),f=new we({}),v=new we({}),{c(){K(e.$$.fragment),t=Z(),K(r.$$.fragment),a=Z(),K(n.$$.fragment),i=Z(),K(o.$$.fragment),l=Z(),K(u.$$.fragment),c=Z(),K(f.$$.fragment),g=Z(),K(v.$$.fragment)},l(h){M(e.$$.fragment,h),t=ee(h),M(r.$$.fragment,h),a=ee(h),M(n.$$.fragment,h),i=ee(h),M(o.$$.fragment,h),l=ee(h),M(u.$$.fragment,h),c=ee(h),M(f.$$.fragment,h),g=ee(h),M(v.$$.fragment,h)},m(h,d){H(e,h,d),q(h,t,d),H(r,h,d),q(h,a,d),H(n,h,d),q(h,i,d),H(o,h,d),q(h,l,d),H(u,h,d),q(h,c,d),H(f,h,d),q(h,g,d),H(v,h,d),p=!0},p(h,d){const y={};d[0]&16|d[2]&4096&&(y.$$scope={dirty:d,ctx:h}),n.$set(y);const E={};d[2]&4096&&(E.$$scope={dirty:d,ctx:h}),o.$set(E);const k={};d[2]&4096&&(k.$$scope={dirty:d,ctx:h}),u.$set(k)},i(h){p||(D(e.$$.fragment,h),D(r.$$.fragment,h),D(n.$$.fragment,h),D(o.$$.fragment,h),D(u.$$.fragment,h),D(f.$$.fragment,h),D(v.$$.fragment,h),p=!0)},o(h){O(e.$$.fragment,h),O(r.$$.fragment,h),O(n.$$.fragment,h),O(o.$$.fragment,h),O(u.$$.fragment,h),O(f.$$.fragment,h),O(v.$$.fragment,h),p=!1},d(h){F(e,h),h&&J(t),F(r,h),h&&J(a),F(n,h),h&&J(i),F(o,h),h&&J(l),F(u,h),h&&J(c),F(f,h),h&&J(g),F(v,h)}}}function fI(s){let e,t,r,a=s[9]==1&&Jp(s);return t=new Nn({props:{$$slots:{default:[cI]},$$scope:{ctx:s}}}),{c(){a&&a.c(),e=Z(),K(t.$$.fragment)},l(n){a&&a.l(n),e=ee(n),M(t.$$.fragment,n)},m(n,i){a&&a.m(n,i),q(n,e,i),H(t,n,i),r=!0},p(n,i){n[9]==1?a?(a.p(n,i),i[0]&512&&D(a,1)):(a=Jp(n),a.c(),D(a,1),a.m(e.parentNode,e)):a&&(In(),O(a,1,1,()=>{a=null}),Bn());const o={};i[0]&16|i[2]&4096&&(o.$$scope={dirty:i,ctx:n}),t.$set(o)},i(n){r||(D(a),D(t.$$.fragment,n),r=!0)},o(n){O(a),O(t.$$.fragment,n),r=!1},d(n){a&&a.d(n),n&&J(e),F(t,n)}}}function hI(s){let e,t,r,a;return e=new W0({props:{$$slots:{default:[rI]},$$scope:{ctx:s}}}),r=new j0({props:{$$slots:{default:[fI]},$$scope:{ctx:s}}}),{c(){K(e.$$.fragment),t=Z(),K(r.$$.fragment)},l(n){M(e.$$.fragment,n),t=ee(n),M(r.$$.fragment,n)},m(n,i){H(e,n,i),q(n,t,i),H(r,n,i),a=!0},p(n,i){const o={};i[2]&4096&&(o.$$scope={dirty:i,ctx:n}),e.$set(o);const l={};i[0]&1552|i[2]&4096&&(l.$$scope={dirty:i,ctx:n}),r.$set(l)},i(n){a||(D(e.$$.fragment,n),D(r.$$.fragment,n),a=!0)},o(n){O(e.$$.fragment,n),O(r.$$.fragment,n),a=!1},d(n){F(e,n),n&&J(t),F(r,n)}}}function dI(s){let e,t;return e=new G0({props:{shadow:!0,striped:!0,tableNoWFull:!0,$$slots:{default:[hI]},$$scope:{ctx:s}}}),{c(){K(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,a){H(e,r,a),t=!0},p(r,a){const n={};a[0]&1552|a[2]&4096&&(n.$$scope={dirty:a,ctx:r}),e.$set(n)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){O(e.$$.fragment,r),t=!1},d(r){F(e,r)}}}function gI(s){let e,t,r,a,n,i,o,l,u,c=0;t=new Dh({props:{open:!0,title:"Machine Certificates",$$slots:{default:[bk]},$$scope:{ctx:s}}}),t.$on("click",s[24]),a=new Dh({props:{title:"CA Certificates",$$slots:{default:[Pk]},$$scope:{ctx:s}}}),a.$on("click",s[25]),i=new Dh({props:{title:"Remote Certificates",$$slots:{default:[Xk]},$$scope:{ctx:s}}}),i.$on("click",s[26]);let f=Zk(s);return{c(){e=Z(),K(t.$$.fragment),r=Z(),K(a.$$.fragment),n=Z(),K(i.$$.fragment),o=Z(),f&&f.c(),l=Vs()},l(g){e=ee(g),M(t.$$.fragment,g),r=ee(g),M(a.$$.fragment,g),n=ee(g),M(i.$$.fragment,g),o=ee(g),f&&f.l(g),l=Vs()},m(g,v){q(g,e,v),H(t,g,v),q(g,r,v),H(a,g,v),q(g,n,v),H(i,g,v),q(g,o,v),f&&f.m(g,v),q(g,l,v),u=!0},p(g,v){const p={};v[0]&24672|v[2]&4096&&(p.$$scope={dirty:v,ctx:g}),t.$set(p);const h={};v[0]&6148|v[2]&4096&&(h.$$scope={dirty:v,ctx:g}),a.$set(h);const d={};v[0]&392|v[2]&4096&&(d.$$scope={dirty:v,ctx:g}),i.$set(d),f.p(g,v)},i(g){u||(D(c),D(t.$$.fragment,g),D(a.$$.fragment,g),D(i.$$.fragment,g),D(f),u=!0)},o(g){O(c),O(t.$$.fragment,g),O(a.$$.fragment,g),O(i.$$.fragment,g),O(f),u=!1},d(g){g&&J(e),F(t,g),g&&J(r),F(a,g),g&&J(n),F(i,g),g&&J(o),f&&f.d(g),g&&J(l)}}}function mI(s){let e,t;return e=new b1({props:{style:"underline",$$slots:{default:[gI]},$$scope:{ctx:s}}}),{c(){K(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,a){H(e,r,a),t=!0},p(r,a){const n={};a[0]&32767|a[2]&4096&&(n.$$scope={dirty:a,ctx:r}),e.$set(n)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){O(e.$$.fragment,r),t=!1},d(r){F(e,r)}}}function pI(s,e,t){let r="",a={},n={},i=0,o=[],l,u;E1.subscribe(be=>{l=be}),Rm.subscribe(be=>{o=be}),fd.subscribe(be=>{n=be});let c=null,f="",g="",v=null,p="",h="",d=null,y="",E="",k=null,R="",V="",L="",ne="",se="",Se=0,Te=[];async function ye(){const be=await fetch(window.location.origin+"/GetRemotecert",{method:"POST",body:u});be.status==200&&(t(8,Te=await be.json()),console.log(Te),t(7,Se=1))}let Ce=0,Ve=[];async function Pe(){const be=await fetch(window.location.origin+"/GeTCRL",{method:"POST",body:u});be.status==200&&(t(10,Ve=await be.json()),console.log(Ve),t(9,Ce=1))}let pe=0,$e=[];async function ie(){const be=await fetch(window.location.origin+"/getCaCERt",{method:"POST",body:u});be.status==200&&(t(12,$e=await be.json()),console.log($e),t(11,pe=1))}let ot=0,Me=[];async function te(){const be=await fetch(window.location.origin+"/getMachinECert",{method:"POST",body:u});be.status==200&&(t(14,Me=await be.json()),console.log(Me),t(13,ot=1))}async function le(be){const it=be.target.files[0];if(it){if(k=it,l){const Ht=l.match(/.{1,2}/g).map(xr=>parseInt(xr,16));u=new Uint8Array(Ht)}const bt=new FileReader;bt.onload=Gt=>{se=new Uint8Array(Gt.target.result)},bt.readAsArrayBuffer(it)}}async function ae(){if(L==""||ne==""||se=="")alert("Alias Name is null or PKCS#12 password is null or machineCertData is null"),console.log(L),console.log(ne),console.log(se);else if(k&&se!=""){console.log(L),console.log(ne),console.log(se);let be,it=0;try{const bt=Cr.util.createBuffer(se),Gt=Cr.asn1.fromDer(bt);be=Cr.pkcs12.pkcs12FromAsn1(Gt,ne)}catch(bt){console.log("error: "+bt),it=1,alert("p12 password is invalid")}if(it==0){const Gt=be.getBags({bagType:Cr.pki.oids.certBag})[Cr.pki.oids.certBag][0];console.log("certBag"),console.log(Gt);const Ht=be.getBags({bagType:Cr.pki.oids.pkcs8ShroudedKeyBag});console.log("bags2"),console.log(Ht);const xr=Ht[Cr.pki.oids.pkcs8ShroudedKeyBag][0];console.log("keyBag"),console.log(xr);let da="",fo="",Nm=0;if(Gt.cert==null){let pu={type:"CERTIFICATE",body:Cr.asn1.toDer(Gt.asn1).getBytes()};da=Cr.pem.encode(pu),console.log(da),console.log(da.length)}else da=Cr.pki.certificateToPem(Gt.cert),console.log(da),console.log(da.length);if(xr.key==null){let pu={type:"PRIVATE KEY",body:Cr.asn1.toDer(xr.asn1).getBytes()};fo=Cr.pem.encode(pu);let ah="";ah=Cr.pki.getPrivateKeyOid(xr.asn1),console.log(ah),ah=="1.2.840.10045.2.1"?(console.log("EC private key"),Nm=1):ah=="1.2.840.113549.1.1.1"&&console.log("RSA Private key")}else fo=Cr.pki.privateKeyToPem(xr.key);console.log("KeyPem"),console.log(fo),console.log(fo.length);const cd=new TextEncoder;let Tm=cd.encode(L);R=new Uint8Array(da.length+u.length+64),R.set(u,0),R.set(Tm,u.length);let y1=cd.encode(da);R.set(y1,u.length+64),V=new Uint8Array(fo.length+u.length+64),V.set(u,0),V.set(Tm,u.length);let v1=cd.encode(fo);V.set(v1,u.length+64),(await fetch(window.location.origin+"/UploadMachineCert",{method:"POST",body:R,headers:{"Content-Type":"application/octet-stream"}})).status==200?console.log("200 Upload machineCertContent"):console.log("error Upload machineCertContent"),Nm==1?(await fetch(window.location.origin+"/UploadEcMachinePrivate",{method:"POST",body:V,headers:{"Content-Type":"application/octet-stream"}})).status==200?console.log("200 Upload machineEcPrivateKeyContent"):console.log("error Upload machineEcPrivateKeyContent"):(await fetch(window.location.origin+"/UploadrsaMachinePrivate",{method:"POST",body:V,headers:{"Content-Type":"application/octet-stream"}})).status==200?console.log("200 Upload machineRSAPrivateKeyContent"):console.log("error Upload machineRSAPrivateKeyContent"),te()}}}async function me(be){const it=be.target.files[0];if(it){if(c=it,l){const Ht=l.match(/.{1,2}/g).map(xr=>parseInt(xr,16));u=new Uint8Array(Ht)}const bt=new FileReader;bt.onload=Gt=>{const Ht=new Uint8Array(Gt.target.result);f=new Uint8Array(Ht.length+u.length+64),f.set(u,0),f.set(Ht,u.length+64)},bt.readAsArrayBuffer(it)}}async function Ae(){if(g==""||f=="")alert("Alias Name is null or caCertContent is null");else if(c){console.log(g);let it=new TextEncoder().encode(g);console.log("caCertContent"),console.log(f),f.set(it,u.length),console.log(g),(await fetch(window.location.origin+"/UploaDCaCert",{method:"POST",body:f,headers:{"Content-Type":"application/octet-stream"}})).status==200?(console.log("200 UploadCACert"),ie()):console.log("error UploadCACert")}}async function qe(be){const it=be.target.files[0];if(it){if(d=it,l){const Ht=l.match(/.{1,2}/g).map(xr=>parseInt(xr,16));u=new Uint8Array(Ht)}const bt=new FileReader;bt.onload=Gt=>{const Ht=new Uint8Array(Gt.target.result);y=new Uint8Array(Ht.length+u.length+64),y.set(u,0),y.set(Ht,u.length+64)},bt.readAsArrayBuffer(it)}}async function nt(){if(E==""||y=="")alert("Alias Name is null or content is null");else if(d){console.log(E);let it=new TextEncoder().encode(E);y.set(it,u.length),(await fetch(window.location.origin+"/UpLoaDcrl",{method:"POST",body:y,headers:{"Content-Type":"application/octet-stream"}})).status==200?(console.log("200 Upload crl"),Pe()):console.log("error Upload crl")}}async function Ue(be){const it=be.target.files[0];if(it){if(v=it,l){const Ht=l.match(/.{1,2}/g).map(xr=>parseInt(xr,16));u=new Uint8Array(Ht)}const bt=new FileReader;bt.onload=Gt=>{const Ht=new Uint8Array(Gt.target.result);p=new Uint8Array(Ht.length+u.length+64),p.set(u,0),p.set(Ht,u.length+64)},bt.readAsArrayBuffer(it)}}async function Ne(){if(h==""||p=="")alert("Alias Name is null or content is null");else if(v){console.log(h);let it=new TextEncoder().encode(h);p.set(it,u.length),(await fetch(window.location.origin+"/UpLoadRemoteCert",{method:"POST",body:p,headers:{"Content-Type":"application/octet-stream"}})).status==200?(console.log("200 UploadRemoteCert"),ye()):console.log("error UploadRemoteCert")}}function fe(){if(console.log("save certificate"),o.length!=0&&(o=[]),a.config.authentication_certificate_certificateSettings.checkCert!=r.config.authentication_certificate_certificateSettings.checkCert){n.config.authentication_certificate_certificateSettings.checkCert=a.config.authentication_certificate_certificateSettings.checkCert;let be="Check the validity period of certificates and CRLs is changed to "+a.config.authentication_certificate_certificateSettings.checkCert;o=[...o,be]}Rm.set(o),fd.set(n),console.log(o)}const ht=()=>{te()},lt=()=>{ie()},ut=()=>{ye()},Oe=()=>{Pe()};async function qt(){const be=await fetch(window.location.origin+"/GetCertificateData",{method:"POST",body:u});be.status==200&&(r=await be.json(),console.log(r),k1.set(r),t(0,a=JSON.parse(JSON.stringify(r))),n=JSON.parse(JSON.stringify(r)),fd.set(n),t(1,i=1))}A1(()=>{if(console.log("certificate sessionid: "),console.log(l),l&&r==""){const it=l.match(/.{1,2}/g).map(bt=>parseInt(bt,16));u=new Uint8Array(it),qt(),ye(),ie(),te(),Pe()}else if(l&&r!=""){const it=l.match(/.{1,2}/g).map(bt=>parseInt(bt,16));u=new Uint8Array(it),t(1,i=1),o.length==0&&(t(0,a=JSON.parse(JSON.stringify(n))),t(0,a.config.authentication_certificate_certificateSettings=JSON.parse(JSON.stringify(r.config.authentication_certificate_certificateSettings)),a))}});function Jt(be){s.$$.not_equal(a.config.authentication_certificate_certificateSettings.checkCert,be)&&(a.config.authentication_certificate_certificateSettings.checkCert=be,t(0,a))}function f1(be){s.$$.not_equal(a.config.authentication_certificate_certificateSettings.checkCert,be)&&(a.config.authentication_certificate_certificateSettings.checkCert=be,t(0,a))}function h1(be){L=be,t(5,L)}function d1(be){ne=be,t(6,ne)}function g1(be){g=be,t(2,g)}function m1(be){h=be,t(3,h)}function p1(be){E=be,t(4,E)}return[a,i,g,h,E,L,ne,Se,Te,Ce,Ve,pe,$e,ot,Me,le,ae,me,Ae,qe,nt,Ue,Ne,fe,ht,lt,ut,Oe,Jt,f1,h1,d1,g1,m1,p1]}class TI extends w1{constructor(e){super(),S1(this,e,pI,mI,C1,{},null,[-1,-1,-1])}}export{TI as default};
