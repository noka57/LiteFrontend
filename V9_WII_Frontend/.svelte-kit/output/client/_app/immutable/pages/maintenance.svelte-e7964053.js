import{S as $e,i as Te,s as Ae,l as p,r as z,a as F,x as ae,m as h,n as u,u as H,h as l,c as C,y as se,p as c,b as K,I as o,z as oe,J as Se,f as B,t as q,d as Oe,C as re,o as De,q as me,a3 as Fe,a4 as Ce,a5 as Ue,V as _e,W as ye,F as Je,g as Me}from"../chunks/index-3c8a32e2.js";import{s as Pe}from"../chunks/Indicator.svelte_svelte_type_style_lang-cfcdb687.js";import{B as be}from"../chunks/Button-4ab8781d.js";import{T as xe}from"../chunks/Toggle-040354fe.js";import{J as we,M as Ee,z as ne}from"../chunks/configG-2bb37b04.js";import"../chunks/index-10bc815a.js";import"../chunks/Radio-623cb2a5.js";function Ne(f){let e;return{c(){e=z("Update")},l(t){e=H(t,"Update")},m(t,a){K(t,e,a)},d(t){t&&l(e)}}}function ke(f){let e,t;return{c(){e=p("p"),t=z("It's not valid firmware. Please choose valid one for update"),this.h()},l(a){e=h(a,"P",{style:!0});var n=u(e);t=H(n,"It's not valid firmware. Please choose valid one for update"),n.forEach(l),this.h()},h(){me(e,"color","red"),me(e,"font-size","18px")},m(a,n){K(a,e,n),o(e,t)},d(a){a&&l(e)}}}function ve(f){let e,t,a;function n(i){f[7](i)}let _={};return f[0].config.system_maintenance.fotaEn!==void 0&&(_.checked=f[0].config.system_maintenance.fotaEn),e=new xe({props:_}),Fe.push(()=>Ce(e,"checked",n,f[0].config.system_maintenance.fotaEn)),e.$on("change",f[6]),{c(){ae(e.$$.fragment)},l(i){se(e.$$.fragment,i)},m(i,g){oe(e,i,g),a=!0},p(i,g){const k={};!t&&g&1&&(t=!0,k.checked=i[0].config.system_maintenance.fotaEn,Ue(()=>t=!1)),e.$set(k)},i(i){a||(B(e.$$.fragment,i),a=!0)},o(i){q(e.$$.fragment,i),a=!1},d(i){re(e,i)}}}function Be(f){let e,t,a;return{c(){e=_e("svg"),t=_e("path"),a=z("Save"),this.h()},l(n){e=ye(n,"svg",{class:!0,fill:!0,stroke:!0,"stroke-width":!0,viewBox:!0,xmlns:!0});var _=u(e);t=ye(_,"path",{d:!0,"stroke-linecap":!0,"stroke-linejoin":!0}),u(t).forEach(l),_.forEach(l),a=H(n,"Save"),this.h()},h(){c(t,"d","M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"),c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(e,"class","mr-2 w-6 h-6"),c(e,"fill","none"),c(e,"stroke","currentColor"),c(e,"stroke-width","2"),c(e,"viewBox","0 0 24 24"),c(e,"xmlns","http://www.w3.org/2000/svg")},m(n,_){K(n,e,_),o(e,t),K(n,a,_)},p:Je,d(n){n&&l(e),n&&l(a)}}}function Ve(f){let e,t,a,n,_,i,g,k,$,T,y,E,S,V,O,M,P,I,R,s,v,r,U,x,N,Y,W,J,Z,G,ee,j,Q,te,le;y=new be({props:{$$slots:{default:[Ne]},$$scope:{ctx:f}}}),y.$on("click",f[4]);let b=f[2]==0&&ke(),d=f[1]==1&&ve(f);return J=new be({props:{color:"blue",pill:!0,$$slots:{default:[Be]},$$scope:{ctx:f}}}),J.$on("click",f[5]),{c(){e=p("table"),t=p("tr"),a=p("td"),n=p("p"),_=z("Update Local Firmware"),i=F(),g=p("td"),k=p("input"),$=F(),T=p("td"),ae(y.$$.fragment),E=F(),S=p("td"),b&&b.c(),V=F(),O=p("tr"),M=p("td"),P=p("p"),I=z("Enable EW-FOTA"),R=F(),s=p("td"),d&&d.c(),v=F(),r=p("tr"),U=p("td"),x=F(),N=p("td"),Y=F(),W=p("td"),ae(J.$$.fragment),Z=F(),G=p("td"),ee=F(),j=p("td"),this.h()},l(m){e=h(m,"TABLE",{});var w=u(e);t=h(w,"TR",{});var A=u(t);a=h(A,"TD",{class:!0});var L=u(a);n=h(L,"P",{class:!0});var ce=u(n);_=H(ce,"Update Local Firmware"),ce.forEach(l),L.forEach(l),i=C(A),g=h(A,"TD",{class:!0});var ie=u(g);k=h(ie,"INPUT",{type:!0,id:!0,class:!0}),ie.forEach(l),$=C(A),T=h(A,"TD",{class:!0});var fe=u(T);se(y.$$.fragment,fe),fe.forEach(l),E=C(A),S=h(A,"TD",{class:!0,colspan:!0});var de=u(S);b&&b.l(de),de.forEach(l),A.forEach(l),V=C(w),O=h(w,"TR",{});var X=u(O);M=h(X,"TD",{class:!0});var ue=u(M);P=h(ue,"P",{class:!0});var ge=u(P);I=H(ge,"Enable EW-FOTA"),ge.forEach(l),ue.forEach(l),R=C(X),s=h(X,"TD",{class:!0});var pe=u(s);d&&d.l(pe),pe.forEach(l),X.forEach(l),v=C(w),r=h(w,"TR",{class:!0});var D=u(r);U=h(D,"TD",{}),u(U).forEach(l),x=C(D),N=h(D,"TD",{}),u(N).forEach(l),Y=C(D),W=h(D,"TD",{});var he=u(W);se(J.$$.fragment,he),he.forEach(l),Z=C(D),G=h(D,"TD",{}),u(G).forEach(l),ee=C(D),j=h(D,"TD",{}),u(j).forEach(l),D.forEach(l),w.forEach(l),this.h()},h(){c(n,"class","pl-10 pt-5 text-lg font-light text-right"),c(a,"class","w-85"),c(k,"type","file"),c(k,"id","FwrUpload"),c(k,"class","block w-full disabled:cursor-not-allowed disabled:opacity-50 focus:border-blue-500 focus:ring-blue-500 dark:focus:border-blue-500 dark:focus:ring-blue-500 bg-gray-50 text-gray-900 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 border-gray-300 dark:border-gray-600 p-2.5 text-sm rounded-lg border !p-0 dark:text-gray-400"),c(g,"class","pl-5 pt-5"),c(T,"class","pl-5 pt-5"),c(S,"class","pl-5 pt-5"),c(S,"colspan","2"),c(P,"class","pl-10 pt-5 text-lg font-light text-right"),c(M,"class","w-85"),c(s,"class","pl-5 pt-5"),c(r,"class","pt-5")},m(m,w){K(m,e,w),o(e,t),o(t,a),o(a,n),o(n,_),o(t,i),o(t,g),o(g,k),o(t,$),o(t,T),oe(y,T,null),o(t,E),o(t,S),b&&b.m(S,null),o(e,V),o(e,O),o(O,M),o(M,P),o(P,I),o(O,R),o(O,s),d&&d.m(s,null),o(e,v),o(e,r),o(r,U),o(r,x),o(r,N),o(r,Y),o(r,W),oe(J,W,null),o(r,Z),o(r,G),o(r,ee),o(r,j),Q=!0,te||(le=Se(k,"change",f[3]),te=!0)},p(m,[w]){const A={};w&131072&&(A.$$scope={dirty:w,ctx:m}),y.$set(A),m[2]==0?b||(b=ke(),b.c(),b.m(S,null)):b&&(b.d(1),b=null),m[1]==1?d?(d.p(m,w),w&2&&B(d,1)):(d=ve(m),d.c(),B(d,1),d.m(s,null)):d&&(Me(),q(d,1,1,()=>{d=null}),Oe());const L={};w&131072&&(L.$$scope={dirty:w,ctx:m}),J.$set(L)},i(m){Q||(B(y.$$.fragment,m),B(d),B(J.$$.fragment,m),Q=!0)},o(m){q(y.$$.fragment,m),q(d),q(J.$$.fragment,m),Q=!1},d(m){m&&l(e),re(y),b&&b.d(),d&&d.d(),re(J),te=!1,le()}}}function Ie(f,e,t){let a="",n={},_={},i=0,g=[],k=null,$,T=1,y,E;Pe.subscribe(s=>{y=s}),we.subscribe(s=>{a=s}),Ee.subscribe(s=>{g=s}),ne.subscribe(s=>{_=s});async function S(s){const v=s.target.files[0];if(v){if(k=v,y){const x=y.match(/.{1,2}/g).map(N=>parseInt(N,16));E=new Uint8Array(x)}const r=new FileReader;r.onload=U=>{const x=new Uint8Array(U.target.result);$=new Uint8Array(x.length+E.length),$.set(E,0),$.set(x,E.length)},r.readAsArrayBuffer(v)}}async function V(){k&&(t(2,T=0),$[E.length]==65&&$[E.length+1]==80&&$[E.length+2]==118&&$[E.length+3]==50?(console.log("is APv2!"),t(2,T=1)):(console.log("is not APv2"),t(2,T=0)),T==1&&(await fetch(window.location.origin+"/updateFwr",{method:"POST",body:$,headers:{"Content-Type":"application/octet-stream"}})).status==200&&console.log("Update Fwr 200 OK"))}function O(s,v){for(const r in s)if(typeof s[r]=="object"&&typeof v[r]=="object")O(s[r],v[r]);else if(s[r]!=v[r]){let U="Value of "+r+" has changed to "+s[r];g=[...g,U]}}function M(){console.log(`Save Maintenance Setting\r
`),g.length!=0&&(g=[]),O(n,a),Ee.set(g),ne.set(n),console.log(g)}function P(){console.log("EW_FOTA_CHACK()"),console.log(n.config.system_maintenance.fotaEn),n.config.system_maintenance.fotaEn?t(0,n.config.system_maintenance.fotaEn=1,n):t(0,n.config.system_maintenance.fotaEn=0,n)}async function I(){const s=await fetch(window.location.origin+"/getMaintenanceData",{method:"POST",body:E});s.status==200&&(a=await s.json(),console.log(a),we.set(a),t(0,n=JSON.parse(JSON.stringify(a))),_=JSON.parse(JSON.stringify(a)),ne.set(_),t(1,i=1))}De(()=>{if(console.log("maintenance sessionid: "),console.log(y),y&&a==""){const v=y.match(/.{1,2}/g).map(r=>parseInt(r,16));E=new Uint8Array(v),I()}else y&&a!=""&&(g.length==0?t(0,n=JSON.parse(JSON.stringify(a))):t(0,n=JSON.parse(JSON.stringify(_))),t(1,i=1))});function R(s){f.$$.not_equal(n.config.system_maintenance.fotaEn,s)&&(n.config.system_maintenance.fotaEn=s,t(0,n))}return[n,i,T,S,V,M,P,R]}class Ge extends $e{constructor(e){super(),Te(this,e,Ie,Ve,Ae,{})}}export{Ge as default};
